THREE.WebGLRenderer3=function(e){console.log("THREE.WebGLRenderer3",THREE.REVISION),e=e||{};var t,i=this,r=void 0!==e.canvas?e.canvas:document.createElement("canvas"),n=void 0!==e.devicePixelRatio?e.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1;try{var o=e.contextAttributes||{};t=r.getContext("webgl",o)||r.getContext("experimental-webgl",o)}catch(a){console.error(a)}var s="highp",l={};null!==t&&(l.element_index_uint=t.getExtension("OES_element_index_uint"),l.texture_float=t.getExtension("OES_texture_float"),l.texture_float_linear=t.getExtension("OES_texture_float_linear"),l.standard_derivatives=t.getExtension("OES_standard_derivatives"),l.texture_filter_anisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),l.compressed_texture_s3tc=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),t.clearColor(0,0,0,1),t.clearDepth(1),t.clearStencil(0),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.enable(t.CULL_FACE),t.frontFace(t.CCW),t.cullFace(t.BACK),t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.clearColor(0,0,0,0));var c=new THREE.Color(0),h=0,u=new THREE.Vector3,d=new THREE.Frustum,p=new THREE.Matrix3,f=new THREE.Matrix4,m=new THREE.Matrix4,g={},v=function(e,r){var n=e.id.toString()+"+"+r.id.toString();if(void 0!==g[n])return g[n];for(var o=e.vertices,a=e.faces,s=[],l=function(e){s.push(e.x,e.y,e.z)},c=[],h=function(e){c.push(e.x,e.y,e.z)},u=0,d=a.length;d>u;u++){var p=a[u],f=p.vertexNormals.length>0;l(o[p.a]),l(o[p.b]),l(o[p.c]),f===!0?(h(p.vertexNormals[0]),h(p.vertexNormals[1]),h(p.vertexNormals[2])):(h(p.normal),h(p.normal),h(p.normal)),p instanceof THREE.Face4&&(l(o[p.a]),l(o[p.c]),l(o[p.d]),f===!0?(h(p.vertexNormals[0]),h(p.vertexNormals[2]),h(p.vertexNormals[3])):(h(p.normal),h(p.normal),h(p.normal)))}var m={positions:t.createBuffer(),normals:t.createBuffer(),count:s.length/3};return t.bindBuffer(t.ARRAY_BUFFER,m.positions),t.bufferData(t.ARRAY_BUFFER,new Float32Array(s),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,m.normals),t.bufferData(t.ARRAY_BUFFER,new Float32Array(c),t.STATIC_DRAW),g[n]=m,i.info.memory.geometries++,m},E={},y={},T=function(e){if(void 0!==E[e.id])return E[e.id];var r=["precision "+s+" float;","attribute vec3 position;","attribute vec3 normal;","uniform mat4 modelViewMatrix;","uniform mat3 normalMatrix;","uniform mat4 projectionMatrix;",""].join("\n"),n=["precision "+s+" float;",""].join("\n");e instanceof THREE.ShaderMaterial?(r+=e.vertexShader,n+=e.fragmentShader):e instanceof THREE.MeshNormalMaterial?(r+=["varying vec3 vNormal;","void main() {","	vNormal = normalize( normalMatrix * normal );","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),n+=["varying vec3 vNormal;","uniform float opacity;","void main() {","	gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );","}"].join("\n")):(r+=["void main() {","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),n+=["void main() {","	gl_FragColor = vec4( 1.0, 0, 0, 1.0 );","}"].join("\n"));var o,a=r+n;return void 0!==y[a]?(o=y[a],E[e.id]=o):(o=t.createProgram(),t.attachShader(o,_(t.VERTEX_SHADER,r)),t.attachShader(o,_(t.FRAGMENT_SHADER,n)),t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)===!0?(y[a]=o,E[e.id]=o,i.info.memory.programs++):(console.error("VALIDATE_STATUS: "+t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("GL_ERROR: "+t.getError()),o=T(new THREE.MeshBasicMaterial),E[e.id]=o)),o},_=function(e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)!==!0?(console.error(t.getShaderInfoLog(r),i),null):r};this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}},this.domElement=r,this.extensions=l,this.autoClear=!0,this.setClearColor=function(e,i){c.set(e),h=void 0!==i?i:1,t.clearColor(c.r,c.g,c.b,h)},this.setSize=function(e,i,o){r.width=e*n,r.height=i*n,1!==n&&o!==!1&&(r.style.width=e+"px",r.style.height=i+"px"),t.viewport(0,0,r.width,r.height)},this.clear=function(e,i,r){var n=0;(void 0===e||e)&&(n|=t.COLOR_BUFFER_BIT),(void 0===i||i)&&(n|=t.DEPTH_BUFFER_BIT),(void 0===r||r)&&(n|=t.STENCIL_BUFFER_BIT),t.clear(n)};var b,x,R,w=null,H=function(e){e!==w&&(e===THREE.NoBlending?t.disable(t.BLEND):t.enable(t.BLEND),w=e)},S=[],M=[],C=function(e,t){if(e.visible!==!1){e instanceof THREE.Mesh&&d.intersectsObject(e)===!0&&(null!==e.renderDepth?e.z=e.renderDepth:(u.getPositionFromMatrix(e.matrixWorld),u.applyProjection(m),e.z=u.z),e.material.transparent===!0?M.push(e):S.push(e));for(var i=0,r=e.children.length;r>i;i++)C(e.children[i],t)}},A=function(e,t){return e.z-t.z},D=function(e,t){return e.z!==t.z?t.z-e.z:t.id-e.id},L={},P=function(e,r){var n=v(e.geometry,e.material),o=e.material;if(o!==x){var a=T(e.material);if(a!==R&&(t.useProgram(a),L.modelViewMatrix=t.getUniformLocation(a,"modelViewMatrix"),L.normalMatrix=t.getUniformLocation(a,"normalMatrix"),L.projectionMatrix=t.getUniformLocation(a,"projectionMatrix"),L.position=t.getAttribLocation(a,"position"),L.normal=t.getAttribLocation(a,"normal"),t.uniformMatrix4fv(L.projectionMatrix,!1,r.projectionMatrix.elements),R=a),o instanceof THREE.MeshNormalMaterial)t.uniform1f(t.getUniformLocation(a,"opacity"),o.opacity);else if(o instanceof THREE.ShaderMaterial){var s=o.uniforms;for(var l in s){var c=t.getUniformLocation(a,l),h=s[l].type,u=s[l].value;"i"===h?t.uniform1i(c,u):"f"===h?t.uniform1f(c,u):"v2"===h?t.uniform2f(c,u.x,u.y):"v3"===h?t.uniform3f(c,u.x,u.y,u.z):"v4"===h?t.uniform4f(c,u.x,u.y,u.z,u.w):"c"===h&&t.uniform3f(c,u.r,u.g,u.b)}}x=o}n!==b&&(t.bindBuffer(t.ARRAY_BUFFER,n.positions),t.enableVertexAttribArray(L.position),t.vertexAttribPointer(L.position,3,t.FLOAT,!1,0,0),L.normal>=0&&(t.bindBuffer(t.ARRAY_BUFFER,n.normals),t.enableVertexAttribArray(L.normal),t.vertexAttribPointer(L.normal,3,t.FLOAT,!1,0,0)),b=n),f.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),p.getNormalMatrix(f),t.uniformMatrix4fv(L.modelViewMatrix,!1,f.elements),t.uniformMatrix3fv(L.normalMatrix,!1,p.elements),t.drawArrays(t.TRIANGLES,0,n.count),i.info.render.calls++};this.render=function(e,t){if(this.autoClear===!0&&this.clear(),e.updateMatrixWorld(),void 0===t.parent&&t.updateMatrixWorld(),t.matrixWorldInverse.getInverse(t.matrixWorld),m.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),d.setFromMatrix(m),S.length=0,M.length=0,i.info.render.calls=0,b=void 0,x=void 0,R=void 0,C(e,t),S.length>0){S.sort(A),H(THREE.NoBlending);for(var r=0,n=S.length;n>r;r++)P(S[r],t)}if(M.length>0){M.sort(D),H(THREE.NormalBlending);for(var r=0,n=M.length;n>r;r++)P(M[r],t)}}};