THREE.SoftwareRenderer=function(){function e(e){var t=e.id,i=b[t];if(void 0===b[t]){if(e instanceof THREE.MeshBasicMaterial||e instanceof THREE.MeshLambertMaterial||e instanceof THREE.MeshPhongMaterial){var r;r=e.vertexColors===THREE.FaceColors?["buffer[ offset ] = face.color.r * 255;","buffer[ offset + 1 ] = face.color.g * 255;","buffer[ offset + 2 ] = face.color.b * 255;","buffer[ offset + 3 ] = material.opacity * 255;"].join("\n"):["buffer[ offset ] = material.color.r * 255;","buffer[ offset + 1 ] = material.color.g * 255;","buffer[ offset + 2 ] = material.color.b * 255;","buffer[ offset + 3 ] = material.opacity * 255;"].join("\n"),i=new Function("buffer, offset, u, v, face, material",r)}else{var r=["buffer[ offset ] = u * 255;","buffer[ offset + 1 ] = v * 255;","buffer[ offset + 2 ] = 0;","buffer[ offset + 3 ] = 255;"].join("\n");i=new Function("buffer, offset, u, v",r)}b[t]=i}return i}function t(e,t,r,s,f,v){if(!(e.z<-1||e.z>1||t.z<-1||t.z>1||r.z<-1||r.z>1)){var T=0|e.x*l+u,_=0|t.x*l+u,b=0|r.x*l+u,C=0|e.y*h+d,k=0|t.y*h+d,N=0|r.y*h+d,I=0|e.z*c+p,O=0|t.z*c+p,F=0|r.z*c+p,z=T-_,V=k-C,B=_-b,U=N-k,j=b-T,W=C-N,G=Math.max(Math.min(T,_,b)+H>>w,0),X=Math.min(Math.max(T,_,b)+H>>w,n),Y=Math.max(Math.min(C,k,N)+H>>w,0),q=Math.min(Math.max(C,k,N)+H>>w,o);A=Math.min(G,A),P=Math.max(X,P),D=Math.min(Y,D),L=Math.max(q,L);var K=M;G&=~(K-1),Y&=~(K-1);var Z=V*((G<<w)-T)+z*((Y<<w)-C),Q=U*((G<<w)-_)+B*((Y<<w)-k),$=W*((G<<w)-b)+j*((Y<<w)-N);(V>0||0==V&&z>0)&&Z++,(U>0||0==U&&B>0)&&Q++,(W>0||0==W&&j>0)&&$++,Z=Z-1>>w,Q=Q-1>>w,$=$-1>>w;var J=I-O,et=F-I,tt=1/(z*W-j*V),it=tt*(J*W-et*V),rt=tt*(J*j-z*et),nt=0|I+((G<<w)-T)*it+((Y<<w)-C)*rt,ot=1<<w;it=0|it*ot,rt=0|rt*ot;var at=K-1,st=0,lt=0,ht=0,ct=0,ut=0,dt=0,pt=0,ft=0;z>=0?lt-=at*z:st-=at*z,V>=0?lt-=at*V:st-=at*V,B>=0?ct-=at*B:ht-=at*B,U>=0?ct-=at*U:ht-=at*U,j>=0?dt-=at*j:ut-=at*j,W>=0?dt-=at*W:ut-=at*W,it>=0?ft+=at*it:pt+=at*it,rt>=0?ft+=at*rt:pt+=at*rt;for(var mt=n-K,gt=1/(Z+Q+$),vt=Z,Et=Q,yt=$,Tt=nt,_t=-K,bt=_t*V,xt=_t*U,Rt=_t*W,wt=_t*it,Ht=G,St=Y;q>St;St+=K){for(;Ht>=G&&X>Ht&&vt>=lt&&Et>=ct&&yt>=dt;)Ht+=_t,vt+=bt,Et+=xt,yt+=Rt,Tt+=wt;for(_t=-_t,bt=-bt,xt=-xt,Rt=-Rt,wt=-wt;;){if(Ht+=_t,vt+=bt,Et+=xt,yt+=Rt,Tt+=wt,G>Ht||Ht>=X)break;if(lt>vt){if(0>bt)break}else if(ct>Et){if(0>xt)break}else if(dt>yt){if(0>Rt)break}else{var Mt=Ht>>S,Ct=St>>S,At=Mt+Ct*a,Dt=Tt+pt;if(!(E[At]<Dt)){var Pt=y[At];Pt&R&&i(Mt,Ct),y[At]=Pt&~(x|R);var Lt=Ht+St*n;if(vt>=st&&Et>=ht&&yt>=ut){var kt=Tt+ft;E[At]=Math.min(E[At],kt);for(var Nt=vt,It=Et,Ot=Tt,Ft=0;K>Ft;Ft++){for(var zt=Nt,Vt=It,Bt=Ot,Ut=0;K>Ut;Ut++){var jt=Bt;if(jt<g[Lt]){g[Lt]=jt;var Wt=zt*gt,Gt=Vt*gt;s(m,4*Lt,Wt,Gt,f,v)}zt+=V,Vt+=U,Bt+=it,Lt++}Nt+=z,It+=B,Ot+=rt,Lt+=mt}}else for(var Nt=vt,It=Et,Xt=yt,Ot=Tt,Ft=0;K>Ft;Ft++){for(var zt=Nt,Vt=It,Yt=Xt,Bt=Ot,Ut=0;K>Ut;Ut++){if((zt|Vt|Yt)>=0){var jt=Bt;if(jt<g[Lt]){var Wt=zt*gt,Gt=Vt*gt;g[Lt]=jt,s(m,4*Lt,Wt,Gt,f,v)}}zt+=V,Vt+=U,Yt+=W,Bt+=it,Lt++}Nt+=z,It+=B,Xt+=j,Ot+=rt,Lt+=mt}}}}vt+=K*z,Et+=K*B,yt+=K*j,Tt+=K*rt}}}function i(e,t){for(var i=e*M+t*M*n,r=4*i+3,o=n-M,a=4*o,s=0;M>s;s++){for(var l=0;M>l;l++)g[i]=C,m[r]=0,i++,r+=4;i+=o,r+=a}}function r(){for(var e=0,t=0;s>t;t++)for(var r=0;a>r;r++)y[e]&R&&(i(r,t),y[e]=x),e++}console.log("THREE.SoftwareRenderer",THREE.REVISION);var n,o,a,s,l,h,c,u,d,p,f,m,g,v,E,y,T=document.createElement("canvas"),_=T.getContext("2d"),b={},x=1,R=2,w=4,H=(1<<w)-1,S=3,M=1<<S,C=1<<24,A=1/0,D=1/0,P=0,L=0,k=1/0,N=1/0,I=0,O=0,F=new THREE.Projector;this.domElement=T,this.autoClear=!0,this.supportsVertexTextures=function(){},this.setFaceCulling=function(){},this.setClearColor=function(){},this.setSize=function(e,t){a=Math.floor(e/M),s=Math.floor(t/M),n=a*M,o=s*M;var i=1<<w;l=i*n/2,h=-i*o/2,c=C/2,u=i*n/2+.5,d=i*o/2+.5,p=C/2+.5,T.width=n,T.height=o,f=_.getImageData(0,0,n,o),m=f.data,g=new Int32Array(m.length/4),v=a*s,E=new Int32Array(v),y=new Uint8Array(v);for(var r=0,b=g.length;b>r;r++)g[r]=C;for(var r=0;v>r;r++)y[r]=x},this.setSize(T.width,T.height),this.clear=function(){A=1/0,D=1/0,P=0,L=0;for(var e=0;v>e;e++)E[e]=C,y[e]=y[e]&x?x:R},this.render=function(i,n){this.autoClear===!0&&this.clear();for(var o=F.projectScene(i,n),a=o.elements,s=0,l=a.length;l>s;s++){var h=a[s],c=h.material,u=e(c);h instanceof THREE.RenderableFace3?t(h.v1.positionScreen,h.v2.positionScreen,h.v3.positionScreen,u,h,c):h instanceof THREE.RenderableFace4&&(t(h.v1.positionScreen,h.v2.positionScreen,h.v4.positionScreen,u,h,c),t(h.v2.positionScreen,h.v3.positionScreen,h.v4.positionScreen,u,h,c))}r();var d=Math.min(A,k),p=Math.min(D,N),m=Math.max(P,I)-d,g=Math.max(L,O)-p;1/0!==d&&_.putImageData(f,0,0,d,p,m,g),k=A,N=D,I=P,O=L}};