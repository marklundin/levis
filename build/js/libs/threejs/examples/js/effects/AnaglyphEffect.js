THREE.AnaglyphEffect=function(e,t,i){var r=new THREE.Matrix4;var n=new THREE.Matrix4;var o=125;var a,s,l,h;var c=new THREE.PerspectiveCamera;c.matrixAutoUpdate=!1;var u=new THREE.PerspectiveCamera;u.matrixAutoUpdate=!1;var f=new THREE.OrthographicCamera(-1,1,1,-1,0,1);var d=new THREE.Scene;var p={minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat};if(void 0===t)t=512;if(void 0===i)i=512;var m=new THREE.WebGLRenderTarget(t,i,p);var v=new THREE.WebGLRenderTarget(t,i,p);var g=new THREE.ShaderMaterial({uniforms:{mapLeft:{type:"t",value:m},mapRight:{type:"t",value:v}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = vec2( uv.x, uv.y );","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D mapLeft;","uniform sampler2D mapRight;","varying vec2 vUv;","void main() {","	vec4 colorL, colorR;","	vec2 uv = vUv;","	colorL = texture2D( mapLeft, uv );","	colorR = texture2D( mapRight, uv );","	gl_FragColor = vec4( colorL.g * 0.7 + colorL.b * 0.3, colorR.g, colorR.b, colorL.a + colorR.a ) * 1.1;","}"].join("\n")});var E=new THREE.Mesh(new THREE.PlaneGeometry(2,2),g);d.add(E);this.setSize=function(t,i){if(m)m.dispose();if(v)v.dispose();m=new THREE.WebGLRenderTarget(t,i,p);v=new THREE.WebGLRenderTarget(t,i,p);g.uniforms["mapLeft"].value=m;g.uniforms["mapRight"].value=v;e.setSize(t,i)};this.render=function(t,i){t.updateMatrixWorld();if(void 0===i.parent)i.updateMatrixWorld();var p=a!==i.aspect||s!==i.near||l!==i.far||h!==i.fov;if(p){a=i.aspect;s=i.near;l=i.far;h=i.fov;var g=i.projectionMatrix.clone();var E=.5*(o/30);var y=E*s/o;var T=s*Math.tan(THREE.Math.degToRad(.5*h));var _,b;r.elements[12]=E;n.elements[12]=-E;_=-T*a+y;b=T*a+y;g.elements[0]=2*s/(b-_);g.elements[8]=(b+_)/(b-_);c.projectionMatrix.copy(g);_=-T*a-y;b=T*a-y;g.elements[0]=2*s/(b-_);g.elements[8]=(b+_)/(b-_);u.projectionMatrix.copy(g)}c.matrixWorld.copy(i.matrixWorld).multiply(n);c.position.copy(i.position);c.near=i.near;c.far=i.far;e.render(t,c,m,!0);u.matrixWorld.copy(i.matrixWorld).multiply(r);u.position.copy(i.position);u.near=i.near;u.far=i.far;e.render(t,u,v,!0);e.render(d,f)};this.dispose=function(){if(m)m.dispose();if(v)v.dispose()}};