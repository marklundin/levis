THREE.AnaglyphEffect=function(e,t,i){var r,o,n,a,s=new THREE.Matrix4,l=new THREE.Matrix4,h=125,c=new THREE.PerspectiveCamera;c.matrixAutoUpdate=!1;var u=new THREE.PerspectiveCamera;u.matrixAutoUpdate=!1;var d=new THREE.OrthographicCamera(-1,1,1,-1,0,1),p=new THREE.Scene,f={minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat};void 0===t&&(t=512),void 0===i&&(i=512);var m=new THREE.WebGLRenderTarget(t,i,f),g=new THREE.WebGLRenderTarget(t,i,f),v=new THREE.ShaderMaterial({uniforms:{mapLeft:{type:"t",value:m},mapRight:{type:"t",value:g}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = vec2( uv.x, uv.y );","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D mapLeft;","uniform sampler2D mapRight;","varying vec2 vUv;","void main() {","	vec4 colorL, colorR;","	vec2 uv = vUv;","	colorL = texture2D( mapLeft, uv );","	colorR = texture2D( mapRight, uv );","	gl_FragColor = vec4( colorL.g * 0.7 + colorL.b * 0.3, colorR.g, colorR.b, colorL.a + colorR.a ) * 1.1;","}"].join("\n")}),E=new THREE.Mesh(new THREE.PlaneGeometry(2,2),v);p.add(E),this.setSize=function(t,i){m&&m.dispose(),g&&g.dispose(),m=new THREE.WebGLRenderTarget(t,i,f),g=new THREE.WebGLRenderTarget(t,i,f),v.uniforms.mapLeft.value=m,v.uniforms.mapRight.value=g,e.setSize(t,i)},this.render=function(t,i){t.updateMatrixWorld(),void 0===i.parent&&i.updateMatrixWorld();var f=r!==i.aspect||o!==i.near||n!==i.far||a!==i.fov;if(f){r=i.aspect,o=i.near,n=i.far,a=i.fov;var v,E,y=i.projectionMatrix.clone(),T=.5*(h/30),_=T*o/h,b=o*Math.tan(THREE.Math.degToRad(.5*a));s.elements[12]=T,l.elements[12]=-T,v=-b*r+_,E=b*r+_,y.elements[0]=2*o/(E-v),y.elements[8]=(E+v)/(E-v),c.projectionMatrix.copy(y),v=-b*r-_,E=b*r-_,y.elements[0]=2*o/(E-v),y.elements[8]=(E+v)/(E-v),u.projectionMatrix.copy(y)}c.matrixWorld.copy(i.matrixWorld).multiply(l),c.position.copy(i.position),c.near=i.near,c.far=i.far,e.render(t,c,m,!0),u.matrixWorld.copy(i.matrixWorld).multiply(s),u.position.copy(i.position),u.near=i.near,u.far=i.far,e.render(t,u,g,!0),e.render(p,d)},this.dispose=function(){m&&m.dispose(),g&&g.dispose()}};