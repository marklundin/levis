THREE.STLExporter=function(){this.stlContent=""},THREE.STLExporter.prototype={constructor:THREE.STLExporter,exportScene:function(e){var t=[];return e.traverse(function(e){e instanceof THREE.Mesh&&t.push(e)}),this.exportMeshes(t)},exportMesh:function(e){return this.exportMeshes([e])},exportMeshes:function(e){this.addLineToContent("solid exported");var t,i,r,o,n,a,s,l,h,c,u;for(t=0;t<e.length;t++)for(r=e[t],o=r.geometry,a=r.matrix,s=r.position,i=0;i<o.faces.length;i++)n=o.faces[i],l=n.normal,n instanceof THREE.Face3?(h=this.getTransformedPosition(o.vertices[n.a],a,s),c=this.getTransformedPosition(o.vertices[n.b],a,s),u=this.getTransformedPosition(o.vertices[n.c],a,s),this.addTriangleToContent(l,h,c,u)):n instanceof THREE.Face4&&(h=this.getTransformedPosition(o.vertices[n.a],a,s),c=this.getTransformedPosition(o.vertices[n.b],a,s),u=this.getTransformedPosition(o.vertices[n.c],a,s),this.addTriangleToContent(l,h,c,u),h=this.getTransformedPosition(o.vertices[n.a],a,s),c=this.getTransformedPosition(o.vertices[n.c],a,s),u=this.getTransformedPosition(o.vertices[n.d],a,s),this.addTriangleToContent(l,h,c,u));return this.addLineToContent("endsolid exported"),this.stlContent},clearContent:function(){this.stlContent=""},addLineToContent:function(e){this.stlContent+=e+"\n"},addTriangleToContent:function(e,t,i,r){this.addLineToContent("	facet normal "+e.x+" "+e.y+" "+e.z),this.addLineToContent("		outer loop"),this.addLineToContent("			vertex "+t.x+" "+t.y+" "+t.z),this.addLineToContent("			vertex "+i.x+" "+i.y+" "+i.z),this.addLineToContent("			vertex "+r.x+" "+r.y+" "+r.z),this.addLineToContent("		endloop"),this.addLineToContent("	endfacet")},getTransformedPosition:function(e,t,i){var r=e.clone();return void 0!==t&&r.applyMatrix4(t),void 0!==i&&r.add(i),r}};