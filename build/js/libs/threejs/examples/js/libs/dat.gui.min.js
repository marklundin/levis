/**
 * dat-gui JavaScript Controller Library
 * http://code.google.com/p/dat-gui
 *
 * Copyright 2011 Data Arts Team, Google Creative Lab
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */

var dat=dat||{};dat.gui=dat.gui||{};dat.utils=dat.utils||{};dat.controllers=dat.controllers||{};dat.dom=dat.dom||{};dat.color=dat.color||{};dat.utils.css=function(){return{load:function(e,t){var t=t||document,i=t.createElement("link");i.type="text/css";i.rel="stylesheet";i.href=e;t.getElementsByTagName("head")[0].appendChild(i)},inject:function(e,t){var t=t||document,i=document.createElement("style");i.type="text/css";i.innerHTML=e;t.getElementsByTagName("head")[0].appendChild(i)}}}();dat.utils.common=function(){var e=Array.prototype.forEach,t=Array.prototype.slice;return{BREAK:{},extend:function(e){this.each(t.call(arguments,1),function(t){for(var i in t)this.isUndefined(t[i])||(e[i]=t[i])},this);return e},defaults:function(e){this.each(t.call(arguments,1),function(t){for(var i in t)this.isUndefined(e[i])&&(e[i]=t[i])},this);return e},compose:function(){var e=t.call(arguments);return function(){for(var i=t.call(arguments),r=e.length-1;r>=0;r--)i=[e[r].apply(this,i)];return i[0]}},each:function(t,i,r){if(e&&t.forEach===e)t.forEach(i,r);else if(t.length===t.length+0)for(var n=0,o=t.length;o>n&&!(n in t&&i.call(r,t[n],n)===this.BREAK);n++);else for(n in t)if(i.call(r,t[n],n)===this.BREAK)break},defer:function(e){setTimeout(e,0)},toArray:function(e){return e.toArray?e.toArray():t.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){return e!==e},isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}}}();dat.controllers.Controller=function(e){var t=function(e,t){this.initialValue=e[t];this.domElement=document.createElement("div");this.object=e;this.property=t;this.__onFinishChange=this.__onChange=void 0};e.extend(t.prototype,{onChange:function(e){this.__onChange=e;return this},onFinishChange:function(e){this.__onFinishChange=e;return this},setValue:function(e){this.object[this.property]=e;this.__onChange&&this.__onChange.call(this,e);this.updateDisplay();return this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}});return t}(dat.utils.common);dat.dom.dom=function(e){function t(t){if("0"===t||e.isUndefined(t))return 0;t=t.match(r);return!e.isNull(t)?parseFloat(t[1]):0}var i={};e.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(t,r){e.each(t,function(e){i[e]=r})});var r=/(\d+(\.\d+)?)px/,n={makeSelectable:function(e,t){if(void 0!==e&&void 0!==e.style)e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off"},makeFullscreen:function(t,i,r){e.isUndefined(i)&&(i=!0);e.isUndefined(r)&&(r=!0);t.style.position="absolute";if(i)t.style.left=0,t.style.right=0;if(r)t.style.top=0,t.style.bottom=0},fakeEvent:function(t,r,n,o){var n=n||{},a=i[r];if(!a)throw Error("Event type "+r+" not supported.");var s=document.createEvent(a);switch(a){case"MouseEvents":s.initMouseEvent(r,n.bubbles||!1,n.cancelable||!0,window,n.clickCount||1,0,0,n.x||n.clientX||0,n.y||n.clientY||0,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":a=s.initKeyboardEvent||s.initKeyEvent;e.defaults(n,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0});a(r,n.bubbles||!1,n.cancelable,window,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.keyCode,n.charCode);break;default:s.initEvent(r,n.bubbles||!1,n.cancelable||!0)}e.defaults(s,o);t.dispatchEvent(s)},bind:function(e,t,i,r){e.addEventListener?e.addEventListener(t,i,r||!1):e.attachEvent&&e.attachEvent("on"+t,i);return n},unbind:function(e,t,i,r){e.removeEventListener?e.removeEventListener(t,i,r||!1):e.detachEvent&&e.detachEvent("on"+t,i);return n},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var i=e.className.split(/ +/);if(-1==i.indexOf(t))i.push(t),e.className=i.join(" ").replace(/^\s+/,"").replace(/\s+$/,"")}return n},removeClass:function(e,t){if(t){if(void 0!==e.className)if(e.className===t)e.removeAttribute("class");else{var i=e.className.split(/ +/),r=i.indexOf(t);if(-1!=r)i.splice(r,1),e.className=i.join(" ")}}else e.className=void 0;return n},hasClass:function(e,t){return RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){e=getComputedStyle(e);return t(e["border-left-width"])+t(e["border-right-width"])+t(e["padding-left"])+t(e["padding-right"])+t(e.width)},getHeight:function(e){e=getComputedStyle(e);return t(e["border-top-width"])+t(e["border-bottom-width"])+t(e["padding-top"])+t(e["padding-bottom"])+t(e.height)},getOffset:function(e){var t={left:0,top:0};if(e.offsetParent)do t.left+=e.offsetLeft,t.top+=e.offsetTop;while(e=e.offsetParent);return t},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}};return n}(dat.utils.common);dat.controllers.OptionController=function(e,t,i){var r=function(e,n,o){r.superclass.call(this,e,n);var a=this;this.__select=document.createElement("select");if(i.isArray(o)){var s={};i.each(o,function(e){s[e]=e});o=s}i.each(o,function(e,t){var i=document.createElement("option");i.innerHTML=t;i.setAttribute("value",e);a.__select.appendChild(i)});this.updateDisplay();t.bind(this.__select,"change",function(){a.setValue(this.options[this.selectedIndex].value)});this.domElement.appendChild(this.__select)};r.superclass=e;i.extend(r.prototype,e.prototype,{setValue:function(e){e=r.superclass.prototype.setValue.call(this,e);this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue());return e},updateDisplay:function(){this.__select.value=this.getValue();return r.superclass.prototype.updateDisplay.call(this)}});return r}(dat.controllers.Controller,dat.dom.dom,dat.utils.common);dat.controllers.NumberController=function(e,t){var i=function(e,r,n){i.superclass.call(this,e,r);n=n||{};this.__min=n.min;this.__max=n.max;this.__step=n.step;e=this.__impliedStep=t.isUndefined(this.__step)?0==this.initialValue?1:Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__step;e=e.toString();this.__precision=e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0};i.superclass=e;t.extend(i.prototype,e.prototype,{setValue:function(e){if(void 0!==this.__min&&e<this.__min)e=this.__min;else if(void 0!==this.__max&&e>this.__max)e=this.__max;void 0!==this.__step&&0!=e%this.__step&&(e=Math.round(e/this.__step)*this.__step);return i.superclass.prototype.setValue.call(this,e)},min:function(e){this.__min=e;return this},max:function(e){this.__max=e;return this},step:function(e){this.__step=e;return this}});return i}(dat.controllers.Controller,dat.utils.common);dat.controllers.NumberControllerBox=function(e,t,i){var r=function(e,n,o){function a(){var e=parseFloat(c.__input.value);i.isNaN(e)||c.setValue(e)}function s(e){var t=h-e.clientY;c.setValue(c.getValue()+t*c.__impliedStep);h=e.clientY}function l(){t.unbind(window,"mousemove",s);t.unbind(window,"mouseup",l)}this.__truncationSuspended=!1;r.superclass.call(this,e,n,o);var h,c=this;this.__input=document.createElement("input");this.__input.setAttribute("type","text");t.bind(this.__input,"change",a);t.bind(this.__input,"blur",function(){a();c.__onFinishChange&&c.__onFinishChange.call(c,c.getValue())});t.bind(this.__input,"mousedown",function(e){t.bind(window,"mousemove",s);t.bind(window,"mouseup",l);h=e.clientY});t.bind(this.__input,"keydown",function(e){if(13===e.keyCode)c.__truncationSuspended=!0,this.blur(),c.__truncationSuspended=!1});this.updateDisplay();this.domElement.appendChild(this.__input)};r.superclass=e;i.extend(r.prototype,e.prototype,{updateDisplay:function(){var e,t=this.__input;if(this.__truncationSuspended)e=this.getValue();else{e=this.getValue();var i=Math.pow(10,this.__precision);e=Math.round(e*i)/i}t.value=e;return r.superclass.prototype.updateDisplay.call(this)}});return r}(dat.controllers.NumberController,dat.dom.dom,dat.utils.common);dat.controllers.NumberControllerSlider=function(e,t,i,r,n){var o=function(e,i,r,n,a){function s(e){e.preventDefault();var i=t.getOffset(h.__background),r=t.getWidth(h.__background);h.setValue(h.__min+(h.__max-h.__min)*((e.clientX-i.left)/(i.left+r-i.left)));return!1}function l(){t.unbind(window,"mousemove",s);t.unbind(window,"mouseup",l);h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}o.superclass.call(this,e,i,{min:r,max:n,step:a});var h=this;this.__background=document.createElement("div");this.__foreground=document.createElement("div");t.bind(this.__background,"mousedown",function(e){t.bind(window,"mousemove",s);t.bind(window,"mouseup",l);s(e)});t.addClass(this.__background,"slider");t.addClass(this.__foreground,"slider-fg");this.updateDisplay();this.__background.appendChild(this.__foreground);this.domElement.appendChild(this.__background)};o.superclass=e;o.useDefaultStyles=function(){i.inject(n)};r.extend(o.prototype,e.prototype,{updateDisplay:function(){this.__foreground.style.width=100*((this.getValue()-this.__min)/(this.__max-this.__min))+"%";return o.superclass.prototype.updateDisplay.call(this)}});return o}(dat.controllers.NumberController,dat.dom.dom,dat.utils.css,dat.utils.common,".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}");dat.controllers.FunctionController=function(e,t,i){var r=function(e,i,n){r.superclass.call(this,e,i);var o=this;this.__button=document.createElement("div");this.__button.innerHTML=void 0===n?"Fire":n;t.bind(this.__button,"click",function(e){e.preventDefault();o.fire();return!1});t.addClass(this.__button,"button");this.domElement.appendChild(this.__button)};r.superclass=e;i.extend(r.prototype,e.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this);this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue());this.getValue().call(this.object)}});return r}(dat.controllers.Controller,dat.dom.dom,dat.utils.common);dat.controllers.BooleanController=function(e,t,i){var r=function(e,i){r.superclass.call(this,e,i);var n=this;this.__prev=this.getValue();this.__checkbox=document.createElement("input");this.__checkbox.setAttribute("type","checkbox");t.bind(this.__checkbox,"change",function(){n.setValue(!n.__prev)},!1);this.domElement.appendChild(this.__checkbox);this.updateDisplay()};r.superclass=e;i.extend(r.prototype,e.prototype,{setValue:function(e){e=r.superclass.prototype.setValue.call(this,e);this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue());this.__prev=this.getValue();return e},updateDisplay:function(){this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1;return r.superclass.prototype.updateDisplay.call(this)}});return r}(dat.controllers.Controller,dat.dom.dom,dat.utils.common);dat.color.toString=function(e){return function(t){if(1==t.a||e.isUndefined(t.a)){for(t=t.hex.toString(16);t.length<6;)t="0"+t;return"#"+t}else return"rgba("+Math.round(t.r)+","+Math.round(t.g)+","+Math.round(t.b)+","+t.a+")"}}(dat.utils.common);dat.color.interpret=function(e,t){var i,r,n=[{litmus:t.isString,conversions:{THREE_CHAR_HEX:{read:function(e){e=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:e},SIX_CHAR_HEX:{read:function(e){e=e.match(/^#([A-F0-9]{6})$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:e},CSS_RGB:{read:function(e){e=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:e},CSS_RGBA:{read:function(e){e=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:e}}},{litmus:t.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:t.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3!=e.length?!1:{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4!=e.length?!1:{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:t.isObject,conversions:{RGBA_OBJ:{read:function(e){return t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)&&t.isNumber(e.a)?{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)?{space:"RGB",r:e.r,g:e.g,b:e.b}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)&&t.isNumber(e.a)?{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)?{space:"HSV",h:e.h,s:e.s,v:e.v}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}];return function(){r=!1;var e=arguments.length>1?t.toArray(arguments):arguments[0];t.each(n,function(n){if(n.litmus(e))return t.each(n.conversions,function(n,o){i=n.read(e);if(r===!1&&i!==!1)return r=i,i.conversionName=o,i.conversion=n,t.BREAK;else return void 0}),t.BREAK;else return void 0});return r}}(dat.color.toString,dat.utils.common);dat.GUI=dat.gui.GUI=function(e,t,i,r,n,o,a,s,l,h,c,u,f,d,p){function m(e,t,i,o){if(void 0===t[i])throw Error("Object "+t+' has no property "'+i+'"');o.color?t=new c(t,i):(t=[t,i].concat(o.factoryArgs),t=r.apply(e,t));if(o.before instanceof n)o.before=o.before.__li;E(e,t);d.addClass(t.domElement,"c");i=document.createElement("span");d.addClass(i,"property-name");i.innerHTML=t.property;var a=document.createElement("div");a.appendChild(i);a.appendChild(t.domElement);o=v(e,a,o.before);d.addClass(o,L.CLASS_CONTROLLER_ROW);d.addClass(o,typeof t.getValue());g(e,o,t);e.__controllers.push(t);return t}function v(e,t,i){var r=document.createElement("li");t&&r.appendChild(t);i?e.__ul.insertBefore(r,params.before):e.__ul.appendChild(r);e.onResize();return r}function g(e,t,i){i.__li=t;i.__gui=e;p.extend(i,{options:function(t){if(arguments.length>1)return i.remove(),m(e,i.object,i.property,{before:i.__li.nextElementSibling,factoryArgs:[p.toArray(arguments)]});if(p.isArray(t)||p.isObject(t))return i.remove(),m(e,i.object,i.property,{before:i.__li.nextElementSibling,factoryArgs:[t]});else return void 0},name:function(e){i.__li.firstElementChild.firstElementChild.innerHTML=e;return i},listen:function(){i.__gui.listen(i);return i},remove:function(){i.__gui.remove(i);return i}});if(i instanceof l){var r=new s(i.object,i.property,{min:i.__min,max:i.__max,step:i.__step});p.each(["updateDisplay","onChange","onFinishChange"],function(e){var t=i[e],n=r[e];i[e]=r[e]=function(){var e=Array.prototype.slice.call(arguments);t.apply(i,e);return n.apply(r,e)}});d.addClass(t,"has-slider");i.domElement.insertBefore(r.domElement,i.domElement.firstElementChild)}else if(i instanceof s){var n=function(t){return p.isNumber(i.__min)&&p.isNumber(i.__max)?(i.remove(),m(e,i.object,i.property,{before:i.__li.nextElementSibling,factoryArgs:[i.__min,i.__max,i.__step]})):t};i.min=p.compose(n,i.min);i.max=p.compose(n,i.max)}else if(i instanceof o)d.bind(t,"click",function(){d.fakeEvent(i.__checkbox,"click")}),d.bind(i.__checkbox,"click",function(e){e.stopPropagation()});else if(i instanceof a)d.bind(t,"click",function(){d.fakeEvent(i.__button,"click")}),d.bind(t,"mouseover",function(){d.addClass(i.__button,"hover")}),d.bind(t,"mouseout",function(){d.removeClass(i.__button,"hover")});else if(i instanceof c)d.addClass(t,"color"),i.updateDisplay=p.compose(function(e){t.style.borderLeftColor=i.__color.toString();return e},i.updateDisplay),i.updateDisplay();i.setValue=p.compose(function(t){e.getRoot().__preset_select&&i.isModified()&&R(e.getRoot(),!0);return t},i.setValue)}function E(e,t){var i=e.getRoot(),r=i.__rememberedObjects.indexOf(t.object);if(-1!=r){var n=i.__rememberedObjectIndecesToControllers[r];void 0===n&&(n={},i.__rememberedObjectIndecesToControllers[r]=n);n[t.property]=t;if(i.load&&i.load.remembered){i=i.load.remembered;if(i[e.preset])i=i[e.preset];else if(i[S])i=i[S];else return;if(i[r]&&void 0!==i[r][t.property])r=i[r][t.property],t.initialValue=r,t.setValue(r)}}}function y(e){var t=e.__save_row=document.createElement("li");d.addClass(e.domElement,"has-save");e.__ul.insertBefore(t,e.__ul.firstChild);d.addClass(t,"save-row");var i=document.createElement("span");i.innerHTML="&nbsp;";d.addClass(i,"button gears");var r=document.createElement("span");r.innerHTML="Save";d.addClass(r,"button");d.addClass(r,"save");var n=document.createElement("span");n.innerHTML="New";d.addClass(n,"button");d.addClass(n,"save-as");var o=document.createElement("span");o.innerHTML="Revert";d.addClass(o,"button");d.addClass(o,"revert");var a=e.__preset_select=document.createElement("select");e.load&&e.load.remembered?p.each(e.load.remembered,function(t,i){x(e,i,i==e.preset)}):x(e,S,!1);d.bind(a,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value});t.appendChild(a);t.appendChild(i);t.appendChild(r);t.appendChild(n);t.appendChild(o);if(H){var t=document.getElementById("dg-save-locally"),s=document.getElementById("dg-local-explain");t.style.display="block";t=document.getElementById("dg-local-storage");"true"===localStorage.getItem(document.location.href+".isLocal")&&t.setAttribute("checked","checked");var l=function(){s.style.display=e.useLocalStorage?"block":"none"};l();d.bind(t,"change",function(){e.useLocalStorage=!e.useLocalStorage;l()})}var h=document.getElementById("dg-new-constructor");d.bind(h,"keydown",function(e){e.metaKey&&(67===e.which||67==e.keyCode)&&C.hide()});d.bind(i,"click",function(){h.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2);C.show();h.focus();h.select()});d.bind(r,"click",function(){e.save()});d.bind(n,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)});d.bind(o,"click",function(){e.revert()})}function _(e){function t(t){t.preventDefault();n=t.clientX;d.addClass(e.__closeButton,L.CLASS_DRAG);d.bind(window,"mousemove",i);d.bind(window,"mouseup",r);return!1}function i(t){t.preventDefault();e.width+=n-t.clientX;e.onResize();n=t.clientX;return!1}function r(){d.removeClass(e.__closeButton,L.CLASS_DRAG);d.unbind(window,"mousemove",i);d.unbind(window,"mouseup",r)}e.__resize_handle=document.createElement("div");p.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var n;d.bind(e.__resize_handle,"mousedown",t);d.bind(e.__closeButton,"mousedown",t);e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function T(e,t){e.domElement.style.width=t+"px";if(e.__save_row&&e.autoPlace)e.__save_row.style.width=t+"px";if(e.__closeButton)e.__closeButton.style.width=t+"px"}function b(e,t){var i={};p.each(e.__rememberedObjects,function(r,n){var o={};p.each(e.__rememberedObjectIndecesToControllers[n],function(e,i){o[i]=t?e.initialValue:e.getValue()});i[n]=o});return i}function x(e,t,i){var r=document.createElement("option");r.innerHTML=t;r.value=t;e.__preset_select.appendChild(r);if(i)e.__preset_select.selectedIndex=e.__preset_select.length-1}function R(e,t){var i=e.__preset_select[e.__preset_select.selectedIndex];i.innerHTML=t?i.value+"*":i.value}function w(e){0!=e.length&&u(function(){w(e)});p.each(e,function(e){e.updateDisplay()})}e.inject(i);var H,S="Default";try{H="localStorage"in window&&null!==window.localStorage}catch(M){H=!1}var C,A,D=!0,P=!1,k=[],L=function(e){function t(){localStorage.setItem(document.location.href+".gui",JSON.stringify(r.getSaveObject()))}function i(){var e=r.getRoot();e.width+=1;p.defer(function(){e.width-=1})}var r=this;this.domElement=document.createElement("div");this.__ul=document.createElement("ul");this.domElement.appendChild(this.__ul);d.addClass(this.domElement,"dg");this.__folders={};this.__controllers=[];this.__rememberedObjects=[];this.__rememberedObjectIndecesToControllers=[];this.__listening=[];e=e||{};e=p.defaults(e,{autoPlace:!0,width:L.DEFAULT_WIDTH});e=p.defaults(e,{resizable:e.autoPlace,hideable:e.autoPlace});if(p.isUndefined(e.load))e.load={preset:S};else if(e.preset)e.load.preset=e.preset;p.isUndefined(e.parent)&&e.hideable&&k.push(this);e.resizable=p.isUndefined(e.parent)&&e.resizable;if(e.autoPlace&&p.isUndefined(e.scrollable))e.scrollable=!0;var n=H&&"true"===localStorage.getItem(document.location.href+".isLocal");Object.defineProperties(this,{parent:{get:function(){return e.parent}},scrollable:{get:function(){return e.scrollable}},autoPlace:{get:function(){return e.autoPlace}},preset:{get:function(){return r.parent?r.getRoot().preset:e.load.preset},set:function(t){r.parent?r.getRoot().preset=t:e.load.preset=t;for(t=0;t<this.__preset_select.length;t++)if(this.__preset_select[t].value==this.preset)this.__preset_select.selectedIndex=t;r.revert()}},width:{get:function(){return e.width},set:function(t){e.width=t;T(r,t)}},name:{get:function(){return e.name},set:function(t){e.name=t;if(a)a.innerHTML=e.name}},closed:{get:function(){return e.closed},set:function(t){e.closed=t;e.closed?d.addClass(r.__ul,L.CLASS_CLOSED):d.removeClass(r.__ul,L.CLASS_CLOSED);this.onResize();if(r.__closeButton)r.__closeButton.innerHTML=t?L.TEXT_OPEN:L.TEXT_CLOSED}},load:{get:function(){return e.load}},useLocalStorage:{get:function(){return n},set:function(e){H&&((n=e)?d.bind(window,"unload",t):d.unbind(window,"unload",t),localStorage.setItem(document.location.href+".isLocal",e))}}});if(p.isUndefined(e.parent)){e.closed=!1;d.addClass(this.domElement,L.CLASS_MAIN);d.makeSelectable(this.domElement,!1);if(H&&n){r.useLocalStorage=!0;var o=localStorage.getItem(document.location.href+".gui");if(o)e.load=JSON.parse(o)}this.__closeButton=document.createElement("div");this.__closeButton.innerHTML=L.TEXT_CLOSED;d.addClass(this.__closeButton,L.CLASS_CLOSE_BUTTON);this.domElement.appendChild(this.__closeButton);d.bind(this.__closeButton,"click",function(){r.closed=!r.closed})}else{if(void 0===e.closed)e.closed=!0;var a=document.createTextNode(e.name);d.addClass(a,"controller-name");o=v(r,a);d.addClass(this.__ul,L.CLASS_CLOSED);d.addClass(o,"title");d.bind(o,"click",function(e){e.preventDefault();r.closed=!r.closed;return!1});if(!e.closed)this.closed=!1}e.autoPlace&&(p.isUndefined(e.parent)&&(D&&(A=document.createElement("div"),d.addClass(A,"dg"),d.addClass(A,L.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(A),D=!1),A.appendChild(this.domElement),d.addClass(this.domElement,L.CLASS_AUTO_PLACE)),this.parent||T(r,e.width));d.bind(window,"resize",function(){r.onResize()});d.bind(this.__ul,"webkitTransitionEnd",function(){r.onResize()});d.bind(this.__ul,"transitionend",function(){r.onResize()});d.bind(this.__ul,"oTransitionEnd",function(){r.onResize()});this.onResize();e.resizable&&_(this);r.getRoot();e.parent||i()};L.toggleHide=function(){P=!P;p.each(k,function(e){e.domElement.style.zIndex=P?-999:999;e.domElement.style.opacity=P?0:1})};L.CLASS_AUTO_PLACE="a";L.CLASS_AUTO_PLACE_CONTAINER="ac";L.CLASS_MAIN="main";L.CLASS_CONTROLLER_ROW="cr";L.CLASS_TOO_TALL="taller-than-window";L.CLASS_CLOSED="closed";L.CLASS_CLOSE_BUTTON="close-button";L.CLASS_DRAG="drag";L.DEFAULT_WIDTH=245;L.TEXT_CLOSED="Close Controls";L.TEXT_OPEN="Open Controls";d.bind(window,"keydown",function(e){"text"!==document.activeElement.type&&(72===e.which||72==e.keyCode)&&L.toggleHide()},!1);p.extend(L.prototype,{add:function(e,t){return m(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return m(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li);this.__controllers.slice(this.__controllers.indexOf(e),1);var t=this;p.defer(function(){t.onResize()})},destroy:function(){this.autoPlace&&A.removeChild(this.domElement)},addFolder:function(e){if(void 0!==this.__folders[e])throw Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace;if(this.load&&this.load.folders&&this.load.folders[e])t.closed=this.load.folders[e].closed,t.load=this.load.folders[e];t=new L(t);this.__folders[e]=t;e=v(this,t.domElement);d.addClass(e,"folder");return t},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=d.getOffset(e.__ul).top,i=0;p.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(i+=d.getHeight(t))});window.innerHeight-t-20<i?(d.addClass(e.domElement,L.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(d.removeClass(e.domElement,L.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&p.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"});if(e.__closeButton)e.__closeButton.style.width=e.width+"px"},remember:function(){if(p.isUndefined(C))C=new f,C.domElement.innerHTML=t;if(this.parent)throw Error("You can only call remember on a top level GUI.");var e=this;p.each(Array.prototype.slice.call(arguments),function(t){0==e.__rememberedObjects.length&&y(e);-1==e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)});this.autoPlace&&T(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;e.closed=this.closed;if(this.__rememberedObjects.length>0){e.preset=this.preset;if(!e.remembered)e.remembered={};e.remembered[this.preset]=b(this)}e.folders={};p.each(this.__folders,function(t,i){e.folders[i]=t.getSaveObject()});return e},save:function(){if(!this.load.remembered)this.load.remembered={};this.load.remembered[this.preset]=b(this);R(this,!1)},saveAs:function(e){if(!this.load.remembered)this.load.remembered={},this.load.remembered[S]=b(this,!0);this.load.remembered[e]=b(this);this.preset=e;x(this,e,!0)},revert:function(e){p.each(this.__controllers,function(t){this.getRoot().load.remembered?E(e||this.getRoot(),t):t.setValue(t.initialValue)},this);p.each(this.__folders,function(e){e.revert(e)});e||R(this.getRoot(),!1)},listen:function(e){var t=0==this.__listening.length;this.__listening.push(e);t&&w(this.__listening)}});return L}(dat.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n",dat.controllers.factory=function(e,t,i,r,n,o,a){return function(s,l,h,c){var u=s[l];
if(a.isArray(h)||a.isObject(h))return new e(s,l,h);if(a.isNumber(u))return a.isNumber(h)&&a.isNumber(c)?new i(s,l,h,c):new t(s,l,{min:h,max:c});if(a.isString(u))return new r(s,l);if(a.isFunction(u))return new n(s,l,"");if(a.isBoolean(u))return new o(s,l);else return void 0}}(dat.controllers.OptionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.StringController=function(e,t,i){var r=function(e,i){function n(){o.setValue(o.__input.value)}r.superclass.call(this,e,i);var o=this;this.__input=document.createElement("input");this.__input.setAttribute("type","text");t.bind(this.__input,"keyup",n);t.bind(this.__input,"change",n);t.bind(this.__input,"blur",function(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())});t.bind(this.__input,"keydown",function(e){13===e.keyCode&&this.blur()});this.updateDisplay();this.domElement.appendChild(this.__input)};r.superclass=e;i.extend(r.prototype,e.prototype,{updateDisplay:function(){if(!t.isActive(this.__input))this.__input.value=this.getValue();return r.superclass.prototype.updateDisplay.call(this)}});return r}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.FunctionController,dat.controllers.BooleanController,dat.utils.common),dat.controllers.Controller,dat.controllers.BooleanController,dat.controllers.FunctionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.OptionController,dat.controllers.ColorController=function(e,t,i,r,n){function o(e,t,i,r){e.style.background="";n.each(l,function(n){e.style.cssText+="background: "+n+"linear-gradient("+t+", "+i+" 0%, "+r+" 100%); "})}function a(e){e.style.background="";e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);";e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var s=function(e,l){function h(e){d(e);t.bind(window,"mousemove",d);t.bind(window,"mouseup",c)}function c(){t.unbind(window,"mousemove",d);t.unbind(window,"mouseup",c)}function u(){var e=r(this.value);e!==!1?(m.__color.__state=e,m.setValue(m.__color.toOriginal())):this.value=m.__color.toString()}function f(){t.unbind(window,"mousemove",p);t.unbind(window,"mouseup",f)}function d(e){e.preventDefault();var i=t.getWidth(m.__saturation_field),r=t.getOffset(m.__saturation_field),n=(e.clientX-r.left+document.body.scrollLeft)/i,e=1-(e.clientY-r.top+document.body.scrollTop)/i;e>1?e=1:0>e&&(e=0);n>1?n=1:0>n&&(n=0);m.__color.v=e;m.__color.s=n;m.setValue(m.__color.toOriginal());return!1}function p(e){e.preventDefault();var i=t.getHeight(m.__hue_field),r=t.getOffset(m.__hue_field),e=1-(e.clientY-r.top+document.body.scrollTop)/i;e>1?e=1:0>e&&(e=0);m.__color.h=360*e;m.setValue(m.__color.toOriginal());return!1}s.superclass.call(this,e,l);this.__color=new i(this.getValue());this.__temp=new i(0);var m=this;this.domElement=document.createElement("div");t.makeSelectable(this.domElement,!1);this.__selector=document.createElement("div");this.__selector.className="selector";this.__saturation_field=document.createElement("div");this.__saturation_field.className="saturation-field";this.__field_knob=document.createElement("div");this.__field_knob.className="field-knob";this.__field_knob_border="2px solid ";this.__hue_knob=document.createElement("div");this.__hue_knob.className="hue-knob";this.__hue_field=document.createElement("div");this.__hue_field.className="hue-field";this.__input=document.createElement("input");this.__input.type="text";this.__input_textShadow="0 1px 1px ";t.bind(this.__input,"keydown",function(e){13===e.keyCode&&u.call(this)});t.bind(this.__input,"blur",u);t.bind(this.__selector,"mousedown",function(){t.addClass(this,"drag").bind(window,"mouseup",function(){t.removeClass(m.__selector,"drag")})});var v=document.createElement("div");n.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"});n.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1});n.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1});n.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"});n.extend(v.style,{width:"100%",height:"100%",background:"none"});o(v,"top","rgba(0,0,0,0)","#000");n.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"});a(this.__hue_field);n.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"});t.bind(this.__saturation_field,"mousedown",h);t.bind(this.__field_knob,"mousedown",h);t.bind(this.__hue_field,"mousedown",function(e){p(e);t.bind(window,"mousemove",p);t.bind(window,"mouseup",f)});this.__saturation_field.appendChild(v);this.__selector.appendChild(this.__field_knob);this.__selector.appendChild(this.__saturation_field);this.__selector.appendChild(this.__hue_field);this.__hue_field.appendChild(this.__hue_knob);this.domElement.appendChild(this.__input);this.domElement.appendChild(this.__selector);this.updateDisplay()};s.superclass=e;n.extend(s.prototype,e.prototype,{updateDisplay:function(){var e=r(this.getValue());if(e!==!1){var t=!1;n.each(i.COMPONENTS,function(i){if(!n.isUndefined(e[i])&&!n.isUndefined(this.__color.__state[i])&&e[i]!==this.__color.__state[i])return t=!0,{};else return void 0},this);t&&n.extend(this.__color.__state,e)}n.extend(this.__temp.__state,this.__color.__state);this.__temp.a=1;var a=this.__color.v<.5||this.__color.s>.5?255:0,s=255-a;n.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+a+","+a+","+a+")"});this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px";this.__temp.s=1;this.__temp.v=1;o(this.__saturation_field,"left","#fff",this.__temp.toString());n.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+a+","+a+","+a+")",textShadow:this.__input_textShadow+"rgba("+s+","+s+","+s+",.7)"})}});var l=["-moz-","-o-","-webkit-","-ms-",""];return s}(dat.controllers.Controller,dat.dom.dom,dat.color.Color=function(e,t,i,r){function n(e,t,i){Object.defineProperty(e,t,{get:function(){if("RGB"===this.__state.space)return this.__state[t];a(this,t,i);return this.__state[t]},set:function(e){if("RGB"!==this.__state.space)a(this,t,i),this.__state.space="RGB";this.__state[t]=e}})}function o(e,t){Object.defineProperty(e,t,{get:function(){if("HSV"===this.__state.space)return this.__state[t];s(this);return this.__state[t]},set:function(e){if("HSV"!==this.__state.space)s(this),this.__state.space="HSV";this.__state[t]=e}})}function a(e,i,n){if("HEX"===e.__state.space)e.__state[i]=t.component_from_hex(e.__state.hex,n);else if("HSV"===e.__state.space)r.extend(e.__state,t.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v));else throw"Corrupted color state"}function s(e){var i=t.rgb_to_hsv(e.r,e.g,e.b);r.extend(e.__state,{s:i.s,v:i.v});if(r.isNaN(i.h)){if(r.isUndefined(e.__state.h))e.__state.h=0}else e.__state.h=i.h}var l=function(){this.__state=e.apply(this,arguments);if(this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};l.COMPONENTS="r,g,b,h,s,v,hex,a".split(",");r.extend(l.prototype,{toString:function(){return i(this)},toOriginal:function(){return this.__state.conversion.write(this)}});n(l.prototype,"r",2);n(l.prototype,"g",1);n(l.prototype,"b",0);o(l.prototype,"h");o(l.prototype,"s");o(l.prototype,"v");Object.defineProperty(l.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}});Object.defineProperty(l.prototype,"hex",{get:function(){if("HEX"!==!this.__state.space)this.__state.hex=t.rgb_to_hex(this.r,this.g,this.b);return this.__state.hex},set:function(e){this.__state.space="HEX";this.__state.hex=e}});return l}(dat.color.interpret,dat.color.math=function(){var e;return{hsv_to_rgb:function(e,t,i){var r=e/60-Math.floor(e/60),n=i*(1-t),o=i*(1-r*t),t=i*(1-(1-r)*t),e=[[i,t,n],[o,i,n],[n,i,t],[n,o,i],[t,n,i],[i,n,o]][Math.floor(e/60)%6];return{r:255*e[0],g:255*e[1],b:255*e[2]}},rgb_to_hsv:function(e,t,i){var r=Math.min(e,t,i),n=Math.max(e,t,i),r=n-r;if(0==n)return{h:0/0,s:0,v:0};e=e==n?(t-i)/r:t==n?2+(i-e)/r:4+(e-t)/r;e/=6;0>e&&(e+=1);return{h:360*e,s:r/n,v:n/255}},rgb_to_hex:function(e,t,i){e=this.hex_with_component(0,2,e);e=this.hex_with_component(e,1,t);return e=this.hex_with_component(e,0,i)},component_from_hex:function(e,t){return 255&e>>8*t},hex_with_component:function(t,i,r){return r<<(e=8*i)|t&~(255<<e)}}}(),dat.color.toString,dat.utils.common),dat.color.interpret,dat.utils.common),dat.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),dat.dom.CenteredDiv=function(e,t){var i=function(){this.backgroundElement=document.createElement("div");t.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"});e.makeFullscreen(this.backgroundElement);this.backgroundElement.style.position="fixed";this.domElement=document.createElement("div");t.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"});document.body.appendChild(this.backgroundElement);document.body.appendChild(this.domElement);var i=this;e.bind(this.backgroundElement,"click",function(){i.hide()})};i.prototype.show=function(){var e=this;this.backgroundElement.style.display="block";this.domElement.style.display="block";this.domElement.style.opacity=0;this.domElement.style.webkitTransform="scale(1.1)";this.layout();t.defer(function(){e.backgroundElement.style.opacity=1;e.domElement.style.opacity=1;e.domElement.style.webkitTransform="scale(1)"})};i.prototype.hide=function(){var t=this,i=function(){t.domElement.style.display="none";t.backgroundElement.style.display="none";e.unbind(t.domElement,"webkitTransitionEnd",i);e.unbind(t.domElement,"transitionend",i);e.unbind(t.domElement,"oTransitionEnd",i)};e.bind(this.domElement,"webkitTransitionEnd",i);e.bind(this.domElement,"transitionend",i);e.bind(this.domElement,"oTransitionEnd",i);this.backgroundElement.style.opacity=0;this.domElement.style.opacity=0;this.domElement.style.webkitTransform="scale(1.1)"};i.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-e.getWidth(this.domElement)/2+"px";this.domElement.style.top=window.innerHeight/2-e.getHeight(this.domElement)/2+"px"};return i}(dat.dom.dom,dat.utils.common),dat.dom.dom,dat.utils.common);