THREE.FlyControls=function(e,t){function i(e,t){return function(){t.apply(e,arguments)}}this.object=e;this.domElement=void 0!==t?t:document;if(t)this.domElement.setAttribute("tabindex",-1);this.movementSpeed=1;this.rollSpeed=.005;this.dragToLook=!1;this.autoForward=!1;this.tmpQuaternion=new THREE.Quaternion;this.mouseStatus=0;this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0};this.moveVector=new THREE.Vector3(0,0,0);this.rotationVector=new THREE.Vector3(0,0,0);this.handleEvent=function(e){if("function"==typeof this[e.type])this[e.type](e)};this.keydown=function(e){if(!e.altKey){switch(e.keyCode){case 16:this.movementSpeedMultiplier=.1;break;case 87:this.moveState.forward=1;break;case 83:this.moveState.back=1;break;case 65:this.moveState.left=1;break;case 68:this.moveState.right=1;break;case 82:this.moveState.up=1;break;case 70:this.moveState.down=1;break;case 38:this.moveState.pitchUp=1;break;case 40:this.moveState.pitchDown=1;break;case 37:this.moveState.yawLeft=1;break;case 39:this.moveState.yawRight=1;break;case 81:this.moveState.rollLeft=1;break;case 69:this.moveState.rollRight=1}this.updateMovementVector();this.updateRotationVector()}};this.keyup=function(e){switch(e.keyCode){case 16:this.movementSpeedMultiplier=1;break;case 87:this.moveState.forward=0;break;case 83:this.moveState.back=0;break;case 65:this.moveState.left=0;break;case 68:this.moveState.right=0;break;case 82:this.moveState.up=0;break;case 70:this.moveState.down=0;break;case 38:this.moveState.pitchUp=0;break;case 40:this.moveState.pitchDown=0;break;case 37:this.moveState.yawLeft=0;break;case 39:this.moveState.yawRight=0;break;case 81:this.moveState.rollLeft=0;break;case 69:this.moveState.rollRight=0}this.updateMovementVector();this.updateRotationVector()};this.mousedown=function(e){if(this.domElement!==document)this.domElement.focus();e.preventDefault();e.stopPropagation();if(this.dragToLook)this.mouseStatus++;else{switch(e.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1}this.updateMovementVector()}};this.mousemove=function(e){if(!this.dragToLook||this.mouseStatus>0){var t=this.getContainerDimensions();var i=t.size[0]/2;var r=t.size[1]/2;this.moveState.yawLeft=-(e.pageX-t.offset[0]-i)/i;this.moveState.pitchDown=(e.pageY-t.offset[1]-r)/r;this.updateRotationVector()}};this.mouseup=function(e){e.preventDefault();e.stopPropagation();if(this.dragToLook){this.mouseStatus--;this.moveState.yawLeft=this.moveState.pitchDown=0}else{switch(e.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0}this.updateMovementVector()}this.updateRotationVector()};this.update=function(e){var t=e*this.movementSpeed;var i=e*this.rollSpeed;this.object.translateX(this.moveVector.x*t);this.object.translateY(this.moveVector.y*t);this.object.translateZ(this.moveVector.z*t);this.tmpQuaternion.set(this.rotationVector.x*i,this.rotationVector.y*i,this.rotationVector.z*i,1).normalize();this.object.quaternion.multiply(this.tmpQuaternion);this.object.rotation.setFromQuaternion(this.object.quaternion,this.object.rotation.order)};this.updateMovementVector=function(){var e=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right;this.moveVector.y=-this.moveState.down+this.moveState.up;this.moveVector.z=-e+this.moveState.back};this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp;this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft;this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft};this.getContainerDimensions=function(){if(this.domElement!=document)return{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]};else return{size:[window.innerWidth,window.innerHeight],offset:[0,0]}};this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1);this.domElement.addEventListener("mousemove",i(this,this.mousemove),!1);this.domElement.addEventListener("mousedown",i(this,this.mousedown),!1);this.domElement.addEventListener("mouseup",i(this,this.mouseup),!1);this.domElement.addEventListener("keydown",i(this,this.keydown),!1);this.domElement.addEventListener("keyup",i(this,this.keyup),!1);this.updateMovementVector();this.updateRotationVector()};