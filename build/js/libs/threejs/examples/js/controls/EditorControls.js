THREE.EditorControls=function(e,t){function i(e){if(l.enabled!==!1){e.preventDefault();if(0===e.button)u=c.ROTATE;else if(1===e.button)u=c.ZOOM;else if(2===e.button)u=c.PAN;t.addEventListener("mousemove",r,!1);t.addEventListener("mouseup",n,!1);t.addEventListener("mouseout",n,!1)}}function r(e){if(l.enabled!==!1){e.preventDefault();var t=e.movementX||e.webkitMovementX||e.mozMovementX||e.oMovementX||0;var i=e.movementY||e.webkitMovementY||e.mozMovementY||e.oMovementY||0;if(u===c.ROTATE)l.rotate(new THREE.Vector3(.005*-t,.005*-i,0));else if(u===c.ZOOM)l.zoom(new THREE.Vector3(0,0,i));else if(u===c.PAN)l.pan(new THREE.Vector3(-t,i,0))}}function n(){if(l.enabled!==!1){t.removeEventListener("mousemove",r,!1);t.removeEventListener("mouseup",n,!1);t.removeEventListener("mouseout",n,!1);u=c.NONE}}function o(e){var t=0;if(e.wheelDelta)t=-e.wheelDelta;else if(e.detail)t=10*e.detail;l.zoom(new THREE.Vector3(0,0,t))}function a(e){if(l.enabled!==!1){var t=e.touches;switch(t.length){case 2:var i=t[0].pageX-t[1].pageX;var r=t[0].pageY-t[1].pageY;g=Math.sqrt(i*i+r*r)}v.set(t[0].pageX,t[0].pageY,0)}}function s(e){if(l.enabled!==!1){e.preventDefault();e.stopPropagation();var t=e.touches;m.set(t[0].pageX,t[0].pageY,0);switch(t.length){case 1:l.rotate(m.sub(v).multiplyScalar(-.005));break;case 2:var i=t[0].pageX-t[1].pageX;var r=t[0].pageY-t[1].pageY;var n=Math.sqrt(i*i+r*r);l.zoom(new THREE.Vector3(0,0,g-n));g=n;break;case 3:l.pan(m.sub(v).setX(-m.x))}v.set(t[0].pageX,t[0].pageY,0)}}t=void 0!==t?t:document;this.enabled=!0;var l=this;var h=new THREE.Vector3;var c={NONE:-1,ROTATE:0,ZOOM:1,PAN:2};var u=c.NONE;var f=new THREE.Vector3;var d=new THREE.Matrix3;var p={type:"change"};this.focus=function(t){f.getPositionFromMatrix(t.matrixWorld);e.lookAt(f);l.dispatchEvent(p)};this.pan=function(t){d.getNormalMatrix(e.matrix);t.applyMatrix3(d);t.multiplyScalar(.001*h.copy(f).sub(e.position).length());e.position.add(t);f.add(t);l.dispatchEvent(p)};this.zoom=function(t){d.getNormalMatrix(e.matrix);t.applyMatrix3(d);t.multiplyScalar(.001*h.copy(f).sub(e.position).length());e.position.add(t);l.dispatchEvent(p)};this.rotate=function(t){h.copy(e.position).sub(f);var i=Math.atan2(h.x,h.z);var r=Math.atan2(Math.sqrt(h.x*h.x+h.z*h.z),h.y);i+=t.x;r+=t.y;var n=1e-6;r=Math.max(n,Math.min(Math.PI-n,r));var o=h.length();h.x=o*Math.sin(r)*Math.sin(i);h.y=o*Math.cos(r);h.z=o*Math.sin(r)*Math.cos(i);e.position.copy(f).add(h);e.lookAt(f);l.dispatchEvent(p)};t.addEventListener("contextmenu",function(e){e.preventDefault()},!1);t.addEventListener("mousedown",i,!1);t.addEventListener("mousewheel",o,!1);t.addEventListener("DOMMouseScroll",o,!1);var m=new THREE.Vector3;var v=new THREE.Vector3;var g=null;t.addEventListener("touchstart",a,!1);t.addEventListener("touchmove",s,!1)};THREE.EditorControls.prototype=Object.create(THREE.EventDispatcher.prototype);