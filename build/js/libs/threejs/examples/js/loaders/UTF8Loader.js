function getHttpRequest(e,t,i){var r={load:function(e){t(n,e)},progress:function(e){i(n,e)}},n=new XMLHttpRequest;addListeners(n,r),n.open("GET",e,!0),n.send(null)}function getJsonRequest(e,t){getHttpRequest(e,function(e){t(JSON.parse(e.responseText))},function(){})}function addListeners(e,t){for(var i in t)e.addEventListener(i,t[i])}THREE.UTF8Loader=function(){},THREE.UTF8Loader.prototype.load=function(e,t,i){this.downloadModelJson(e,i,t)},THREE.UTF8Loader.BufferGeometryCreator=function(){},THREE.UTF8Loader.BufferGeometryCreator.prototype.create=function(e,t){var i,r,n,o,a,s,l,h,c=t.length/3,u=new THREE.BufferGeometry,d=new Float32Array(9*c),p=new Float32Array(9*c),f=new Float32Array(6*c),m=e.length,g=8;for(r=0,n=0,i=n;m>i;i+=g)o=e[i],a=e[i+1],s=e[i+2],d[r++]=o,d[r++]=a,d[r++]=s;for(r=0,n=3,i=n;m>i;i+=g)l=e[i],h=e[i+1],f[r++]=l,f[r++]=h;for(r=0,n=5,i=n;m>i;i+=g)o=e[i],a=e[i+1],s=e[i+2],p[r++]=o,p[r++]=a,p[r++]=s;var v=u.attributes;return v.index={itemSize:1,array:t,numItems:t.length},v.position={itemSize:3,array:d,numItems:d.length},v.normal={itemSize:3,array:p,numItems:p.length},v.uv={itemSize:2,array:f,numItems:f.length},u.offsets=[{start:0,count:t.length,index:0}],u.computeBoundingSphere(),u},THREE.UTF8Loader.GeometryCreator=function(){},THREE.UTF8Loader.GeometryCreator.prototype={create:function(e,t){var i=new THREE.Geometry;this.init_vertices(i,e,8,0);var r=this.init_uvs(e,8,3),n=this.init_normals(e,8,5);return this.init_faces(i,n,r,t),i.computeCentroids(),i.computeFaceNormals(),i},init_vertices:function(e,t,i,r){var n,o,a,s,l=t.length;for(n=r;l>n;n+=i)o=t[n],a=t[n+1],s=t[n+2],this.addVertex(e,o,a,s)},init_normals:function(e,t,i){var r,n,o,a,s=[],l=e.length;for(r=i;l>r;r+=t)n=e[r],o=e[r+1],a=e[r+2],s.push(n,o,a);return s},init_uvs:function(e,t,i){var r,n,o,a=[],s=e.length;for(r=i;s>r;r+=t)n=e[r],o=e[r+1],a.push(n,o);return a},init_faces:function(e,t,i,r){var n,o,a,s,l,h,c,u,d,p,f=r.length,m=0;for(n=0;f>n;n+=3)o=r[n],a=r[n+1],s=r[n+2],this.f3n(e,t,o,a,s,m,o,a,s),l=i[2*o],h=i[2*o+1],c=i[2*a],u=i[2*a+1],d=i[2*s],p=i[2*s+1],this.uv3(e.faceVertexUvs[0],l,h,c,u,d,p)},addVertex:function(e,t,i,r){e.vertices.push(new THREE.Vector3(t,i,r))},f3n:function(e,t,i,r,n,o,a,s,l){var h=t[3*a],c=t[3*a+1],u=t[3*a+2],d=t[3*s],p=t[3*s+1],f=t[3*s+2],m=t[3*l],g=t[3*l+1],v=t[3*l+2],E=new THREE.Vector3(h,c,u),y=new THREE.Vector3(d,p,f),_=new THREE.Vector3(m,g,v);e.faces.push(new THREE.Face3(i,r,n,[E,y,_],null,o))},uv3:function(e,t,i,r,n,o,a){var s=[];s.push(new THREE.Vector2(t,i)),s.push(new THREE.Vector2(r,n)),s.push(new THREE.Vector2(o,a)),e.push(s)}};var DEFAULT_DECODE_PARAMS={decodeOffsets:[-4095,-4095,-4095,0,0,-511,-511,-511],decodeScales:[1/8191,1/8191,1/8191,1/1023,1/1023,1/1023,1/1023,1/1023]};THREE.UTF8Loader.prototype.decompressAttribsInner_=function(e,t,i,r,n,o,a,s){for(var l=0,h=t;i>h;h++){var c=e.charCodeAt(h);l+=c>>1^-(1&c),r[n]=s*(l+a),n+=o}},THREE.UTF8Loader.prototype.decompressIndices_=function(e,t,i,r,n){for(var o=0,a=0;i>a;a++){var s=e.charCodeAt(t++);r[n++]=o-s,0===s&&o++}},THREE.UTF8Loader.prototype.decompressAABBs_=function(e,t,i,r,n){for(var o=6*i,a=t+o,s=0,l=new Float32Array(o),h=t;a>h;h+=6){var c=e.charCodeAt(h+0)+r[0],u=e.charCodeAt(h+1)+r[1],d=e.charCodeAt(h+2)+r[2],p=e.charCodeAt(h+3)+1>>1,f=e.charCodeAt(h+4)+1>>1,m=e.charCodeAt(h+5)+1>>1;l[s++]=n[0]*(c+p),l[s++]=n[1]*(u+f),l[s++]=n[2]*(d+m),l[s++]=n[0]*p,l[s++]=n[1]*f,l[s++]=n[2]*m}return l},THREE.UTF8Loader.prototype.decompressMesh=function(e,t,i,r,n,o){for(var a=i.decodeScales.length,s=i.decodeOffsets,l=i.decodeScales,h=t.attribRange[0],c=t.attribRange[1],u=h,d=new Float32Array(a*c),p=0;a>p;p++){var f=u+c,m=l[p];m&&this.decompressAttribsInner_(e,u,f,d,p,a,s[p],m),u=f}t.indexRange[0];var g=3*t.indexRange[1],v=new Uint16Array(g);this.decompressIndices_(e,u,g,v,0);var E=void 0,y=t.bboxes;y&&(E=this.decompressAABBs_(e,y,t.names.length,s,l)),o(r,n,d,v,E,t)},THREE.UTF8Loader.prototype.copyAttrib=function(e,t,i,r){for(var n=0;e>n;n++)i[n]=t[e*r+n]},THREE.UTF8Loader.prototype.decodeAttrib2=function(e,t,i,r,n,o,a,s,l,h){for(var c=0;5>c;c++){var u=e.charCodeAt(n+o*c+h),d=u>>1^-(1&u);l[c]+=d,s[t*h+c]=l[c],a[t*h+c]=r[c]*(l[c]+i[c])}},THREE.UTF8Loader.prototype.accumulateNormal=function(e,t,i,r,n){var o=r[8*e],a=r[8*e+1],s=r[8*e+2],l=r[8*t],h=r[8*t+1],c=r[8*t+2],u=r[8*i],d=r[8*i+1],p=r[8*i+2];l-=o,h-=a,c-=s,u-=o,d-=a,p-=s,o=h*p-c*d,a=c*u-l*p,s=l*d-h*u,n[3*e]+=o,n[3*e+1]+=a,n[3*e+2]+=s,n[3*t]+=o,n[3*t+1]+=a,n[3*t+2]+=s,n[3*i]+=o,n[3*i+1]+=a,n[3*i+2]+=s},THREE.UTF8Loader.prototype.decompressMesh2=function(e,t,i,r,n,o){var a=96,s=i.decodeScales.length,l=i.decodeOffsets,h=i.decodeScales,c=t.attribRange[0],u=t.attribRange[1],d=t.codeRange[0];t.codeRange[1];for(var p=3*t.codeRange[2],f=new Uint16Array(p),m=new Int32Array(3*u),g=new Uint16Array(s),v=new Uint16Array(s*u),E=new Float32Array(s*u),y=0,_=0,T=0;p>T;T+=3){var b=e.charCodeAt(d++),x=Math.min(T,a);if(x>b){var w,R,H,S=b%3,M=T-(b-S);switch(S){case 0:w=f[M+2],R=f[M+1],H=f[M+0];break;case 1:w=f[M+0],R=f[M+2],H=f[M+1];break;case 2:w=f[M+1],R=f[M+0],H=f[M+2]}f[_++]=w,f[_++]=R,b=e.charCodeAt(d++);var C=y-b;if(f[_++]=C,0===b){for(var A=0;5>A;A++){var D=e.charCodeAt(c+u*A+y),P=(D>>1^-(1&D))+v[s*w+A]+v[s*R+A]-v[s*H+A];g[A]=P,v[s*y+A]=P,E[s*y+A]=h[A]*(P+l[A])}y++}else this.copyAttrib(s,v,g,C);this.accumulateNormal(w,R,C,v,m)}else{var L=y-(b-x);f[_++]=L,b===x?this.decodeAttrib2(e,s,l,h,c,u,E,v,g,y++):this.copyAttrib(s,v,g,L),b=e.charCodeAt(d++);var k=y-b;f[_++]=k,0===b?this.decodeAttrib2(e,s,l,h,c,u,E,v,g,y++):this.copyAttrib(s,v,g,k),b=e.charCodeAt(d++);var N=y-b;if(f[_++]=N,0===b){for(var A=0;5>A;A++)g[A]=(v[s*L+A]+v[s*k+A])/2;this.decodeAttrib2(e,s,l,h,c,u,E,v,g,y++)}else this.copyAttrib(s,v,g,N);this.accumulateNormal(L,k,N,v,m)}}for(var T=0;u>T;T++){var I=m[3*T],O=m[3*T+1],F=m[3*T+2],z=511/Math.sqrt(I*I+O*O+F*F),V=e.charCodeAt(c+5*u+T),U=e.charCodeAt(c+6*u+T),B=e.charCodeAt(c+7*u+T);E[s*T+5]=z*I+(V>>1^-(1&V)),E[s*T+6]=z*O+(U>>1^-(1&U)),E[s*T+7]=z*F+(B>>1^-(1&B))}o(r,n,E,f,void 0,t)},THREE.UTF8Loader.prototype.downloadMesh=function(e,t,i,r,n){function o(e){for(;s<i.length;){var o=i[s],l=o.indexRange;if(l){var h=l[0]+3*l[1];if(e.responseText.length<h)break;a.decompressMesh(e.responseText,o,r,t,s,n)}else{var c=o.codeRange,h=c[0]+c[1];if(e.responseText.length<h)break;a.decompressMesh2(e.responseText,o,r,t,s,n)}++s}}var a=this,s=0;getHttpRequest(e,function(e,t){(200===e.status||0===e.status)&&o(e,t)},o)},THREE.UTF8Loader.prototype.downloadMeshes=function(e,t,i,r){for(var n in t){var o=t[n];this.downloadMesh(e+n,n,o,i,r)}},THREE.UTF8Loader.prototype.createMeshCallback=function(e,t,i){var r=0,n=0,o={},a={},s={},l=t.urls;for(var h in l)o[h]=l[h].length,a[h]=0,n++,s[h]=new THREE.Object3D;var c=new THREE.Object3D,u=new THREE.MTLLoader.MaterialCreator(e,t.options);u.setMaterials(t.materials),u.preload();var d=new THREE.UTF8Loader.GeometryCreator,p=new THREE.UTF8Loader.BufferGeometryCreator,f=function(e,l,h,f,m,g){var v=void 0!==t.options.useBuffers?t.options.useBuffers:!0;if(v)var E=p.create(h,f);else var E=d.create(h,f);var y=u.create(g.material),_=new THREE.Mesh(E,y);s[e].add(_),a[e]++,a[e]===o[e]&&(r++,c.add(s[e]),r===n&&i(c))};return f},THREE.UTF8Loader.prototype.downloadModel=function(e,t,i,r){var n=this.createMeshCallback(t,i,r);this.downloadMeshes(e,i.urls,i.decodeParams,n)},THREE.UTF8Loader.prototype.downloadModelJson=function(e,t,i){getJsonRequest(e,function(r){r.decodeParams||(r.decodeParams=t&&t.decodeParams?t.decodeParams:DEFAULT_DECODE_PARAMS),r.options=t;var n=e.substr(0,e.lastIndexOf("/")+1),o=n;t&&t.geometryBase&&(n=t.geometryBase,"/"!==n.charAt(n.length-1)&&(n+="/")),t&&t.materialBase&&(o=t.materialBase,"/"!==o.charAt(o.length-1)&&(o+="/")),this.downloadModel(n,o,r,i)}.bind(this))};