function getHttpRequest(e,t,i){var r={load:function(e){t(n,e)},progress:function(e){i(n,e)}};var n=new XMLHttpRequest;addListeners(n,r);n.open("GET",e,!0);n.send(null)}function getJsonRequest(e,t){getHttpRequest(e,function(e){t(JSON.parse(e.responseText))},function(){})}function addListeners(e,t){for(var i in t)e.addEventListener(i,t[i])}THREE.UTF8Loader=function(){};THREE.UTF8Loader.prototype.load=function(e,t,i){this.downloadModelJson(e,i,t)};THREE.UTF8Loader.BufferGeometryCreator=function(){};THREE.UTF8Loader.BufferGeometryCreator.prototype.create=function(e,t){var i=t.length/3;var r=new THREE.BufferGeometry;var n=new Float32Array(9*i);var o=new Float32Array(9*i);var a=new Float32Array(6*i);var s,l,h;var c,u,f;var d,p;var m=e.length;var v=8;l=0;h=0;for(s=h;m>s;s+=v){c=e[s];u=e[s+1];f=e[s+2];n[l++]=c;n[l++]=u;n[l++]=f}l=0;h=3;for(s=h;m>s;s+=v){d=e[s];p=e[s+1];a[l++]=d;a[l++]=p}l=0;h=5;for(s=h;m>s;s+=v){c=e[s];u=e[s+1];f=e[s+2];o[l++]=c;o[l++]=u;o[l++]=f}var g=r.attributes;g["index"]={itemSize:1,array:t,numItems:t.length};g["position"]={itemSize:3,array:n,numItems:n.length};g["normal"]={itemSize:3,array:o,numItems:o.length};g["uv"]={itemSize:2,array:a,numItems:a.length};r.offsets=[{start:0,count:t.length,index:0}];r.computeBoundingSphere();return r};THREE.UTF8Loader.GeometryCreator=function(){};THREE.UTF8Loader.GeometryCreator.prototype={create:function(e,t){var i=new THREE.Geometry;this.init_vertices(i,e,8,0);var r=this.init_uvs(e,8,3);var n=this.init_normals(e,8,5);this.init_faces(i,n,r,t);i.computeCentroids();i.computeFaceNormals();return i},init_vertices:function(e,t,i,r){var n,o,a,s;var l=t.length;for(n=r;l>n;n+=i){o=t[n];a=t[n+1];s=t[n+2];this.addVertex(e,o,a,s)}},init_normals:function(e,t,i){var r=[];var n,o,a,s;var l=e.length;for(n=i;l>n;n+=t){o=e[n];a=e[n+1];s=e[n+2];r.push(o,a,s)}return r},init_uvs:function(e,t,i){var r=[];var n,o,a;var s=e.length;for(n=i;s>n;n+=t){o=e[n];a=e[n+1];r.push(o,a)}return r},init_faces:function(e,t,i,r){var n,o,a,s,l,h,c,u,f,d;var p=r.length;var m=0;for(n=0;p>n;n+=3){o=r[n];a=r[n+1];s=r[n+2];this.f3n(e,t,o,a,s,m,o,a,s);l=i[2*o];h=i[2*o+1];c=i[2*a];u=i[2*a+1];f=i[2*s];d=i[2*s+1];this.uv3(e.faceVertexUvs[0],l,h,c,u,f,d)}},addVertex:function(e,t,i,r){e.vertices.push(new THREE.Vector3(t,i,r))},f3n:function(e,t,i,r,n,o,a,s,l){var h=t[3*a],c=t[3*a+1],u=t[3*a+2],f=t[3*s],d=t[3*s+1],p=t[3*s+2],m=t[3*l],v=t[3*l+1],g=t[3*l+2];var E=new THREE.Vector3(h,c,u),y=new THREE.Vector3(f,d,p),_=new THREE.Vector3(m,v,g);e.faces.push(new THREE.Face3(i,r,n,[E,y,_],null,o))},uv3:function(e,t,i,r,n,o,a){var s=[];s.push(new THREE.Vector2(t,i));s.push(new THREE.Vector2(r,n));s.push(new THREE.Vector2(o,a));e.push(s)}};var DEFAULT_DECODE_PARAMS={decodeOffsets:[-4095,-4095,-4095,0,0,-511,-511,-511],decodeScales:[1/8191,1/8191,1/8191,1/1023,1/1023,1/1023,1/1023,1/1023]};THREE.UTF8Loader.prototype.decompressAttribsInner_=function(e,t,i,r,n,o,a,s){var l=0;for(var h=t;i>h;h++){var c=e.charCodeAt(h);l+=c>>1^-(1&c);r[n]=s*(l+a);n+=o}};THREE.UTF8Loader.prototype.decompressIndices_=function(e,t,i,r,n){var o=0;for(var a=0;i>a;a++){var s=e.charCodeAt(t++);r[n++]=o-s;if(0===s)o++}};THREE.UTF8Loader.prototype.decompressAABBs_=function(e,t,i,r,n){var o=6*i;var a=t+o;var s=0;var l=new Float32Array(o);for(var h=t;a>h;h+=6){var c=e.charCodeAt(h+0)+r[0];var u=e.charCodeAt(h+1)+r[1];var f=e.charCodeAt(h+2)+r[2];var d=e.charCodeAt(h+3)+1>>1;var p=e.charCodeAt(h+4)+1>>1;var m=e.charCodeAt(h+5)+1>>1;l[s++]=n[0]*(c+d);l[s++]=n[1]*(u+p);l[s++]=n[2]*(f+m);l[s++]=n[0]*d;l[s++]=n[1]*p;l[s++]=n[2]*m}return l};THREE.UTF8Loader.prototype.decompressMesh=function(e,t,i,r,n,o){var a=i.decodeScales.length;var s=i.decodeOffsets;var l=i.decodeScales;var h=t.attribRange[0];var c=t.attribRange[1];var u=h;var f=new Float32Array(a*c);for(var d=0;a>d;d++){var p=u+c;var m=l[d];if(m)this.decompressAttribsInner_(e,u,p,f,d,a,s[d],m);u=p}t.indexRange[0];var v=3*t.indexRange[1];var g=new Uint16Array(v);this.decompressIndices_(e,u,v,g,0);var E=void 0;var y=t.bboxes;if(y)E=this.decompressAABBs_(e,y,t.names.length,s,l);o(r,n,f,g,E,t)};THREE.UTF8Loader.prototype.copyAttrib=function(e,t,i,r){for(var n=0;e>n;n++)i[n]=t[e*r+n]};THREE.UTF8Loader.prototype.decodeAttrib2=function(e,t,i,r,n,o,a,s,l,h){for(var c=0;5>c;c++){var u=e.charCodeAt(n+o*c+h);var f=u>>1^-(1&u);l[c]+=f;s[t*h+c]=l[c];a[t*h+c]=r[c]*(l[c]+i[c])}};THREE.UTF8Loader.prototype.accumulateNormal=function(e,t,i,r,n){var o=r[8*e];var a=r[8*e+1];var s=r[8*e+2];var l=r[8*t];var h=r[8*t+1];var c=r[8*t+2];var u=r[8*i];var f=r[8*i+1];var d=r[8*i+2];l-=o;h-=a;c-=s;u-=o;f-=a;d-=s;o=h*d-c*f;a=c*u-l*d;s=l*f-h*u;n[3*e]+=o;n[3*e+1]+=a;n[3*e+2]+=s;n[3*t]+=o;n[3*t+1]+=a;n[3*t+2]+=s;n[3*i]+=o;n[3*i+1]+=a;n[3*i+2]+=s};THREE.UTF8Loader.prototype.decompressMesh2=function(e,t,i,r,n,o){var a=96;var s=i.decodeScales.length;var l=i.decodeOffsets;var h=i.decodeScales;var c=t.attribRange[0];var u=t.attribRange[1];var f=t.codeRange[0];t.codeRange[1];var d=3*t.codeRange[2];var p=new Uint16Array(d);var m=new Int32Array(3*u);var v=new Uint16Array(s);var g=new Uint16Array(s*u);var E=new Float32Array(s*u);var y=0;var _=0;for(var T=0;d>T;T+=3){var b=e.charCodeAt(f++);var x=Math.min(T,a);if(x>b){var w=b%3;var R=T-(b-w);var H,S,M;switch(w){case 0:H=p[R+2];S=p[R+1];M=p[R+0];break;case 1:H=p[R+0];S=p[R+2];M=p[R+1];break;case 2:H=p[R+1];S=p[R+0];M=p[R+2]}p[_++]=H;p[_++]=S;b=e.charCodeAt(f++);var C=y-b;p[_++]=C;if(0===b){for(var A=0;5>A;A++){var D=e.charCodeAt(c+u*A+y);var P=(D>>1^-(1&D))+g[s*H+A]+g[s*S+A]-g[s*M+A];v[A]=P;g[s*y+A]=P;E[s*y+A]=h[A]*(P+l[A])}y++}else this.copyAttrib(s,g,v,C);this.accumulateNormal(H,S,C,g,m)}else{var L=y-(b-x);p[_++]=L;if(b===x)this.decodeAttrib2(e,s,l,h,c,u,E,g,v,y++);else this.copyAttrib(s,g,v,L);b=e.charCodeAt(f++);var k=y-b;p[_++]=k;if(0===b)this.decodeAttrib2(e,s,l,h,c,u,E,g,v,y++);else this.copyAttrib(s,g,v,k);b=e.charCodeAt(f++);var N=y-b;p[_++]=N;if(0===b){for(var A=0;5>A;A++)v[A]=(g[s*L+A]+g[s*k+A])/2;this.decodeAttrib2(e,s,l,h,c,u,E,g,v,y++)}else this.copyAttrib(s,g,v,N);this.accumulateNormal(L,k,N,g,m)}}for(var T=0;u>T;T++){var O=m[3*T];var I=m[3*T+1];var F=m[3*T+2];var z=511/Math.sqrt(O*O+I*I+F*F);var V=e.charCodeAt(c+5*u+T);var U=e.charCodeAt(c+6*u+T);var B=e.charCodeAt(c+7*u+T);E[s*T+5]=z*O+(V>>1^-(1&V));E[s*T+6]=z*I+(U>>1^-(1&U));E[s*T+7]=z*F+(B>>1^-(1&B))}o(r,n,E,p,void 0,t)};THREE.UTF8Loader.prototype.downloadMesh=function(e,t,i,r,n){function o(e){for(;s<i.length;){var o=i[s];var l=o.indexRange;if(l){var h=l[0]+3*l[1];if(e.responseText.length<h)break;a.decompressMesh(e.responseText,o,r,t,s,n)}else{var c=o.codeRange;var h=c[0]+c[1];if(e.responseText.length<h)break;a.decompressMesh2(e.responseText,o,r,t,s,n)}++s}}var a=this;var s=0;getHttpRequest(e,function(e,t){if(200===e.status||0===e.status)o(e,t)},o)};THREE.UTF8Loader.prototype.downloadMeshes=function(e,t,i,r){for(var n in t){var o=t[n];this.downloadMesh(e+n,n,o,i,r)}};THREE.UTF8Loader.prototype.createMeshCallback=function(e,t,i){var r=0;var n=0;var o={};var a={};var s={};var l=t.urls;for(var h in l){o[h]=l[h].length;a[h]=0;n++;s[h]=new THREE.Object3D}var c=new THREE.Object3D;var u=new THREE.MTLLoader.MaterialCreator(e,t.options);u.setMaterials(t.materials);u.preload();var f=new THREE.UTF8Loader.GeometryCreator;var d=new THREE.UTF8Loader.BufferGeometryCreator;var p=function(e,l,h,p,m,v){var g=void 0!==t.options.useBuffers?t.options.useBuffers:!0;if(g)var E=d.create(h,p);else var E=f.create(h,p);var y=u.create(v.material);var _=new THREE.Mesh(E,y);s[e].add(_);a[e]++;if(a[e]===o[e]){r++;c.add(s[e]);if(r===n)i(c)}};return p};THREE.UTF8Loader.prototype.downloadModel=function(e,t,i,r){var n=this.createMeshCallback(t,i,r);this.downloadMeshes(e,i.urls,i.decodeParams,n)};THREE.UTF8Loader.prototype.downloadModelJson=function(e,t,i){getJsonRequest(e,function(r){if(!r.decodeParams)if(t&&t.decodeParams)r.decodeParams=t.decodeParams;else r.decodeParams=DEFAULT_DECODE_PARAMS;r.options=t;var n=e.substr(0,e.lastIndexOf("/")+1);var o=n;if(t&&t.geometryBase){n=t.geometryBase;if("/"!==n.charAt(n.length-1))n+="/"}if(t&&t.materialBase){o=t.materialBase;if("/"!==o.charAt(o.length-1))o+="/"}this.downloadModel(n,o,r,i)}.bind(this))};