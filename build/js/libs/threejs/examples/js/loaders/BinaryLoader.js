THREE.BinaryLoader=function(e){THREE.Loader.call(this,e)};THREE.BinaryLoader.prototype=Object.create(THREE.Loader.prototype);THREE.BinaryLoader.prototype.load=function(e,t,i,r){i=i||this.extractUrlBase(e);r=r||this.extractUrlBase(e);var n=this.showProgress?THREE.Loader.prototype.updateProgress:void 0;this.onLoadStart();this.loadAjaxJSON(this,e,t,i,r,n)};THREE.BinaryLoader.prototype.loadAjaxJSON=function(e,t,i,r,n,o){var a=new XMLHttpRequest;r=r&&"string"==typeof r?r:this.extractUrlBase(t);n=n&&"string"==typeof n?n:this.extractUrlBase(t);a.onreadystatechange=function(){if(4==a.readyState)if(200==a.status||0==a.status){var s=JSON.parse(a.responseText);e.loadAjaxBuffers(s,i,n,r,o)}else console.error("THREE.BinaryLoader: Couldn't load ["+t+"] ["+a.status+"]")};a.open("GET",t,!0);a.send(null)};THREE.BinaryLoader.prototype.loadAjaxBuffers=function(e,t,i,r,n){var o=new XMLHttpRequest,a=i+"/"+e.buffers;o.addEventListener("load",function(){var i=o.response;if(void 0===i)i=new Uint8Array(o.responseBody).buffer;if(0==i.byteLength){var i=new ArrayBuffer(o.responseText.length);var n=new Uint8Array(i);for(var a=0,s=o.responseText.length;s>a;a++)n[a]=255&o.responseText.charCodeAt(a)}THREE.BinaryLoader.prototype.createBinModel(i,t,r,e.materials)},!1);if(void 0!==n)o.addEventListener("progress",function(e){if(e.lengthComputable)n(e)},!1);o.addEventListener("error",function(){console.error("THREE.BinaryLoader: Couldn't load ["+a+"] ["+o.status+"]")},!1);o.open("GET",a,!0);o.responseType="arraybuffer";if(o.overrideMimeType)o.overrideMimeType("text/plain; charset=x-user-defined");o.send(null)};THREE.BinaryLoader.prototype.createBinModel=function(e,t,i,r){function n(e,t,i,r){e.vertices.push(new THREE.Vector3(t,i,r))}function o(e,t,i,r,n){e.faces.push(new THREE.Face3(t,i,r,null,null,n))}function a(e,t,i,r,n,o){e.faces.push(new THREE.Face4(t,i,r,n,null,null,o))}function s(e,t,i,r,n,o,a,s,l){var h=t[3*a],c=t[3*a+1],u=t[3*a+2],f=t[3*s],d=t[3*s+1],p=t[3*s+2],m=t[3*l],v=t[3*l+1],g=t[3*l+2];e.faces.push(new THREE.Face3(i,r,n,[new THREE.Vector3(h,c,u),new THREE.Vector3(f,d,p),new THREE.Vector3(m,v,g)],null,o))}function l(e,t,i,r,n,o,a,s,l,h,c){var u=t[3*s],f=t[3*s+1],d=t[3*s+2],p=t[3*l],m=t[3*l+1],v=t[3*l+2],g=t[3*h],E=t[3*h+1],y=t[3*h+2],_=t[3*c],T=t[3*c+1],b=t[3*c+2];e.faces.push(new THREE.Face4(i,r,n,o,[new THREE.Vector3(u,f,d),new THREE.Vector3(p,m,v),new THREE.Vector3(g,E,y),new THREE.Vector3(_,T,b)],null,a))}function h(e,t,i,r,n,o,a){e.push([new THREE.Vector2(t,i),new THREE.Vector2(r,n),new THREE.Vector2(o,a)])}function c(e,t,i,r,n,o,a,s,l){e.push([new THREE.Vector2(t,i),new THREE.Vector2(r,n),new THREE.Vector2(o,a),new THREE.Vector2(s,l)])}var u=function(){function t(e){return e%4?4-e%4:0}function i(e,t){var i={signature:r(e,t,12),header_bytes:u(e,t+12),vertex_coordinate_bytes:u(e,t+13),normal_coordinate_bytes:u(e,t+14),uv_coordinate_bytes:u(e,t+15),vertex_index_bytes:u(e,t+16),normal_index_bytes:u(e,t+17),uv_index_bytes:u(e,t+18),material_index_bytes:u(e,t+19),nvertices:f(e,t+20),nnormals:f(e,t+20+4),nuvs:f(e,t+20+8),ntri_flat:f(e,t+20+12),ntri_smooth:f(e,t+20+16),ntri_flat_uv:f(e,t+20+20),ntri_smooth_uv:f(e,t+20+24),nquad_flat:f(e,t+20+28),nquad_smooth:f(e,t+20+32),nquad_flat_uv:f(e,t+20+36),nquad_smooth_uv:f(e,t+20+40)};return i}function r(e,t,i){var r=new Uint8Array(e,t,i);var n="";for(var o=0;i>o;o++)n+=String.fromCharCode(r[t+o]);return n}function u(e,t){var i=new Uint8Array(e,t,1);return i[0]}function f(e,t){var i=new Uint32Array(e,t,1);return i[0]}function d(t){var i=A.nvertices;var r=new Float32Array(e,t,3*i);var o,a,s,l;for(o=0;i>o;o++){a=r[3*o];s=r[3*o+1];l=r[3*o+2];n(K,a,s,l)}return 3*i*Float32Array.BYTES_PER_ELEMENT}function p(t){var i=A.nnormals;if(i){var r=new Int8Array(e,t,3*i);var n,o,a,s;for(n=0;i>n;n++){o=r[3*n];a=r[3*n+1];s=r[3*n+2];Q.push(o/127,a/127,s/127)}}return 3*i*Int8Array.BYTES_PER_ELEMENT}function m(t){var i=A.nuvs;if(i){var r=new Float32Array(e,t,2*i);var n,o,a;for(n=0;i>n;n++){o=r[2*n];a=r[2*n+1];$.push(o,a)}}return 2*i*Float32Array.BYTES_PER_ELEMENT}function v(t,i){var r,n,o,a,s,l,c,u,f,d;var p=new Uint32Array(e,i,3*t);for(r=0;t>r;r++){n=p[3*r];o=p[3*r+1];a=p[3*r+2];s=$[2*n];u=$[2*n+1];l=$[2*o];f=$[2*o+1];c=$[2*a];d=$[2*a+1];h(K.faceVertexUvs[0],s,u,l,f,c,d)}}function g(t,i){var r,n,o,a,s,l,h,u,f,d,p,m,v;var g=new Uint32Array(e,i,4*t);for(r=0;t>r;r++){n=g[4*r];o=g[4*r+1];a=g[4*r+2];s=g[4*r+3];l=$[2*n];d=$[2*n+1];h=$[2*o];p=$[2*o+1];u=$[2*a];m=$[2*a+1];f=$[2*s];v=$[2*s+1];c(K.faceVertexUvs[0],l,d,h,p,u,m,f,v)}}function E(t,i,r){var n,a,s,l,h;var c=new Uint32Array(e,i,3*t);var u=new Uint16Array(e,r,t);for(n=0;t>n;n++){a=c[3*n];s=c[3*n+1];l=c[3*n+2];h=u[n];o(K,a,s,l,h)}}function y(t,i,r){var n,o,s,l,h,c;var u=new Uint32Array(e,i,4*t);var f=new Uint16Array(e,r,t);for(n=0;t>n;n++){o=u[4*n];s=u[4*n+1];l=u[4*n+2];h=u[4*n+3];c=f[n];a(K,o,s,l,h,c)}}function _(t,i,r,n){var o,a,l,h,c;var u,f,d;var p=new Uint32Array(e,i,3*t);var m=new Uint32Array(e,r,3*t);var v=new Uint16Array(e,n,t);for(o=0;t>o;o++){a=p[3*o];l=p[3*o+1];h=p[3*o+2];u=m[3*o];f=m[3*o+1];d=m[3*o+2];c=v[o];s(K,Q,a,l,h,c,u,f,d)}}function T(t,i,r,n){var o,a,s,h,c,u;var f,d,p,m;var v=new Uint32Array(e,i,4*t);var g=new Uint32Array(e,r,4*t);var E=new Uint16Array(e,n,t);for(o=0;t>o;o++){a=v[4*o];s=v[4*o+1];h=v[4*o+2];c=v[4*o+3];f=g[4*o];d=g[4*o+1];p=g[4*o+2];m=g[4*o+3];u=E[o];l(K,Q,a,s,h,c,u,f,d,p,m)}}function b(e){var t=A.ntri_flat;if(t){var i=e+3*t*Uint32Array.BYTES_PER_ELEMENT;E(t,e,i)}}function x(e){var t=A.ntri_flat_uv;if(t){var i=e+3*t*Uint32Array.BYTES_PER_ELEMENT;var r=i+3*t*Uint32Array.BYTES_PER_ELEMENT;E(t,e,r);v(t,i)}}function w(e){var t=A.ntri_smooth;if(t){var i=e+3*t*Uint32Array.BYTES_PER_ELEMENT;var r=i+3*t*Uint32Array.BYTES_PER_ELEMENT;_(t,e,i,r)}}function R(e){var t=A.ntri_smooth_uv;if(t){var i=e+3*t*Uint32Array.BYTES_PER_ELEMENT;var r=i+3*t*Uint32Array.BYTES_PER_ELEMENT;var n=r+3*t*Uint32Array.BYTES_PER_ELEMENT;_(t,e,i,n);v(t,r)}}function H(e){var t=A.nquad_flat;if(t){var i=e+4*t*Uint32Array.BYTES_PER_ELEMENT;y(t,e,i)}}function S(e){var t=A.nquad_flat_uv;if(t){var i=e+4*t*Uint32Array.BYTES_PER_ELEMENT;var r=i+4*t*Uint32Array.BYTES_PER_ELEMENT;y(t,e,r);g(t,i)}}function M(e){var t=A.nquad_smooth;if(t){var i=e+4*t*Uint32Array.BYTES_PER_ELEMENT;var r=i+4*t*Uint32Array.BYTES_PER_ELEMENT;T(t,e,i,r)}}function C(e){var t=A.nquad_smooth_uv;if(t){var i=e+4*t*Uint32Array.BYTES_PER_ELEMENT;var r=i+4*t*Uint32Array.BYTES_PER_ELEMENT;var n=r+4*t*Uint32Array.BYTES_PER_ELEMENT;T(t,e,i,n);g(t,r)}}var A,D,P,L,k,N,O,I,z,F,V,U,B,j,W,G,X,Y,q,K=this,Z=0,Q=[],$=[];THREE.Geometry.call(this);A=i(e,Z);Z+=A.header_bytes;F=3*A.vertex_index_bytes+A.material_index_bytes;V=4*A.vertex_index_bytes+A.material_index_bytes;U=A.ntri_flat*F;B=A.ntri_smooth*(F+3*A.normal_index_bytes);j=A.ntri_flat_uv*(F+3*A.uv_index_bytes);W=A.ntri_smooth_uv*(F+3*A.normal_index_bytes+3*A.uv_index_bytes);G=A.nquad_flat*V;X=A.nquad_smooth*(V+4*A.normal_index_bytes);Y=A.nquad_flat_uv*(V+4*A.uv_index_bytes);q=A.nquad_smooth_uv*(V+4*A.normal_index_bytes+4*A.uv_index_bytes);Z+=d(Z);Z+=p(Z);Z+=t(3*A.nnormals);Z+=m(Z);D=Z;P=D+U+t(2*A.ntri_flat);L=P+B+t(2*A.ntri_smooth);k=L+j+t(2*A.ntri_flat_uv);N=k+W+t(2*A.ntri_smooth_uv);O=N+G+t(2*A.nquad_flat);I=O+X+t(2*A.nquad_smooth);z=I+Y+t(2*A.nquad_flat_uv);x(L);R(k);S(I);C(z);b(D);w(P);H(N);M(O);this.computeCentroids();this.computeFaceNormals()};u.prototype=Object.create(THREE.Geometry.prototype);var f=new u(i);var d=this.initMaterials(r,i);if(this.needsTangents(d))f.computeTangents();t(f,d)};