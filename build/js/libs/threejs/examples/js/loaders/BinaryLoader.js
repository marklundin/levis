THREE.BinaryLoader=function(e){THREE.Loader.call(this,e)},THREE.BinaryLoader.prototype=Object.create(THREE.Loader.prototype),THREE.BinaryLoader.prototype.load=function(e,t,i,n){i=i||this.extractUrlBase(e),n=n||this.extractUrlBase(e);var r=this.showProgress?THREE.Loader.prototype.updateProgress:void 0;this.onLoadStart(),this.loadAjaxJSON(this,e,t,i,n,r)},THREE.BinaryLoader.prototype.loadAjaxJSON=function(e,t,i,n,r,o){var a=new XMLHttpRequest;n=n&&"string"==typeof n?n:this.extractUrlBase(t),r=r&&"string"==typeof r?r:this.extractUrlBase(t),a.onreadystatechange=function(){if(4==a.readyState)if(200==a.status||0==a.status){var s=JSON.parse(a.responseText);e.loadAjaxBuffers(s,i,r,n,o)}else console.error("THREE.BinaryLoader: Couldn't load ["+t+"] ["+a.status+"]")},a.open("GET",t,!0),a.send(null)},THREE.BinaryLoader.prototype.loadAjaxBuffers=function(e,t,i,n,r){var o=new XMLHttpRequest,a=i+"/"+e.buffers;o.addEventListener("load",function(){var i=o.response;if(void 0===i&&(i=new Uint8Array(o.responseBody).buffer),0==i.byteLength)for(var i=new ArrayBuffer(o.responseText.length),r=new Uint8Array(i),a=0,s=o.responseText.length;s>a;a++)r[a]=255&o.responseText.charCodeAt(a);THREE.BinaryLoader.prototype.createBinModel(i,t,n,e.materials)},!1),void 0!==r&&o.addEventListener("progress",function(e){e.lengthComputable&&r(e)},!1),o.addEventListener("error",function(){console.error("THREE.BinaryLoader: Couldn't load ["+a+"] ["+o.status+"]")},!1),o.open("GET",a,!0),o.responseType="arraybuffer",o.overrideMimeType&&o.overrideMimeType("text/plain; charset=x-user-defined"),o.send(null)},THREE.BinaryLoader.prototype.createBinModel=function(e,t,i,n){function r(e,t,i,n){e.vertices.push(new THREE.Vector3(t,i,n))}function o(e,t,i,n,r){e.faces.push(new THREE.Face3(t,i,n,null,null,r))}function a(e,t,i,n,r,o){e.faces.push(new THREE.Face4(t,i,n,r,null,null,o))}function s(e,t,i,n,r,o,a,s,l){var h=t[3*a],c=t[3*a+1],u=t[3*a+2],d=t[3*s],p=t[3*s+1],f=t[3*s+2],m=t[3*l],g=t[3*l+1],v=t[3*l+2];e.faces.push(new THREE.Face3(i,n,r,[new THREE.Vector3(h,c,u),new THREE.Vector3(d,p,f),new THREE.Vector3(m,g,v)],null,o))}function l(e,t,i,n,r,o,a,s,l,h,c){var u=t[3*s],d=t[3*s+1],p=t[3*s+2],f=t[3*l],m=t[3*l+1],g=t[3*l+2],v=t[3*h],E=t[3*h+1],y=t[3*h+2],_=t[3*c],T=t[3*c+1],b=t[3*c+2];e.faces.push(new THREE.Face4(i,n,r,o,[new THREE.Vector3(u,d,p),new THREE.Vector3(f,m,g),new THREE.Vector3(v,E,y),new THREE.Vector3(_,T,b)],null,a))}function h(e,t,i,n,r,o,a){e.push([new THREE.Vector2(t,i),new THREE.Vector2(n,r),new THREE.Vector2(o,a)])}function c(e,t,i,n,r,o,a,s,l){e.push([new THREE.Vector2(t,i),new THREE.Vector2(n,r),new THREE.Vector2(o,a),new THREE.Vector2(s,l)])}var u=function(){function t(e){return e%4?4-e%4:0}function i(e,t){var i={signature:n(e,t,12),header_bytes:u(e,t+12),vertex_coordinate_bytes:u(e,t+13),normal_coordinate_bytes:u(e,t+14),uv_coordinate_bytes:u(e,t+15),vertex_index_bytes:u(e,t+16),normal_index_bytes:u(e,t+17),uv_index_bytes:u(e,t+18),material_index_bytes:u(e,t+19),nvertices:d(e,t+20),nnormals:d(e,t+20+4),nuvs:d(e,t+20+8),ntri_flat:d(e,t+20+12),ntri_smooth:d(e,t+20+16),ntri_flat_uv:d(e,t+20+20),ntri_smooth_uv:d(e,t+20+24),nquad_flat:d(e,t+20+28),nquad_smooth:d(e,t+20+32),nquad_flat_uv:d(e,t+20+36),nquad_smooth_uv:d(e,t+20+40)};return i}function n(e,t,i){for(var n=new Uint8Array(e,t,i),r="",o=0;i>o;o++)r+=String.fromCharCode(n[t+o]);return r}function u(e,t){var i=new Uint8Array(e,t,1);return i[0]}function d(e,t){var i=new Uint32Array(e,t,1);return i[0]}function p(t){var i,n,o,a,s=A.nvertices,l=new Float32Array(e,t,3*s);for(i=0;s>i;i++)n=l[3*i],o=l[3*i+1],a=l[3*i+2],r(K,n,o,a);return 3*s*Float32Array.BYTES_PER_ELEMENT}function f(t){var i=A.nnormals;if(i){var n,r,o,a,s=new Int8Array(e,t,3*i);for(n=0;i>n;n++)r=s[3*n],o=s[3*n+1],a=s[3*n+2],Z.push(r/127,o/127,a/127)}return 3*i*Int8Array.BYTES_PER_ELEMENT}function m(t){var i=A.nuvs;if(i){var n,r,o,a=new Float32Array(e,t,2*i);for(n=0;i>n;n++)r=a[2*n],o=a[2*n+1],$.push(r,o)}return 2*i*Float32Array.BYTES_PER_ELEMENT}function g(t,i){var n,r,o,a,s,l,c,u,d,p,f=new Uint32Array(e,i,3*t);for(n=0;t>n;n++)r=f[3*n],o=f[3*n+1],a=f[3*n+2],s=$[2*r],u=$[2*r+1],l=$[2*o],d=$[2*o+1],c=$[2*a],p=$[2*a+1],h(K.faceVertexUvs[0],s,u,l,d,c,p)}function v(t,i){var n,r,o,a,s,l,h,u,d,p,f,m,g,v=new Uint32Array(e,i,4*t);for(n=0;t>n;n++)r=v[4*n],o=v[4*n+1],a=v[4*n+2],s=v[4*n+3],l=$[2*r],p=$[2*r+1],h=$[2*o],f=$[2*o+1],u=$[2*a],m=$[2*a+1],d=$[2*s],g=$[2*s+1],c(K.faceVertexUvs[0],l,p,h,f,u,m,d,g)}function E(t,i,n){var r,a,s,l,h,c=new Uint32Array(e,i,3*t),u=new Uint16Array(e,n,t);for(r=0;t>r;r++)a=c[3*r],s=c[3*r+1],l=c[3*r+2],h=u[r],o(K,a,s,l,h)}function y(t,i,n){var r,o,s,l,h,c,u=new Uint32Array(e,i,4*t),d=new Uint16Array(e,n,t);for(r=0;t>r;r++)o=u[4*r],s=u[4*r+1],l=u[4*r+2],h=u[4*r+3],c=d[r],a(K,o,s,l,h,c)}function _(t,i,n,r){var o,a,l,h,c,u,d,p,f=new Uint32Array(e,i,3*t),m=new Uint32Array(e,n,3*t),g=new Uint16Array(e,r,t);for(o=0;t>o;o++)a=f[3*o],l=f[3*o+1],h=f[3*o+2],u=m[3*o],d=m[3*o+1],p=m[3*o+2],c=g[o],s(K,Z,a,l,h,c,u,d,p)}function T(t,i,n,r){var o,a,s,h,c,u,d,p,f,m,g=new Uint32Array(e,i,4*t),v=new Uint32Array(e,n,4*t),E=new Uint16Array(e,r,t);for(o=0;t>o;o++)a=g[4*o],s=g[4*o+1],h=g[4*o+2],c=g[4*o+3],d=v[4*o],p=v[4*o+1],f=v[4*o+2],m=v[4*o+3],u=E[o],l(K,Z,a,s,h,c,u,d,p,f,m)}function b(e){var t=A.ntri_flat;if(t){var i=e+3*t*Uint32Array.BYTES_PER_ELEMENT;E(t,e,i)}}function x(e){var t=A.ntri_flat_uv;if(t){var i=e+3*t*Uint32Array.BYTES_PER_ELEMENT,n=i+3*t*Uint32Array.BYTES_PER_ELEMENT;E(t,e,n),g(t,i)}}function w(e){var t=A.ntri_smooth;if(t){var i=e+3*t*Uint32Array.BYTES_PER_ELEMENT,n=i+3*t*Uint32Array.BYTES_PER_ELEMENT;_(t,e,i,n)}}function R(e){var t=A.ntri_smooth_uv;if(t){var i=e+3*t*Uint32Array.BYTES_PER_ELEMENT,n=i+3*t*Uint32Array.BYTES_PER_ELEMENT,r=n+3*t*Uint32Array.BYTES_PER_ELEMENT;_(t,e,i,r),g(t,n)}}function H(e){var t=A.nquad_flat;if(t){var i=e+4*t*Uint32Array.BYTES_PER_ELEMENT;y(t,e,i)}}function S(e){var t=A.nquad_flat_uv;if(t){var i=e+4*t*Uint32Array.BYTES_PER_ELEMENT,n=i+4*t*Uint32Array.BYTES_PER_ELEMENT;y(t,e,n),v(t,i)}}function M(e){var t=A.nquad_smooth;if(t){var i=e+4*t*Uint32Array.BYTES_PER_ELEMENT,n=i+4*t*Uint32Array.BYTES_PER_ELEMENT;T(t,e,i,n)}}function C(e){var t=A.nquad_smooth_uv;if(t){var i=e+4*t*Uint32Array.BYTES_PER_ELEMENT,n=i+4*t*Uint32Array.BYTES_PER_ELEMENT,r=n+4*t*Uint32Array.BYTES_PER_ELEMENT;T(t,e,i,r),v(t,n)}}var A,D,P,L,k,N,O,I,z,F,V,U,B,j,W,G,X,Y,q,K=this,Q=0,Z=[],$=[];THREE.Geometry.call(this),A=i(e,Q),Q+=A.header_bytes,F=3*A.vertex_index_bytes+A.material_index_bytes,V=4*A.vertex_index_bytes+A.material_index_bytes,U=A.ntri_flat*F,B=A.ntri_smooth*(F+3*A.normal_index_bytes),j=A.ntri_flat_uv*(F+3*A.uv_index_bytes),W=A.ntri_smooth_uv*(F+3*A.normal_index_bytes+3*A.uv_index_bytes),G=A.nquad_flat*V,X=A.nquad_smooth*(V+4*A.normal_index_bytes),Y=A.nquad_flat_uv*(V+4*A.uv_index_bytes),q=A.nquad_smooth_uv*(V+4*A.normal_index_bytes+4*A.uv_index_bytes),Q+=p(Q),Q+=f(Q),Q+=t(3*A.nnormals),Q+=m(Q),D=Q,P=D+U+t(2*A.ntri_flat),L=P+B+t(2*A.ntri_smooth),k=L+j+t(2*A.ntri_flat_uv),N=k+W+t(2*A.ntri_smooth_uv),O=N+G+t(2*A.nquad_flat),I=O+X+t(2*A.nquad_smooth),z=I+Y+t(2*A.nquad_flat_uv),x(L),R(k),S(I),C(z),b(D),w(P),H(N),M(O),this.computeCentroids(),this.computeFaceNormals()};u.prototype=Object.create(THREE.Geometry.prototype);var d=new u(i),p=this.initMaterials(n,i);this.needsTangents(p)&&d.computeTangents(),t(d,p)};