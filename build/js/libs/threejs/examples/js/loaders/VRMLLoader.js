THREE.VRMLLoader=function(){};THREE.VRMLLoader.prototype={constructor:THREE.VTKLoader,load:function(e,t){var i=this;var r=new XMLHttpRequest;r.addEventListener("load",function(e){var r=i.parse(e.target.responseText);i.dispatchEvent({type:"load",content:r});if(t)t(geometry)},!1);r.addEventListener("progress",function(e){i.dispatchEvent({type:"progress",loaded:e.loaded,total:e.total})},!1);r.addEventListener("error",function(){i.dispatchEvent({type:"error",message:"Couldn't load URL ["+e+"]"})},!1);r.open("GET",e,!0);r.send(null)},parse:function(e){var t=function(){console.warn("VRML V1.0 not supported yet")};var i=function(e,t){var i=function(e){var t={string:"Scene",children:[]};for(var i=0;i<e.length;i++){var r=e[i];if(!/^#/.exec(r));else;}return t};var r={};var n=/( +[\d|\.|\+|\-|e]+)/;var o=/( +[\d|\.|\+|\-|e]+),?( +[\d|\.|\+|\-|e]+),?( +[\d|\.|\+|\-|e]+)/;var a=/( +[\d|\.|\+|\-|e]+),?( +[\d|\.|\+|\-|e]+),?( +[\d|\.|\+|\-|e]+),?( +[\d|\.|\+|\-|e]+)/;var s=function(e,t){if("string"!=typeof e){var i=t;if(/Transform/.exec(e.string)||/Group/.exec(e.string)){i=new THREE.Object3D;if(/DEF/.exec(e.string)){i.name=/DEF (\w+)/.exec(e.string)[1];r[i.name]=i}for(var l=0,h=e.children.length;h>l;l++){var c=e.children[l];if(/translation/.exec(c)){var u=o.exec(c);i.position.set(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]))}else if(/rotation/.exec(c)){var u=a.exec(c);i.rotation.set(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])).multiplyScalar(u[4])}else if(/scale/.exec(c)){var u=o.exec(c);i.scale.set(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]))}}t.add(i)}else if(/Shape/.exec(e.string)){i=new THREE.Mesh;if(/DEF/.exec(e.string)){i.name=/DEF (\w+)/.exec(e.string)[1];r[i.name]=i}t.add(i)}else if(/geometry/.exec(e.string)){if(/Box/.exec(e.string)){var f=1,d=1,p=1;for(var l=0,h=e.children.length;h>l;l++){var c=e.children[l];if(/size/.exec(c)){var u=o.exec(c);f=parseFloat(u[1]);d=parseFloat(u[2]);p=parseFloat(u[3])}}t.geometry=new THREE.CubeGeometry(f,d,p)}else if(/Cylinder/.exec(e.string)){var m=1,d=1;for(var l=0,h=e.children.length;h>l;l++){var c=e.children[l];if(/radius/.exec(c))m=parseFloat(n.exec(c)[1]);else if(/height/.exec(c))d=parseFloat(n.exec(c)[1])}t.geometry=new THREE.CylinderGeometry(m,m,d)}else if(/Cone/.exec(e.string)){var v=0,g=1,d=1;for(var l=0,h=e.children.length;h>l;l++){var c=e.children[l];if(/bottomRadius/.exec(c))g=parseFloat(n.exec(c)[1]);else if(/height/.exec(c))d=parseFloat(n.exec(c)[1])}t.geometry=new THREE.CylinderGeometry(v,g,d)}else if(/Sphere/.exec(e.string)){var u=/radius( +[\d|\.|\+|\-|e]+)/.exec(e.children[0]);t.geometry=new THREE.SphereGeometry(parseFloat(u[1]))}return}else if(/appearance/.exec(e.string)){for(var l=0;l<e.children.length;l++){var c=e.children[l];if(/Material/.exec(c.string)){var E=new THREE.MeshPhongMaterial;for(var h=0;h<c.children.length;h++){var y=c.children[h];if(/diffuseColor/.exec(y)){var u=o.exec(y);E.color.setRGB(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]))}else if(/emissiveColor/.exec(y)){var u=o.exec(y);E.emissive.setRGB(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]))}else if(/specularColor/.exec(y)){var u=o.exec(y);E.specular.setRGB(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]))}else if(/transparency/.exec(y)){var u=/( +[\d|\.|\+|\-|e]+)/.exec(y);E.opacity=parseFloat(u[1]);E.transparent=!0}}if(/DEF/.exec(e.string)){E.name=/DEF (\w+)/.exec(e.string)[1];r[E.name]=E}t.material=E}}return}for(var l=0,_=e.children.length;_>l;l++){var c=e.children[l];s(e.children[l],i)}}else if(/USE/.exec(e))if(/appearance/.exec(e))t.material=r[/USE (\w+)/.exec(e)[1]].clone();else{var i=r[/USE (\w+)/.exec(e)[1]].clone();t.add(i)}};s(i(e),t)};var r=new THREE.Scene;var n=e.split("\n");var o=n.shift();if(/V1.0/.exec(o))t(n,r);else if(/V2.0/.exec(o))i(n,r);return r}};THREE.EventDispatcher.prototype.apply(THREE.VRMLLoader.prototype);