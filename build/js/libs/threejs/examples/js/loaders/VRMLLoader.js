THREE.VRMLLoader=function(){},THREE.VRMLLoader.prototype={constructor:THREE.VTKLoader,load:function(e,t){var i=this,r=new XMLHttpRequest;r.addEventListener("load",function(e){var r=i.parse(e.target.responseText);i.dispatchEvent({type:"load",content:r}),t&&t(geometry)},!1),r.addEventListener("progress",function(e){i.dispatchEvent({type:"progress",loaded:e.loaded,total:e.total})},!1),r.addEventListener("error",function(){i.dispatchEvent({type:"error",message:"Couldn't load URL ["+e+"]"})},!1),r.open("GET",e,!0),r.send(null)},parse:function(e){var t=function(){console.warn("VRML V1.0 not supported yet")},i=function(e,t){var i=function(e){for(var t={string:"Scene",children:[]},i=t,r=0;r<e.length;r++){var n=e[r];if(!/^#/.exec(n))if(/{/.exec(n)){var o={string:n,parent:i,children:[]};i.children.push(o),i=o,/}/.exec(n)&&(o.children.push(/{(.*)}/.exec(n)[1]),i=i.parent)}else/}/.exec(n)?i=i.parent:""!==n&&i.children.push(n)}return t},r={},n=/( +[\d|\.|\+|\-|e]+)/,o=/( +[\d|\.|\+|\-|e]+),?( +[\d|\.|\+|\-|e]+),?( +[\d|\.|\+|\-|e]+)/,a=/( +[\d|\.|\+|\-|e]+),?( +[\d|\.|\+|\-|e]+),?( +[\d|\.|\+|\-|e]+),?( +[\d|\.|\+|\-|e]+)/,s=function(e,t){if("string"!=typeof e){var i=t;if(/Transform/.exec(e.string)||/Group/.exec(e.string)){i=new THREE.Object3D,/DEF/.exec(e.string)&&(i.name=/DEF (\w+)/.exec(e.string)[1],r[i.name]=i);for(var l=0,h=e.children.length;h>l;l++){var c=e.children[l];if(/translation/.exec(c)){var u=o.exec(c);i.position.set(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]))}else if(/rotation/.exec(c)){var u=a.exec(c);i.rotation.set(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])).multiplyScalar(u[4])}else if(/scale/.exec(c)){var u=o.exec(c);i.scale.set(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]))}}t.add(i)}else if(/Shape/.exec(e.string))i=new THREE.Mesh,/DEF/.exec(e.string)&&(i.name=/DEF (\w+)/.exec(e.string)[1],r[i.name]=i),t.add(i);else{if(/geometry/.exec(e.string)){if(/Box/.exec(e.string)){for(var d=1,p=1,f=1,l=0,h=e.children.length;h>l;l++){var c=e.children[l];if(/size/.exec(c)){var u=o.exec(c);d=parseFloat(u[1]),p=parseFloat(u[2]),f=parseFloat(u[3])}}t.geometry=new THREE.CubeGeometry(d,p,f)}else if(/Cylinder/.exec(e.string)){for(var m=1,p=1,l=0,h=e.children.length;h>l;l++){var c=e.children[l];/radius/.exec(c)?m=parseFloat(n.exec(c)[1]):/height/.exec(c)&&(p=parseFloat(n.exec(c)[1]))}t.geometry=new THREE.CylinderGeometry(m,m,p)}else if(/Cone/.exec(e.string)){for(var g=0,v=1,p=1,l=0,h=e.children.length;h>l;l++){var c=e.children[l];/bottomRadius/.exec(c)?v=parseFloat(n.exec(c)[1]):/height/.exec(c)&&(p=parseFloat(n.exec(c)[1]))}t.geometry=new THREE.CylinderGeometry(g,v,p)}else if(/Sphere/.exec(e.string)){var u=/radius( +[\d|\.|\+|\-|e]+)/.exec(e.children[0]);t.geometry=new THREE.SphereGeometry(parseFloat(u[1]))}return}if(/appearance/.exec(e.string)){for(var l=0;l<e.children.length;l++){var c=e.children[l];if(/Material/.exec(c.string)){for(var E=new THREE.MeshPhongMaterial,h=0;h<c.children.length;h++){var y=c.children[h];if(/diffuseColor/.exec(y)){var u=o.exec(y);E.color.setRGB(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]))}else if(/emissiveColor/.exec(y)){var u=o.exec(y);E.emissive.setRGB(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]))}else if(/specularColor/.exec(y)){var u=o.exec(y);E.specular.setRGB(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]))}else if(/transparency/.exec(y)){var u=/( +[\d|\.|\+|\-|e]+)/.exec(y);E.opacity=parseFloat(u[1]),E.transparent=!0}}/DEF/.exec(e.string)&&(E.name=/DEF (\w+)/.exec(e.string)[1],r[E.name]=E),t.material=E}}return}}for(var l=0,_=e.children.length;_>l;l++){var c=e.children[l];s(e.children[l],i)}}else if(/USE/.exec(e))if(/appearance/.exec(e))t.material=r[/USE (\w+)/.exec(e)[1]].clone();else{var i=r[/USE (\w+)/.exec(e)[1]].clone();t.add(i)}};s(i(e),t)},r=new THREE.Scene,n=e.split("\n"),o=n.shift();return/V1.0/.exec(o)?t(n,r):/V2.0/.exec(o)&&i(n,r),r}},THREE.EventDispatcher.prototype.apply(THREE.VRMLLoader.prototype);