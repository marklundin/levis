THREE.Matrix4=function(e,t,i,r,o,n,a,s,l,c,h,u,d,p,f,m){this.elements=new Float32Array(16);var g=this.elements;g[0]=void 0!==e?e:1,g[4]=t||0,g[8]=i||0,g[12]=r||0,g[1]=o||0,g[5]=void 0!==n?n:1,g[9]=a||0,g[13]=s||0,g[2]=l||0,g[6]=c||0,g[10]=void 0!==h?h:1,g[14]=u||0,g[3]=d||0,g[7]=p||0,g[11]=f||0,g[15]=void 0!==m?m:1},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(e,t,i,r,o,n,a,s,l,c,h,u,d,p,f,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=r,g[1]=o,g[5]=n,g[9]=a,g[13]=s,g[2]=l,g[6]=c,g[10]=h,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(e){return this.elements.set(e.elements),this},extractPosition:function(e){return console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},copyPosition:function(e){var t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this},extractRotation:function(){var e=new THREE.Vector3;return function(t){var i=this.elements,r=t.elements,o=1/e.set(r[0],r[1],r[2]).length(),n=1/e.set(r[4],r[5],r[6]).length(),a=1/e.set(r[8],r[9],r[10]).length();return i[0]=r[0]*o,i[1]=r[1]*o,i[2]=r[2]*o,i[4]=r[4]*n,i[5]=r[5]*n,i[6]=r[6]*n,i[8]=r[8]*a,i[9]=r[9]*a,i[10]=r[10]*a,this}}(),makeRotationFromEuler:function(e){void 0===typeof e.order&&console.error("ERROR: Matrix's .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var t=this.elements,i=e.x,r=e.y,o=e.z,n=Math.cos(i),a=Math.sin(i),s=Math.cos(r),l=Math.sin(r),c=Math.cos(o),h=Math.sin(o);if(void 0===e.order||"XYZ"===e.order){var u=n*c,d=n*h,p=a*c,f=a*h;t[0]=s*c,t[4]=-s*h,t[8]=l,t[1]=d+p*l,t[5]=u-f*l,t[9]=-a*s,t[2]=f-u*l,t[6]=p+d*l,t[10]=n*s}else if("YXZ"===e.order){var m=s*c,g=s*h,v=l*c,E=l*h;t[0]=m+E*a,t[4]=v*a-g,t[8]=n*l,t[1]=n*h,t[5]=n*c,t[9]=-a,t[2]=g*a-v,t[6]=E+m*a,t[10]=n*s}else if("ZXY"===e.order){var m=s*c,g=s*h,v=l*c,E=l*h;t[0]=m-E*a,t[4]=-n*h,t[8]=v+g*a,t[1]=g+v*a,t[5]=n*c,t[9]=E-m*a,t[2]=-n*l,t[6]=a,t[10]=n*s}else if("ZYX"===e.order){var u=n*c,d=n*h,p=a*c,f=a*h;t[0]=s*c,t[4]=p*l-d,t[8]=u*l+f,t[1]=s*h,t[5]=f*l+u,t[9]=d*l-p,t[2]=-l,t[6]=a*s,t[10]=n*s}else if("YZX"===e.order){var y=n*s,T=n*l,x=a*s,R=a*l;t[0]=s*c,t[4]=R-y*h,t[8]=x*h+T,t[1]=h,t[5]=n*c,t[9]=-a*c,t[2]=-l*c,t[6]=T*h+x,t[10]=y-R*h}else if("XZY"===e.order){var y=n*s,T=n*l,x=a*s,R=a*l;t[0]=s*c,t[4]=-h,t[8]=l*c,t[1]=y*h+R,t[5]=n*c,t[9]=T*h-x,t[2]=x*h-T,t[6]=a*c,t[10]=R*h+y}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},setRotationFromQuaternion:function(e){return console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code."),this.makeRotationFromQuaternion(e)},makeRotationFromQuaternion:function(e){var t=this.elements,i=e.x,r=e.y,o=e.z,n=e.w,a=i+i,s=r+r,l=o+o,c=i*a,h=i*s,u=i*l,d=r*s,p=r*l,f=o*l,m=n*a,g=n*s,v=n*l;return t[0]=1-(d+f),t[4]=h-v,t[8]=u+g,t[1]=h+v,t[5]=1-(c+f),t[9]=p-m,t[2]=u-g,t[6]=p+m,t[10]=1-(c+d),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:function(){var e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3;return function(r,o,n){var a=this.elements;return i.subVectors(r,o).normalize(),0===i.length()&&(i.z=1),e.crossVectors(n,i).normalize(),0===e.length()&&(i.x+=1e-4,e.crossVectors(n,i).normalize()),t.crossVectors(i,e),a[0]=e.x,a[4]=t.x,a[8]=i.x,a[1]=e.y,a[5]=t.y,a[9]=i.y,a[2]=e.z,a[6]=t.z,a[10]=i.z,this}}(),multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var i=e.elements,r=t.elements,o=this.elements,n=i[0],a=i[4],s=i[8],l=i[12],c=i[1],h=i[5],u=i[9],d=i[13],p=i[2],f=i[6],m=i[10],g=i[14],v=i[3],E=i[7],y=i[11],T=i[15],x=r[0],R=r[4],b=r[8],_=r[12],w=r[1],H=r[5],M=r[9],S=r[13],C=r[2],A=r[6],D=r[10],P=r[14],L=r[3],N=r[7],F=r[11],k=r[15];return o[0]=n*x+a*w+s*C+l*L,o[4]=n*R+a*H+s*A+l*N,o[8]=n*b+a*M+s*D+l*F,o[12]=n*_+a*S+s*P+l*k,o[1]=c*x+h*w+u*C+d*L,o[5]=c*R+h*H+u*A+d*N,o[9]=c*b+h*M+u*D+d*F,o[13]=c*_+h*S+u*P+d*k,o[2]=p*x+f*w+m*C+g*L,o[6]=p*R+f*H+m*A+g*N,o[10]=p*b+f*M+m*D+g*F,o[14]=p*_+f*S+m*P+g*k,o[3]=v*x+E*w+y*C+T*L,o[7]=v*R+E*H+y*A+T*N,o[11]=v*b+E*M+y*D+T*F,o[15]=v*_+E*S+y*P+T*k,this},multiplyToArray:function(e,t,i){var r=this.elements;return this.multiplyMatrices(e,t),i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},multiplyVector3:function(e){return console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),e.applyProjection(this)},multiplyVector4:function(e){return console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){var e=new THREE.Vector3;return function(t){for(var i=0,r=t.length;r>i;i+=3)e.x=t[i],e.y=t[i+1],e.z=t[i+2],e.applyProjection(this),t[i]=e.x,t[i+1]=e.y,t[i+2]=e.z;return t}}(),rotateAxis:function(e){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},determinant:function(){var e=this.elements,t=e[0],i=e[4],r=e[8],o=e[12],n=e[1],a=e[5],s=e[9],l=e[13],c=e[2],h=e[6],u=e[10],d=e[14],p=e[3],f=e[7],m=e[11],g=e[15];return p*(+o*s*h-r*l*h-o*a*u+i*l*u+r*a*d-i*s*d)+f*(+t*s*d-t*l*u+o*n*u-r*n*d+r*l*c-o*s*c)+m*(+t*l*h-t*a*d-o*n*h+i*n*d+o*a*c-i*l*c)+g*(-r*a*c-t*s*h+t*a*u+r*n*h-i*n*u+i*s*c)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},flattenToArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},flattenToArrayOffset:function(e,t){var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e},getPosition:function(){var e=new THREE.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");var t=this.elements;return e.set(t[12],t[13],t[14])}}(),setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var i=this.elements,r=e.elements,o=r[0],n=r[4],a=r[8],s=r[12],l=r[1],c=r[5],h=r[9],u=r[13],d=r[2],p=r[6],f=r[10],m=r[14],g=r[3],v=r[7],E=r[11],y=r[15];i[0]=h*m*v-u*f*v+u*p*E-c*m*E-h*p*y+c*f*y,i[4]=s*f*v-a*m*v-s*p*E+n*m*E+a*p*y-n*f*y,i[8]=a*u*v-s*h*v+s*c*E-n*u*E-a*c*y+n*h*y,i[12]=s*h*p-a*u*p-s*c*f+n*u*f+a*c*m-n*h*m,i[1]=u*f*g-h*m*g-u*d*E+l*m*E+h*d*y-l*f*y,i[5]=a*m*g-s*f*g+s*d*E-o*m*E-a*d*y+o*f*y,i[9]=s*h*g-a*u*g-s*l*E+o*u*E+a*l*y-o*h*y,i[13]=a*u*d-s*h*d+s*l*f-o*u*f-a*l*m+o*h*m,i[2]=c*m*g-u*p*g+u*d*v-l*m*v-c*d*y+l*p*y,i[6]=s*p*g-n*m*g-s*d*v+o*m*v+n*d*y-o*p*y,i[10]=n*u*g-s*c*g+s*l*v-o*u*v-n*l*y+o*c*y,i[14]=s*c*d-n*u*d-s*l*p+o*u*p+n*l*m-o*c*m,i[3]=h*p*g-c*f*g-h*d*v+l*f*v+c*d*E-l*p*E,i[7]=n*f*g-a*p*g+a*d*v-o*f*v-n*d*E+o*p*E,i[11]=a*c*g-n*h*g-a*l*v+o*h*v+n*l*E-o*c*E,i[15]=n*h*d-a*c*d+a*l*p-o*h*p-n*l*f+o*c*f;var T=o*i[0]+l*i[4]+d*i[8]+g*i[12];if(0==T){var x="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(x);return console.warn(x),this.identity(),this}return this.multiplyScalar(1/T),this},translate:function(){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},scale:function(e){var t=this.elements,i=e.x,r=e.y,o=e.z;return t[0]*=i,t[4]*=r,t[8]*=o,t[1]*=i,t[5]*=r,t[9]*=o,t[2]*=i,t[6]*=r,t[10]*=o,t[3]*=i,t[7]*=r,t[11]*=o,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,Math.max(i,r)))},makeTranslation:function(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var i=Math.cos(t),r=Math.sin(t),o=1-i,n=e.x,a=e.y,s=e.z,l=o*n,c=o*a;return this.set(l*n+i,l*a-r*s,l*s+r*a,0,l*a+r*s,c*a+i,c*s-r*n,0,l*s-r*a,c*s+r*n,o*s*s+i,0,0,0,0,1),this},makeScale:function(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this},compose:function(e,t,i){return this.makeRotationFromQuaternion(t),this.scale(i),this.setPosition(e),this},decompose:function(){var e=new THREE.Vector3,t=new THREE.Matrix4;return function(i,r,o){var n=this.elements,a=e.set(n[0],n[1],n[2]).length(),s=e.set(n[4],n[5],n[6]).length(),l=e.set(n[8],n[9],n[10]).length();i.x=n[12],i.y=n[13],i.z=n[14],t.elements.set(this.elements);var c=1/a,h=1/s,u=1/l;return t.elements[0]*=c,t.elements[1]*=c,t.elements[2]*=c,t.elements[4]*=h,t.elements[5]*=h,t.elements[6]*=h,t.elements[8]*=u,t.elements[9]*=u,t.elements[10]*=u,r.setFromRotationMatrix(t),o.x=a,o.y=s,o.z=l,this}}(),makeFrustum:function(e,t,i,r,o,n){var a=this.elements,s=2*o/(t-e),l=2*o/(r-i),c=(t+e)/(t-e),h=(r+i)/(r-i),u=-(n+o)/(n-o),d=-2*n*o/(n-o);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(e,t,i,r){var o=i*Math.tan(THREE.Math.degToRad(.5*e)),n=-o,a=n*t,s=o*t;return this.makeFrustum(a,s,n,o,i,r)},makeOrthographic:function(e,t,i,r,o,n){var a=this.elements,s=t-e,l=i-r,c=n-o,h=(t+e)/s,u=(i+r)/l,d=(n+o)/c;return a[0]=2/s,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2/l,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2/c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},clone:function(){var e=this.elements;return new THREE.Matrix4(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])}};