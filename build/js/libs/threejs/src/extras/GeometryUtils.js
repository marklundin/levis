THREE.GeometryUtils={merge:function(e,t,i){var r,n,o=e.vertices.length,a=(e.faceVertexUvs[0].length,t instanceof THREE.Mesh?t.geometry:t),s=e.vertices,l=a.vertices,c=e.faces,h=a.faces,u=e.faceVertexUvs[0],f=a.faceVertexUvs[0];if(void 0===i)i=0;if(t instanceof THREE.Mesh){t.matrixAutoUpdate&&t.updateMatrix();r=t.matrix;n=(new THREE.Matrix3).getNormalMatrix(r)}for(var d=0,p=l.length;p>d;d++){var m=l[d];var v=m.clone();if(r)v.applyMatrix4(r);s.push(v)}for(d=0,p=h.length;p>d;d++){var g,E,y,T=h[d],_=T.vertexNormals,b=T.vertexColors;if(T instanceof THREE.Face3)g=new THREE.Face3(T.a+o,T.b+o,T.c+o);else if(T instanceof THREE.Face4)g=new THREE.Face4(T.a+o,T.b+o,T.c+o,T.d+o);g.normal.copy(T.normal);if(n)g.normal.applyMatrix3(n).normalize();for(var x=0,R=_.length;R>x;x++){E=_[x].clone();if(n)E.applyMatrix3(n).normalize();g.vertexNormals.push(E)}g.color.copy(T.color);for(var x=0,R=b.length;R>x;x++){y=b[x];g.vertexColors.push(y.clone())}g.materialIndex=T.materialIndex+i;g.centroid.copy(T.centroid);if(r)g.centroid.applyMatrix4(r);c.push(g)}for(d=0,p=f.length;p>d;d++){var w=f[d],H=[];for(var x=0,R=w.length;R>x;x++)H.push(new THREE.Vector2(w[x].x,w[x].y));u.push(H)}},removeMaterials:function(e,t){var i={};for(var r=0,n=t.length;n>r;r++)i[t[r]]=!0;var o,a=[];for(var r=0,n=e.faces.length;n>r;r++){o=e.faces[r];if(!(o.materialIndex in i))a.push(o)}e.faces=a},randomPointInTriangle:function(){var e=new THREE.Vector3;return function(t,i,r){var n=new THREE.Vector3;var o=THREE.Math.random16();var a=THREE.Math.random16();if(o+a>1){o=1-o;a=1-a}var s=1-o-a;n.copy(t);n.multiplyScalar(o);e.copy(i);e.multiplyScalar(a);n.add(e);e.copy(r);e.multiplyScalar(s);n.add(e);return n}}(),randomPointInFace:function(e,t,i){var r,n,o,a;if(e instanceof THREE.Face3){r=t.vertices[e.a];n=t.vertices[e.b];o=t.vertices[e.c];return THREE.GeometryUtils.randomPointInTriangle(r,n,o)}else if(e instanceof THREE.Face4){r=t.vertices[e.a];n=t.vertices[e.b];o=t.vertices[e.c];a=t.vertices[e.d];var s,l;if(i)if(e._area1&&e._area2){s=e._area1;l=e._area2}else{s=THREE.GeometryUtils.triangleArea(r,n,a);l=THREE.GeometryUtils.triangleArea(n,o,a);e._area1=s;e._area2=l}else s=THREE.GeometryUtils.triangleArea(r,n,a),l=THREE.GeometryUtils.triangleArea(n,o,a);var c=THREE.Math.random16()*(s+l);if(s>c)return THREE.GeometryUtils.randomPointInTriangle(r,n,a);else return THREE.GeometryUtils.randomPointInTriangle(n,o,a)}},randomPointsInGeometry:function(e,t){function i(e){function t(i,r){if(i>r)return i;var n=i+Math.floor((r-i)/2);if(d[n]>e)return t(i,n-1);else if(d[n]<e)return t(n+1,r);else return n}var i=t(0,d.length-1);return i}var r,n,o,a,s,l,c=e.faces,h=e.vertices,u=c.length,f=0,d=[];for(n=0;u>n;n++){r=c[n];if(r instanceof THREE.Face3){o=h[r.a];a=h[r.b];s=h[r.c];r._area=THREE.GeometryUtils.triangleArea(o,a,s)}else if(r instanceof THREE.Face4){o=h[r.a];a=h[r.b];s=h[r.c];l=h[r.d];r._area1=THREE.GeometryUtils.triangleArea(o,a,l);r._area2=THREE.GeometryUtils.triangleArea(a,s,l);r._area=r._area1+r._area2}f+=r._area;d[n]=f}var p,m,v=[];var g={};for(n=0;t>n;n++){p=THREE.Math.random16()*f;m=i(p);v[n]=THREE.GeometryUtils.randomPointInFace(c[m],e,!0);if(!g[m])g[m]=1;else g[m]+=1}return v},triangleArea:function(){var e=new THREE.Vector3;var t=new THREE.Vector3;return function(i,r,n){e.subVectors(r,i);t.subVectors(n,i);e.cross(t);return.5*e.length()}}(),center:function(e){e.computeBoundingBox();var t=e.boundingBox;var i=new THREE.Vector3;i.addVectors(t.min,t.max);i.multiplyScalar(-.5);e.applyMatrix((new THREE.Matrix4).makeTranslation(i.x,i.y,i.z));e.computeBoundingBox();return i},triangulateQuads:function(e){var t,i,r,n;var o=[];var a=[];var s=[];for(t=0,i=e.faceUvs.length;i>t;t++)a[t]=[];for(t=0,i=e.faceVertexUvs.length;i>t;t++)s[t]=[];for(t=0,i=e.faces.length;i>t;t++){var l=e.faces[t];if(l instanceof THREE.Face4){var c=l.a;var h=l.b;var u=l.c;var f=l.d;var d=new THREE.Face3;var p=new THREE.Face3;d.color.copy(l.color);p.color.copy(l.color);d.materialIndex=l.materialIndex;p.materialIndex=l.materialIndex;d.a=c;d.b=h;d.c=f;p.a=h;p.b=u;p.c=f;if(4===l.vertexColors.length){d.vertexColors[0]=l.vertexColors[0].clone();d.vertexColors[1]=l.vertexColors[1].clone();d.vertexColors[2]=l.vertexColors[3].clone();p.vertexColors[0]=l.vertexColors[1].clone();p.vertexColors[1]=l.vertexColors[2].clone();p.vertexColors[2]=l.vertexColors[3].clone()}o.push(d,p);for(r=0,n=e.faceVertexUvs.length;n>r;r++)if(e.faceVertexUvs[r].length){var m=e.faceVertexUvs[r][t];var v=m[0];var g=m[1];var E=m[2];var y=m[3];var T=[v.clone(),g.clone(),y.clone()];var _=[g.clone(),E.clone(),y.clone()];s[r].push(T,_)}for(r=0,n=e.faceUvs.length;n>r;r++)if(e.faceUvs[r].length){var b=e.faceUvs[r][t];a[r].push(b,b)}}else{o.push(l);for(r=0,n=e.faceUvs.length;n>r;r++)a[r].push(e.faceUvs[r][t]);for(r=0,n=e.faceVertexUvs.length;n>r;r++)s[r].push(e.faceVertexUvs[r][t])}}e.faces=o;e.faceUvs=a;e.faceVertexUvs=s;e.computeCentroids();e.computeFaceNormals();e.computeVertexNormals();if(e.hasTangents)e.computeTangents()},setMaterialIndex:function(e,t,i,r){var n=e.faces;var o=i||0;var a=r||n.length-1;for(var s=o;a>=s;s++)n[s].materialIndex=t}};