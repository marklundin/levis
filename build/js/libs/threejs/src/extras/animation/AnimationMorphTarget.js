THREE.AnimationMorphTarget=function(e,t){this.root=e,this.data=THREE.AnimationHandler.get(t),this.hierarchy=THREE.AnimationHandler.parse(e),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.isPaused=!0,this.loop=!0,this.influence=1},THREE.AnimationMorphTarget.prototype.play=function(e,t){if(!this.isPlaying){this.isPlaying=!0,this.loop=void 0!==e?e:!0,this.currentTime=void 0!==t?t:0;for(var i=0;i<this.hierarchy.length;i++)void 0===this.hierarchy[i].animationCache&&(this.hierarchy[i].animationCache={},this.hierarchy[i].animationCache.prevKey=0,this.hierarchy[i].animationCache.nextKey=0),this.hierarchy[i].animationCache.prevKey=this.data.hierarchy[i].keys[0],this.hierarchy[i].animationCache.nextKey=this.data.hierarchy[i].keys[1];this.update(0)}this.isPaused=!1,THREE.AnimationHandler.addToUpdate(this)},THREE.AnimationMorphTarget.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this),this.isPaused=!this.isPaused},THREE.AnimationMorphTarget.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,THREE.AnimationHandler.removeFromUpdate(this);for(var e=0;e<this.hierarchy.length;e++)void 0!==this.hierarchy[e].animationCache&&delete this.hierarchy[e].animationCache},THREE.AnimationMorphTarget.prototype.update=function(e){if(this.isPlaying){var t,i,r,n,o,a,s;this.currentTime+=e*this.timeScale,s=this.currentTime,a=this.currentTime=this.currentTime%this.data.length;for(var l=0,c=this.hierarchy.length;c>l;l++){if(n=this.hierarchy[l],o=n.animationCache,i=o.prevKey,r=o.nextKey,r.time<=s){if(s>a){if(!this.loop)return this.stop(),void 0;for(i=this.data.hierarchy[l].keys[0],r=this.data.hierarchy[l].keys[1];r.time<a;)i=r,r=this.data.hierarchy[l].keys[r.index+1]}else do i=r,r=this.data.hierarchy[l].keys[r.index+1];while(r.time<a);o.prevKey=i,o.nextKey=r}t=(a-i.time)/(r.time-i.time),(0>t||t>1)&&(console.log("THREE.AnimationMorphTarget.update: Warning! Scale out of bounds:"+t),t=0>t?0:1);var h,u,d,p,f=i.morphTargetsInfluences,m=r.morphTargetsInfluences;for(d in f)h=f[d],u=m[d],p=this.root.getMorphTargetIndexByName(d),this.root.morphTargetInfluences[p]=(h+(u-h)*t)*this.influence}}};