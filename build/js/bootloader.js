/**
 * @license RequireJS domReady 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/*! jQuery v2.0.3 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license
*/

/*! jQuery UI - v1.10.3 - 2013-05-03
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.draggable.js, jquery.ui.droppable.js, jquery.ui.resizable.js, jquery.ui.selectable.js, jquery.ui.sortable.js, jquery.ui.effect.js, jquery.ui.accordion.js, jquery.ui.autocomplete.js, jquery.ui.button.js, jquery.ui.datepicker.js, jquery.ui.dialog.js, jquery.ui.effect-blind.js, jquery.ui.effect-bounce.js, jquery.ui.effect-clip.js, jquery.ui.effect-drop.js, jquery.ui.effect-explode.js, jquery.ui.effect-fade.js, jquery.ui.effect-fold.js, jquery.ui.effect-highlight.js, jquery.ui.effect-pulsate.js, jquery.ui.effect-scale.js, jquery.ui.effect-shake.js, jquery.ui.effect-slide.js, jquery.ui.effect-transfer.js, jquery.ui.menu.js, jquery.ui.position.js, jquery.ui.progressbar.js, jquery.ui.slider.js, jquery.ui.spinner.js, jquery.ui.tabs.js, jquery.ui.tooltip.js
* Copyright 2013 jQuery Foundation and other contributors; Licensed MIT */

/*!
 * jQuery Color Animations v2.1.2
 * https://github.com/jquery/jquery-color
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Date: Wed Jan 16 08:47:09 2013 -0600
 */

/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.

/**
 * dat-gui JavaScript Controller Library
 * http://code.google.com/p/dat-gui
 *
 * Copyright 2011 Data Arts Team, Google Creative Lab
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */

/*
 * Purl (A JavaScript URL parser) v2.3.1
 * Developed and maintanined by Mark Perkins, mark@allmarkedup.com
 * Source repository: https://github.com/allmarkedup/jQuery-URL-Parser
 * Licensed under an MIT-style license. See https://github.com/allmarkedup/jQuery-URL-Parser/blob/master/LICENSE for details.
 */

define("utils/domReady",[],function(){function e(e){var t;for(t=0;t<e.length;t+=1)e[t](h)}function t(){var t=c;l&&t.length&&(c=[],e(t))}function i(){l||(l=!0,a&&clearInterval(a),t())}function r(e){return l?e(h):c.push(e),r}var n,o,a,s="undefined"!=typeof window&&window.document,l=!s,h=s?document:null,c=[];if(s){if(document.addEventListener)document.addEventListener("DOMContentLoaded",i,!1),window.addEventListener("load",i,!1);else if(window.attachEvent){window.attachEvent("onload",i),o=document.createElement("div");try{n=null===window.frameElement}catch(u){}o.doScroll&&n&&window.external&&(a=setInterval(function(){try{o.doScroll(),i()}catch(e){}},30))}"complete"===document.readyState&&i()}return r.version="2.0.1",r.load=function(e,t,i,n){n.isBuild?i(null):r(i)},r}),requirejs.config({name:"main",baseUrl:"./js",waitSeconds:0,config:{main:{proxy:"https://levismakeourmark.thismoment.com/v4/api/media/image_proxy.json?url="},data:{instagram:{feed:"https://levismakeourmark.thismoment.com/v4/api/gallery/get.jsonp?environment=1&sort=1&gallery_id=4&category_id=28",search:"https://levismakeourmark.thismoment.com/v4/api/gallery/get.jsonp?environment=1&gallery_id=4&category_id=28&user_id="},twitter:{feed:"https://levismakeourmark.thismoment.com/v4/api/gallery/get.jsonp?environment=1&sort=1&gallery_id=4&category_id=29",search:"https://levismakeourmark.thismoment.com/v4/api/gallery/get.jsonp?environment=1&gallery_id=4&category_id=29&user_id="}}},paths:{glsl:"loaders/glsl",text:"loaders/text",json:"loaders/json",template:"loaders/template"},shim:{"libs/threejs/build/three":{exports:"THREE"},purl:{deps:["jquery"]},"libs/Tween":{exports:"Tween"},"libs/jquery-ui":["jquery"],"libs/threejs/examples/js/controls/OrbitControls":["libs/threejs/build/three"],"libs/threejs/examples/js/controls/TransformControls":["libs/threejs/build/three"]}}),"undefined"==typeof NAME&&(NAME="Levis"),"undefined"==typeof APP&&(APP="main"),require(["utils/domReady!","require"],function(e,t){t([APP])}),define("bootloader",function(){}),function(e,t){function i(e){var t=e.length,i=ot.type(e);return ot.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===i||"function"!==i&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function r(e){var t=ft[e]={};return ot.each(e.match(st)||[],function(e,i){t[i]=!0}),t}function n(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=ot.expando+Math.random()}function o(e,i,r){var n;if(r===t&&1===e.nodeType)if(n="data-"+i.replace(Et,"-$1").toLowerCase(),r=e.getAttribute(n),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:vt.test(r)?JSON.parse(r):r}catch(o){}mt.set(e,i,r)}else r=t;return r}function a(){return!0}function s(){return!1}function l(){try{return G.activeElement}catch(e){}}function h(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function c(e,t,i){if(ot.isFunction(t))return ot.grep(e,function(e,r){return!!t.call(e,r,e)!==i});if(t.nodeType)return ot.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(St.test(t))return ot.filter(t,e,i);t=ot.filter(t,e)}return ot.grep(e,function(e){return tt.call(t,e)>=0!==i})}function u(e,t){return ot.nodeName(e,"table")&&ot.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function d(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function p(e){var t=Ot.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function f(e,t){for(var i=e.length,r=0;i>r;r++)gt.set(e[r],"globalEval",!t||gt.get(t[r],"globalEval"))}function m(e,t){var i,r,n,o,a,s,l,h;if(1===t.nodeType){if(gt.hasData(e)&&(o=gt.access(e),a=gt.set(t,o),h=o.events)){delete a.handle,a.events={};for(n in h)for(i=0,r=h[n].length;r>i;i++)ot.event.add(t,n,h[n][i])}mt.hasData(e)&&(s=mt.access(e),l=ot.extend({},s),mt.set(t,l))}}function g(e,i){var r=e.getElementsByTagName?e.getElementsByTagName(i||"*"):e.querySelectorAll?e.querySelectorAll(i||"*"):[];return i===t||i&&ot.nodeName(e,i)?ot.merge([e],r):r}function v(e,t){var i=t.nodeName.toLowerCase();"input"===i&&zt.test(e.type)?t.checked=e.checked:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}function E(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),r=t,n=Jt.length;n--;)if(t=Jt[n]+i,t in e)return t;return r}function y(e,t){return e=t||e,"none"===ot.css(e,"display")||!ot.contains(e.ownerDocument,e)}function T(t){return e.getComputedStyle(t,null)}function _(e,t){for(var i,r,n,o=[],a=0,s=e.length;s>a;a++)r=e[a],r.style&&(o[a]=gt.get(r,"olddisplay"),i=r.style.display,t?(o[a]||"none"!==i||(r.style.display=""),""===r.style.display&&y(r)&&(o[a]=gt.access(r,"olddisplay",w(r.nodeName)))):o[a]||(n=y(r),(i&&"none"!==i||!n)&&gt.set(r,"olddisplay",n?i:ot.css(r,"display"))));for(a=0;s>a;a++)r=e[a],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[a]||"":"none"));return e}function b(e,t,i){var r=Xt.exec(t);return r?Math.max(0,r[1]-(i||0))+(r[2]||"px"):t}function x(e,t,i,r,n){for(var o=i===(r?"border":"content")?4:"width"===t?1:0,a=0;4>o;o+=2)"margin"===i&&(a+=ot.css(e,i+Zt[o],!0,n)),r?("content"===i&&(a-=ot.css(e,"padding"+Zt[o],!0,n)),"margin"!==i&&(a-=ot.css(e,"border"+Zt[o]+"Width",!0,n))):(a+=ot.css(e,"padding"+Zt[o],!0,n),"padding"!==i&&(a+=ot.css(e,"border"+Zt[o]+"Width",!0,n)));return a}function R(e,t,i){var r=!0,n="width"===t?e.offsetWidth:e.offsetHeight,o=T(e),a=ot.support.boxSizing&&"border-box"===ot.css(e,"boxSizing",!1,o);if(0>=n||null==n){if(n=Bt(e,t,o),(0>n||null==n)&&(n=e.style[t]),Yt.test(n))return n;r=a&&(ot.support.boxSizingReliable||n===e.style[t]),n=parseFloat(n)||0}return n+x(e,t,i||(a?"border":"content"),r,o)+"px"}function w(e){var t=G,i=Kt[e];return i||(i=H(e,t),"none"!==i&&i||(jt=(jt||ot("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(jt[0].contentWindow||jt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),i=H(e,t),jt.detach()),Kt[e]=i),i}function H(e,t){var i=ot(t.createElement(e)).appendTo(t.body),r=ot.css(i[0],"display");return i.remove(),r}function M(e,t,i,r){var n;if(ot.isArray(t))ot.each(t,function(t,n){i||ti.test(e)?r(e,n):M(e+"["+("object"==typeof n?t:"")+"]",n,i,r)});else if(i||"object"!==ot.type(t))r(e,t);else for(n in t)M(e+"["+n+"]",t[n],i,r)}function S(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var r,n=0,o=t.toLowerCase().match(st)||[];if(ot.isFunction(i))for(;r=o[n++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(i)):(e[r]=e[r]||[]).push(i)}}function C(e,i,r,n){function o(l){var h;return a[l]=!0,ot.each(e[l]||[],function(e,l){var c=l(i,r,n);return"string"!=typeof c||s||a[c]?s?!(h=c):t:(i.dataTypes.unshift(c),o(c),!1)}),h}var a={},s=e===Ei;return o(i.dataTypes[0])||!a["*"]&&o("*")}function A(e,i){var r,n,o=ot.ajaxSettings.flatOptions||{};for(r in i)i[r]!==t&&((o[r]?e:n||(n={}))[r]=i[r]);return n&&ot.extend(!0,e,n),e}function D(e,i,r){for(var n,o,a,s,l=e.contents,h=e.dataTypes;"*"===h[0];)h.shift(),n===t&&(n=e.mimeType||i.getResponseHeader("Content-Type"));if(n)for(o in l)if(l[o]&&l[o].test(n)){h.unshift(o);break}if(h[0]in r)a=h[0];else{for(o in r){if(!h[0]||e.converters[o+" "+h[0]]){a=o;break}s||(s=o)}a=a||s}return a?(a!==h[0]&&h.unshift(a),r[a]):t}function P(e,t,i,r){var n,o,a,s,l,h={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)h[a.toLowerCase()]=e.converters[a];for(o=c.shift();o;)if(e.responseFields[o]&&(i[e.responseFields[o]]=t),!l&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(a=h[l+" "+o]||h["* "+o],!a)for(n in h)if(s=n.split(" "),s[1]===o&&(a=h[l+" "+s[0]]||h["* "+s[0]])){a===!0?a=h[n]:h[n]!==!0&&(o=s[0],c.unshift(s[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(u){return{state:"parsererror",error:a?u:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}function L(){return setTimeout(function(){Mi=t}),Mi=ot.now()}function k(e,t,i){for(var r,n=(Li[t]||[]).concat(Li["*"]),o=0,a=n.length;a>o;o++)if(r=n[o].call(i,t,e))return r}function F(e,t,i){var r,n,o=0,a=Pi.length,s=ot.Deferred().always(function(){delete l.elem}),l=function(){if(n)return!1;for(var t=Mi||L(),i=Math.max(0,h.startTime+h.duration-t),r=i/h.duration||0,o=1-r,a=0,l=h.tweens.length;l>a;a++)h.tweens[a].run(o);return s.notifyWith(e,[h,o,i]),1>o&&l?i:(s.resolveWith(e,[h]),!1)},h=s.promise({elem:e,props:ot.extend({},t),opts:ot.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Mi||L(),duration:i.duration,tweens:[],createTween:function(t,i){var r=ot.Tween(e,h.opts,t,i,h.opts.specialEasing[t]||h.opts.easing);return h.tweens.push(r),r},stop:function(t){var i=0,r=t?h.tweens.length:0;if(n)return this;for(n=!0;r>i;i++)h.tweens[i].run(1);return t?s.resolveWith(e,[h,t]):s.rejectWith(e,[h,t]),this}}),c=h.props;for(z(c,h.opts.specialEasing);a>o;o++)if(r=Pi[o].call(h,e,c,h.opts))return r;return ot.map(c,k,h),ot.isFunction(h.opts.start)&&h.opts.start.call(e,h),ot.fx.timer(ot.extend(l,{elem:e,anim:h,queue:h.opts.queue})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}function z(e,t){var i,r,n,o,a;for(i in e)if(r=ot.camelCase(i),n=t[r],o=e[i],ot.isArray(o)&&(n=o[1],o=e[i]=o[0]),i!==r&&(e[r]=o,delete e[i]),a=ot.cssHooks[r],a&&"expand"in a){o=a.expand(o),delete e[r];for(i in o)i in e||(e[i]=o[i],t[i]=n)}else t[r]=n}function N(e,i,r){var n,o,a,s,l,h,c=this,u={},d=e.style,p=e.nodeType&&y(e),f=gt.get(e,"fxshow");r.queue||(l=ot._queueHooks(e,"fx"),null==l.unqueued&&(l.unqueued=0,h=l.empty.fire,l.empty.fire=function(){l.unqueued||h()}),l.unqueued++,c.always(function(){c.always(function(){l.unqueued--,ot.queue(e,"fx").length||l.empty.fire()})})),1===e.nodeType&&("height"in i||"width"in i)&&(r.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===ot.css(e,"display")&&"none"===ot.css(e,"float")&&(d.display="inline-block")),r.overflow&&(d.overflow="hidden",c.always(function(){d.overflow=r.overflow[0],d.overflowX=r.overflow[1],d.overflowY=r.overflow[2]}));for(n in i)if(o=i[n],Ci.exec(o)){if(delete i[n],a=a||"toggle"===o,o===(p?"hide":"show")){if("show"!==o||!f||f[n]===t)continue;p=!0}u[n]=f&&f[n]||ot.style(e,n)}if(!ot.isEmptyObject(u)){f?"hidden"in f&&(p=f.hidden):f=gt.access(e,"fxshow",{}),a&&(f.hidden=!p),p?ot(e).show():c.done(function(){ot(e).hide()}),c.done(function(){var t;gt.remove(e,"fxshow");for(t in u)ot.style(e,t,u[t])});for(n in u)s=k(p?f[n]:0,n,c),n in f||(f[n]=s.start,p&&(s.end=s.start,s.start="width"===n||"height"===n?1:0))}}function I(e,t,i,r,n){return new I.prototype.init(e,t,i,r,n)}function O(e,t){var i,r={height:e},n=0;for(t=t?1:0;4>n;n+=2-t)i=Zt[n],r["margin"+i]=r["padding"+i]=e;return t&&(r.opacity=r.width=e),r}function U(e){return ot.isWindow(e)?e:9===e.nodeType&&e.defaultView}var V,B,j=typeof t,W=e.location,G=e.document,X=G.documentElement,Y=e.jQuery,q=e.$,K={},Q=[],$="2.0.3",Z=Q.concat,J=Q.push,et=Q.slice,tt=Q.indexOf,it=K.toString,rt=K.hasOwnProperty,nt=$.trim,ot=function(e,t){return new ot.fn.init(e,t,V)},at=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,st=/\S+/g,lt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ht=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ct=/^-ms-/,ut=/-([\da-z])/gi,dt=function(e,t){return t.toUpperCase()},pt=function(){G.removeEventListener("DOMContentLoaded",pt,!1),e.removeEventListener("load",pt,!1),ot.ready()};ot.fn=ot.prototype={jquery:$,constructor:ot,init:function(e,i,r){var n,o;if(!e)return this;if("string"==typeof e){if(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:lt.exec(e),!n||!n[1]&&i)return!i||i.jquery?(i||r).find(e):this.constructor(i).find(e);if(n[1]){if(i=i instanceof ot?i[0]:i,ot.merge(this,ot.parseHTML(n[1],i&&i.nodeType?i.ownerDocument||i:G,!0)),ht.test(n[1])&&ot.isPlainObject(i))for(n in i)ot.isFunction(this[n])?this[n](i[n]):this.attr(n,i[n]);return this}return o=G.getElementById(n[2]),o&&o.parentNode&&(this.length=1,this[0]=o),this.context=G,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):ot.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),ot.makeArray(e,this))},selector:"",length:0,toArray:function(){return et.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=ot.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return ot.each(this,e,t)},ready:function(e){return ot.ready.promise().done(e),this},slice:function(){return this.pushStack(et.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},map:function(e){return this.pushStack(ot.map(this,function(t,i){return e.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:J,sort:[].sort,splice:[].splice},ot.fn.init.prototype=ot.fn,ot.extend=ot.fn.extend=function(){var e,i,r,n,o,a,s=arguments[0]||{},l=1,h=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},l=2),"object"==typeof s||ot.isFunction(s)||(s={}),h===l&&(s=this,--l);h>l;l++)if(null!=(e=arguments[l]))for(i in e)r=s[i],n=e[i],s!==n&&(c&&n&&(ot.isPlainObject(n)||(o=ot.isArray(n)))?(o?(o=!1,a=r&&ot.isArray(r)?r:[]):a=r&&ot.isPlainObject(r)?r:{},s[i]=ot.extend(c,a,n)):n!==t&&(s[i]=n));return s},ot.extend({expando:"jQuery"+($+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===ot&&(e.$=q),t&&e.jQuery===ot&&(e.jQuery=Y),ot},isReady:!1,readyWait:1,holdReady:function(e){e?ot.readyWait++:ot.ready(!0)},ready:function(e){(e===!0?--ot.readyWait:ot.isReady)||(ot.isReady=!0,e!==!0&&--ot.readyWait>0||(B.resolveWith(G,[ot]),ot.fn.trigger&&ot(G).trigger("ready").off("ready")))},isFunction:function(e){return"function"===ot.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?K[it.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==ot.type(e)||e.nodeType||ot.isWindow(e))return!1;try{if(e.constructor&&!rt.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||G;var r=ht.exec(e),n=!i&&[];return r?[t.createElement(r[1])]:(r=ot.buildFragment([e],t,n),n&&ot(n).remove(),ot.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var i,r;if(!e||"string"!=typeof e)return null;try{r=new DOMParser,i=r.parseFromString(e,"text/xml")}catch(n){i=t}return(!i||i.getElementsByTagName("parsererror").length)&&ot.error("Invalid XML: "+e),i},noop:function(){},globalEval:function(e){var t,i=eval;e=ot.trim(e),e&&(1===e.indexOf("use strict")?(t=G.createElement("script"),t.text=e,G.head.appendChild(t).parentNode.removeChild(t)):i(e))},camelCase:function(e){return e.replace(ct,"ms-").replace(ut,dt)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,r){var n,o=0,a=e.length,s=i(e);if(r){if(s)for(;a>o&&(n=t.apply(e[o],r),n!==!1);o++);else for(o in e)if(n=t.apply(e[o],r),n===!1)break}else if(s)for(;a>o&&(n=t.call(e[o],o,e[o]),n!==!1);o++);else for(o in e)if(n=t.call(e[o],o,e[o]),n===!1)break;return e},trim:function(e){return null==e?"":nt.call(e)},makeArray:function(e,t){var r=t||[];return null!=e&&(i(Object(e))?ot.merge(r,"string"==typeof e?[e]:e):J.call(r,e)),r},inArray:function(e,t,i){return null==t?-1:tt.call(t,e,i)},merge:function(e,i){var r=i.length,n=e.length,o=0;if("number"==typeof r)for(;r>o;o++)e[n++]=i[o];else for(;i[o]!==t;)e[n++]=i[o++];return e.length=n,e},grep:function(e,t,i){var r,n=[],o=0,a=e.length;for(i=!!i;a>o;o++)r=!!t(e[o],o),i!==r&&n.push(e[o]);return n},map:function(e,t,r){var n,o=0,a=e.length,s=i(e),l=[];if(s)for(;a>o;o++)n=t(e[o],o,r),null!=n&&(l[l.length]=n);else for(o in e)n=t(e[o],o,r),null!=n&&(l[l.length]=n);return Z.apply([],l)},guid:1,proxy:function(e,i){var r,n,o;return"string"==typeof i&&(r=e[i],i=e,e=r),ot.isFunction(e)?(n=et.call(arguments,2),o=function(){return e.apply(i||this,n.concat(et.call(arguments)))},o.guid=e.guid=e.guid||ot.guid++,o):t},access:function(e,i,r,n,o,a,s){var l=0,h=e.length,c=null==r;if("object"===ot.type(r)){o=!0;for(l in r)ot.access(e,i,l,r[l],!0,a,s)}else if(n!==t&&(o=!0,ot.isFunction(n)||(s=!0),c&&(s?(i.call(e,n),i=null):(c=i,i=function(e,t,i){return c.call(ot(e),i)})),i))for(;h>l;l++)i(e[l],r,s?n:n.call(e[l],l,i(e[l],r)));return o?e:c?i.call(e):h?i(e[0],r):a},now:Date.now,swap:function(e,t,i,r){var n,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];n=i.apply(e,r||[]);for(o in t)e.style[o]=a[o];return n}}),ot.ready.promise=function(t){return B||(B=ot.Deferred(),"complete"===G.readyState?setTimeout(ot.ready):(G.addEventListener("DOMContentLoaded",pt,!1),e.addEventListener("load",pt,!1))),B.promise(t)},ot.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){K["[object "+t+"]"]=t.toLowerCase()}),V=ot(G),function(e,t){function i(e,t,i,r){var n,o,a,s,l,h,c,u,f,m;if((t?t.ownerDocument||t:U)!==P&&D(t),t=t||P,i=i||[],!e||"string"!=typeof e)return i;if(1!==(s=t.nodeType)&&9!==s)return[];if(k&&!r){if(n=yt.exec(e))if(a=n[1]){if(9===s){if(o=t.getElementById(a),!o||!o.parentNode)return i;if(o.id===a)return i.push(o),i}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&I(t,o)&&o.id===a)return i.push(o),i}else{if(n[2])return et.apply(i,t.getElementsByTagName(e)),i;if((a=n[3])&&x.getElementsByClassName&&t.getElementsByClassName)return et.apply(i,t.getElementsByClassName(a)),i}if(x.qsa&&(!F||!F.test(e))){if(u=c=O,f=t,m=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(h=d(e),(c=t.getAttribute("id"))?u=c.replace(bt,"\\$&"):t.setAttribute("id",u),u="[id='"+u+"'] ",l=h.length;l--;)h[l]=u+p(h[l]);f=pt.test(e)&&t.parentNode||t,m=h.join(",")}if(m)try{return et.apply(i,f.querySelectorAll(m)),i}catch(g){}finally{c||t.removeAttribute("id")}}}return _(e.replace(ct,"$1"),t,i,r)}function r(){function e(i,r){return t.push(i+=" ")>w.cacheLength&&delete e[t.shift()],e[i]=r}var t=[];return e}function n(e){return e[O]=!0,e}function o(e){var t=P.createElement("div");try{return!!e(t)}catch(i){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function a(e,t){for(var i=e.split("|"),r=e.length;r--;)w.attrHandle[i[r]]=t}function s(e,t){var i=t&&e,r=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||K)-(~e.sourceIndex||K);if(r)return r;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function l(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function h(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function c(e){return n(function(t){return t=+t,n(function(i,r){for(var n,o=e([],i.length,t),a=o.length;a--;)i[n=o[a]]&&(i[n]=!(r[n]=i[n]))})})}function u(){}function d(e,t){var r,n,o,a,s,l,h,c=W[e+" "];if(c)return t?0:c.slice(0);for(s=e,l=[],h=w.preFilter;s;){(!r||(n=ut.exec(s)))&&(n&&(s=s.slice(n[0].length)||s),l.push(o=[])),r=!1,(n=dt.exec(s))&&(r=n.shift(),o.push({value:r,type:n[0].replace(ct," ")}),s=s.slice(r.length));for(a in w.filter)!(n=vt[a].exec(s))||h[a]&&!(n=h[a](n))||(r=n.shift(),o.push({value:r,type:a,matches:n}),s=s.slice(r.length));if(!r)break}return t?s.length:s?i.error(e):W(e,l).slice(0)}function p(e){for(var t=0,i=e.length,r="";i>t;t++)r+=e[t].value;return r}function f(e,t,i){var r=t.dir,n=i&&"parentNode"===r,o=B++;return t.first?function(t,i,o){for(;t=t[r];)if(1===t.nodeType||n)return e(t,i,o)}:function(t,i,a){var s,l,h,c=V+" "+o;if(a){for(;t=t[r];)if((1===t.nodeType||n)&&e(t,i,a))return!0}else for(;t=t[r];)if(1===t.nodeType||n)if(h=t[O]||(t[O]={}),(l=h[r])&&l[0]===c){if((s=l[1])===!0||s===R)return s===!0}else if(l=h[r]=[c],l[1]=e(t,i,a)||R,l[1]===!0)return!0}}function m(e){return e.length>1?function(t,i,r){for(var n=e.length;n--;)if(!e[n](t,i,r))return!1;return!0}:e[0]}function g(e,t,i,r,n){for(var o,a=[],s=0,l=e.length,h=null!=t;l>s;s++)(o=e[s])&&(!i||i(o,r,n))&&(a.push(o),h&&t.push(s));return a}function v(e,t,i,r,o,a){return r&&!r[O]&&(r=v(r)),o&&!o[O]&&(o=v(o,a)),n(function(n,a,s,l){var h,c,u,d=[],p=[],f=a.length,m=n||T(t||"*",s.nodeType?[s]:s,[]),v=!e||!n&&t?m:g(m,d,e,s,l),E=i?o||(n?e:f||r)?[]:a:v;if(i&&i(v,E,s,l),r)for(h=g(E,p),r(h,[],s,l),c=h.length;c--;)(u=h[c])&&(E[p[c]]=!(v[p[c]]=u));if(n){if(o||e){if(o){for(h=[],c=E.length;c--;)(u=E[c])&&h.push(v[c]=u);o(null,E=[],h,l)}for(c=E.length;c--;)(u=E[c])&&(h=o?it.call(n,u):d[c])>-1&&(n[h]=!(a[h]=u))}}else E=g(E===a?E.splice(f,E.length):E),o?o(null,a,E,l):et.apply(a,E)})}function E(e){for(var t,i,r,n=e.length,o=w.relative[e[0].type],a=o||w.relative[" "],s=o?1:0,l=f(function(e){return e===t},a,!0),h=f(function(e){return it.call(t,e)>-1},a,!0),c=[function(e,i,r){return!o&&(r||i!==C)||((t=i).nodeType?l(e,i,r):h(e,i,r))}];n>s;s++)if(i=w.relative[e[s].type])c=[f(m(c),i)];else{if(i=w.filter[e[s].type].apply(null,e[s].matches),i[O]){for(r=++s;n>r&&!w.relative[e[r].type];r++);return v(s>1&&m(c),s>1&&p(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(ct,"$1"),i,r>s&&E(e.slice(s,r)),n>r&&E(e=e.slice(r)),n>r&&p(e))}c.push(i)}return m(c)}function y(e,t){var r=0,o=t.length>0,a=e.length>0,s=function(n,s,l,h,c){var u,d,p,f=[],m=0,v="0",E=n&&[],y=null!=c,T=C,_=n||a&&w.find.TAG("*",c&&s.parentNode||s),b=V+=null==T?1:Math.random()||.1;for(y&&(C=s!==P&&s,R=r);null!=(u=_[v]);v++){if(a&&u){for(d=0;p=e[d++];)if(p(u,s,l)){h.push(u);break}y&&(V=b,R=++r)}o&&((u=!p&&u)&&m--,n&&E.push(u))}if(m+=v,o&&v!==m){for(d=0;p=t[d++];)p(E,f,s,l);if(n){if(m>0)for(;v--;)E[v]||f[v]||(f[v]=Z.call(h));f=g(f)}et.apply(h,f),y&&!n&&f.length>0&&m+t.length>1&&i.uniqueSort(h)}return y&&(V=b,C=T),E};return o?n(s):s}function T(e,t,r){for(var n=0,o=t.length;o>n;n++)i(e,t[n],r);return r}function _(e,t,i,r){var n,o,a,s,l,h=d(e);if(!r&&1===h.length){if(o=h[0]=h[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&x.getById&&9===t.nodeType&&k&&w.relative[o[1].type]){if(t=(w.find.ID(a.matches[0].replace(xt,Rt),t)||[])[0],!t)return i;e=e.slice(o.shift().value.length)}for(n=vt.needsContext.test(e)?0:o.length;n--&&(a=o[n],!w.relative[s=a.type]);)if((l=w.find[s])&&(r=l(a.matches[0].replace(xt,Rt),pt.test(o[0].type)&&t.parentNode||t))){if(o.splice(n,1),e=r.length&&p(o),!e)return et.apply(i,r),i;break}}return S(e,h)(r,t,!k,i,pt.test(e)),i}var b,x,R,w,H,M,S,C,A,D,P,L,k,F,z,N,I,O="sizzle"+-new Date,U=e.document,V=0,B=0,j=r(),W=r(),G=r(),X=!1,Y=function(e,t){return e===t?(X=!0,0):0},q=typeof t,K=1<<31,Q={}.hasOwnProperty,$=[],Z=$.pop,J=$.push,et=$.push,tt=$.slice,it=$.indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(this[t]===e)return t;return-1},rt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\x20\\t\\r\\n\\f]",at="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",st=at.replace("w","w#"),lt="\\["+nt+"*("+at+")"+nt+"*(?:([*^$|!~]?=)"+nt+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+st+")|)|)"+nt+"*\\]",ht=":("+at+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+lt.replace(3,8)+")*)|.*)\\)|)",ct=RegExp("^"+nt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+nt+"+$","g"),ut=RegExp("^"+nt+"*,"+nt+"*"),dt=RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),pt=RegExp(nt+"*[+~]"),ft=RegExp("="+nt+"*([^\\]'\"]*)"+nt+"*\\]","g"),mt=RegExp(ht),gt=RegExp("^"+st+"$"),vt={ID:RegExp("^#("+at+")"),CLASS:RegExp("^\\.("+at+")"),TAG:RegExp("^("+at.replace("w","w*")+")"),ATTR:RegExp("^"+lt),PSEUDO:RegExp("^"+ht),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+nt+"*(even|odd|(([+-]|)(\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\d+)|))"+nt+"*\\)|)","i"),bool:RegExp("^(?:"+rt+")$","i"),needsContext:RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+nt+"*((?:-\\d)?\\d*)"+nt+"*\\)|)(?=[^-]|$)","i")},Et=/^[^{]+\{\s*\[native \w/,yt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Tt=/^(?:input|select|textarea|button)$/i,_t=/^h\d$/i,bt=/'|\\/g,xt=RegExp("\\\\([\\da-f]{1,6}"+nt+"?|("+nt+")|.)","ig"),Rt=function(e,t,i){var r="0x"+t-65536;return r!==r||i?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{et.apply($=tt.call(U.childNodes),U.childNodes),$[U.childNodes.length].nodeType}catch(wt){et={apply:$.length?function(e,t){J.apply(e,tt.call(t))}:function(e,t){for(var i=e.length,r=0;e[i++]=t[r++];);e.length=i-1}}}M=i.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},x=i.support={},D=i.setDocument=function(e){var i=e?e.ownerDocument||e:U,r=i.defaultView;return i!==P&&9===i.nodeType&&i.documentElement?(P=i,L=i.documentElement,k=!M(i),r&&r.attachEvent&&r!==r.top&&r.attachEvent("onbeforeunload",function(){D()}),x.attributes=o(function(e){return e.className="i",!e.getAttribute("className")}),x.getElementsByTagName=o(function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length}),x.getElementsByClassName=o(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),x.getById=o(function(e){return L.appendChild(e).id=O,!i.getElementsByName||!i.getElementsByName(O).length}),x.getById?(w.find.ID=function(e,t){if(typeof t.getElementById!==q&&k){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},w.filter.ID=function(e){var t=e.replace(xt,Rt);return function(e){return e.getAttribute("id")===t}}):(delete w.find.ID,w.filter.ID=function(e){var t=e.replace(xt,Rt);return function(e){var i=typeof e.getAttributeNode!==q&&e.getAttributeNode("id");return i&&i.value===t}}),w.find.TAG=x.getElementsByTagName?function(e,i){return typeof i.getElementsByTagName!==q?i.getElementsByTagName(e):t}:function(e,t){var i,r=[],n=0,o=t.getElementsByTagName(e);if("*"===e){for(;i=o[n++];)1===i.nodeType&&r.push(i);return r}return o},w.find.CLASS=x.getElementsByClassName&&function(e,i){return typeof i.getElementsByClassName!==q&&k?i.getElementsByClassName(e):t},z=[],F=[],(x.qsa=Et.test(i.querySelectorAll))&&(o(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||F.push("\\["+nt+"*(?:value|"+rt+")"),e.querySelectorAll(":checked").length||F.push(":checked")}),o(function(e){var t=i.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&F.push("[*^$]="+nt+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||F.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),F.push(",.*:")})),(x.matchesSelector=Et.test(N=L.webkitMatchesSelector||L.mozMatchesSelector||L.oMatchesSelector||L.msMatchesSelector))&&o(function(e){x.disconnectedMatch=N.call(e,"div"),N.call(e,"[s!='']:x"),z.push("!=",ht)}),F=F.length&&RegExp(F.join("|")),z=z.length&&RegExp(z.join("|")),I=Et.test(L.contains)||L.compareDocumentPosition?function(e,t){var i=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(i.contains?i.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},Y=L.compareDocumentPosition?function(e,t){if(e===t)return X=!0,0;var r=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return r?1&r||!x.sortDetached&&t.compareDocumentPosition(e)===r?e===i||I(U,e)?-1:t===i||I(U,t)?1:A?it.call(A,e)-it.call(A,t):0:4&r?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,n=0,o=e.parentNode,a=t.parentNode,l=[e],h=[t];if(e===t)return X=!0,0;if(!o||!a)return e===i?-1:t===i?1:o?-1:a?1:A?it.call(A,e)-it.call(A,t):0;if(o===a)return s(e,t);for(r=e;r=r.parentNode;)l.unshift(r);for(r=t;r=r.parentNode;)h.unshift(r);for(;l[n]===h[n];)n++;return n?s(l[n],h[n]):l[n]===U?-1:h[n]===U?1:0},i):P},i.matches=function(e,t){return i(e,null,null,t)},i.matchesSelector=function(e,t){if((e.ownerDocument||e)!==P&&D(e),t=t.replace(ft,"='$1']"),!(!x.matchesSelector||!k||z&&z.test(t)||F&&F.test(t)))try{var r=N.call(e,t);if(r||x.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(n){}return i(t,P,null,[e]).length>0},i.contains=function(e,t){return(e.ownerDocument||e)!==P&&D(e),I(e,t)},i.attr=function(e,i){(e.ownerDocument||e)!==P&&D(e);var r=w.attrHandle[i.toLowerCase()],n=r&&Q.call(w.attrHandle,i.toLowerCase())?r(e,i,!k):t;return n===t?x.attributes||!k?e.getAttribute(i):(n=e.getAttributeNode(i))&&n.specified?n.value:null:n},i.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},i.uniqueSort=function(e){var t,i=[],r=0,n=0;if(X=!x.detectDuplicates,A=!x.sortStable&&e.slice(0),e.sort(Y),X){for(;t=e[n++];)t===e[n]&&(r=i.push(n));for(;r--;)e.splice(i[r],1)}return e},H=i.getText=function(e){var t,i="",r=0,n=e.nodeType;if(n){if(1===n||9===n||11===n){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=H(e)}else if(3===n||4===n)return e.nodeValue}else for(;t=e[r];r++)i+=H(t);return i},w=i.selectors={cacheLength:50,createPseudo:n,match:vt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(xt,Rt),e[3]=(e[4]||e[5]||"").replace(xt,Rt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||i.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&i.error(e[0]),e},PSEUDO:function(e){var i,r=!e[5]&&e[2];return vt.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&mt.test(r)&&(i=d(r,!0))&&(i=r.indexOf(")",r.length-i)-r.length)&&(e[0]=e[0].slice(0,i),e[2]=r.slice(0,i)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(xt,Rt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=j[e+" "];return t||(t=RegExp("(^|"+nt+")"+e+"("+nt+"|$)"))&&j(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==q&&e.getAttribute("class")||"")})},ATTR:function(e,t,r){return function(n){var o=i.attr(n,e);return null==o?"!="===t:t?(o+="","="===t?o===r:"!="===t?o!==r:"^="===t?r&&0===o.indexOf(r):"*="===t?r&&o.indexOf(r)>-1:"$="===t?r&&o.slice(-r.length)===r:"~="===t?(" "+o+" ").indexOf(r)>-1:"|="===t?o===r||o.slice(0,r.length+1)===r+"-":!1):!0}},CHILD:function(e,t,i,r,n){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===n?function(e){return!!e.parentNode}:function(t,i,l){var h,c,u,d,p,f,m=o!==a?"nextSibling":"previousSibling",g=t.parentNode,v=s&&t.nodeName.toLowerCase(),E=!l&&!s;if(g){if(o){for(;m;){for(u=t;u=u[m];)if(s?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;f=m="only"===e&&!f&&"nextSibling"}return!0}if(f=[a?g.firstChild:g.lastChild],a&&E){for(c=g[O]||(g[O]={}),h=c[e]||[],p=h[0]===V&&h[1],d=h[0]===V&&h[2],u=p&&g.childNodes[p];u=++p&&u&&u[m]||(d=p=0)||f.pop();)if(1===u.nodeType&&++d&&u===t){c[e]=[V,p,d];break}}else if(E&&(h=(t[O]||(t[O]={}))[e])&&h[0]===V)d=h[1];else for(;(u=++p&&u&&u[m]||(d=p=0)||f.pop())&&((s?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++d||(E&&((u[O]||(u[O]={}))[e]=[V,d]),u!==t)););return d-=n,d===r||0===d%r&&d/r>=0}}},PSEUDO:function(e,t){var r,o=w.pseudos[e]||w.setFilters[e.toLowerCase()]||i.error("unsupported pseudo: "+e);return o[O]?o(t):o.length>1?(r=[e,e,"",t],w.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,i){for(var r,n=o(e,t),a=n.length;a--;)r=it.call(e,n[a]),e[r]=!(i[r]=n[a])}):function(e){return o(e,0,r)}):o}},pseudos:{not:n(function(e){var t=[],i=[],r=S(e.replace(ct,"$1"));return r[O]?n(function(e,t,i,n){for(var o,a=r(e,null,n,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,n,o){return t[0]=e,r(t,null,o,i),!i.pop()
}}),has:n(function(e){return function(t){return i(e,t).length>0}}),contains:n(function(e){return function(t){return(t.textContent||t.innerText||H(t)).indexOf(e)>-1}}),lang:n(function(e){return gt.test(e||"")||i.error("unsupported lang: "+e),e=e.replace(xt,Rt).toLowerCase(),function(t){var i;do if(i=k?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===L},focus:function(e){return e===P.activeElement&&(!P.hasFocus||P.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!w.pseudos.empty(e)},header:function(e){return _t.test(e.nodeName)},input:function(e){return Tt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,i){return[0>i?i+t:i]}),even:c(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:c(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:c(function(e,t,i){for(var r=0>i?i+t:i;--r>=0;)e.push(r);return e}),gt:c(function(e,t,i){for(var r=0>i?i+t:i;t>++r;)e.push(r);return e})}},w.pseudos.nth=w.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[b]=l(b);for(b in{submit:!0,reset:!0})w.pseudos[b]=h(b);u.prototype=w.filters=w.pseudos,w.setFilters=new u,S=i.compile=function(e,t){var i,r=[],n=[],o=G[e+" "];if(!o){for(t||(t=d(e)),i=t.length;i--;)o=E(t[i]),o[O]?r.push(o):n.push(o);o=G(e,y(n,r))}return o},x.sortStable=O.split("").sort(Y).join("")===O,x.detectDuplicates=X,D(),x.sortDetached=o(function(e){return 1&e.compareDocumentPosition(P.createElement("div"))}),o(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||a("type|href|height|width",function(e,i,r){return r?t:e.getAttribute(i,"type"===i.toLowerCase()?1:2)}),x.attributes&&o(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||a("value",function(e,i,r){return r||"input"!==e.nodeName.toLowerCase()?t:e.defaultValue}),o(function(e){return null==e.getAttribute("disabled")})||a(rt,function(e,i,r){var n;return r?t:(n=e.getAttributeNode(i))&&n.specified?n.value:e[i]===!0?i.toLowerCase():null}),ot.find=i,ot.expr=i.selectors,ot.expr[":"]=ot.expr.pseudos,ot.unique=i.uniqueSort,ot.text=i.getText,ot.isXMLDoc=i.isXML,ot.contains=i.contains}(e);var ft={};ot.Callbacks=function(e){e="string"==typeof e?ft[e]||r(e):ot.extend({},e);var i,n,o,a,s,l,h=[],c=!e.once&&[],u=function(t){for(i=e.memory&&t,n=!0,l=a||0,a=0,s=h.length,o=!0;h&&s>l;l++)if(h[l].apply(t[0],t[1])===!1&&e.stopOnFalse){i=!1;break}o=!1,h&&(c?c.length&&u(c.shift()):i?h=[]:d.disable())},d={add:function(){if(h){var t=h.length;!function r(t){ot.each(t,function(t,i){var n=ot.type(i);"function"===n?e.unique&&d.has(i)||h.push(i):i&&i.length&&"string"!==n&&r(i)})}(arguments),o?s=h.length:i&&(a=t,u(i))}return this},remove:function(){return h&&ot.each(arguments,function(e,t){for(var i;(i=ot.inArray(t,h,i))>-1;)h.splice(i,1),o&&(s>=i&&s--,l>=i&&l--)}),this},has:function(e){return e?ot.inArray(e,h)>-1:!(!h||!h.length)},empty:function(){return h=[],s=0,this},disable:function(){return h=c=i=t,this},disabled:function(){return!h},lock:function(){return c=t,i||d.disable(),this},locked:function(){return!c},fireWith:function(e,t){return!h||n&&!c||(t=t||[],t=[e,t.slice?t.slice():t],o?c.push(t):u(t)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!n}};return d},ot.extend({Deferred:function(e){var t=[["resolve","done",ot.Callbacks("once memory"),"resolved"],["reject","fail",ot.Callbacks("once memory"),"rejected"],["notify","progress",ot.Callbacks("memory")]],i="pending",r={state:function(){return i},always:function(){return n.done(arguments).fail(arguments),this},then:function(){var e=arguments;return ot.Deferred(function(i){ot.each(t,function(t,o){var a=o[0],s=ot.isFunction(e[t])&&e[t];n[o[1]](function(){var e=s&&s.apply(this,arguments);e&&ot.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[a+"With"](this===r?i.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?ot.extend(e,r):r}},n={};return r.pipe=r.then,ot.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){i=s},t[1^e][2].disable,t[2][2].lock),n[o[0]]=function(){return n[o[0]+"With"](this===n?r:this,arguments),this},n[o[0]+"With"]=a.fireWith}),r.promise(n),e&&e.call(n,n),n},when:function(e){var t,i,r,n=0,o=et.call(arguments),a=o.length,s=1!==a||e&&ot.isFunction(e.promise)?a:0,l=1===s?e:ot.Deferred(),h=function(e,i,r){return function(n){i[e]=this,r[e]=arguments.length>1?et.call(arguments):n,r===t?l.notifyWith(i,r):--s||l.resolveWith(i,r)}};if(a>1)for(t=Array(a),i=Array(a),r=Array(a);a>n;n++)o[n]&&ot.isFunction(o[n].promise)?o[n].promise().done(h(n,r,o)).fail(l.reject).progress(h(n,i,t)):--s;return s||l.resolveWith(r,o),l.promise()}}),ot.support=function(t){var i=G.createElement("input"),r=G.createDocumentFragment(),n=G.createElement("div"),o=G.createElement("select"),a=o.appendChild(G.createElement("option"));return i.type?(i.type="checkbox",t.checkOn=""!==i.value,t.optSelected=a.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,i.checked=!0,t.noCloneChecked=i.cloneNode(!0).checked,o.disabled=!0,t.optDisabled=!a.disabled,i=G.createElement("input"),i.value="t",i.type="radio",t.radioValue="t"===i.value,i.setAttribute("checked","t"),i.setAttribute("name","t"),r.appendChild(i),t.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin"in e,n.style.backgroundClip="content-box",n.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===n.style.backgroundClip,ot(function(){var i,r,o="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",a=G.getElementsByTagName("body")[0];a&&(i=G.createElement("div"),i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(i).appendChild(n),n.innerHTML="",n.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",ot.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===n.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(n,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(n,null)||{width:"4px"}).width,r=n.appendChild(G.createElement("div")),r.style.cssText=n.style.cssText=o,r.style.marginRight=r.style.width="0",n.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),a.removeChild(i))}),t):t}({});var mt,gt,vt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Et=/([A-Z])/g;n.uid=1,n.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},n.prototype={key:function(e){if(!n.accepts(e))return 0;var t={},i=e[this.expando];if(!i){i=n.uid++;try{t[this.expando]={value:i},Object.defineProperties(e,t)}catch(r){t[this.expando]=i,ot.extend(e,t)}}return this.cache[i]||(this.cache[i]={}),i},set:function(e,t,i){var r,n=this.key(e),o=this.cache[n];if("string"==typeof t)o[t]=i;else if(ot.isEmptyObject(o))ot.extend(this.cache[n],t);else for(r in t)o[r]=t[r];return o},get:function(e,i){var r=this.cache[this.key(e)];return i===t?r:r[i]},access:function(e,i,r){var n;return i===t||i&&"string"==typeof i&&r===t?(n=this.get(e,i),n!==t?n:this.get(e,ot.camelCase(i))):(this.set(e,i,r),r!==t?r:i)},remove:function(e,i){var r,n,o,a=this.key(e),s=this.cache[a];if(i===t)this.cache[a]={};else{ot.isArray(i)?n=i.concat(i.map(ot.camelCase)):(o=ot.camelCase(i),i in s?n=[i,o]:(n=o,n=n in s?[n]:n.match(st)||[])),r=n.length;for(;r--;)delete s[n[r]]}},hasData:function(e){return!ot.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},mt=new n,gt=new n,ot.extend({acceptData:n.accepts,hasData:function(e){return mt.hasData(e)||gt.hasData(e)},data:function(e,t,i){return mt.access(e,t,i)},removeData:function(e,t){mt.remove(e,t)},_data:function(e,t,i){return gt.access(e,t,i)},_removeData:function(e,t){gt.remove(e,t)}}),ot.fn.extend({data:function(e,i){var r,n,a=this[0],s=0,l=null;if(e===t){if(this.length&&(l=mt.get(a),1===a.nodeType&&!gt.get(a,"hasDataAttrs"))){for(r=a.attributes;r.length>s;s++)n=r[s].name,0===n.indexOf("data-")&&(n=ot.camelCase(n.slice(5)),o(a,n,l[n]));gt.set(a,"hasDataAttrs",!0)}return l}return"object"==typeof e?this.each(function(){mt.set(this,e)}):ot.access(this,function(i){var r,n=ot.camelCase(e);if(a&&i===t){if(r=mt.get(a,e),r!==t)return r;if(r=mt.get(a,n),r!==t)return r;if(r=o(a,n,t),r!==t)return r}else this.each(function(){var r=mt.get(this,n);mt.set(this,n,i),-1!==e.indexOf("-")&&r!==t&&mt.set(this,e,i)})},null,i,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){mt.remove(this,e)})}}),ot.extend({queue:function(e,i,r){var n;return e?(i=(i||"fx")+"queue",n=gt.get(e,i),r&&(!n||ot.isArray(r)?n=gt.access(e,i,ot.makeArray(r)):n.push(r)),n||[]):t},dequeue:function(e,t){t=t||"fx";var i=ot.queue(e,t),r=i.length,n=i.shift(),o=ot._queueHooks(e,t),a=function(){ot.dequeue(e,t)};"inprogress"===n&&(n=i.shift(),r--),n&&("fx"===t&&i.unshift("inprogress"),delete o.stop,n.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return gt.get(e,i)||gt.access(e,i,{empty:ot.Callbacks("once memory").add(function(){gt.remove(e,[t+"queue",i])})})}}),ot.fn.extend({queue:function(e,i){var r=2;return"string"!=typeof e&&(i=e,e="fx",r--),r>arguments.length?ot.queue(this[0],e):i===t?this:this.each(function(){var t=ot.queue(this,e,i);ot._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&ot.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ot.dequeue(this,e)})},delay:function(e,t){return e=ot.fx?ot.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var r=setTimeout(t,e);i.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,i){var r,n=1,o=ot.Deferred(),a=this,s=this.length,l=function(){--n||o.resolveWith(a,[a])};for("string"!=typeof e&&(i=e,e=t),e=e||"fx";s--;)r=gt.get(a[s],e+"queueHooks"),r&&r.empty&&(n++,r.empty.add(l));return l(),o.promise(i)}});var yt,Tt,_t=/[\t\r\n\f]/g,bt=/\r/g,xt=/^(?:input|select|textarea|button)$/i;ot.fn.extend({attr:function(e,t){return ot.access(this,ot.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ot.removeAttr(this,e)})},prop:function(e,t){return ot.access(this,ot.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[ot.propFix[e]||e]})},addClass:function(e){var t,i,r,n,o,a=0,s=this.length,l="string"==typeof e&&e;if(ot.isFunction(e))return this.each(function(t){ot(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(st)||[];s>a;a++)if(i=this[a],r=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(_t," "):" ")){for(o=0;n=t[o++];)0>r.indexOf(" "+n+" ")&&(r+=n+" ");i.className=ot.trim(r)}return this},removeClass:function(e){var t,i,r,n,o,a=0,s=this.length,l=0===arguments.length||"string"==typeof e&&e;if(ot.isFunction(e))return this.each(function(t){ot(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(st)||[];s>a;a++)if(i=this[a],r=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(_t," "):"")){for(o=0;n=t[o++];)for(;r.indexOf(" "+n+" ")>=0;)r=r.replace(" "+n+" "," ");i.className=e?ot.trim(r):""}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):ot.isFunction(e)?this.each(function(i){ot(this).toggleClass(e.call(this,i,this.className,t),t)}):this.each(function(){if("string"===i)for(var t,r=0,n=ot(this),o=e.match(st)||[];t=o[r++];)n.hasClass(t)?n.removeClass(t):n.addClass(t);else(i===j||"boolean"===i)&&(this.className&&gt.set(this,"__className__",this.className),this.className=this.className||e===!1?"":gt.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,r=this.length;r>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(_t," ").indexOf(t)>=0)return!0;return!1},val:function(e){var i,r,n,o=this[0];return arguments.length?(n=ot.isFunction(e),this.each(function(r){var o;1===this.nodeType&&(o=n?e.call(this,r,ot(this).val()):e,null==o?o="":"number"==typeof o?o+="":ot.isArray(o)&&(o=ot.map(o,function(e){return null==e?"":e+""})),i=ot.valHooks[this.type]||ot.valHooks[this.nodeName.toLowerCase()],i&&"set"in i&&i.set(this,o,"value")!==t||(this.value=o))})):o?(i=ot.valHooks[o.type]||ot.valHooks[o.nodeName.toLowerCase()],i&&"get"in i&&(r=i.get(o,"value"))!==t?r:(r=o.value,"string"==typeof r?r.replace(bt,""):null==r?"":r)):void 0}}),ot.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){for(var t,i,r=e.options,n=e.selectedIndex,o="select-one"===e.type||0>n,a=o?null:[],s=o?n+1:r.length,l=0>n?s:o?n:0;s>l;l++)if(i=r[l],!(!i.selected&&l!==n||(ot.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&ot.nodeName(i.parentNode,"optgroup"))){if(t=ot(i).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var i,r,n=e.options,o=ot.makeArray(t),a=n.length;a--;)r=n[a],(r.selected=ot.inArray(ot(r).val(),o)>=0)&&(i=!0);return i||(e.selectedIndex=-1),o}}},attr:function(e,i,r){var n,o,a=e.nodeType;return e&&3!==a&&8!==a&&2!==a?typeof e.getAttribute===j?ot.prop(e,i,r):(1===a&&ot.isXMLDoc(e)||(i=i.toLowerCase(),n=ot.attrHooks[i]||(ot.expr.match.bool.test(i)?Tt:yt)),r===t?n&&"get"in n&&null!==(o=n.get(e,i))?o:(o=ot.find.attr(e,i),null==o?t:o):null!==r?n&&"set"in n&&(o=n.set(e,r,i))!==t?o:(e.setAttribute(i,r+""),r):(ot.removeAttr(e,i),t)):void 0},removeAttr:function(e,t){var i,r,n=0,o=t&&t.match(st);if(o&&1===e.nodeType)for(;i=o[n++];)r=ot.propFix[i]||i,ot.expr.match.bool.test(i)&&(e[r]=!1),e.removeAttribute(i)},attrHooks:{type:{set:function(e,t){if(!ot.support.radioValue&&"radio"===t&&ot.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,i,r){var n,o,a,s=e.nodeType;return e&&3!==s&&8!==s&&2!==s?(a=1!==s||!ot.isXMLDoc(e),a&&(i=ot.propFix[i]||i,o=ot.propHooks[i]),r!==t?o&&"set"in o&&(n=o.set(e,r,i))!==t?n:e[i]=r:o&&"get"in o&&null!==(n=o.get(e,i))?n:e[i]):void 0},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||xt.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),Tt={set:function(e,t,i){return t===!1?ot.removeAttr(e,i):e.setAttribute(i,i),i}},ot.each(ot.expr.match.bool.source.match(/\w+/g),function(e,i){var r=ot.expr.attrHandle[i]||ot.find.attr;ot.expr.attrHandle[i]=function(e,i,n){var o=ot.expr.attrHandle[i],a=n?t:(ot.expr.attrHandle[i]=t)!=r(e,i,n)?i.toLowerCase():null;return ot.expr.attrHandle[i]=o,a}}),ot.support.optSelected||(ot.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),ot.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ot.propFix[this.toLowerCase()]=this}),ot.each(["radio","checkbox"],function(){ot.valHooks[this]={set:function(e,i){return ot.isArray(i)?e.checked=ot.inArray(ot(e).val(),i)>=0:t}},ot.support.checkOn||(ot.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Rt=/^key/,wt=/^(?:mouse|contextmenu)|click/,Ht=/^(?:focusinfocus|focusoutblur)$/,Mt=/^([^.]*)(?:\.(.+)|)$/;ot.event={global:{},add:function(e,i,r,n,o){var a,s,l,h,c,u,d,p,f,m,g,v=gt.get(e);if(v){for(r.handler&&(a=r,r=a.handler,o=a.selector),r.guid||(r.guid=ot.guid++),(h=v.events)||(h=v.events={}),(s=v.handle)||(s=v.handle=function(e){return typeof ot===j||e&&ot.event.triggered===e.type?t:ot.event.dispatch.apply(s.elem,arguments)},s.elem=e),i=(i||"").match(st)||[""],c=i.length;c--;)l=Mt.exec(i[c])||[],f=g=l[1],m=(l[2]||"").split(".").sort(),f&&(d=ot.event.special[f]||{},f=(o?d.delegateType:d.bindType)||f,d=ot.event.special[f]||{},u=ot.extend({type:f,origType:g,data:n,handler:r,guid:r.guid,selector:o,needsContext:o&&ot.expr.match.needsContext.test(o),namespace:m.join(".")},a),(p=h[f])||(p=h[f]=[],p.delegateCount=0,d.setup&&d.setup.call(e,n,m,s)!==!1||e.addEventListener&&e.addEventListener(f,s,!1)),d.add&&(d.add.call(e,u),u.handler.guid||(u.handler.guid=r.guid)),o?p.splice(p.delegateCount++,0,u):p.push(u),ot.event.global[f]=!0);e=null}},remove:function(e,t,i,r,n){var o,a,s,l,h,c,u,d,p,f,m,g=gt.hasData(e)&&gt.get(e);if(g&&(l=g.events)){for(t=(t||"").match(st)||[""],h=t.length;h--;)if(s=Mt.exec(t[h])||[],p=m=s[1],f=(s[2]||"").split(".").sort(),p){for(u=ot.event.special[p]||{},p=(r?u.delegateType:u.bindType)||p,d=l[p]||[],s=s[2]&&RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=d.length;o--;)c=d[o],!n&&m!==c.origType||i&&i.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(d.splice(o,1),c.selector&&d.delegateCount--,u.remove&&u.remove.call(e,c));a&&!d.length&&(u.teardown&&u.teardown.call(e,f,g.handle)!==!1||ot.removeEvent(e,p,g.handle),delete l[p])}else for(p in l)ot.event.remove(e,p+t[h],i,r,!0);ot.isEmptyObject(l)&&(delete g.handle,gt.remove(e,"events"))}},trigger:function(i,r,n,o){var a,s,l,h,c,u,d,p=[n||G],f=rt.call(i,"type")?i.type:i,m=rt.call(i,"namespace")?i.namespace.split("."):[];if(s=l=n=n||G,3!==n.nodeType&&8!==n.nodeType&&!Ht.test(f+ot.event.triggered)&&(f.indexOf(".")>=0&&(m=f.split("."),f=m.shift(),m.sort()),c=0>f.indexOf(":")&&"on"+f,i=i[ot.expando]?i:new ot.Event(f,"object"==typeof i&&i),i.isTrigger=o?2:3,i.namespace=m.join("."),i.namespace_re=i.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=t,i.target||(i.target=n),r=null==r?[i]:ot.makeArray(r,[i]),d=ot.event.special[f]||{},o||!d.trigger||d.trigger.apply(n,r)!==!1)){if(!o&&!d.noBubble&&!ot.isWindow(n)){for(h=d.delegateType||f,Ht.test(h+f)||(s=s.parentNode);s;s=s.parentNode)p.push(s),l=s;l===(n.ownerDocument||G)&&p.push(l.defaultView||l.parentWindow||e)}for(a=0;(s=p[a++])&&!i.isPropagationStopped();)i.type=a>1?h:d.bindType||f,u=(gt.get(s,"events")||{})[i.type]&&gt.get(s,"handle"),u&&u.apply(s,r),u=c&&s[c],u&&ot.acceptData(s)&&u.apply&&u.apply(s,r)===!1&&i.preventDefault();return i.type=f,o||i.isDefaultPrevented()||d._default&&d._default.apply(p.pop(),r)!==!1||!ot.acceptData(n)||c&&ot.isFunction(n[f])&&!ot.isWindow(n)&&(l=n[c],l&&(n[c]=null),ot.event.triggered=f,n[f](),ot.event.triggered=t,l&&(n[c]=l)),i.result}},dispatch:function(e){e=ot.event.fix(e);var i,r,n,o,a,s=[],l=et.call(arguments),h=(gt.get(this,"events")||{})[e.type]||[],c=ot.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){for(s=ot.event.handlers.call(this,e,h),i=0;(o=s[i++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,r=0;(a=o.handlers[r++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(a.namespace))&&(e.handleObj=a,e.data=a.data,n=((ot.event.special[a.origType]||{}).handle||a.handler).apply(o.elem,l),n!==t&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,i){var r,n,o,a,s=[],l=i.delegateCount,h=e.target;if(l&&h.nodeType&&(!e.button||"click"!==e.type))for(;h!==this;h=h.parentNode||this)if(h.disabled!==!0||"click"!==e.type){for(n=[],r=0;l>r;r++)a=i[r],o=a.selector+" ",n[o]===t&&(n[o]=a.needsContext?ot(o,this).index(h)>=0:ot.find(o,this,null,[h]).length),n[o]&&n.push(a);n.length&&s.push({elem:h,handlers:n})}return i.length>l&&s.push({elem:this,handlers:i.slice(l)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,i){var r,n,o,a=i.button;return null==e.pageX&&null!=i.clientX&&(r=e.target.ownerDocument||G,n=r.documentElement,o=r.body,e.pageX=i.clientX+(n&&n.scrollLeft||o&&o.scrollLeft||0)-(n&&n.clientLeft||o&&o.clientLeft||0),e.pageY=i.clientY+(n&&n.scrollTop||o&&o.scrollTop||0)-(n&&n.clientTop||o&&o.clientTop||0)),e.which||a===t||(e.which=1&a?1:2&a?3:4&a?2:0),e}},fix:function(e){if(e[ot.expando])return e;var t,i,r,n=e.type,o=e,a=this.fixHooks[n];for(a||(this.fixHooks[n]=a=wt.test(n)?this.mouseHooks:Rt.test(n)?this.keyHooks:{}),r=a.props?this.props.concat(a.props):this.props,e=new ot.Event(o),t=r.length;t--;)i=r[t],e[i]=o[i];return e.target||(e.target=G),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==l()&&this.focus?(this.focus(),!1):t},delegateType:"focusin"},blur:{trigger:function(){return this===l()&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&ot.nodeName(this,"input")?(this.click(),!1):t},_default:function(e){return ot.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,r){var n=ot.extend(new ot.Event,i,{type:e,isSimulated:!0,originalEvent:{}});r?ot.event.trigger(n,null,t):ot.event.dispatch.call(t,n),n.isDefaultPrevented()&&i.preventDefault()}},ot.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)},ot.Event=function(e,i){return this instanceof ot.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?a:s):this.type=e,i&&ot.extend(this,i),this.timeStamp=e&&e.timeStamp||ot.now(),this[ot.expando]=!0,t):new ot.Event(e,i)},ot.Event.prototype={isDefaultPrevented:s,isPropagationStopped:s,isImmediatePropagationStopped:s,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=a,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=a,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=a,this.stopPropagation()}},ot.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){ot.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,r=this,n=e.relatedTarget,o=e.handleObj;return(!n||n!==r&&!ot.contains(r,n))&&(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}}),ot.support.focusinBubbles||ot.each({focus:"focusin",blur:"focusout"},function(e,t){var i=0,r=function(e){ot.event.simulate(t,e.target,ot.event.fix(e),!0)};ot.event.special[t]={setup:function(){0===i++&&G.addEventListener(e,r,!0)},teardown:function(){0===--i&&G.removeEventListener(e,r,!0)}}}),ot.fn.extend({on:function(e,i,r,n,o){var a,l;if("object"==typeof e){"string"!=typeof i&&(r=r||i,i=t);for(l in e)this.on(l,i,r,e[l],o);return this}if(null==r&&null==n?(n=i,r=i=t):null==n&&("string"==typeof i?(n=r,r=t):(n=r,r=i,i=t)),n===!1)n=s;else if(!n)return this;return 1===o&&(a=n,n=function(e){return ot().off(e),a.apply(this,arguments)},n.guid=a.guid||(a.guid=ot.guid++)),this.each(function(){ot.event.add(this,e,n,r,i)})},one:function(e,t,i,r){return this.on(e,t,i,r,1)},off:function(e,i,r){var n,o;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,ot(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(o in e)this.off(o,i,e[o]);return this}return(i===!1||"function"==typeof i)&&(r=i,i=t),r===!1&&(r=s),this.each(function(){ot.event.remove(this,e,r,i)})},trigger:function(e,t){return this.each(function(){ot.event.trigger(e,t,this)})},triggerHandler:function(e,i){var r=this[0];return r?ot.event.trigger(e,i,r,!0):t}});var St=/^.[^:#\[\.,]*$/,Ct=/^(?:parents|prev(?:Until|All))/,At=ot.expr.match.needsContext,Dt={children:!0,contents:!0,next:!0,prev:!0};ot.fn.extend({find:function(e){var t,i=[],r=this,n=r.length;if("string"!=typeof e)return this.pushStack(ot(e).filter(function(){for(t=0;n>t;t++)if(ot.contains(r[t],this))return!0}));for(t=0;n>t;t++)ot.find(e,r[t],i);return i=this.pushStack(n>1?ot.unique(i):i),i.selector=this.selector?this.selector+" "+e:e,i},has:function(e){var t=ot(e,this),i=t.length;return this.filter(function(){for(var e=0;i>e;e++)if(ot.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(c(this,e||[],!0))},filter:function(e){return this.pushStack(c(this,e||[],!1))},is:function(e){return!!c(this,"string"==typeof e&&At.test(e)?ot(e):e||[],!1).length},closest:function(e,t){for(var i,r=0,n=this.length,o=[],a=At.test(e)||"string"!=typeof e?ot(e,t||this.context):0;n>r;r++)for(i=this[r];i&&i!==t;i=i.parentNode)if(11>i.nodeType&&(a?a.index(i)>-1:1===i.nodeType&&ot.find.matchesSelector(i,e))){i=o.push(i);break}return this.pushStack(o.length>1?ot.unique(o):o)},index:function(e){return e?"string"==typeof e?tt.call(ot(e),this[0]):tt.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var i="string"==typeof e?ot(e,t):ot.makeArray(e&&e.nodeType?[e]:e),r=ot.merge(this.get(),i);return this.pushStack(ot.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ot.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ot.dir(e,"parentNode")},parentsUntil:function(e,t,i){return ot.dir(e,"parentNode",i)},next:function(e){return h(e,"nextSibling")},prev:function(e){return h(e,"previousSibling")},nextAll:function(e){return ot.dir(e,"nextSibling")},prevAll:function(e){return ot.dir(e,"previousSibling")},nextUntil:function(e,t,i){return ot.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return ot.dir(e,"previousSibling",i)},siblings:function(e){return ot.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ot.sibling(e.firstChild)},contents:function(e){return e.contentDocument||ot.merge([],e.childNodes)}},function(e,t){ot.fn[e]=function(i,r){var n=ot.map(this,t,i);return"Until"!==e.slice(-5)&&(r=i),r&&"string"==typeof r&&(n=ot.filter(r,n)),this.length>1&&(Dt[e]||ot.unique(n),Ct.test(e)&&n.reverse()),this.pushStack(n)}}),ot.extend({filter:function(e,t,i){var r=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?ot.find.matchesSelector(r,e)?[r]:[]:ot.find.matches(e,ot.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,i,r){for(var n=[],o=r!==t;(e=e[i])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&ot(e).is(r))break;n.push(e)}return n},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}});var Pt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Lt=/<([\w:]+)/,kt=/<|&#?\w+;/,Ft=/<(?:script|style|link)/i,zt=/^(?:checkbox|radio)$/i,Nt=/checked\s*(?:[^=]|=\s*.checked.)/i,It=/^$|\/(?:java|ecma)script/i,Ot=/^true\/(.*)/,Ut=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Vt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Vt.optgroup=Vt.option,Vt.tbody=Vt.tfoot=Vt.colgroup=Vt.caption=Vt.thead,Vt.th=Vt.td,ot.fn.extend({text:function(e){return ot.access(this,function(e){return e===t?ot.text(this):this.empty().append((this[0]&&this[0].ownerDocument||G).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=u(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=u(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,r=e?ot.filter(e,this):this,n=0;null!=(i=r[n]);n++)t||1!==i.nodeType||ot.cleanData(g(i)),i.parentNode&&(t&&ot.contains(i.ownerDocument,i)&&f(g(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(ot.cleanData(g(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return ot.clone(this,e,t)})},html:function(e){return ot.access(this,function(e){var i=this[0]||{},r=0,n=this.length;if(e===t&&1===i.nodeType)return i.innerHTML;if("string"==typeof e&&!Ft.test(e)&&!Vt[(Lt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Pt,"<$1></$2>");try{for(;n>r;r++)i=this[r]||{},1===i.nodeType&&(ot.cleanData(g(i,!1)),i.innerHTML=e);i=0}catch(o){}}i&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=ot.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(i){var r=e[t++],n=e[t++];n&&(r&&r.parentNode!==n&&(r=this.nextSibling),ot(this).remove(),n.insertBefore(i,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,i){e=Z.apply([],e);var r,n,o,a,s,l,h=0,c=this.length,u=this,f=c-1,m=e[0],v=ot.isFunction(m);if(v||!(1>=c||"string"!=typeof m||ot.support.checkClone)&&Nt.test(m))return this.each(function(r){var n=u.eq(r);v&&(e[0]=m.call(this,r,n.html())),n.domManip(e,t,i)});if(c&&(r=ot.buildFragment(e,this[0].ownerDocument,!1,!i&&this),n=r.firstChild,1===r.childNodes.length&&(r=n),n)){for(o=ot.map(g(r,"script"),d),a=o.length;c>h;h++)s=r,h!==f&&(s=ot.clone(s,!0,!0),a&&ot.merge(o,g(s,"script"))),t.call(this[h],s,h);if(a)for(l=o[o.length-1].ownerDocument,ot.map(o,p),h=0;a>h;h++)s=o[h],It.test(s.type||"")&&!gt.access(s,"globalEval")&&ot.contains(l,s)&&(s.src?ot._evalUrl(s.src):ot.globalEval(s.textContent.replace(Ut,"")))}return this}}),ot.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ot.fn[e]=function(e){for(var i,r=[],n=ot(e),o=n.length-1,a=0;o>=a;a++)i=a===o?this:this.clone(!0),ot(n[a])[t](i),J.apply(r,i.get());return this.pushStack(r)}}),ot.extend({clone:function(e,t,i){var r,n,o,a,s=e.cloneNode(!0),l=ot.contains(e.ownerDocument,e);if(!(ot.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ot.isXMLDoc(e)))for(a=g(s),o=g(e),r=0,n=o.length;n>r;r++)v(o[r],a[r]);if(t)if(i)for(o=o||g(e),a=a||g(s),r=0,n=o.length;n>r;r++)m(o[r],a[r]);else m(e,s);return a=g(s,"script"),a.length>0&&f(a,!l&&g(e,"script")),s},buildFragment:function(e,t,i,r){for(var n,o,a,s,l,h,c=0,u=e.length,d=t.createDocumentFragment(),p=[];u>c;c++)if(n=e[c],n||0===n)if("object"===ot.type(n))ot.merge(p,n.nodeType?[n]:n);else if(kt.test(n)){for(o=o||d.appendChild(t.createElement("div")),a=(Lt.exec(n)||["",""])[1].toLowerCase(),s=Vt[a]||Vt._default,o.innerHTML=s[1]+n.replace(Pt,"<$1></$2>")+s[2],h=s[0];h--;)o=o.lastChild;
ot.merge(p,o.childNodes),o=d.firstChild,o.textContent=""}else p.push(t.createTextNode(n));for(d.textContent="",c=0;n=p[c++];)if((!r||-1===ot.inArray(n,r))&&(l=ot.contains(n.ownerDocument,n),o=g(d.appendChild(n),"script"),l&&f(o),i))for(h=0;n=o[h++];)It.test(n.type||"")&&i.push(n);return d},cleanData:function(e){for(var i,r,o,a,s,l,h=ot.event.special,c=0;(r=e[c])!==t;c++){if(n.accepts(r)&&(s=r[gt.expando],s&&(i=gt.cache[s]))){if(o=Object.keys(i.events||{}),o.length)for(l=0;(a=o[l])!==t;l++)h[a]?ot.event.remove(r,a):ot.removeEvent(r,a,i.handle);gt.cache[s]&&delete gt.cache[s]}delete mt.cache[r[mt.expando]]}},_evalUrl:function(e){return ot.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),ot.fn.extend({wrapAll:function(e){var t;return ot.isFunction(e)?this.each(function(t){ot(this).wrapAll(e.call(this,t))}):(this[0]&&(t=ot(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return ot.isFunction(e)?this.each(function(t){ot(this).wrapInner(e.call(this,t))}):this.each(function(){var t=ot(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=ot.isFunction(e);return this.each(function(i){ot(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){ot.nodeName(this,"body")||ot(this).replaceWith(this.childNodes)}).end()}});var Bt,jt,Wt=/^(none|table(?!-c[ea]).+)/,Gt=/^margin/,Xt=RegExp("^("+at+")(.*)$","i"),Yt=RegExp("^("+at+")(?!px)[a-z%]+$","i"),qt=RegExp("^([+-])=("+at+")","i"),Kt={BODY:"block"},Qt={position:"absolute",visibility:"hidden",display:"block"},$t={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],Jt=["Webkit","O","Moz","ms"];ot.fn.extend({css:function(e,i){return ot.access(this,function(e,i,r){var n,o,a={},s=0;if(ot.isArray(i)){for(n=T(e),o=i.length;o>s;s++)a[i[s]]=ot.css(e,i[s],!1,n);return a}return r!==t?ot.style(e,i,r):ot.css(e,i)},e,i,arguments.length>1)},show:function(){return _(this,!0)},hide:function(){return _(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){y(this)?ot(this).show():ot(this).hide()})}}),ot.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=Bt(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,i,r,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,l=ot.camelCase(i),h=e.style;return i=ot.cssProps[l]||(ot.cssProps[l]=E(h,l)),s=ot.cssHooks[i]||ot.cssHooks[l],r===t?s&&"get"in s&&(o=s.get(e,!1,n))!==t?o:h[i]:(a=typeof r,"string"===a&&(o=qt.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(ot.css(e,i)),a="number"),null==r||"number"===a&&isNaN(r)||("number"!==a||ot.cssNumber[l]||(r+="px"),ot.support.clearCloneStyle||""!==r||0!==i.indexOf("background")||(h[i]="inherit"),s&&"set"in s&&(r=s.set(e,r,n))===t||(h[i]=r)),t)}},css:function(e,i,r,n){var o,a,s,l=ot.camelCase(i);return i=ot.cssProps[l]||(ot.cssProps[l]=E(e.style,l)),s=ot.cssHooks[i]||ot.cssHooks[l],s&&"get"in s&&(o=s.get(e,!0,r)),o===t&&(o=Bt(e,i,n)),"normal"===o&&i in $t&&(o=$t[i]),""===r||r?(a=parseFloat(o),r===!0||ot.isNumeric(a)?a||0:o):o}}),Bt=function(e,i,r){var n,o,a,s=r||T(e),l=s?s.getPropertyValue(i)||s[i]:t,h=e.style;return s&&(""!==l||ot.contains(e.ownerDocument,e)||(l=ot.style(e,i)),Yt.test(l)&&Gt.test(i)&&(n=h.width,o=h.minWidth,a=h.maxWidth,h.minWidth=h.maxWidth=h.width=l,l=s.width,h.width=n,h.minWidth=o,h.maxWidth=a)),l},ot.each(["height","width"],function(e,i){ot.cssHooks[i]={get:function(e,r,n){return r?0===e.offsetWidth&&Wt.test(ot.css(e,"display"))?ot.swap(e,Qt,function(){return R(e,i,n)}):R(e,i,n):t},set:function(e,t,r){var n=r&&T(e);return b(e,t,r?x(e,i,r,ot.support.boxSizing&&"border-box"===ot.css(e,"boxSizing",!1,n),n):0)}}}),ot(function(){ot.support.reliableMarginRight||(ot.cssHooks.marginRight={get:function(e,i){return i?ot.swap(e,{display:"inline-block"},Bt,[e,"marginRight"]):t}}),!ot.support.pixelPosition&&ot.fn.position&&ot.each(["top","left"],function(e,i){ot.cssHooks[i]={get:function(e,r){return r?(r=Bt(e,i),Yt.test(r)?ot(e).position()[i]+"px":r):t}}})}),ot.expr&&ot.expr.filters&&(ot.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight},ot.expr.filters.visible=function(e){return!ot.expr.filters.hidden(e)}),ot.each({margin:"",padding:"",border:"Width"},function(e,t){ot.cssHooks[e+t]={expand:function(i){for(var r=0,n={},o="string"==typeof i?i.split(" "):[i];4>r;r++)n[e+Zt[r]+t]=o[r]||o[r-2]||o[0];return n}},Gt.test(e)||(ot.cssHooks[e+t].set=b)});var ei=/%20/g,ti=/\[\]$/,ii=/\r?\n/g,ri=/^(?:submit|button|image|reset|file)$/i,ni=/^(?:input|select|textarea|keygen)/i;ot.fn.extend({serialize:function(){return ot.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ot.prop(this,"elements");return e?ot.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ot(this).is(":disabled")&&ni.test(this.nodeName)&&!ri.test(e)&&(this.checked||!zt.test(e))}).map(function(e,t){var i=ot(this).val();return null==i?null:ot.isArray(i)?ot.map(i,function(e){return{name:t.name,value:e.replace(ii,"\r\n")}}):{name:t.name,value:i.replace(ii,"\r\n")}}).get()}}),ot.param=function(e,i){var r,n=[],o=function(e,t){t=ot.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(i===t&&(i=ot.ajaxSettings&&ot.ajaxSettings.traditional),ot.isArray(e)||e.jquery&&!ot.isPlainObject(e))ot.each(e,function(){o(this.name,this.value)});else for(r in e)M(r,e[r],i,o);return n.join("&").replace(ei,"+")},ot.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){ot.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),ot.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,r){return this.on(t,e,i,r)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var oi,ai,si=ot.now(),li=/\?/,hi=/#.*$/,ci=/([?&])_=[^&]*/,ui=/^(.*?):[ \t]*([^\r\n]*)$/gm,di=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,pi=/^(?:GET|HEAD)$/,fi=/^\/\//,mi=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,gi=ot.fn.load,vi={},Ei={},yi="*/".concat("*");try{ai=W.href}catch(Ti){ai=G.createElement("a"),ai.href="",ai=ai.href}oi=mi.exec(ai.toLowerCase())||[],ot.fn.load=function(e,i,r){if("string"!=typeof e&&gi)return gi.apply(this,arguments);var n,o,a,s=this,l=e.indexOf(" ");return l>=0&&(n=e.slice(l),e=e.slice(0,l)),ot.isFunction(i)?(r=i,i=t):i&&"object"==typeof i&&(o="POST"),s.length>0&&ot.ajax({url:e,type:o,dataType:"html",data:i}).done(function(e){a=arguments,s.html(n?ot("<div>").append(ot.parseHTML(e)).find(n):e)}).complete(r&&function(e,t){s.each(r,a||[e.responseText,t,e])}),this},ot.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ot.fn[t]=function(e){return this.on(t,e)}}),ot.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ai,type:"GET",isLocal:di.test(oi[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":yi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ot.parseJSON,"text xml":ot.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?A(A(e,ot.ajaxSettings),t):A(ot.ajaxSettings,e)},ajaxPrefilter:S(vi),ajaxTransport:S(Ei),ajax:function(e,i){function r(e,i,r,s){var h,u,E,y,_,x=i;2!==T&&(T=2,l&&clearTimeout(l),n=t,a=s||"",b.readyState=e>0?4:0,h=e>=200&&300>e||304===e,r&&(y=D(d,b,r)),y=P(d,y,b,h),h?(d.ifModified&&(_=b.getResponseHeader("Last-Modified"),_&&(ot.lastModified[o]=_),_=b.getResponseHeader("etag"),_&&(ot.etag[o]=_)),204===e||"HEAD"===d.type?x="nocontent":304===e?x="notmodified":(x=y.state,u=y.data,E=y.error,h=!E)):(E=x,(e||!x)&&(x="error",0>e&&(e=0))),b.status=e,b.statusText=(i||x)+"",h?m.resolveWith(p,[u,x,b]):m.rejectWith(p,[b,x,E]),b.statusCode(v),v=t,c&&f.trigger(h?"ajaxSuccess":"ajaxError",[b,d,h?u:E]),g.fireWith(p,[b,x]),c&&(f.trigger("ajaxComplete",[b,d]),--ot.active||ot.event.trigger("ajaxStop")))}"object"==typeof e&&(i=e,e=t),i=i||{};var n,o,a,s,l,h,c,u,d=ot.ajaxSetup({},i),p=d.context||d,f=d.context&&(p.nodeType||p.jquery)?ot(p):ot.event,m=ot.Deferred(),g=ot.Callbacks("once memory"),v=d.statusCode||{},E={},y={},T=0,_="canceled",b={readyState:0,getResponseHeader:function(e){var t;if(2===T){if(!s)for(s={};t=ui.exec(a);)s[t[1].toLowerCase()]=t[2];t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===T?a:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return T||(e=y[i]=y[i]||e,E[e]=t),this},overrideMimeType:function(e){return T||(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>T)for(t in e)v[t]=[v[t],e[t]];else b.always(e[b.status]);return this},abort:function(e){var t=e||_;return n&&n.abort(t),r(0,t),this}};if(m.promise(b).complete=g.add,b.success=b.done,b.error=b.fail,d.url=((e||d.url||ai)+"").replace(hi,"").replace(fi,oi[1]+"//"),d.type=i.method||i.type||d.method||d.type,d.dataTypes=ot.trim(d.dataType||"*").toLowerCase().match(st)||[""],null==d.crossDomain&&(h=mi.exec(d.url.toLowerCase()),d.crossDomain=!(!h||h[1]===oi[1]&&h[2]===oi[2]&&(h[3]||("http:"===h[1]?"80":"443"))===(oi[3]||("http:"===oi[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=ot.param(d.data,d.traditional)),C(vi,d,i,b),2===T)return b;c=d.global,c&&0===ot.active++&&ot.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!pi.test(d.type),o=d.url,d.hasContent||(d.data&&(o=d.url+=(li.test(o)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=ci.test(o)?o.replace(ci,"$1_="+si++):o+(li.test(o)?"&":"?")+"_="+si++)),d.ifModified&&(ot.lastModified[o]&&b.setRequestHeader("If-Modified-Since",ot.lastModified[o]),ot.etag[o]&&b.setRequestHeader("If-None-Match",ot.etag[o])),(d.data&&d.hasContent&&d.contentType!==!1||i.contentType)&&b.setRequestHeader("Content-Type",d.contentType),b.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+yi+"; q=0.01":""):d.accepts["*"]);for(u in d.headers)b.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(p,b,d)===!1||2===T))return b.abort();_="abort";for(u in{success:1,error:1,complete:1})b[u](d[u]);if(n=C(Ei,d,i,b)){b.readyState=1,c&&f.trigger("ajaxSend",[b,d]),d.async&&d.timeout>0&&(l=setTimeout(function(){b.abort("timeout")},d.timeout));try{T=1,n.send(E,r)}catch(x){if(!(2>T))throw x;r(-1,x)}}else r(-1,"No Transport");return b},getJSON:function(e,t,i){return ot.get(e,t,i,"json")},getScript:function(e,i){return ot.get(e,t,i,"script")}}),ot.each(["get","post"],function(e,i){ot[i]=function(e,r,n,o){return ot.isFunction(r)&&(o=o||n,n=r,r=t),ot.ajax({url:e,type:i,dataType:o,data:r,success:n})}}),ot.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return ot.globalEval(e),e}}}),ot.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),ot.ajaxTransport("script",function(e){if(e.crossDomain){var t,i;return{send:function(r,n){t=ot("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&n("error"===e.type?404:200,e.type)}),G.head.appendChild(t[0])},abort:function(){i&&i()}}}});var _i=[],bi=/(=)\?(?=&|$)|\?\?/;ot.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=_i.pop()||ot.expando+"_"+si++;return this[e]=!0,e}}),ot.ajaxPrefilter("json jsonp",function(i,r,n){var o,a,s,l=i.jsonp!==!1&&(bi.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&bi.test(i.data)&&"data");return l||"jsonp"===i.dataTypes[0]?(o=i.jsonpCallback=ot.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,l?i[l]=i[l].replace(bi,"$1"+o):i.jsonp!==!1&&(i.url+=(li.test(i.url)?"&":"?")+i.jsonp+"="+o),i.converters["script json"]=function(){return s||ot.error(o+" was not called"),s[0]},i.dataTypes[0]="json",a=e[o],e[o]=function(){s=arguments},n.always(function(){e[o]=a,i[o]&&(i.jsonpCallback=r.jsonpCallback,_i.push(o)),s&&ot.isFunction(a)&&a(s[0]),s=a=t}),"script"):t}),ot.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var xi=ot.ajaxSettings.xhr(),Ri={0:200,1223:204},wi=0,Hi={};e.ActiveXObject&&ot(e).on("unload",function(){for(var e in Hi)Hi[e]();Hi=t}),ot.support.cors=!!xi&&"withCredentials"in xi,ot.support.ajax=xi=!!xi,ot.ajaxTransport(function(e){var i;return ot.support.cors||xi&&!e.crossDomain?{send:function(r,n){var o,a,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)s[o]=e.xhrFields[o];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest");for(o in r)s.setRequestHeader(o,r[o]);i=function(e){return function(){i&&(delete Hi[a],i=s.onload=s.onerror=null,"abort"===e?s.abort():"error"===e?n(s.status||404,s.statusText):n(Ri[s.status]||s.status,s.statusText,"string"==typeof s.responseText?{text:s.responseText}:t,s.getAllResponseHeaders()))}},s.onload=i(),s.onerror=i("error"),i=Hi[a=wi++]=i("abort"),s.send(e.hasContent&&e.data||null)},abort:function(){i&&i()}}:t});var Mi,Si,Ci=/^(?:toggle|show|hide)$/,Ai=RegExp("^(?:([+-])=|)("+at+")([a-z%]*)$","i"),Di=/queueHooks$/,Pi=[N],Li={"*":[function(e,t){var i=this.createTween(e,t),r=i.cur(),n=Ai.exec(t),o=n&&n[3]||(ot.cssNumber[e]?"":"px"),a=(ot.cssNumber[e]||"px"!==o&&+r)&&Ai.exec(ot.css(i.elem,e)),s=1,l=20;if(a&&a[3]!==o){o=o||a[3],n=n||[],a=+r||1;do s=s||".5",a/=s,ot.style(i.elem,e,a+o);while(s!==(s=i.cur()/r)&&1!==s&&--l)}return n&&(a=i.start=+a||+r||0,i.unit=o,i.end=n[1]?a+(n[1]+1)*n[2]:+n[2]),i}]};ot.Animation=ot.extend(F,{tweener:function(e,t){ot.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,r=0,n=e.length;n>r;r++)i=e[r],Li[i]=Li[i]||[],Li[i].unshift(t)},prefilter:function(e,t){t?Pi.unshift(e):Pi.push(e)}}),ot.Tween=I,I.prototype={constructor:I,init:function(e,t,i,r,n,o){this.elem=e,this.prop=i,this.easing=n||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(ot.cssNumber[i]?"":"px")},cur:function(){var e=I.propHooks[this.prop];return e&&e.get?e.get(this):I.propHooks._default.get(this)},run:function(e){var t,i=I.propHooks[this.prop];return this.pos=t=this.options.duration?ot.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):I.propHooks._default.set(this),this}},I.prototype.init.prototype=I.prototype,I.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=ot.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){ot.fx.step[e.prop]?ot.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[ot.cssProps[e.prop]]||ot.cssHooks[e.prop])?ot.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},I.propHooks.scrollTop=I.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ot.each(["toggle","show","hide"],function(e,t){var i=ot.fn[t];ot.fn[t]=function(e,r,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(O(t,!0),e,r,n)}}),ot.fn.extend({fadeTo:function(e,t,i,r){return this.filter(y).css("opacity",0).show().end().animate({opacity:t},e,i,r)},animate:function(e,t,i,r){var n=ot.isEmptyObject(e),o=ot.speed(t,i,r),a=function(){var t=F(this,ot.extend({},e),o);(n||gt.get(this,"finish"))&&t.stop(!0)};return a.finish=a,n||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,i,r){var n=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=i,i=e,e=t),i&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=ot.timers,a=gt.get(this);if(i)a[i]&&a[i].stop&&n(a[i]);else for(i in a)a[i]&&a[i].stop&&Di.test(i)&&n(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(r),t=!1,o.splice(i,1));(t||!r)&&ot.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=gt.get(this),r=i[e+"queue"],n=i[e+"queueHooks"],o=ot.timers,a=r?r.length:0;for(i.finish=!0,ot.queue(this,e,[]),n&&n.stop&&n.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete i.finish})}}),ot.each({slideDown:O("show"),slideUp:O("hide"),slideToggle:O("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){ot.fn[e]=function(e,i,r){return this.animate(t,e,i,r)}}),ot.speed=function(e,t,i){var r=e&&"object"==typeof e?ot.extend({},e):{complete:i||!i&&t||ot.isFunction(e)&&e,duration:e,easing:i&&t||t&&!ot.isFunction(t)&&t};return r.duration=ot.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in ot.fx.speeds?ot.fx.speeds[r.duration]:ot.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){ot.isFunction(r.old)&&r.old.call(this),r.queue&&ot.dequeue(this,r.queue)},r},ot.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ot.timers=[],ot.fx=I.prototype.init,ot.fx.tick=function(){var e,i=ot.timers,r=0;for(Mi=ot.now();i.length>r;r++)e=i[r],e()||i[r]!==e||i.splice(r--,1);i.length||ot.fx.stop(),Mi=t},ot.fx.timer=function(e){e()&&ot.timers.push(e)&&ot.fx.start()},ot.fx.interval=13,ot.fx.start=function(){Si||(Si=setInterval(ot.fx.tick,ot.fx.interval))},ot.fx.stop=function(){clearInterval(Si),Si=null},ot.fx.speeds={slow:600,fast:200,_default:400},ot.fx.step={},ot.expr&&ot.expr.filters&&(ot.expr.filters.animated=function(e){return ot.grep(ot.timers,function(t){return e===t.elem}).length}),ot.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){ot.offset.setOffset(this,e,t)});var i,r,n=this[0],o={top:0,left:0},a=n&&n.ownerDocument;return a?(i=a.documentElement,ot.contains(i,n)?(typeof n.getBoundingClientRect!==j&&(o=n.getBoundingClientRect()),r=U(a),{top:o.top+r.pageYOffset-i.clientTop,left:o.left+r.pageXOffset-i.clientLeft}):o):void 0},ot.offset={setOffset:function(e,t,i){var r,n,o,a,s,l,h,c=ot.css(e,"position"),u=ot(e),d={};"static"===c&&(e.style.position="relative"),s=u.offset(),o=ot.css(e,"top"),l=ot.css(e,"left"),h=("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1,h?(r=u.position(),a=r.top,n=r.left):(a=parseFloat(o)||0,n=parseFloat(l)||0),ot.isFunction(t)&&(t=t.call(e,i,s)),null!=t.top&&(d.top=t.top-s.top+a),null!=t.left&&(d.left=t.left-s.left+n),"using"in t?t.using.call(e,d):u.css(d)}},ot.fn.extend({position:function(){if(this[0]){var e,t,i=this[0],r={top:0,left:0};return"fixed"===ot.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),ot.nodeName(e[0],"html")||(r=e.offset()),r.top+=ot.css(e[0],"borderTopWidth",!0),r.left+=ot.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-ot.css(i,"marginTop",!0),left:t.left-r.left-ot.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||X;e&&!ot.nodeName(e,"html")&&"static"===ot.css(e,"position");)e=e.offsetParent;return e||X})}}),ot.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(i,r){var n="pageYOffset"===r;ot.fn[i]=function(o){return ot.access(this,function(i,o,a){var s=U(i);return a===t?s?s[r]:i[o]:(s?s.scrollTo(n?e.pageXOffset:a,n?a:e.pageYOffset):i[o]=a,t)},i,o,arguments.length,null)}}),ot.each({Height:"height",Width:"width"},function(e,i){ot.each({padding:"inner"+e,content:i,"":"outer"+e},function(r,n){ot.fn[n]=function(n,o){var a=arguments.length&&(r||"boolean"!=typeof n),s=r||(n===!0||o===!0?"margin":"border");return ot.access(this,function(i,r,n){var o;return ot.isWindow(i)?i.document.documentElement["client"+e]:9===i.nodeType?(o=i.documentElement,Math.max(i.body["scroll"+e],o["scroll"+e],i.body["offset"+e],o["offset"+e],o["client"+e])):n===t?ot.css(i,r,s):ot.style(i,r,n,s)},i,a?n:t,a,null)}})}),ot.fn.size=function(){return this.length},ot.fn.andSelf=ot.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=ot:"function"==typeof define&&define.amd&&define("jquery",[],function(){return ot}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=ot)}(window),function(e,t){function i(t,i){var n,o,a,s=t.nodeName.toLowerCase();return"area"===s?(n=t.parentNode,o=n.name,t.href&&o&&"map"===n.nodeName.toLowerCase()?(a=e("img[usemap=#"+o+"]")[0],!!a&&r(a)):!1):(/input|select|textarea|button|object/.test(s)?!t.disabled:"a"===s?t.href||i:i)&&r(t)}function r(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var n=0,o=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(i,r){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),r&&r.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(i){if(i!==t)return this.css("zIndex",i);if(this.length)for(var r,n,o=e(this[0]);o.length&&o[0]!==document;){if(r=o.css("position"),("absolute"===r||"relative"===r||"fixed"===r)&&(n=parseInt(o.css("zIndex"),10),!isNaN(n)&&0!==n))return n;o=o.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++n)})},removeUniqueId:function(){return this.each(function(){o.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,r){return!!e.data(t,r[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var r=e.attr(t,"tabindex"),n=isNaN(r);return(n||r>=0)&&i(t,!n)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(i,r){function n(t,i,r,n){return e.each(o,function(){i-=parseFloat(e.css(t,"padding"+this))||0,r&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),n&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var o="Width"===r?["Left","Right"]:["Top","Bottom"],a=r.toLowerCase(),s={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(i){return i===t?s["inner"+r].call(this):this.each(function(){e(this).css(a,n(this,i)+"px")})},e.fn["outer"+r]=function(t,i){return"number"!=typeof t?s["outer"+r].call(this,t):this.each(function(){e(this).css(a,n(this,t,!0,i)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,i,r){var n,o=e.ui[t].prototype;for(n in r)o.plugins[n]=o.plugins[n]||[],o.plugins[n].push([i,r[n]])},call:function(e,t,i){var r,n=e.plugins[t];if(n&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(r=0;r<n.length;r++)e.options[n[r][0]]&&n[r][1].apply(e.element,i)}},hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var r=i&&"left"===i?"scrollLeft":"scrollTop",n=!1;return t[r]>0?!0:(t[r]=1,n=t[r]>0,t[r]=0,n)}})}(jQuery),function(e,t){var i=0,r=Array.prototype.slice,n=e.cleanData;e.cleanData=function(t){for(var i,r=0;null!=(i=t[r]);r++)try{e(i).triggerHandler("remove")}catch(o){}n(t)},e.widget=function(t,i,r){var n,o,a,s,l={},h=t.split(".")[0];t=t.split(".")[1],n=h+"-"+t,r||(r=i,i=e.Widget),e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[h]=e[h]||{},o=e[h][t],a=e[h][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new a(e,t)},e.extend(a,o,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),s=new i,s.options=e.widget.extend({},s.options),e.each(r,function(t,r){return e.isFunction(r)?(l[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,o=this._superApply;return this._super=e,this._superApply=n,t=r.apply(this,arguments),this._super=i,this._superApply=o,t}}(),void 0):(l[t]=r,void 0)}),a.prototype=e.widget.extend(s,{widgetEventPrefix:o?s.widgetEventPrefix:t},l,{constructor:a,namespace:h,widgetName:t,widgetFullName:n}),o?(e.each(o._childConstructors,function(t,i){var r=i.prototype;e.widget(r.namespace+"."+r.widgetName,a,i._proto)}),delete o._childConstructors):i._childConstructors.push(a),e.widget.bridge(t,a)},e.widget.extend=function(i){for(var n,o,a=r.call(arguments,1),s=0,l=a.length;l>s;s++)for(n in a[s])o=a[s][n],a[s].hasOwnProperty(n)&&o!==t&&(i[n]=e.isPlainObject(o)?e.isPlainObject(i[n])?e.widget.extend({},i[n],o):e.widget.extend({},o):o);return i},e.widget.bridge=function(i,n){var o=n.prototype.widgetFullName||i;e.fn[i]=function(a){var s="string"==typeof a,l=r.call(arguments,1),h=this;return a=!s&&l.length?e.widget.extend.apply(null,[a].concat(l)):a,s?this.each(function(){var r,n=e.data(this,o);return n?e.isFunction(n[a])&&"_"!==a.charAt(0)?(r=n[a].apply(n,l),r!==n&&r!==t?(h=r&&r.jquery?h.pushStack(r.get()):r,!1):void 0):e.error("no such method '"+a+"' for "+i+" widget instance"):e.error("cannot call methods on "+i+" prior to initialization; "+"attempted to call method '"+a+"'")}):this.each(function(){var t=e.data(this,o);t?t.option(a||{})._init():e.data(this,o,new n(a,this))}),h}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(i,r){var n,o,a,s=i;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof i)if(s={},n=i.split("."),i=n.shift(),n.length){for(o=s[i]=e.widget.extend({},this.options[i]),a=0;a<n.length-1;a++)o[n[a]]=o[n[a]]||{},o=o[n[a]];if(i=n.pop(),r===t)return o[i]===t?null:o[i];o[i]=r}else{if(r===t)return this.options[i]===t?null:this.options[i];s[i]=r}return this._setOptions(s),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,i,r){var n,o=this;"boolean"!=typeof t&&(r=i,i=t,t=!1),r?(i=n=e(i),this.bindings=this.bindings.add(i)):(r=i,i=this.element,n=this.widget()),e.each(r,function(r,a){function s(){return t||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||e.guid++);var l=r.match(/^(\w+)\s*(.*)$/),h=l[1]+o.eventNamespace,c=l[2];c?n.delegate(c,h,s):i.bind(h,s)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return("string"==typeof e?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,r){var n,o,a=this.options[t];if(r=r||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(n in o)n in i||(i[n]=o[n]);return this.element.trigger(i,r),!(e.isFunction(a)&&a.apply(this.element[0],[i].concat(r))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(r,n,o){"string"==typeof n&&(n={effect:n});var a,s=n?n===!0||"number"==typeof n?i:n.effect||i:t;n=n||{},"number"==typeof n&&(n={duration:n}),a=!e.isEmptyObject(n),n.complete=o,n.delay&&r.delay(n.delay),a&&e.effects&&e.effects.effect[s]?r[t](n):s!==t&&r[s]?r[s](n.duration,n.easing,o):r.queue(function(i){e(this)[t](),o&&o.call(r[0]),i()})}})}(jQuery),function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0
}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!t){this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var r=this,n=1===i.which,o="string"==typeof this.options.cancel&&i.target.nodeName?e(i.target).closest(this.options.cancel).length:!1;return n&&!o&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===e.data(i.target,this.widgetName+".preventClickEvent")&&e.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return r._mouseMove(e)},this._mouseUpDelegate=function(e){return r._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e){e.widget("ui.draggable",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var i=this.options;return this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(i.iframeFix===!0?"iframe":i.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,i){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!i){var r=this._uiHash();if(this._trigger("drag",t,r)===!1)return this._mouseUp({}),!1;this.position=r.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,r=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(r=e.ui.ddmanager.drop(this,t)),this.dropped&&(r=this.dropped,this.dropped=!1),"original"!==this.options.helper||e.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!r||"valid"===this.options.revert&&r||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,r)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1):!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(t){var i=this.options,r=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),r[0]===this.element[0]||/(fixed|absolute)/.test(r.css("position"))||r.css("position","absolute"),r},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,r,n=this.options;return n.containment?"window"===n.containment?(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===n.containment?(this.containment=[0,0,e(document).width()-this.helperProportions.width-this.margins.left,(e(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):n.containment.constructor===Array?(this.containment=n.containment,void 0):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=e(n.containment),r=i[0],r&&(t="hidden"!==i.css("overflow"),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=i),void 0):(this.containment=null,void 0)},_convertPositionTo:function(t,i){i||(i=this.position);var r="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:n.scrollTop(),left:n.scrollLeft()}),{top:i.top+this.offset.relative.top*r+this.offset.parent.top*r-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*r,left:i.left+this.offset.relative.left*r+this.offset.parent.left*r-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*r}},_generatePosition:function(t){var i,r,n,o,a=this.options,s="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=t.pageX,h=t.pageY;return this.offset.scroll||(this.offset.scroll={top:s.scrollTop(),left:s.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(r=this.relative_container.offset(),i=[this.containment[0]+r.left,this.containment[1]+r.top,this.containment[2]+r.left,this.containment[3]+r.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(h=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(h=i[3]+this.offset.click.top)),a.grid&&(n=a.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,h=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-a.grid[1]:n+a.grid[1]:n,o=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=i?o-this.offset.click.left>=i[0]||o-this.offset.click.left>i[2]?o:o-this.offset.click.left>=i[0]?o-a.grid[0]:o+a.grid[0]:o)),{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,i,r){return r=r||this._uiHash(),e.ui.plugin.call(this,t,[i,r]),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,i,r)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i){var r=e(this).data("ui-draggable"),n=r.options,o=e.extend({},i,{item:r.element});r.sortables=[],e(n.connectToSortable).each(function(){var i=e.data(this,"ui-sortable");i&&!i.options.disabled&&(r.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",t,o))})},stop:function(t,i){var r=e(this).data("ui-draggable"),n=e.extend({},i,{item:r.element});e.each(r.sortables,function(){this.instance.isOver?(this.instance.isOver=0,r.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===r.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,n))})},drag:function(t,i){var r=e(this).data("ui-draggable"),n=this;e.each(r.sortables,function(){var o=!1,a=this;this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,e.each(r.sortables,function(){return this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this!==a&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(a.instance.element[0],this.instance.element[0])&&(o=!1),o})),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(n).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=r.offset.click.top,this.instance.offset.click.left=r.offset.click.left,this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top,r._trigger("toSortable",t),r.dropped=this.instance.element,r.currentItem=r.element,this.instance.fromOutside=r),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),r._trigger("fromSortable",t),r.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),i=e(this).data("ui-draggable").options;t.css("cursor")&&(i._cursor=t.css("cursor")),t.css("cursor",i.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i){var r=e(i.helper),n=e(this).data("ui-draggable").options;r.css("opacity")&&(n._opacity=r.css("opacity")),r.css("opacity",n.opacity)},stop:function(t,i){var r=e(this).data("ui-draggable").options;r._opacity&&e(i.helper).css("opacity",r._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");t.scrollParent[0]!==document&&"HTML"!==t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var i=e(this).data("ui-draggable"),r=i.options,n=!1;i.scrollParent[0]!==document&&"HTML"!==i.scrollParent[0].tagName?(r.axis&&"x"===r.axis||(i.overflowOffset.top+i.scrollParent[0].offsetHeight-t.pageY<r.scrollSensitivity?i.scrollParent[0].scrollTop=n=i.scrollParent[0].scrollTop+r.scrollSpeed:t.pageY-i.overflowOffset.top<r.scrollSensitivity&&(i.scrollParent[0].scrollTop=n=i.scrollParent[0].scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(i.overflowOffset.left+i.scrollParent[0].offsetWidth-t.pageX<r.scrollSensitivity?i.scrollParent[0].scrollLeft=n=i.scrollParent[0].scrollLeft+r.scrollSpeed:t.pageX-i.overflowOffset.left<r.scrollSensitivity&&(i.scrollParent[0].scrollLeft=n=i.scrollParent[0].scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(t.pageY-e(document).scrollTop()<r.scrollSensitivity?n=e(document).scrollTop(e(document).scrollTop()-r.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<r.scrollSensitivity&&(n=e(document).scrollTop(e(document).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(t.pageX-e(document).scrollLeft()<r.scrollSensitivity?n=e(document).scrollLeft(e(document).scrollLeft()-r.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<r.scrollSensitivity&&(n=e(document).scrollLeft(e(document).scrollLeft()+r.scrollSpeed)))),n!==!1&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(i,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),i=t.options;t.snapElements=[],e(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var i=e(this),r=i.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:i.outerWidth(),height:i.outerHeight(),top:r.top,left:r.left})})},drag:function(t,i){var r,n,o,a,s,l,h,c,u,d,p=e(this).data("ui-draggable"),f=p.options,m=f.snapTolerance,g=i.offset.left,v=g+p.helperProportions.width,E=i.offset.top,y=E+p.helperProportions.height;for(u=p.snapElements.length-1;u>=0;u--)s=p.snapElements[u].left,l=s+p.snapElements[u].width,h=p.snapElements[u].top,c=h+p.snapElements[u].height,s-m>v||g>l+m||h-m>y||E>c+m||!e.contains(p.snapElements[u].item.ownerDocument,p.snapElements[u].item)?(p.snapElements[u].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[u].item})),p.snapElements[u].snapping=!1):("inner"!==f.snapMode&&(r=Math.abs(h-y)<=m,n=Math.abs(c-E)<=m,o=Math.abs(s-v)<=m,a=Math.abs(l-g)<=m,r&&(i.position.top=p._convertPositionTo("relative",{top:h-p.helperProportions.height,left:0}).top-p.margins.top),n&&(i.position.top=p._convertPositionTo("relative",{top:c,left:0}).top-p.margins.top),o&&(i.position.left=p._convertPositionTo("relative",{top:0,left:s-p.helperProportions.width}).left-p.margins.left),a&&(i.position.left=p._convertPositionTo("relative",{top:0,left:l}).left-p.margins.left)),d=r||n||o||a,"outer"!==f.snapMode&&(r=Math.abs(h-E)<=m,n=Math.abs(c-y)<=m,o=Math.abs(s-g)<=m,a=Math.abs(l-v)<=m,r&&(i.position.top=p._convertPositionTo("relative",{top:h,left:0}).top-p.margins.top),n&&(i.position.top=p._convertPositionTo("relative",{top:c-p.helperProportions.height,left:0}).top-p.margins.top),o&&(i.position.left=p._convertPositionTo("relative",{top:0,left:s}).left-p.margins.left),a&&(i.position.left=p._convertPositionTo("relative",{top:0,left:l-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[u].snapping&&(r||n||o||a||d)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[u].item})),p.snapElements[u].snapping=r||n||o||a||d)}}),e.ui.plugin.add("draggable","stack",{start:function(){var t,i=this.data("ui-draggable").options,r=e.makeArray(e(i.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});r.length&&(t=parseInt(e(r[0]).css("zIndex"),10)||0,e(r).each(function(i){e(this).css("zIndex",t+i)}),this.css("zIndex",t+r.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i){var r=e(i.helper),n=e(this).data("ui-draggable").options;r.css("zIndex")&&(n._zIndex=r.css("zIndex")),r.css("zIndex",n.zIndex)},stop:function(t,i){var r=e(this).data("ui-draggable").options;r._zIndex&&e(i.helper).css("zIndex",r._zIndex)}})}(jQuery),function(e){function t(e,t,i){return e>t&&t+i>e}e.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t=this.options,i=t.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(i)?i:function(e){return e.is(i)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},e.ui.ddmanager.droppables[t.scope]=e.ui.ddmanager.droppables[t.scope]||[],e.ui.ddmanager.droppables[t.scope].push(this),t.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var t=0,i=e.ui.ddmanager.droppables[this.options.scope];t<i.length;t++)i[t]===this&&i.splice(t,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,i){"accept"===t&&(this.accept=e.isFunction(i)?i:function(e){return e.is(i)}),e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var r=i||e.ui.ddmanager.current,n=!1;return r&&(r.currentItem||r.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=e.data(this,"ui-droppable");return t.options.greedy&&!t.options.disabled&&t.options.scope===r.options.scope&&t.accept.call(t.element[0],r.currentItem||r.element)&&e.ui.intersect(r,e.extend(t,{offset:t.element.offset()}),t.options.tolerance)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],r.currentItem||r.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(r)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(e,i,r){if(!i.offset)return!1;var n,o,a=(e.positionAbs||e.position.absolute).left,s=a+e.helperProportions.width,l=(e.positionAbs||e.position.absolute).top,h=l+e.helperProportions.height,c=i.offset.left,u=c+i.proportions.width,d=i.offset.top,p=d+i.proportions.height;switch(r){case"fit":return a>=c&&u>=s&&l>=d&&p>=h;case"intersect":return c<a+e.helperProportions.width/2&&s-e.helperProportions.width/2<u&&d<l+e.helperProportions.height/2&&h-e.helperProportions.height/2<p;case"pointer":return n=(e.positionAbs||e.position.absolute).left+(e.clickOffset||e.offset.click).left,o=(e.positionAbs||e.position.absolute).top+(e.clickOffset||e.offset.click).top,t(o,d,i.proportions.height)&&t(n,c,i.proportions.width);case"touch":return(l>=d&&p>=l||h>=d&&p>=h||d>l&&h>p)&&(a>=c&&u>=a||s>=c&&u>=s||c>a&&s>u);default:return!1}},e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,i){var r,n,o=e.ui.ddmanager.droppables[t.options.scope]||[],a=i?i.type:null,s=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(r=0;r<o.length;r++)if(!(o[r].options.disabled||t&&!o[r].accept.call(o[r].element[0],t.currentItem||t.element))){for(n=0;n<s.length;n++)if(s[n]===o[r].element[0]){o[r].proportions.height=0;continue e}o[r].visible="none"!==o[r].element.css("display"),o[r].visible&&("mousedown"===a&&o[r]._activate.call(o[r],i),o[r].offset=o[r].element.offset(),o[r].proportions={width:o[r].element[0].offsetWidth,height:o[r].element[0].offsetHeight})}},drop:function(t,i){var r=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(r=this._drop.call(this,i)||r),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),r},dragStart:function(t,i){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var r,n,o,a=e.ui.intersect(t,this,this.options.tolerance),s=!a&&this.isover?"isout":a&&!this.isover?"isover":null;s&&(this.options.greedy&&(n=this.options.scope,o=this.element.parents(":data(ui-droppable)").filter(function(){return e.data(this,"ui-droppable").options.scope===n}),o.length&&(r=e.data(o[0],"ui-droppable"),r.greedyChild="isover"===s)),r&&"isover"===s&&(r.isover=!1,r.isout=!0,r._out.call(r,i)),this[s]=!0,this["isout"===s?"isover":"isout"]=!1,this["isover"===s?"_over":"_out"].call(this,i),r&&"isout"===s&&(r.isout=!1,r.isover=!0,r._over.call(r,i)))}})},dragStop:function(t,i){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}}}(jQuery),function(e){function t(e){return parseInt(e,10)||0}function i(e){return!isNaN(parseInt(e,10))}e.widget("ui.resizable",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var t,i,r,n,o,a=this,s=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!s.aspectRatio,aspectRatio:s.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:s.helper||s.ghost||s.animate?s.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=s.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},i=0;i<t.length;i++)r=e.trim(t[i]),o="ui-resizable-"+r,n=e("<div class='ui-resizable-handle "+o+"'></div>"),n.css({zIndex:s.zIndex}),"se"===r&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[r]=".ui-resizable-"+r,this.element.append(n);this._renderAxis=function(t){var i,r,n,o;t=t||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=e(this.handles[i],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(r=e(this.handles[i],this.element),o=/sw|ne|nw|se|n|s/.test(i)?r.outerHeight():r.outerWidth(),n=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),t.css(n,o),this._proportionallyResize()),e(this.handles[i]).length},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){a.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),a.axis=n&&n[1]?n[1]:"se")}),s.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){s.disabled||(e(this).removeClass("ui-resizable-autohide"),a._handles.show())}).mouseleave(function(){s.disabled||a.resizing||(e(this).addClass("ui-resizable-autohide"),a._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,i=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(t){var i,r,n=!1;for(i in this.handles)r=e(this.handles[i])[0],(r===t.target||e.contains(r,t.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(i){var r,n,o,a=this.options,s=this.element.position(),l=this.element;return this.resizing=!0,/absolute/.test(l.css("position"))?l.css({position:"absolute",top:l.css("top"),left:l.css("left")}):l.is(".ui-draggable")&&l.css({position:"absolute",top:s.top,left:s.left}),this._renderProxy(),r=t(this.helper.css("left")),n=t(this.helper.css("top")),a.containment&&(r+=e(a.containment).scrollLeft()||0,n+=e(a.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:r,top:n},this.size=this._helper?{width:l.outerWidth(),height:l.outerHeight()}:{width:l.width(),height:l.height()},this.originalSize=this._helper?{width:l.outerWidth(),height:l.outerHeight()}:{width:l.width(),height:l.height()},this.originalPosition={left:r,top:n},this.sizeDiff={width:l.outerWidth()-l.width(),height:l.outerHeight()-l.height()},this.originalMousePosition={left:i.pageX,top:i.pageY},this.aspectRatio="number"==typeof a.aspectRatio?a.aspectRatio:this.originalSize.width/this.originalSize.height||1,o=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===o?this.axis+"-resize":o),l.addClass("ui-resizable-resizing"),this._propagate("start",i),!0},_mouseDrag:function(t){var i,r=this.helper,n={},o=this.originalMousePosition,a=this.axis,s=this.position.top,l=this.position.left,h=this.size.width,c=this.size.height,u=t.pageX-o.left||0,d=t.pageY-o.top||0,p=this._change[a];
return p?(i=p.apply(this,[t,u,d]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),this.position.top!==s&&(n.top=this.position.top+"px"),this.position.left!==l&&(n.left=this.position.left+"px"),this.size.width!==h&&(n.width=this.size.width+"px"),this.size.height!==c&&(n.height=this.size.height+"px"),r.css(n),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(n)||this._trigger("resize",t,this.ui()),!1):!1},_mouseStop:function(t){this.resizing=!1;var i,r,n,o,a,s,l,h=this.options,c=this;return this._helper&&(i=this._proportionallyResizeElements,r=i.length&&/textarea/i.test(i[0].nodeName),n=r&&e.ui.hasScroll(i[0],"left")?0:c.sizeDiff.height,o=r?0:c.sizeDiff.width,a={width:c.helper.width()-o,height:c.helper.height()-n},s=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,l=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null,h.animate||this.element.css(e.extend(a,{top:l,left:s})),c.helper.height(c.size.height),c.helper.width(c.size.width),this._helper&&!h.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,r,n,o,a,s=this.options;a={minWidth:i(s.minWidth)?s.minWidth:0,maxWidth:i(s.maxWidth)?s.maxWidth:1/0,minHeight:i(s.minHeight)?s.minHeight:0,maxHeight:i(s.maxHeight)?s.maxHeight:1/0},(this._aspectRatio||e)&&(t=a.minHeight*this.aspectRatio,n=a.minWidth/this.aspectRatio,r=a.maxHeight*this.aspectRatio,o=a.maxWidth/this.aspectRatio,t>a.minWidth&&(a.minWidth=t),n>a.minHeight&&(a.minHeight=n),r<a.maxWidth&&(a.maxWidth=r),o<a.maxHeight&&(a.maxHeight=o)),this._vBoundaries=a},_updateCache:function(e){this.offset=this.helper.offset(),i(e.left)&&(this.position.left=e.left),i(e.top)&&(this.position.top=e.top),i(e.height)&&(this.size.height=e.height),i(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,r=this.size,n=this.axis;return i(e.height)?e.width=e.height*this.aspectRatio:i(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===n&&(e.left=t.left+(r.width-e.width),e.top=null),"nw"===n&&(e.top=t.top+(r.height-e.height),e.left=t.left+(r.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,r=this.axis,n=i(e.width)&&t.maxWidth&&t.maxWidth<e.width,o=i(e.height)&&t.maxHeight&&t.maxHeight<e.height,a=i(e.width)&&t.minWidth&&t.minWidth>e.width,s=i(e.height)&&t.minHeight&&t.minHeight>e.height,l=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,c=/sw|nw|w/.test(r),u=/nw|ne|n/.test(r);return a&&(e.width=t.minWidth),s&&(e.height=t.minHeight),n&&(e.width=t.maxWidth),o&&(e.height=t.maxHeight),a&&c&&(e.left=l-t.minWidth),n&&c&&(e.left=l-t.maxWidth),s&&u&&(e.top=h-t.minHeight),o&&u&&(e.top=h-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var e,t,i,r,n,o=this.helper||this.element;for(e=0;e<this._proportionallyResizeElements.length;e++){if(n=this._proportionallyResizeElements[e],!this.borderDif)for(this.borderDif=[],i=[n.css("borderTopWidth"),n.css("borderRightWidth"),n.css("borderBottomWidth"),n.css("borderLeftWidth")],r=[n.css("paddingTop"),n.css("paddingRight"),n.css("paddingBottom"),n.css("paddingLeft")],t=0;t<i.length;t++)this.borderDif[t]=(parseInt(i[t],10)||0)+(parseInt(r[t],10)||0);n.css({height:o.height()-this.borderDif[0]-this.borderDif[2]||0,width:o.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,r=this.originalPosition;return{left:r.left+t,width:i.width-t}},n:function(e,t,i){var r=this.originalSize,n=this.originalPosition;return{top:n.top+i,height:r.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,r){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,r]))},sw:function(t,i,r){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,r]))},ne:function(t,i,r){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,r]))},nw:function(t,i,r){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,r]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),"resize"!==t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).data("ui-resizable"),r=i.options,n=i._proportionallyResizeElements,o=n.length&&/textarea/i.test(n[0].nodeName),a=o&&e.ui.hasScroll(n[0],"left")?0:i.sizeDiff.height,s=o?0:i.sizeDiff.width,l={width:i.size.width-s,height:i.size.height-a},h=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,c=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(l,c&&h?{top:c,left:h}:{}),{duration:r.animateDuration,easing:r.animateEasing,step:function(){var r={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};n&&n.length&&e(n[0]).css({width:r.width,height:r.height}),i._updateCache(r),i._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var i,r,n,o,a,s,l,h=e(this).data("ui-resizable"),c=h.options,u=h.element,d=c.containment,p=d instanceof e?d.get(0):/parent/.test(d)?u.parent().get(0):d;p&&(h.containerElement=e(p),/document/.test(d)||d===document?(h.containerOffset={left:0,top:0},h.containerPosition={left:0,top:0},h.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(i=e(p),r=[],e(["Top","Right","Left","Bottom"]).each(function(e,n){r[e]=t(i.css("padding"+n))}),h.containerOffset=i.offset(),h.containerPosition=i.position(),h.containerSize={height:i.innerHeight()-r[3],width:i.innerWidth()-r[1]},n=h.containerOffset,o=h.containerSize.height,a=h.containerSize.width,s=e.ui.hasScroll(p,"left")?p.scrollWidth:a,l=e.ui.hasScroll(p)?p.scrollHeight:o,h.parentData={element:p,left:n.left,top:n.top,width:s,height:l}))},resize:function(t){var i,r,n,o,a=e(this).data("ui-resizable"),s=a.options,l=a.containerOffset,h=a.position,c=a._aspectRatio||t.shiftKey,u={top:0,left:0},d=a.containerElement;d[0]!==document&&/static/.test(d.css("position"))&&(u=l),h.left<(a._helper?l.left:0)&&(a.size.width=a.size.width+(a._helper?a.position.left-l.left:a.position.left-u.left),c&&(a.size.height=a.size.width/a.aspectRatio),a.position.left=s.helper?l.left:0),h.top<(a._helper?l.top:0)&&(a.size.height=a.size.height+(a._helper?a.position.top-l.top:a.position.top),c&&(a.size.width=a.size.height*a.aspectRatio),a.position.top=a._helper?l.top:0),a.offset.left=a.parentData.left+a.position.left,a.offset.top=a.parentData.top+a.position.top,i=Math.abs((a._helper?a.offset.left-u.left:a.offset.left-u.left)+a.sizeDiff.width),r=Math.abs((a._helper?a.offset.top-u.top:a.offset.top-l.top)+a.sizeDiff.height),n=a.containerElement.get(0)===a.element.parent().get(0),o=/relative|absolute/.test(a.containerElement.css("position")),n&&o&&(i-=a.parentData.left),i+a.size.width>=a.parentData.width&&(a.size.width=a.parentData.width-i,c&&(a.size.height=a.size.width/a.aspectRatio)),r+a.size.height>=a.parentData.height&&(a.size.height=a.parentData.height-r,c&&(a.size.width=a.size.height*a.aspectRatio))},stop:function(){var t=e(this).data("ui-resizable"),i=t.options,r=t.containerOffset,n=t.containerPosition,o=t.containerElement,a=e(t.helper),s=a.offset(),l=a.outerWidth()-t.sizeDiff.width,h=a.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(o.css("position"))&&e(this).css({left:s.left-n.left-r.left,width:l,height:h}),t._helper&&!i.animate&&/static/.test(o.css("position"))&&e(this).css({left:s.left-n.left-r.left,width:l,height:h})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).data("ui-resizable"),i=t.options,r=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof i.alsoResize||i.alsoResize.parentNode?r(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],r(i.alsoResize)):e.each(i.alsoResize,function(e){r(e)})},resize:function(t,i){var r=e(this).data("ui-resizable"),n=r.options,o=r.originalSize,a=r.originalPosition,s={height:r.size.height-o.height||0,width:r.size.width-o.width||0,top:r.position.top-a.top||0,left:r.position.left-a.left||0},l=function(t,r){e(t).each(function(){var t=e(this),n=e(this).data("ui-resizable-alsoresize"),o={},a=r&&r.length?r:t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(a,function(e,t){var i=(n[t]||0)+(s[t]||0);i&&i>=0&&(o[t]=i||null)}),t.css(o)})};"object"!=typeof n.alsoResize||n.alsoResize.nodeType?l(n.alsoResize):e.each(n.alsoResize,function(e,t){l(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).data("ui-resizable"),i=t.options,r=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:r.height,width:r.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).data("ui-resizable");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).data("ui-resizable");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t=e(this).data("ui-resizable"),i=t.options,r=t.size,n=t.originalSize,o=t.originalPosition,a=t.axis,s="number"==typeof i.grid?[i.grid,i.grid]:i.grid,l=s[0]||1,h=s[1]||1,c=Math.round((r.width-n.width)/l)*l,u=Math.round((r.height-n.height)/h)*h,d=n.width+c,p=n.height+u,f=i.maxWidth&&i.maxWidth<d,m=i.maxHeight&&i.maxHeight<p,g=i.minWidth&&i.minWidth>d,v=i.minHeight&&i.minHeight>p;i.grid=s,g&&(d+=l),v&&(p+=h),f&&(d-=l),m&&(p-=h),/^(se|s|e)$/.test(a)?(t.size.width=d,t.size.height=p):/^(ne)$/.test(a)?(t.size.width=d,t.size.height=p,t.position.top=o.top-u):/^(sw)$/.test(a)?(t.size.width=d,t.size.height=p,t.position.left=o.left-c):(t.size.width=d,t.size.height=p,t.position.top=o.top-u,t.position.left=o.left-c)}})}(jQuery),function(e){e.widget("ui.selectable",e.ui.mouse,{version:"1.10.3",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,i=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(i.options.filter,i.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),i=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:i.left,top:i.top,right:i.left+t.outerWidth(),bottom:i.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var i=this,r=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=e(r.filter,this.element[0]),this._trigger("start",t),e(r.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),r.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var r=e.data(this,"selectable-item");r.startselected=!0,t.metaKey||t.ctrlKey||(r.$element.removeClass("ui-selected"),r.selected=!1,r.$element.addClass("ui-unselecting"),r.unselecting=!0,i._trigger("unselecting",t,{unselecting:r.element}))}),e(t.target).parents().addBack().each(function(){var r,n=e.data(this,"selectable-item");return n?(r=!t.metaKey&&!t.ctrlKey||!n.$element.hasClass("ui-selected"),n.$element.removeClass(r?"ui-unselecting":"ui-selected").addClass(r?"ui-selecting":"ui-unselecting"),n.unselecting=!r,n.selecting=r,n.selected=r,r?i._trigger("selecting",t,{selecting:n.element}):i._trigger("unselecting",t,{unselecting:n.element}),!1):void 0}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var i,r=this,n=this.options,o=this.opos[0],a=this.opos[1],s=t.pageX,l=t.pageY;return o>s&&(i=s,s=o,o=i),a>l&&(i=l,l=a,a=i),this.helper.css({left:o,top:a,width:s-o,height:l-a}),this.selectees.each(function(){var i=e.data(this,"selectable-item"),h=!1;i&&i.element!==r.element[0]&&("touch"===n.tolerance?h=!(i.left>s||i.right<o||i.top>l||i.bottom<a):"fit"===n.tolerance&&(h=i.left>o&&i.right<s&&i.top>a&&i.bottom<l),h?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,r._trigger("selecting",t,{selecting:i.element}))):(i.selecting&&((t.metaKey||t.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),r._trigger("unselecting",t,{unselecting:i.element}))),i.selected&&(t.metaKey||t.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,r._trigger("unselecting",t,{unselecting:i.element})))))}),!1}},_mouseStop:function(t){var i=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-unselecting"),r.unselecting=!1,r.startselected=!1,i._trigger("unselected",t,{unselected:r.element})}),e(".ui-selecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-selecting").addClass("ui-selected"),r.selecting=!1,r.selected=!0,r.startselected=!0,i._trigger("selected",t,{selected:r.element})}),this._trigger("stop",t),this.helper.remove(),!1}})}(jQuery),function(e){function t(e,t,i){return e>t&&t+i>e}function i(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))}e.widget("ui.sortable",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||i(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,i){"disabled"===t?(this.options[t]=i,this.widget().toggleClass("ui-sortable-disabled",!!i)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,i){var r=null,n=!1,o=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,o.widgetName+"-item")===o?(r=e(this),!1):void 0}),e.data(t.target,o.widgetName+"-item")===o&&(r=e(t.target)),r?!this.options.handle||i||(e(this.options.handle,r).find("*").addBack().each(function(){this===t.target&&(n=!0)}),n)?(this.currentItem=r,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(t,i,r){var n,o,a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),a.containment&&this._setContainment(),a.cursor&&"auto"!==a.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",a.cursor),this.storedStylesheet=e("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(o)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!r)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var i,r,n,o,a=this.options,s=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<a.scrollSensitivity?this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop+a.scrollSpeed:t.pageY-this.overflowOffset.top<a.scrollSensitivity&&(this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop-a.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<a.scrollSensitivity?this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft+a.scrollSpeed:t.pageX-this.overflowOffset.left<a.scrollSensitivity&&(this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft-a.scrollSpeed)):(t.pageY-e(document).scrollTop()<a.scrollSensitivity?s=e(document).scrollTop(e(document).scrollTop()-a.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<a.scrollSensitivity&&(s=e(document).scrollTop(e(document).scrollTop()+a.scrollSpeed)),t.pageX-e(document).scrollLeft()<a.scrollSensitivity?s=e(document).scrollLeft(e(document).scrollLeft()-a.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<a.scrollSensitivity&&(s=e(document).scrollLeft(e(document).scrollLeft()+a.scrollSpeed))),s!==!1&&e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(r=this.items[i],n=r.item[0],o=this._intersectsWithPointer(r),o&&r.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===o?"next":"prev"]()[0]!==n&&!e.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],n):!0)){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(r))break;this._rearrange(t,r),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var r=this,n=this.placeholder.offset(),o=this.options.axis,a={};o&&"x"!==o||(a.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(a.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(a,parseInt(this.options.revert,10)||500,function(){r._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);i&&r.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))}),!r.length&&t.key&&r.push(t.key+"="),r.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},i.each(function(){r.push(e(t.item||this).attr(t.attribute||"id")||"")}),r},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,r=this.positionAbs.top,n=r+this.helperProportions.height,o=e.left,a=o+e.width,s=e.top,l=s+e.height,h=this.offset.click.top,c=this.offset.click.left,u="x"===this.options.axis||r+h>s&&l>r+h,d="y"===this.options.axis||t+c>o&&a>t+c,p=u&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:o<t+this.helperProportions.width/2&&i-this.helperProportions.width/2<a&&s<r+this.helperProportions.height/2&&n-this.helperProportions.height/2<l},_intersectsWithPointer:function(e){var i="x"===this.options.axis||t(this.positionAbs.top+this.offset.click.top,e.top,e.height),r="y"===this.options.axis||t(this.positionAbs.left+this.offset.click.left,e.left,e.width),n=i&&r,o=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return n?this.floating?a&&"right"===a||"down"===o?2:1:o&&("down"===o?2:1):!1},_intersectsWithSides:function(e){var i=t(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),r=t(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),n=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return this.floating&&o?"right"===o&&r||"left"===o&&!r:n&&("down"===n&&i||"up"===n&&!i)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var i,r,n,o,a=[],s=[],l=this._connectWith();if(l&&t)for(i=l.length-1;i>=0;i--)for(n=e(l[i]),r=n.length-1;r>=0;r--)o=e.data(n[r],this.widgetFullName),o&&o!==this&&!o.options.disabled&&s.push([e.isFunction(o.options.items)?o.options.items.call(o.element):e(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(s.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=s.length-1;i>=0;i--)s[i][0].each(function(){a.push(this)});return e(a)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var i=0;i<t.length;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var i,r,n,o,a,s,l,h,c=this.items,u=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(n=e(d[i]),r=n.length-1;r>=0;r--)o=e.data(n[r],this.widgetFullName),o&&o!==this&&!o.options.disabled&&(u.push([e.isFunction(o.options.items)?o.options.items.call(o.element[0],t,{item:this.currentItem}):e(o.options.items,o.element),o]),this.containers.push(o));for(i=u.length-1;i>=0;i--)for(a=u[i][1],s=u[i][0],r=0,h=s.length;h>r;r++)l=e(s[r]),l.data(this.widgetName+"-item",a),c.push({item:l,instance:a,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,r,n,o;for(i=this.items.length-1;i>=0;i--)r=this.items[i],r.instance!==this.currentContainer&&this.currentContainer&&r.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?e(this.options.toleranceElement,r.item):r.item,t||(r.width=n.outerWidth(),r.height=n.outerHeight()),o=n.offset(),r.left=o.left,r.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)o=this.containers[i].element.offset(),this.containers[i].containerCache.left=o.left,this.containers[i].containerCache.top=o.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var i,r=t.options;r.placeholder&&r.placeholder.constructor!==String||(i=r.placeholder,r.placeholder={element:function(){var r=t.currentItem[0].nodeName.toLowerCase(),n=e("<"+r+">",t.document[0]).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===r?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(n)}):"img"===r&&n.attr("src",t.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(e,n){(!i||r.forcePlaceholderSize)&&(n.height()||n.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(r.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),r.placeholder.update(t,t.placeholder)},_contactContainers:function(r){var n,o,a,s,l,h,c,u,d,p,f=null,m=null;for(n=this.containers.length-1;n>=0;n--)if(!e.contains(this.currentItem[0],this.containers[n].element[0]))if(this._intersectsWith(this.containers[n].containerCache)){if(f&&e.contains(this.containers[n].element[0],f.element[0]))continue;f=this.containers[n],m=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",r,this._uiHash(this)),this.containers[n].containerCache.over=0);if(f)if(1===this.containers.length)this.containers[m].containerCache.over||(this.containers[m]._trigger("over",r,this._uiHash(this)),this.containers[m].containerCache.over=1);else{for(a=1e4,s=null,p=f.floating||i(this.currentItem),l=p?"left":"top",h=p?"width":"height",c=this.positionAbs[l]+this.offset.click[l],o=this.items.length-1;o>=0;o--)e.contains(this.containers[m].element[0],this.items[o].item[0])&&this.items[o].item[0]!==this.currentItem[0]&&(!p||t(this.positionAbs.top+this.offset.click.top,this.items[o].top,this.items[o].height))&&(u=this.items[o].item.offset()[l],d=!1,Math.abs(u-c)>Math.abs(u+this.items[o][h]-c)&&(d=!0,u+=this.items[o][h]),Math.abs(u-c)<a&&(a=Math.abs(u-c),s=this.items[o],this.direction=d?"up":"down"));if(!s&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[m])return;s?this._rearrange(r,s,null,!0):this._rearrange(r,null,this.containers[m].element,!0),this._trigger("change",r,this._uiHash()),this.containers[m]._trigger("change",r,this._uiHash(this)),this.currentContainer=this.containers[m],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[m]._trigger("over",r,this._uiHash(this)),this.containers[m].containerCache.over=1}},_createHelper:function(t){var i=this.options,r=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return r.parents("body").length||e("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(r[0]),r[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!r[0].style.width||i.forceHelperSize)&&r.width(this.currentItem.width()),(!r[0].style.height||i.forceHelperSize)&&r.height(this.currentItem.height()),r},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}
},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,r,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"===n.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"===n.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(t=e(n.containment)[0],i=e(n.containment).offset(),r="hidden"!==e(t).css("overflow"),this.containment=[i.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(r?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(r?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,i){i||(i=this.position);var r="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*r+this.offset.parent.top*r-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:n.scrollTop())*r,left:i.left+this.offset.relative.left*r+this.offset.parent.left*r-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())*r}},_generatePosition:function(t){var i,r,n=this.options,o=t.pageX,a=t.pageY,s="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(s[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(a=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(a=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((a-this.originalPageY)/n.grid[1])*n.grid[1],a=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,r=this.originalPageX+Math.round((o-this.originalPageX)/n.grid[0])*n.grid[0],o=this.containment?r-this.offset.click.left>=this.containment[0]&&r-this.offset.click.left<=this.containment[2]?r:r-this.offset.click.left>=this.containment[0]?r-n.grid[0]:r+n.grid[0]:r)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:s.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:s.scrollLeft())}},_rearrange:function(e,t,i,r){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!r)})},_clear:function(e,t){this.reverting=!1;var i,r=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)("auto"===this._storedCSS[i]||"static"===this._storedCSS[i])&&(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&r.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||r.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(r.push(function(e){this._trigger("remove",e,this._uiHash())}),r.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),r.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)t||r.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over&&(r.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!t){for(this._trigger("beforeStop",e,this._uiHash()),i=0;i<r.length;i++)r[i].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!1}if(t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!t){for(i=0;i<r.length;i++)r[i].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}})}(jQuery),function(e,t){var i="ui-effects-";e.effects={effect:{}},function(e,t){function i(e,t,i){var r=u[t.type]||{};return null==e?i||!t.def?null:t.def:(e=r.floor?~~e:parseFloat(e),isNaN(e)?t.def:r.mod?(e+r.mod)%r.mod:0>e?0:r.max<e?r.max:e)}function r(t){var i=h(),r=i._rgba=[];return t=t.toLowerCase(),f(l,function(e,n){var o,a=n.re.exec(t),s=a&&n.parse(a),l=n.space||"rgba";return s?(o=i[l](s),i[c[l].cache]=o[c[l].cache],r=i._rgba=o._rgba,!1):void 0}),r.length?("0,0,0,0"===r.join()&&e.extend(r,o.transparent),i):o[t]}function n(e,t,i){return i=(i+1)%1,1>6*i?e+6*(t-e)*i:1>2*i?t:2>3*i?e+6*(t-e)*(2/3-i):e}var o,a="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",s=/^([\-+])=\s*(\d+\.?\d*)/,l=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],h=e.Color=function(t,i,r,n){return new e.Color.fn.parse(t,i,r,n)},c={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},u={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},d=h.support={},p=e("<p>")[0],f=e.each;p.style.cssText="background-color:rgba(1,1,1,.5)",d.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(c,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),h.fn=e.extend(h.prototype,{parse:function(n,a,s,l){if(n===t)return this._rgba=[null,null,null,null],this;(n.jquery||n.nodeType)&&(n=e(n).css(a),a=t);var u=this,d=e.type(n),p=this._rgba=[];return a!==t&&(n=[n,a,s,l],d="array"),"string"===d?this.parse(r(n)||o._default):"array"===d?(f(c.rgba.props,function(e,t){p[t.idx]=i(n[t.idx],t)}),this):"object"===d?(n instanceof h?f(c,function(e,t){n[t.cache]&&(u[t.cache]=n[t.cache].slice())}):f(c,function(t,r){var o=r.cache;f(r.props,function(e,t){if(!u[o]&&r.to){if("alpha"===e||null==n[e])return;u[o]=r.to(u._rgba)}u[o][t.idx]=i(n[e],t,!0)}),u[o]&&e.inArray(null,u[o].slice(0,3))<0&&(u[o][3]=1,r.from&&(u._rgba=r.from(u[o])))}),this):void 0},is:function(e){var t=h(e),i=!0,r=this;return f(c,function(e,n){var o,a=t[n.cache];return a&&(o=r[n.cache]||n.to&&n.to(r._rgba)||[],f(n.props,function(e,t){return null!=a[t.idx]?i=a[t.idx]===o[t.idx]:void 0})),i}),i},_space:function(){var e=[],t=this;return f(c,function(i,r){t[r.cache]&&e.push(i)}),e.pop()},transition:function(e,t){var r=h(e),n=r._space(),o=c[n],a=0===this.alpha()?h("transparent"):this,s=a[o.cache]||o.to(a._rgba),l=s.slice();return r=r[o.cache],f(o.props,function(e,n){var o=n.idx,a=s[o],h=r[o],c=u[n.type]||{};null!==h&&(null===a?l[o]=h:(c.mod&&(h-a>c.mod/2?a+=c.mod:a-h>c.mod/2&&(a-=c.mod)),l[o]=i((h-a)*t+a,n)))}),this[n](l)},blend:function(t){if(1===this._rgba[3])return this;var i=this._rgba.slice(),r=i.pop(),n=h(t)._rgba;return h(e.map(i,function(e,t){return(1-r)*n[t]+r*e}))},toRgbaString:function(){var t="rgba(",i=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===i[3]&&(i.pop(),t="rgb("),t+i.join()+")"},toHslaString:function(){var t="hsla(",i=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===i[3]&&(i.pop(),t="hsl("),t+i.join()+")"},toHexString:function(t){var i=this._rgba.slice(),r=i.pop();return t&&i.push(~~(255*r)),"#"+e.map(i,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),h.fn.parse.prototype=h.fn,c.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,i,r=e[0]/255,n=e[1]/255,o=e[2]/255,a=e[3],s=Math.max(r,n,o),l=Math.min(r,n,o),h=s-l,c=s+l,u=.5*c;return t=l===s?0:r===s?60*(n-o)/h+360:n===s?60*(o-r)/h+120:60*(r-n)/h+240,i=0===h?0:.5>=u?h/c:h/(2-c),[Math.round(t)%360,i,u,null==a?1:a]},c.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],r=e[2],o=e[3],a=.5>=r?r*(1+i):r+i-r*i,s=2*r-a;return[Math.round(255*n(s,a,t+1/3)),Math.round(255*n(s,a,t)),Math.round(255*n(s,a,t-1/3)),o]},f(c,function(r,n){var o=n.props,a=n.cache,l=n.to,c=n.from;h.fn[r]=function(r){if(l&&!this[a]&&(this[a]=l(this._rgba)),r===t)return this[a].slice();var n,s=e.type(r),u="array"===s||"object"===s?r:arguments,d=this[a].slice();return f(o,function(e,t){var r=u["object"===s?e:t.idx];null==r&&(r=d[t.idx]),d[t.idx]=i(r,t)}),c?(n=h(c(d)),n[a]=d,n):h(d)},f(o,function(t,i){h.fn[t]||(h.fn[t]=function(n){var o,a=e.type(n),l="alpha"===t?this._hsla?"hsla":"rgba":r,h=this[l](),c=h[i.idx];return"undefined"===a?c:("function"===a&&(n=n.call(this,c),a=e.type(n)),null==n&&i.empty?this:("string"===a&&(o=s.exec(n),o&&(n=c+parseFloat(o[2])*("+"===o[1]?1:-1))),h[i.idx]=n,this[l](h)))})})}),h.hook=function(t){var i=t.split(" ");f(i,function(t,i){e.cssHooks[i]={set:function(t,n){var o,a,s="";if("transparent"!==n&&("string"!==e.type(n)||(o=r(n)))){if(n=h(o||n),!d.rgba&&1!==n._rgba[3]){for(a="backgroundColor"===i?t.parentNode:t;(""===s||"transparent"===s)&&a&&a.style;)try{s=e.css(a,"backgroundColor"),a=a.parentNode}catch(l){}n=n.blend(s&&"transparent"!==s?s:"_default")}n=n.toRgbaString()}try{t.style[i]=n}catch(l){}}},e.fx.step[i]=function(t){t.colorInit||(t.start=h(t.elem,i),t.end=h(t.end),t.colorInit=!0),e.cssHooks[i].set(t.elem,t.start.transition(t.end,t.pos))}})},h.hook(a),e.cssHooks.borderColor={expand:function(e){var t={};return f(["Top","Right","Bottom","Left"],function(i,r){t["border"+r+"Color"]=e}),t}},o=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function i(t){var i,r,n=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,o={};if(n&&n.length&&n[0]&&n[n[0]])for(r=n.length;r--;)i=n[r],"string"==typeof n[i]&&(o[e.camelCase(i)]=n[i]);else for(i in n)"string"==typeof n[i]&&(o[i]=n[i]);return o}function r(t,i){var r,n,a={};for(r in i)n=i[r],t[r]!==n&&(o[r]||(e.fx.step[r]||!isNaN(parseFloat(n)))&&(a[r]=n));return a}var n=["add","remove","toggle"],o={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,i){e.fx.step[i]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(jQuery.style(e.elem,i,e.end),e.setAttr=!0)}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(t,o,a,s){var l=e.speed(o,a,s);return this.queue(function(){var o,a=e(this),s=a.attr("class")||"",h=l.children?a.find("*").addBack():a;h=h.map(function(){var t=e(this);return{el:t,start:i(this)}}),o=function(){e.each(n,function(e,i){t[i]&&a[i+"Class"](t[i])})},o(),h=h.map(function(){return this.end=i(this.el[0]),this.diff=r(this.start,this.end),this}),a.attr("class",s),h=h.map(function(){var t=this,i=e.Deferred(),r=e.extend({},l,{queue:!1,complete:function(){i.resolve(t)}});return this.el.animate(this.diff,r),i.promise()}),e.when.apply(e,h.get()).done(function(){o(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),l.complete.call(a[0])})})},e.fn.extend({addClass:function(t){return function(i,r,n,o){return r?e.effects.animateClass.call(this,{add:i},r,n,o):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(i,r,n,o){return arguments.length>1?e.effects.animateClass.call(this,{remove:i},r,n,o):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(i){return function(r,n,o,a,s){return"boolean"==typeof n||n===t?o?e.effects.animateClass.call(this,n?{add:r}:{remove:r},o,a,s):i.apply(this,arguments):e.effects.animateClass.call(this,{toggle:r},n,o,a)}}(e.fn.toggleClass),switchClass:function(t,i,r,n,o){return e.effects.animateClass.call(this,{add:i,remove:t},r,n,o)}})}(),function(){function r(t,i,r,n){return e.isPlainObject(t)&&(i=t,t=t.effect),t={effect:t},null==i&&(i={}),e.isFunction(i)&&(n=i,r=null,i={}),("number"==typeof i||e.fx.speeds[i])&&(n=r,r=i,i={}),e.isFunction(r)&&(n=r,r=null),i&&e.extend(t,i),r=r||i.duration,t.duration=e.fx.off?0:"number"==typeof r?r:r in e.fx.speeds?e.fx.speeds[r]:e.fx.speeds._default,t.complete=n||i.complete,t}function n(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"!=typeof t||e.effects.effect[t]?e.isFunction(t)?!0:"object"!=typeof t||t.effect?!1:!0:!0}e.extend(e.effects,{version:"1.10.3",save:function(e,t){for(var r=0;r<t.length;r++)null!==t[r]&&e.data(i+t[r],e[0].style[t[r]])},restore:function(e,r){var n,o;for(o=0;o<r.length;o++)null!==r[o]&&(n=e.data(i+r[o]),n===t&&(n=""),e.css(r[o],n))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var i,r;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":r=0;break;case"center":r=.5;break;case"right":r=1;break;default:r=e[1]/t.width}return{x:r,y:i}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var i={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},r=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:t.width(),height:t.height()},o=document.activeElement;try{o.id}catch(a){o=document.body}return t.wrap(r),(t[0]===o||e.contains(t[0],o))&&e(o).focus(),r=t.parent(),"static"===t.css("position")?(r.css({position:"relative"}),t.css({position:"relative"})):(e.extend(i,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,r){i[r]=t.css(r),isNaN(parseInt(i[r],10))&&(i[r]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(n),r.css(i).show()},removeWrapper:function(t){var i=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===i||e.contains(t[0],i))&&e(i).focus()),t},setTransition:function(t,i,r,n){return n=n||{},e.each(i,function(e,i){var o=t.cssUnit(i);o[0]>0&&(n[i]=o[0]*r+o[1])}),n}}),e.fn.extend({effect:function(){function t(t){function r(){e.isFunction(o)&&o.call(n[0]),e.isFunction(t)&&t()}var n=e(this),o=i.complete,s=i.mode;(n.is(":hidden")?"hide"===s:"show"===s)?(n[s](),r()):a.call(n[0],i,r)}var i=r.apply(this,arguments),n=i.mode,o=i.queue,a=e.effects.effect[i.effect];return e.fx.off||!a?n?this[n](i.duration,i.complete):this.each(function(){i.complete&&i.complete.call(this)}):o===!1?this.each(t):this.queue(o||"fx",t)},show:function(e){return function(t){if(n(t))return e.apply(this,arguments);var i=r.apply(this,arguments);return i.mode="show",this.effect.call(this,i)}}(e.fn.show),hide:function(e){return function(t){if(n(t))return e.apply(this,arguments);var i=r.apply(this,arguments);return i.mode="hide",this.effect.call(this,i)}}(e.fn.hide),toggle:function(e){return function(t){if(n(t)||"boolean"==typeof t)return e.apply(this,arguments);var i=r.apply(this,arguments);return i.mode="toggle",this.effect.call(this,i)}}(e.fn.toggle),cssUnit:function(t){var i=this.css(t),r=[];return e.each(["em","px","%","pt"],function(e,t){i.indexOf(t)>0&&(r=[parseFloat(i),t])}),r}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,i){t[i]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,i=4;e<((t=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,i){e.easing["easeIn"+t]=i,e.easing["easeOut"+t]=function(e){return 1-i(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?i(2*e)/2:1-i(-2*e+2)/2}})}()}(jQuery),function(e){var t=0,i={},r={};i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="hide",r.height=r.paddingTop=r.paddingBottom=r.borderTopWidth=r.borderBottomWidth="show",e.widget("ui.accordion",{version:"1.10.3",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||t.active!==!1&&null!=t.active||(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e(),content:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),"disabled"===e&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t),void 0)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var i=e.ui.keyCode,r=this.headers.length,n=this.headers.index(t.target),o=!1;switch(t.keyCode){case i.RIGHT:case i.DOWN:o=this.headers[(n+1)%r];break;case i.LEFT:case i.UP:o=this.headers[(n-1+r)%r];break;case i.SPACE:case i.ENTER:this._eventHandler(t);break;case i.HOME:o=this.headers[0];break;case i.END:o=this.headers[r-1]}o&&(e(t.target).attr("tabIndex",-1),e(o).attr("tabIndex",0),o.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var i,r=this.options,n=r.heightStyle,o=this.element.parent(),a=this.accordionId="ui-accordion-"+(this.element.attr("id")||++t);this.active=this._findActive(r.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(t){var i=e(this),r=i.attr("id"),n=i.next(),o=n.attr("id");r||(r=a+"-header-"+t,i.attr("id",r)),o||(o=a+"-panel-"+t,n.attr("id",o)),i.attr("aria-controls",o),n.attr("aria-labelledby",r)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(r.event),"fill"===n?(i=o.height(),this.element.siblings(":visible").each(function(){var t=e(this),r=t.css("position");"absolute"!==r&&"fixed"!==r&&(i-=t.outerHeight(!0))}),this.headers.each(function(){i-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===n&&(i=0,this.headers.next().each(function(){i=Math.max(i,e(this).css("height","").height())}).height(i))},_activate:function(t){var i=this._findActive(t)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var i={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var i=this.options,r=this.active,n=e(t.currentTarget),o=n[0]===r[0],a=o&&i.collapsible,s=a?e():n.next(),l=r.next(),h={oldHeader:r,oldPanel:l,newHeader:a?e():n,newPanel:s};t.preventDefault(),o&&!i.collapsible||this._trigger("beforeActivate",t,h)===!1||(i.active=a?!1:this.headers.index(n),this.active=o?e():n,this._toggle(h),r.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&r.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),o||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var i=t.newPanel,r=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=r,this.options.animate?this._animate(i,r,t):(r.hide(),i.show(),this._toggleComplete(t)),r.attr({"aria-expanded":"false","aria-hidden":"true"}),r.prev().attr("aria-selected","false"),i.length&&r.length?r.prev().attr("tabIndex",-1):i.length&&this.headers.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),i.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(e,t,n){var o,a,s,l=this,h=0,c=e.length&&(!t.length||e.index()<t.index()),u=this.options.animate||{},d=c&&u.down||u,p=function(){l._toggleComplete(n)};return"number"==typeof d&&(s=d),"string"==typeof d&&(a=d),a=a||d.easing||u.easing,s=s||d.duration||u.duration,t.length?e.length?(o=e.show().outerHeight(),t.animate(i,{duration:s,easing:a,step:function(e,t){t.now=Math.round(e)}}),e.hide().animate(r,{duration:s,easing:a,complete:p,step:function(e,i){i.now=Math.round(e),"height"!==i.prop?h+=i.now:"content"!==l.options.heightStyle&&(i.now=Math.round(o-t.outerHeight()-h),h=0)}}),void 0):t.animate(i,s,a,p):e.animate(r,s,a,p)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}})}(jQuery),function(e){var t=0;e.widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var t,i,r,n=this.element[0].nodeName.toLowerCase(),o="textarea"===n,a="input"===n;this.isMultiLine=o?!0:a?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[o||a?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return t=!0,r=!0,i=!0,void 0;t=!1,r=!1,i=!1;var o=e.ui.keyCode;switch(n.keyCode){case o.PAGE_UP:t=!0,this._move("previousPage",n);break;case o.PAGE_DOWN:t=!0,this._move("nextPage",n);break;case o.UP:t=!0,this._keyEvent("previous",n);break;case o.DOWN:t=!0,this._keyEvent("next",n);break;case o.ENTER:case o.NUMPAD_ENTER:this.menu.active&&(t=!0,n.preventDefault(),this.menu.select(n));break;case o.TAB:this.menu.active&&this.menu.select(n);break;case o.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(r){if(t)return t=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&r.preventDefault(),void 0;if(!i){var n=e.ui.keyCode;switch(r.keyCode){case n.PAGE_UP:this._move("previousPage",r);break;case n.PAGE_DOWN:this._move("nextPage",r);break;case n.UP:this._keyEvent("previous",r);break;case n.DOWN:this._keyEvent("next",r)}}},input:function(e){return r?(r=!1,e.preventDefault(),void 0):(this._searchTimeout(e),void 0)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(e),this._change(e),void 0)}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(r){r.target===t.element[0]||r.target===i||e.contains(i,r.target)||t.close()})})},menufocus:function(t,i){if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)}),void 0;var r=i.item.data("ui-autocomplete-item");!1!==this._trigger("focus",t,{item:r})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(r.value):this.liveRegion.text(r.value)},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),r=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=r,this._delay(function(){this.previous=r,this.selectedItem=i})),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t
},_initSource:function(){var t,i,r=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,r){r(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,n){r.xhr&&r.xhr.abort(),r.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e){n(e)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var e=this,i=++t;return function(r){i===t&&e.__response(r),e.pending--,e.pending||e.element.removeClass("ui-autocomplete-loading")}},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var r=this;e.each(i,function(e,i){r._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return e("<li>").append(e("<a>").text(i.label)).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this._value(this.term),this.menu.blur(),void 0):(this.menu[e](t),void 0):(this.search(null,t),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var r=new RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return r.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.text(t))}})}(jQuery),function(e){var t,i,r,n,o="ui-button ui-widget ui-state-default ui-corner-all",a="ui-state-hover ui-state-active ",s="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",l=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},h=function(t){var i=t.name,r=t.form,n=e([]);return i&&(i=i.replace(/'/g,"\\'"),n=r?e(r).find("[name='"+i+"']"):e("[name='"+i+"']",t.ownerDocument).filter(function(){return!this.form})),n};e.widget("ui.button",{version:"1.10.3",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,l),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var a=this,s=this.options,c="checkbox"===this.type||"radio"===this.type,u=c?"":"ui-state-active",d="ui-state-focus";null===s.label&&(s.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(o).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){s.disabled||this===t&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){s.disabled||e(this).removeClass(u)}).bind("click"+this.eventNamespace,function(e){s.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){a.buttonElement.addClass(d)}).bind("blur"+this.eventNamespace,function(){a.buttonElement.removeClass(d)}),c&&(this.element.bind("change"+this.eventNamespace,function(){n||a.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(e){s.disabled||(n=!1,i=e.pageX,r=e.pageY)}).bind("mouseup"+this.eventNamespace,function(e){s.disabled||(i!==e.pageX||r!==e.pageY)&&(n=!0)})),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return s.disabled||n?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(s.disabled||n)return!1;e(this).addClass("ui-state-active"),a.buttonElement.attr("aria-pressed","true");var t=a.element[0];h(t).not(t).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return s.disabled?!1:(e(this).addClass("ui-state-active"),t=this,a.document.one("mouseup",function(){t=null}),void 0)}).bind("mouseup"+this.eventNamespace,function(){return s.disabled?!1:(e(this).removeClass("ui-state-active"),void 0)}).bind("keydown"+this.eventNamespace,function(t){return s.disabled?!1:((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"),void 0)}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",s.disabled),this._resetButton()},_determineButtonType:function(){var e,t,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(o+" "+a+" "+s).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(t?this.element.prop("disabled",!0):this.element.prop("disabled",!1),void 0):(this._resetButton(),void 0)},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?h(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return this.options.label&&this.element.val(this.options.label),void 0;var t=this.buttonElement.removeClass(s),i=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),r=this.options.icons,n=r.primary&&r.secondary,o=[];r.primary||r.secondary?(this.options.text&&o.push("ui-button-text-icon"+(n?"s":r.primary?"-primary":"-secondary")),r.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+r.primary+"'></span>"),r.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+r.secondary+"'></span>"),this.options.text||(o.push(n?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(i)))):o.push("ui-button-text-only"),t.addClass(o.join(" "))}}),e.widget("ui.buttonset",{version:"1.10.3",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function(e,t){function i(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.dpDiv=r(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function r(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(i,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",function(){e.datepicker._isDisabledDatepicker(o.inline?t.parent()[0]:o.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))})}function n(t,i){e.extend(t,i);for(var r in i)null==i[r]&&(t[r]=i[r]);return t}e.extend(e.ui,{datepicker:{version:"1.10.3"}});var o,a="datepicker";e.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return n(this._defaults,e||{}),this},_attachDatepicker:function(t,i){var r,n,o;r=t.nodeName.toLowerCase(),n="div"===r||"span"===r,t.id||(this.uuid+=1,t.id="dp"+this.uuid),o=this._newInst(e(t),n),o.settings=e.extend({},i||{}),"input"===r?this._connectDatepicker(t,o):n&&this._inlineDatepicker(t,o)},_newInst:function(t,i){var n=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:n,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?r(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,i){var r=e(t);i.append=e([]),i.trigger=e([]),r.hasClass(this.markerClassName)||(this._attachments(r,i),r.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),e.data(t,a,i),i.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var r,n,o,a=this._get(i,"appendText"),s=this._get(i,"isRTL");i.append&&i.append.remove(),a&&(i.append=e("<span class='"+this._appendClass+"'>"+a+"</span>"),t[s?"before":"after"](i.append)),t.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),r=this._get(i,"showOn"),("focus"===r||"both"===r)&&t.focus(this._showDatepicker),("button"===r||"both"===r)&&(n=this._get(i,"buttonText"),o=this._get(i,"buttonImage"),i.trigger=e(this._get(i,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:o,alt:n,title:n}):e("<button type='button'></button>").addClass(this._triggerClass).html(o?e("<img/>").attr({src:o,alt:n,title:n}):n)),t[s?"before":"after"](i.trigger),i.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,r,n,o=new Date(2009,11,20),a=this._get(e,"dateFormat");a.match(/[DM]/)&&(t=function(e){for(i=0,r=0,n=0;n<e.length;n++)e[n].length>i&&(i=e[n].length,r=n);return r},o.setMonth(t(this._get(e,a.match(/MM/)?"monthNames":"monthNamesShort"))),o.setDate(t(this._get(e,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())),e.input.attr("size",this._formatDate(e,o).length)}},_inlineDatepicker:function(t,i){var r=e(t);r.hasClass(this.markerClassName)||(r.addClass(this.markerClassName).append(i.dpDiv),e.data(t,a,i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(t),i.dpDiv.css("display","block"))},_dialogDatepicker:function(t,i,r,o,s){var l,h,c,u,d,p=this._dialogInst;return p||(this.uuid+=1,l="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+l+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),p=this._dialogInst=this._newInst(this._dialogInput,!1),p.settings={},e.data(this._dialogInput[0],a,p)),n(p.settings,o||{}),i=i&&i.constructor===Date?this._formatDate(p,i):i,this._dialogInput.val(i),this._pos=s?s.length?s:[s.pageX,s.pageY]:null,this._pos||(h=document.documentElement.clientWidth,c=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[h/2-100+u,c/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),p.settings.onSelect=r,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],a,p),this},_destroyDatepicker:function(t){var i,r=e(t),n=e.data(t,a);r.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),e.removeData(t,a),"input"===i?(n.append.remove(),n.trigger.remove(),r.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&r.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var i,r,n=e(t),o=e.data(t,a);n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(r=n.children("."+this._inlineClass),r.children().removeClass("ui-state-disabled"),r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var i,r,n=e(t),o=e.data(t,a);n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(r=n.children("."+this._inlineClass),r.children().addClass("ui-state-disabled"),r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,a)}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(i,r,o){var a,s,l,h,c=this._getInst(i);return 2===arguments.length&&"string"==typeof r?"defaults"===r?e.extend({},e.datepicker._defaults):c?"all"===r?e.extend({},c.settings):this._get(c,r):null:(a=r||{},"string"==typeof r&&(a={},a[r]=o),c&&(this._curInst===c&&this._hideDatepicker(),s=this._getDateDatepicker(i,!0),l=this._getMinMaxDate(c,"min"),h=this._getMinMaxDate(c,"max"),n(c.settings,a),null!==l&&a.dateFormat!==t&&a.minDate===t&&(c.settings.minDate=this._formatDate(c,l)),null!==h&&a.dateFormat!==t&&a.maxDate===t&&(c.settings.maxDate=this._formatDate(c,h)),"disabled"in a&&(a.disabled?this._disableDatepicker(i):this._enableDatepicker(i)),this._attachments(e(i),c),this._autoSize(c),this._setDate(c,s),this._updateAlternate(c),this._updateDatepicker(c)),void 0)},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var i,r,n,o=e.datepicker._getInst(t.target),a=!0,s=o.dpDiv.is(".ui-datepicker-rtl");if(o._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),a=!1;break;case 13:return n=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",o.dpDiv),n[0]&&e.datepicker._selectDay(t.target,o.selectedMonth,o.selectedYear,n[0]),i=e.datepicker._get(o,"onSelect"),i?(r=e.datepicker._formatDate(o),i.apply(o.input?o.input[0]:null,[r,o])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(o,"stepBigMonths"):-e.datepicker._get(o,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(o,"stepBigMonths"):+e.datepicker._get(o,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),a=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),a=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,s?1:-1,"D"),a=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(o,"stepBigMonths"):-e.datepicker._get(o,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),a=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,s?-1:1,"D"),a=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(o,"stepBigMonths"):+e.datepicker._get(o,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),a=t.ctrlKey||t.metaKey;break;default:a=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):a=!1;a&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var i,r,n=e.datepicker._getInst(t.target);return e.datepicker._get(n,"constrainInput")?(i=e.datepicker._possibleChars(e.datepicker._get(n,"dateFormat")),r=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">r||!i||i.indexOf(r)>-1):void 0},_doKeyUp:function(t){var i,r=e.datepicker._getInst(t.target);if(r.input.val()!==r.lastVal)try{i=e.datepicker.parseDate(e.datepicker._get(r,"dateFormat"),r.input?r.input.val():null,e.datepicker._getFormatConfig(r)),i&&(e.datepicker._setDateFromField(r),e.datepicker._updateAlternate(r),e.datepicker._updateDatepicker(r))}catch(n){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var i,r,o,a,s,l,h;i=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==i&&(e.datepicker._curInst.dpDiv.stop(!0,!0),i&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),r=e.datepicker._get(i,"beforeShow"),o=r?r.apply(t,[t,i]):{},o!==!1&&(n(i.settings,o),i.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(i),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),a=!1,e(t).parents().each(function(){return a|="fixed"===e(this).css("position"),!a}),s={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(i),s=e.datepicker._checkOffset(i,s,a),i.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":a?"fixed":"absolute",display:"none",left:s.left+"px",top:s.top+"px"}),i.inline||(l=e.datepicker._get(i,"showAnim"),h=e.datepicker._get(i,"duration"),i.dpDiv.zIndex(e(t).zIndex()+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[l]?i.dpDiv.show(l,e.datepicker._get(i,"showOptions"),h):i.dpDiv[l||"show"](l?h:null),e.datepicker._shouldFocusInput(i)&&i.input.focus(),e.datepicker._curInst=i))}},_updateDatepicker:function(t){this.maxRows=4,o=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t),t.dpDiv.find("."+this._dayOverClass+" a").mouseover();var i,r=this._getNumberOfMonths(t),n=r[1],a=17;t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&t.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",a*n+"em"),t.dpDiv[(1!==r[0]||1!==r[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(i=t.yearshtml,setTimeout(function(){i===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),i=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,i,r){var n=t.dpDiv.outerWidth(),o=t.dpDiv.outerHeight(),a=t.input?t.input.outerWidth():0,s=t.input?t.input.outerHeight():0,l=document.documentElement.clientWidth+(r?0:e(document).scrollLeft()),h=document.documentElement.clientHeight+(r?0:e(document).scrollTop());return i.left-=this._get(t,"isRTL")?n-a:0,i.left-=r&&i.left===t.input.offset().left?e(document).scrollLeft():0,i.top-=r&&i.top===t.input.offset().top+s?e(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>l&&l>n?Math.abs(i.left+n-l):0),i.top-=Math.min(i.top,i.top+o>h&&h>o?Math.abs(o+s):0),i},_findPos:function(t){for(var i,r=this._getInst(t),n=this._get(r,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];return i=e(t).offset(),[i.left,i.top]},_hideDatepicker:function(t){var i,r,n,o,s=this._curInst;!s||t&&s!==e.data(t,a)||this._datepickerShowing&&(i=this._get(s,"showAnim"),r=this._get(s,"duration"),n=function(){e.datepicker._tidyDialog(s)},e.effects&&(e.effects.effect[i]||e.effects[i])?s.dpDiv.hide(i,e.datepicker._get(s,"showOptions"),r,n):s.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?r:null,n),i||n(),this._datepickerShowing=!1,o=this._get(s,"onClose"),o&&o.apply(s.input?s.input[0]:null,[s.input?s.input.val():"",s]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),r=e.datepicker._getInst(i[0]);(i[0].id!==e.datepicker._mainDivId&&0===i.parents("#"+e.datepicker._mainDivId).length&&!i.hasClass(e.datepicker.markerClassName)&&!i.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||i.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==r)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,i,r){var n=e(t),o=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(o,i+("M"===r?this._get(o,"showCurrentAtPos"):0),r),this._updateDatepicker(o))},_gotoToday:function(t){var i,r=e(t),n=this._getInst(r[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(r)},_selectMonthYear:function(t,i,r){var n=e(t),o=this._getInst(n[0]);o["selected"+("M"===r?"Month":"Year")]=o["draw"+("M"===r?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(o),this._adjustDate(n)},_selectDay:function(t,i,r,n){var o,a=e(t);e(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(a[0])||(o=this._getInst(a[0]),o.selectedDay=o.currentDay=e("a",n).html(),o.selectedMonth=o.currentMonth=i,o.selectedYear=o.currentYear=r,this._selectDate(t,this._formatDate(o,o.currentDay,o.currentMonth,o.currentYear)))},_clearDate:function(t){var i=e(t);this._selectDate(i,"")},_selectDate:function(t,i){var r,n=e(t),o=this._getInst(n[0]);i=null!=i?i:this._formatDate(o),o.input&&o.input.val(i),this._updateAlternate(o),r=this._get(o,"onSelect"),r?r.apply(o.input?o.input[0]:null,[i,o]):o.input&&o.input.trigger("change"),o.inline?this._updateDatepicker(o):(this._hideDatepicker(),this._lastInput=o.input[0],"object"!=typeof o.input[0]&&o.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var i,r,n,o=this._get(t,"altField");o&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),r=this._getDate(t),n=this.formatDate(i,r,this._getFormatConfig(t)),e(o).each(function(){e(this).val(n)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(t,i,r){if(null==t||null==i)throw"Invalid arguments";if(i="object"==typeof i?i.toString():i+"",""===i)return null;var n,o,a,s,l=0,h=(r?r.shortYearCutoff:null)||this._defaults.shortYearCutoff,c="string"!=typeof h?h:(new Date).getFullYear()%100+parseInt(h,10),u=(r?r.dayNamesShort:null)||this._defaults.dayNamesShort,d=(r?r.dayNames:null)||this._defaults.dayNames,p=(r?r.monthNamesShort:null)||this._defaults.monthNamesShort,f=(r?r.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,E=-1,y=!1,T=function(e){var i=n+1<t.length&&t.charAt(n+1)===e;return i&&n++,i},_=function(e){var t=T(e),r="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,n=new RegExp("^\\d{1,"+r+"}"),o=i.substring(l).match(n);if(!o)throw"Missing number at position "+l;return l+=o[0].length,parseInt(o[0],10)},b=function(t,r,n){var o=-1,a=e.map(T(t)?n:r,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(a,function(e,t){var r=t[1];return i.substr(l,r.length).toLowerCase()===r.toLowerCase()?(o=t[0],l+=r.length,!1):void 0}),-1!==o)return o+1;throw"Unknown name at position "+l},x=function(){if(i.charAt(l)!==t.charAt(n))throw"Unexpected literal at position "+l;l++};for(n=0;n<t.length;n++)if(y)"'"!==t.charAt(n)||T("'")?x():y=!1;else switch(t.charAt(n)){case"d":v=_("d");break;case"D":b("D",u,d);break;case"o":E=_("o");break;case"m":g=_("m");break;case"M":g=b("M",p,f);break;case"y":m=_("y");break;case"@":s=new Date(_("@")),m=s.getFullYear(),g=s.getMonth()+1,v=s.getDate();break;case"!":s=new Date((_("!")-this._ticksTo1970)/1e4),m=s.getFullYear(),g=s.getMonth()+1,v=s.getDate();break;case"'":T("'")?x():y=!0;break;default:x()}if(l<i.length&&(a=i.substr(l),!/^\s+/.test(a)))throw"Extra/unparsed characters found in date: "+a;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c>=m?0:-100)),E>-1)for(g=1,v=E;;){if(o=this._getDaysInMonth(m,g-1),o>=v)break;g++,v-=o}if(s=this._daylightSavingAdjust(new Date(m,g-1,v)),s.getFullYear()!==m||s.getMonth()+1!==g||s.getDate()!==v)throw"Invalid date";return s},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,i){if(!t)return"";var r,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,o=(i?i.dayNames:null)||this._defaults.dayNames,a=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,s=(i?i.monthNames:null)||this._defaults.monthNames,l=function(t){var i=r+1<e.length&&e.charAt(r+1)===t;
return i&&r++,i},h=function(e,t,i){var r=""+t;if(l(e))for(;r.length<i;)r="0"+r;return r},c=function(e,t,i,r){return l(e)?r[t]:i[t]},u="",d=!1;if(t)for(r=0;r<e.length;r++)if(d)"'"!==e.charAt(r)||l("'")?u+=e.charAt(r):d=!1;else switch(e.charAt(r)){case"d":u+=h("d",t.getDate(),2);break;case"D":u+=c("D",t.getDay(),n,o);break;case"o":u+=h("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=h("m",t.getMonth()+1,2);break;case"M":u+=c("M",t.getMonth(),a,s);break;case"y":u+=l("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":u+=t.getTime();break;case"!":u+=1e4*t.getTime()+this._ticksTo1970;break;case"'":l("'")?u+="'":d=!0;break;default:u+=e.charAt(r)}return u},_possibleChars:function(e){var t,i="",r=!1,n=function(i){var r=t+1<e.length&&e.charAt(t+1)===i;return r&&t++,r};for(t=0;t<e.length;t++)if(r)"'"!==e.charAt(t)||n("'")?i+=e.charAt(t):r=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":r=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,i){return e.settings[i]!==t?e.settings[i]:this._defaults[i]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,n=this._getDefaultDate(e),o=n,a=this._getFormatConfig(e);try{o=this.parseDate(i,r,a)||n}catch(s){r=t?"":r}e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),e.currentDay=r?o.getDate():0,e.currentMonth=r?o.getMonth():0,e.currentYear=r?o.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,i,r){var n=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},o=function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),i,e.datepicker._getFormatConfig(t))}catch(r){}for(var n=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,o=n.getFullYear(),a=n.getMonth(),s=n.getDate(),l=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,h=l.exec(i);h;){switch(h[2]||"d"){case"d":case"D":s+=parseInt(h[1],10);break;case"w":case"W":s+=7*parseInt(h[1],10);break;case"m":case"M":a+=parseInt(h[1],10),s=Math.min(s,e.datepicker._getDaysInMonth(o,a));break;case"y":case"Y":o+=parseInt(h[1],10),s=Math.min(s,e.datepicker._getDaysInMonth(o,a))}h=l.exec(i)}return new Date(o,a,s)},a=null==i||""===i?r:"string"==typeof i?o(i):"number"==typeof i?isNaN(i)?r:n(i):new Date(i.getTime());return a=a&&"Invalid Date"===a.toString()?r:a,a&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)),this._daylightSavingAdjust(a)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var r=!t,n=e.selectedMonth,o=e.selectedYear,a=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=a.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=a.getMonth(),e.drawYear=e.selectedYear=e.currentYear=a.getFullYear(),n===e.selectedMonth&&o===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(r?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var i=this._get(t,"stepMonths"),r="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(r,-i,"M")},next:function(){e.datepicker._adjustDate(r,+i,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(r)},selectDay:function(){return e.datepicker._selectDay(r,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(r,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(r,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,r,n,o,a,s,l,h,c,u,d,p,f,m,g,v,E,y,T,_,b,x,R,w,H,M,S,C,A,D,P,L,k,F,z,N,I,O,U=new Date,V=this._daylightSavingAdjust(new Date(U.getFullYear(),U.getMonth(),U.getDate())),B=this._get(e,"isRTL"),j=this._get(e,"showButtonPanel"),W=this._get(e,"hideIfNoPrevNext"),G=this._get(e,"navigationAsDateFormat"),X=this._getNumberOfMonths(e),Y=this._get(e,"showCurrentAtPos"),q=this._get(e,"stepMonths"),K=1!==X[0]||1!==X[1],Q=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),$=this._getMinMaxDate(e,"min"),Z=this._getMinMaxDate(e,"max"),J=e.drawMonth-Y,et=e.drawYear;if(0>J&&(J+=12,et--),Z)for(t=this._daylightSavingAdjust(new Date(Z.getFullYear(),Z.getMonth()-X[0]*X[1]+1,Z.getDate())),t=$&&$>t?$:t;this._daylightSavingAdjust(new Date(et,J,1))>t;)J--,0>J&&(J=11,et--);for(e.drawMonth=J,e.drawYear=et,i=this._get(e,"prevText"),i=G?this.formatDate(i,this._daylightSavingAdjust(new Date(et,J-q,1)),this._getFormatConfig(e)):i,r=this._canAdjustMonth(e,-1,et,J)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"e":"w")+"'>"+i+"</span></a>":W?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"e":"w")+"'>"+i+"</span></a>",n=this._get(e,"nextText"),n=G?this.formatDate(n,this._daylightSavingAdjust(new Date(et,J+q,1)),this._getFormatConfig(e)):n,o=this._canAdjustMonth(e,1,et,J)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"w":"e")+"'>"+n+"</span></a>":W?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"w":"e")+"'>"+n+"</span></a>",a=this._get(e,"currentText"),s=this._get(e,"gotoCurrent")&&e.currentDay?Q:V,a=G?this.formatDate(a,s,this._getFormatConfig(e)):a,l=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",h=j?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(B?l:"")+(this._isInRange(e,s)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+a+"</button>":"")+(B?"":l)+"</div>":"",c=parseInt(this._get(e,"firstDay"),10),c=isNaN(c)?0:c,u=this._get(e,"showWeek"),d=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),f=this._get(e,"monthNames"),m=this._get(e,"monthNamesShort"),g=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),E=this._get(e,"selectOtherMonths"),y=this._getDefaultDate(e),T="",b=0;b<X[0];b++){for(x="",this.maxRows=4,R=0;R<X[1];R++){if(w=this._daylightSavingAdjust(new Date(et,J,e.selectedDay)),H=" ui-corner-all",M="",K){if(M+="<div class='ui-datepicker-group",X[1]>1)switch(R){case 0:M+=" ui-datepicker-group-first",H=" ui-corner-"+(B?"right":"left");break;case X[1]-1:M+=" ui-datepicker-group-last",H=" ui-corner-"+(B?"left":"right");break;default:M+=" ui-datepicker-group-middle",H=""}M+="'>"}for(M+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+H+"'>"+(/all|left/.test(H)&&0===b?B?o:r:"")+(/all|right/.test(H)&&0===b?B?r:o:"")+this._generateMonthYearHeader(e,J,et,$,Z,b>0||R>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",S=u?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",_=0;7>_;_++)C=(_+c)%7,S+="<th"+((_+c+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+d[C]+"'>"+p[C]+"</span></th>";for(M+=S+"</tr></thead><tbody>",A=this._getDaysInMonth(et,J),et===e.selectedYear&&J===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,A)),D=(this._getFirstDayOfMonth(et,J)-c+7)%7,P=Math.ceil((D+A)/7),L=K?this.maxRows>P?this.maxRows:P:P,this.maxRows=L,k=this._daylightSavingAdjust(new Date(et,J,1-D)),F=0;L>F;F++){for(M+="<tr>",z=u?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(k)+"</td>":"",_=0;7>_;_++)N=g?g.apply(e.input?e.input[0]:null,[k]):[!0,""],I=k.getMonth()!==J,O=I&&!E||!N[0]||$&&$>k||Z&&k>Z,z+="<td class='"+((_+c+6)%7>=5?" ui-datepicker-week-end":"")+(I?" ui-datepicker-other-month":"")+(k.getTime()===w.getTime()&&J===e.selectedMonth&&e._keyEvent||y.getTime()===k.getTime()&&y.getTime()===w.getTime()?" "+this._dayOverClass:"")+(O?" "+this._unselectableClass+" ui-state-disabled":"")+(I&&!v?"":" "+N[1]+(k.getTime()===Q.getTime()?" "+this._currentClass:"")+(k.getTime()===V.getTime()?" ui-datepicker-today":""))+"'"+(I&&!v||!N[2]?"":" title='"+N[2].replace(/'/g,"&#39;")+"'")+(O?"":" data-handler='selectDay' data-event='click' data-month='"+k.getMonth()+"' data-year='"+k.getFullYear()+"'")+">"+(I&&!v?"&#xa0;":O?"<span class='ui-state-default'>"+k.getDate()+"</span>":"<a class='ui-state-default"+(k.getTime()===V.getTime()?" ui-state-highlight":"")+(k.getTime()===Q.getTime()?" ui-state-active":"")+(I?" ui-priority-secondary":"")+"' href='#'>"+k.getDate()+"</a>")+"</td>",k.setDate(k.getDate()+1),k=this._daylightSavingAdjust(k);M+=z+"</tr>"}J++,J>11&&(J=0,et++),M+="</tbody></table>"+(K?"</div>"+(X[0]>0&&R===X[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=M}T+=x}return T+=h,e._keyEvent=!1,T},_generateMonthYearHeader:function(e,t,i,r,n,o,a,s){var l,h,c,u,d,p,f,m,g=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),E=this._get(e,"showMonthAfterYear"),y="<div class='ui-datepicker-title'>",T="";if(o||!g)T+="<span class='ui-datepicker-month'>"+a[t]+"</span>";else{for(l=r&&r.getFullYear()===i,h=n&&n.getFullYear()===i,T+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",c=0;12>c;c++)(!l||c>=r.getMonth())&&(!h||c<=n.getMonth())&&(T+="<option value='"+c+"'"+(c===t?" selected='selected'":"")+">"+s[c]+"</option>");T+="</select>"}if(E||(y+=T+(!o&&g&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",o||!v)y+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(e,"yearRange").split(":"),d=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?d+parseInt(e,10):parseInt(e,10);return isNaN(t)?d:t},f=p(u[0]),m=Math.max(f,p(u[1]||"")),f=r?Math.max(f,r.getFullYear()):f,m=n?Math.min(m,n.getFullYear()):m,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)e.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",y+=e.yearshtml,e.yearshtml=null}return y+=this._get(e,"yearSuffix"),E&&(y+=(!o&&g&&v?"":"&#xa0;")+T),y+="</div>"},_adjustInstDate:function(e,t,i){var r=e.drawYear+("Y"===i?t:0),n=e.drawMonth+("M"===i?t:0),o=Math.min(e.selectedDay,this._getDaysInMonth(r,n))+("D"===i?t:0),a=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,n,o)));e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),n=i&&i>t?i:t;return r&&n>r?r:n},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,r){var n=this._getNumberOfMonths(e),o=this._daylightSavingAdjust(new Date(i,r+(0>t?t:n[0]*n[1]),1));return 0>t&&o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth())),this._isInRange(e,o)},_isInRange:function(e,t){var i,r,n=this._getMinMaxDate(e,"min"),o=this._getMinMaxDate(e,"max"),a=null,s=null,l=this._get(e,"yearRange");return l&&(i=l.split(":"),r=(new Date).getFullYear(),a=parseInt(i[0],10),s=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(a+=r),i[1].match(/[+\-].*/)&&(s+=r)),(!n||t.getTime()>=n.getTime())&&(!o||t.getTime()<=o.getTime())&&(!a||t.getFullYear()>=a)&&(!s||t.getFullYear()<=s)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,r){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var n=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(r,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),n,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i))},e.datepicker=new i,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.10.3"}(jQuery),function(e){var t={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},i={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};e.widget("ui.dialog",{version:"1.10.3",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var i=e(this).css(t).offset().top;0>i&&e(this).css("top",t.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var i=this;this._isOpen&&this._trigger("beforeClose",t)!==!1&&(this._isOpen=!1,this._destroyOverlay(),this.opener.filter(":focusable").focus().length||e(this.document[0].activeElement).blur(),this._hide(this.uiDialog,this.options.hide,function(){i._trigger("close",t)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,t){var i=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return i&&!t&&this._trigger("focus",e),i},open:function(){var t=this;return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._trigger("open"),void 0)},_focusTabbable:function(){var e=this.element.find("[autofocus]");e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function i(){var t=this.document[0].activeElement,i=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);i||this._focusTabbable()}t.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),this.close(t),void 0;if(t.keyCode===e.ui.keyCode.TAB){var i=this.uiDialog.find(":tabbable"),r=i.filter(":first"),n=i.filter(":last");t.target!==n[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==r[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(n.focus(1),t.preventDefault()):(r.focus(1),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(i)||e.isArray(i)&&!i.length?(this.uiDialog.removeClass("ui-dialog-buttons"),void 0):(e.each(i,function(i,r){var n,o;r=e.isFunction(r)?{click:r,text:i}:r,r=e.extend({type:"button"},r),n=r.click,r.click=function(){n.apply(t.element[0],arguments)},o={icons:r.icons,text:r.showText},delete r.icons,delete r.showText,e("<button></button>",r).button(o).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var i=this,r=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(r,n){e(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",r,t(n))},drag:function(e,r){i._trigger("drag",e,t(r))},stop:function(n,o){r.position=[o.position.left-i.document.scrollLeft(),o.position.top-i.document.scrollTop()],e(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",n,t(o))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var i=this,r=this.options,n=r.resizable,o=this.uiDialog.css("position"),a="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:r.maxWidth,maxHeight:r.maxHeight,minWidth:r.minWidth,minHeight:this._minHeight(),handles:a,start:function(r,n){e(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",r,t(n))},resize:function(e,r){i._trigger("resize",e,t(r))},stop:function(n,o){r.height=e(this).height(),r.width=e(this).width(),e(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",n,t(o))}}).css("position",o)},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(r){var n=this,o=!1,a={};e.each(r,function(e,r){n._setOption(e,r),e in t&&(o=!0),e in i&&(a[e]=r)}),o&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",a)},_setOption:function(e,t){var i,r,n=this.uiDialog;"dialogClass"===e&&n.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&(i=n.is(":data(ui-draggable)"),i&&!t&&n.draggable("destroy"),!i&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(r=n.is(":data(ui-resizable)"),r&&!t&&n.resizable("destroy"),r&&"string"==typeof t&&n.resizable("option","handles",t),r||t===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,i,r=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),r.minWidth>r.width&&(r.width=r.minWidth),e=this.uiDialog.css({height:"auto",width:r.width}).outerHeight(),t=Math.max(0,r.minHeight-e),i="number"==typeof r.maxHeight?Math.max(0,r.maxHeight-e):"none","auto"===r.height?this.element.css({minHeight:t,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,r.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return e(t.target).closest(".ui-dialog").length?!0:!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=this,i=this.widgetFullName;e.ui.dialog.overlayInstances||this._delay(function(){e.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(r){t._allowInteraction(r)||(r.preventDefault(),e(".ui-dialog:visible:last .ui-dialog-content").data(i)._focusTabbable())})}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),e.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&(e.ui.dialog.overlayInstances--,e.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),e.ui.dialog.overlayInstances=0,e.uiBackCompat!==!1&&e.widget("ui.dialog",e.ui.dialog,{_position:function(){var t,i=this.options.position,r=[],n=[0,0];i?(("string"==typeof i||"object"==typeof i&&"0"in i)&&(r=i.split?i.split(" "):[i[0],i[1]],1===r.length&&(r[1]=r[0]),e.each(["left","top"],function(e,t){+r[e]===r[e]&&(n[e]=r[e],r[e]=t)}),i={my:r[0]+(n[0]<0?n[0]:"+"+n[0])+" "+r[1]+(n[1]<0?n[1]:"+"+n[1]),at:r.join(" ")}),i=e.extend({},e.ui.dialog.prototype.options.position,i)):i=e.ui.dialog.prototype.options.position,t=this.uiDialog.is(":visible"),t||this.uiDialog.show(),this.uiDialog.position(i),t||this.uiDialog.hide()}})}(jQuery),function(e){var t=/up|down|vertical/,i=/up|left|vertical|horizontal/;e.effects.effect.blind=function(r,n){var o,a,s,l=e(this),h=["position","top","bottom","left","right","height","width"],c=e.effects.setMode(l,r.mode||"hide"),u=r.direction||"up",d=t.test(u),p=d?"height":"width",f=d?"top":"left",m=i.test(u),g={},v="show"===c;l.parent().is(".ui-effects-wrapper")?e.effects.save(l.parent(),h):e.effects.save(l,h),l.show(),o=e.effects.createWrapper(l).css({overflow:"hidden"}),a=o[p](),s=parseFloat(o.css(f))||0,g[p]=v?a:0,m||(l.css(d?"bottom":"right",0).css(d?"top":"left","auto").css({position:"absolute"}),g[f]=v?s:a+s),v&&(o.css(p,0),m||o.css(f,s+a)),o.animate(g,{duration:r.duration,easing:r.easing,queue:!1,complete:function(){"hide"===c&&l.hide(),e.effects.restore(l,h),e.effects.removeWrapper(l),n()}})}}(jQuery),function(e){e.effects.effect.bounce=function(t,i){var r,n,o,a=e(this),s=["position","top","bottom","left","right","height","width"],l=e.effects.setMode(a,t.mode||"effect"),h="hide"===l,c="show"===l,u=t.direction||"up",d=t.distance,p=t.times||5,f=2*p+(c||h?1:0),m=t.duration/f,g=t.easing,v="up"===u||"down"===u?"top":"left",E="up"===u||"left"===u,y=a.queue(),T=y.length;for((c||h)&&s.push("opacity"),e.effects.save(a,s),a.show(),e.effects.createWrapper(a),d||(d=a["top"===v?"outerHeight":"outerWidth"]()/3),c&&(o={opacity:1},o[v]=0,a.css("opacity",0).css(v,E?2*-d:2*d).animate(o,m,g)),h&&(d/=Math.pow(2,p-1)),o={},o[v]=0,r=0;p>r;r++)n={},n[v]=(E?"-=":"+=")+d,a.animate(n,m,g).animate(o,m,g),d=h?2*d:d/2;h&&(n={opacity:0},n[v]=(E?"-=":"+=")+d,a.animate(n,m,g)),a.queue(function(){h&&a.hide(),e.effects.restore(a,s),e.effects.removeWrapper(a),i()}),T>1&&y.splice.apply(y,[1,0].concat(y.splice(T,f+1))),a.dequeue()}}(jQuery),function(e){e.effects.effect.clip=function(t,i){var r,n,o,a=e(this),s=["position","top","bottom","left","right","height","width"],l=e.effects.setMode(a,t.mode||"hide"),h="show"===l,c=t.direction||"vertical",u="vertical"===c,d=u?"height":"width",p=u?"top":"left",f={};e.effects.save(a,s),a.show(),r=e.effects.createWrapper(a).css({overflow:"hidden"}),n="IMG"===a[0].tagName?r:a,o=n[d](),h&&(n.css(d,0),n.css(p,o/2)),f[d]=h?o:0,f[p]=h?0:o/2,n.animate(f,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){h||a.hide(),e.effects.restore(a,s),e.effects.removeWrapper(a),i()}})}}(jQuery),function(e){e.effects.effect.drop=function(t,i){var r,n=e(this),o=["position","top","bottom","left","right","opacity","height","width"],a=e.effects.setMode(n,t.mode||"hide"),s="show"===a,l=t.direction||"left",h="up"===l||"down"===l?"top":"left",c="up"===l||"left"===l?"pos":"neg",u={opacity:s?1:0};e.effects.save(n,o),n.show(),e.effects.createWrapper(n),r=t.distance||n["top"===h?"outerHeight":"outerWidth"](!0)/2,s&&n.css("opacity",0).css(h,"pos"===c?-r:r),u[h]=(s?"pos"===c?"+=":"-=":"pos"===c?"-=":"+=")+r,n.animate(u,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===a&&n.hide(),e.effects.restore(n,o),e.effects.removeWrapper(n),i()}})}}(jQuery),function(e){e.effects.effect.explode=function(t,i){function r(){y.push(this),y.length===u*d&&n()}function n(){p.css({visibility:"visible"}),e(y).remove(),m||p.hide(),i()}var o,a,s,l,h,c,u=t.pieces?Math.round(Math.sqrt(t.pieces)):3,d=u,p=e(this),f=e.effects.setMode(p,t.mode||"hide"),m="show"===f,g=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/d),E=Math.ceil(p.outerHeight()/u),y=[];for(o=0;u>o;o++)for(l=g.top+o*E,c=o-(u-1)/2,a=0;d>a;a++)s=g.left+a*v,h=a-(d-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-a*v,top:-o*E}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:E,left:s+(m?h*v:0),top:l+(m?c*E:0),opacity:m?0:1}).animate({left:s+(m?0:h*v),top:l+(m?0:c*E),opacity:m?1:0},t.duration||500,t.easing,r)}}(jQuery),function(e){e.effects.effect.fade=function(t,i){var r=e(this),n=e.effects.setMode(r,t.mode||"toggle");r.animate({opacity:n},{queue:!1,duration:t.duration,easing:t.easing,complete:i})}}(jQuery),function(e){e.effects.effect.fold=function(t,i){var r,n,o=e(this),a=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(o,t.mode||"hide"),l="show"===s,h="hide"===s,c=t.size||15,u=/([0-9]+)%/.exec(c),d=!!t.horizFirst,p=l!==d,f=p?["width","height"]:["height","width"],m=t.duration/2,g={},v={};e.effects.save(o,a),o.show(),r=e.effects.createWrapper(o).css({overflow:"hidden"}),n=p?[r.width(),r.height()]:[r.height(),r.width()],u&&(c=parseInt(u[1],10)/100*n[h?0:1]),l&&r.css(d?{height:0,width:c}:{height:c,width:0}),g[f[0]]=l?n[0]:c,v[f[1]]=l?n[1]:0,r.animate(g,m,t.easing).animate(v,m,t.easing,function(){h&&o.hide(),e.effects.restore(o,a),e.effects.removeWrapper(o),i()})}}(jQuery),function(e){e.effects.effect.highlight=function(t,i){var r=e(this),n=["backgroundImage","backgroundColor","opacity"],o=e.effects.setMode(r,t.mode||"show"),a={backgroundColor:r.css("backgroundColor")};"hide"===o&&(a.opacity=0),e.effects.save(r,n),r.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(a,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&r.hide(),e.effects.restore(r,n),i()}})}}(jQuery),function(e){e.effects.effect.pulsate=function(t,i){var r,n=e(this),o=e.effects.setMode(n,t.mode||"show"),a="show"===o,s="hide"===o,l=a||"hide"===o,h=2*(t.times||5)+(l?1:0),c=t.duration/h,u=0,d=n.queue(),p=d.length;for((a||!n.is(":visible"))&&(n.css("opacity",0).show(),u=1),r=1;h>r;r++)n.animate({opacity:u},c,t.easing),u=1-u;n.animate({opacity:u},c,t.easing),n.queue(function(){s&&n.hide(),i()}),p>1&&d.splice.apply(d,[1,0].concat(d.splice(p,h+1))),n.dequeue()}}(jQuery),function(e){e.effects.effect.puff=function(t,i){var r=e(this),n=e.effects.setMode(r,t.mode||"hide"),o="hide"===n,a=parseInt(t.percent,10)||150,s=a/100,l={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:n,complete:i,percent:o?a:100,from:o?l:{height:l.height*s,width:l.width*s,outerHeight:l.outerHeight*s,outerWidth:l.outerWidth*s}}),r.effect(t)},e.effects.effect.scale=function(t,i){var r=e(this),n=e.extend(!0,{},t),o=e.effects.setMode(r,t.mode||"effect"),a=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===o?0:100),s=t.direction||"both",l=t.origin,h={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()},c={y:"horizontal"!==s?a/100:1,x:"vertical"!==s?a/100:1};n.effect="size",n.queue=!1,n.complete=i,"effect"!==o&&(n.origin=l||["middle","center"],n.restore=!0),n.from=t.from||("show"===o?{height:0,width:0,outerHeight:0,outerWidth:0}:h),n.to={height:h.height*c.y,width:h.width*c.x,outerHeight:h.outerHeight*c.y,outerWidth:h.outerWidth*c.x},n.fade&&("show"===o&&(n.from.opacity=0,n.to.opacity=1),"hide"===o&&(n.from.opacity=1,n.to.opacity=0)),r.effect(n)},e.effects.effect.size=function(t,i){var r,n,o,a=e(this),s=["position","top","bottom","left","right","width","height","overflow","opacity"],l=["position","top","bottom","left","right","overflow","opacity"],h=["width","height","overflow"],c=["fontSize"],u=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],d=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(a,t.mode||"effect"),f=t.restore||"effect"!==p,m=t.scale||"both",g=t.origin||["middle","center"],v=a.css("position"),E=f?s:l,y={height:0,width:0,outerHeight:0,outerWidth:0};
"show"===p&&a.show(),r={height:a.height(),width:a.width(),outerHeight:a.outerHeight(),outerWidth:a.outerWidth()},"toggle"===t.mode&&"show"===p?(a.from=t.to||y,a.to=t.from||r):(a.from=t.from||("show"===p?y:r),a.to=t.to||("hide"===p?y:r)),o={from:{y:a.from.height/r.height,x:a.from.width/r.width},to:{y:a.to.height/r.height,x:a.to.width/r.width}},("box"===m||"both"===m)&&(o.from.y!==o.to.y&&(E=E.concat(u),a.from=e.effects.setTransition(a,u,o.from.y,a.from),a.to=e.effects.setTransition(a,u,o.to.y,a.to)),o.from.x!==o.to.x&&(E=E.concat(d),a.from=e.effects.setTransition(a,d,o.from.x,a.from),a.to=e.effects.setTransition(a,d,o.to.x,a.to))),("content"===m||"both"===m)&&o.from.y!==o.to.y&&(E=E.concat(c).concat(h),a.from=e.effects.setTransition(a,c,o.from.y,a.from),a.to=e.effects.setTransition(a,c,o.to.y,a.to)),e.effects.save(a,E),a.show(),e.effects.createWrapper(a),a.css("overflow","hidden").css(a.from),g&&(n=e.effects.getBaseline(g,r),a.from.top=(r.outerHeight-a.outerHeight())*n.y,a.from.left=(r.outerWidth-a.outerWidth())*n.x,a.to.top=(r.outerHeight-a.to.outerHeight)*n.y,a.to.left=(r.outerWidth-a.to.outerWidth)*n.x),a.css(a.from),("content"===m||"both"===m)&&(u=u.concat(["marginTop","marginBottom"]).concat(c),d=d.concat(["marginLeft","marginRight"]),h=s.concat(u).concat(d),a.find("*[width]").each(function(){var i=e(this),r={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};f&&e.effects.save(i,h),i.from={height:r.height*o.from.y,width:r.width*o.from.x,outerHeight:r.outerHeight*o.from.y,outerWidth:r.outerWidth*o.from.x},i.to={height:r.height*o.to.y,width:r.width*o.to.x,outerHeight:r.height*o.to.y,outerWidth:r.width*o.to.x},o.from.y!==o.to.y&&(i.from=e.effects.setTransition(i,u,o.from.y,i.from),i.to=e.effects.setTransition(i,u,o.to.y,i.to)),o.from.x!==o.to.x&&(i.from=e.effects.setTransition(i,d,o.from.x,i.from),i.to=e.effects.setTransition(i,d,o.to.x,i.to)),i.css(i.from),i.animate(i.to,t.duration,t.easing,function(){f&&e.effects.restore(i,h)})})),a.animate(a.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===a.to.opacity&&a.css("opacity",a.from.opacity),"hide"===p&&a.hide(),e.effects.restore(a,E),f||("static"===v?a.css({position:"relative",top:a.to.top,left:a.to.left}):e.each(["top","left"],function(e,t){a.css(t,function(t,i){var r=parseInt(i,10),n=e?a.to.left:a.to.top;return"auto"===i?n+"px":r+n+"px"})})),e.effects.removeWrapper(a),i()}})}}(jQuery),function(e){e.effects.effect.shake=function(t,i){var r,n=e(this),o=["position","top","bottom","left","right","height","width"],a=e.effects.setMode(n,t.mode||"effect"),s=t.direction||"left",l=t.distance||20,h=t.times||3,c=2*h+1,u=Math.round(t.duration/c),d="up"===s||"down"===s?"top":"left",p="up"===s||"left"===s,f={},m={},g={},v=n.queue(),E=v.length;for(e.effects.save(n,o),n.show(),e.effects.createWrapper(n),f[d]=(p?"-=":"+=")+l,m[d]=(p?"+=":"-=")+2*l,g[d]=(p?"-=":"+=")+2*l,n.animate(f,u,t.easing),r=1;h>r;r++)n.animate(m,u,t.easing).animate(g,u,t.easing);n.animate(m,u,t.easing).animate(f,u/2,t.easing).queue(function(){"hide"===a&&n.hide(),e.effects.restore(n,o),e.effects.removeWrapper(n),i()}),E>1&&v.splice.apply(v,[1,0].concat(v.splice(E,c+1))),n.dequeue()}}(jQuery),function(e){e.effects.effect.slide=function(t,i){var r,n=e(this),o=["position","top","bottom","left","right","width","height"],a=e.effects.setMode(n,t.mode||"show"),s="show"===a,l=t.direction||"left",h="up"===l||"down"===l?"top":"left",c="up"===l||"left"===l,u={};e.effects.save(n,o),n.show(),r=t.distance||n["top"===h?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(n).css({overflow:"hidden"}),s&&n.css(h,c?isNaN(r)?"-"+r:-r:r),u[h]=(s?c?"+=":"-=":c?"-=":"+=")+r,n.animate(u,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===a&&n.hide(),e.effects.restore(n,o),e.effects.removeWrapper(n),i()}})}}(jQuery),function(e){e.effects.effect.transfer=function(t,i){var r=e(this),n=e(t.to),o="fixed"===n.css("position"),a=e("body"),s=o?a.scrollTop():0,l=o?a.scrollLeft():0,h=n.offset(),c={top:h.top-s,left:h.left-l,height:n.innerHeight(),width:n.innerWidth()},u=r.offset(),d=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:u.top-s,left:u.left-l,height:r.innerHeight(),width:r.innerWidth(),position:o?"fixed":"absolute"}).animate(c,t.duration,t.easing,function(){d.remove(),i()})}}(jQuery),function(e){e.widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(e){this.options.disabled&&e.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(t){var i=e(t.target).closest(".ui-menu-item");!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(t),i.has(".ui-menu").length?this.expand(t):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var i=e(t.currentTarget);i.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(t,i)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,i)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){e(t.target).closest(".ui-menu").length||this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var r,n,o,a,s,l=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:l=!1,n=this.previousFilter||"",o=String.fromCharCode(t.keyCode),a=!1,clearTimeout(this.filterTimer),o===n?a=!0:o=n+o,s=new RegExp("^"+i(o),"i"),r=this.activeMenu.children(".ui-menu-item").filter(function(){return s.test(e(this).children("a").text())}),r=a&&-1!==r.index(this.active.next())?this.active.nextAll(".ui-menu-item"):r,r.length||(o=String.fromCharCode(t.keyCode),s=new RegExp("^"+i(o),"i"),r=this.activeMenu.children(".ui-menu-item").filter(function(){return s.test(e(this).children("a").text())})),r.length?(this.focus(t,r),r.length>1?(this.previousFilter=o,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}l&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,i=this.options.icons.submenu,r=this.element.find(this.options.menus);r.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),r=t.prev("a"),n=e("<span>").addClass("ui-menu-icon ui-icon "+i).data("ui-menu-submenu-carat",!0);r.attr("aria-haspopup","true").prepend(n),t.attr("aria-labelledby",r.attr("id"))}),t=r.add(this.element),t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),t.children(":not(.ui-menu-item)").each(function(){var t=e(this);/[^\-\u2014\u2013\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")}),t.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),this._super(e,t)},focus:function(e,t){var i,r;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),r=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",r.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=t.children(".ui-menu"),i.length&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var i,r,n,o,a,s;this._hasScroll()&&(i=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,r=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,n=t.offset().top-this.activeMenu.offset().top-i-r,o=this.activeMenu.scrollTop(),a=this.activeMenu.height(),s=t.height(),0>n?this.activeMenu.scrollTop(o+n):n+s>a&&this.activeMenu.scrollTop(o+n-a+s))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var r=i?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));r.length||(r=this.element),this._close(r),this.blur(t),this.activeMenu=r},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var r;this.active&&(r="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),r&&r.length&&this.active||(r=this.activeMenu.children(".ui-menu-item")[t]()),this.focus(i,r)},nextPage:function(t){var i,r,n;return this.active?(this.isLastItem()||(this._hasScroll()?(r=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-r-n<0}),this.focus(t,i)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())),void 0):(this.next(t),void 0)},previousPage:function(t){var i,r,n;return this.active?(this.isFirstItem()||(this._hasScroll()?(r=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-r+n>0}),this.focus(t,i)):this.focus(t,this.activeMenu.children(".ui-menu-item").first())),void 0):(this.next(t),void 0)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,i)}})}(jQuery),function(e,t){function i(e,t,i){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?i/100:1)]}function r(t,i){return parseInt(e.css(t,i),10)||0}function n(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var o,a=Math.max,s=Math.abs,l=Math.round,h=/left|center|right/,c=/top|center|bottom/,u=/[\+\-]\d+(\.[\d]+)?%?/,d=/^\w+/,p=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(o!==t)return o;var i,r,n=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),a=n.children()[0];return e("body").append(n),i=a.offsetWidth,n.css("overflow","scroll"),r=a.offsetWidth,i===r&&(r=n[0].clientWidth),n.remove(),o=i-r},getScrollInfo:function(t){var i=t.isWindow?"":t.element.css("overflow-x"),r=t.isWindow?"":t.element.css("overflow-y"),n="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,o="scroll"===r||"auto"===r&&t.height<t.element[0].scrollHeight;return{width:o?e.position.scrollbarWidth():0,height:n?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),r=e.isWindow(i[0]);return{element:i,isWindow:r,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:r?i.width():i.outerWidth(),height:r?i.height():i.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return f.apply(this,arguments);t=e.extend({},t);var o,p,m,g,v,E,y=e(t.of),T=e.position.getWithinInfo(t.within),_=e.position.getScrollInfo(T),b=(t.collision||"flip").split(" "),x={};return E=n(y),y[0].preventDefault&&(t.at="left top"),p=E.width,m=E.height,g=E.offset,v=e.extend({},g),e.each(["my","at"],function(){var e,i,r=(t[this]||"").split(" ");1===r.length&&(r=h.test(r[0])?r.concat(["center"]):c.test(r[0])?["center"].concat(r):["center","center"]),r[0]=h.test(r[0])?r[0]:"center",r[1]=c.test(r[1])?r[1]:"center",e=u.exec(r[0]),i=u.exec(r[1]),x[this]=[e?e[0]:0,i?i[0]:0],t[this]=[d.exec(r[0])[0],d.exec(r[1])[0]]}),1===b.length&&(b[1]=b[0]),"right"===t.at[0]?v.left+=p:"center"===t.at[0]&&(v.left+=p/2),"bottom"===t.at[1]?v.top+=m:"center"===t.at[1]&&(v.top+=m/2),o=i(x.at,p,m),v.left+=o[0],v.top+=o[1],this.each(function(){var n,h,c=e(this),u=c.outerWidth(),d=c.outerHeight(),f=r(this,"marginLeft"),E=r(this,"marginTop"),R=u+f+r(this,"marginRight")+_.width,w=d+E+r(this,"marginBottom")+_.height,H=e.extend({},v),M=i(x.my,c.outerWidth(),c.outerHeight());"right"===t.my[0]?H.left-=u:"center"===t.my[0]&&(H.left-=u/2),"bottom"===t.my[1]?H.top-=d:"center"===t.my[1]&&(H.top-=d/2),H.left+=M[0],H.top+=M[1],e.support.offsetFractions||(H.left=l(H.left),H.top=l(H.top)),n={marginLeft:f,marginTop:E},e.each(["left","top"],function(i,r){e.ui.position[b[i]]&&e.ui.position[b[i]][r](H,{targetWidth:p,targetHeight:m,elemWidth:u,elemHeight:d,collisionPosition:n,collisionWidth:R,collisionHeight:w,offset:[o[0]+M[0],o[1]+M[1]],my:t.my,at:t.at,within:T,elem:c})}),t.using&&(h=function(e){var i=g.left-H.left,r=i+p-u,n=g.top-H.top,o=n+m-d,l={target:{element:y,left:g.left,top:g.top,width:p,height:m},element:{element:c,left:H.left,top:H.top,width:u,height:d},horizontal:0>r?"left":i>0?"right":"center",vertical:0>o?"top":n>0?"bottom":"middle"};u>p&&s(i+r)<p&&(l.horizontal="center"),d>m&&s(n+o)<m&&(l.vertical="middle"),l.important=a(s(i),s(r))>a(s(n),s(o))?"horizontal":"vertical",t.using.call(this,e,l)}),c.offset(e.extend(H,{using:h}))})},e.ui.position={fit:{left:function(e,t){var i,r=t.within,n=r.isWindow?r.scrollLeft:r.offset.left,o=r.width,s=e.left-t.collisionPosition.marginLeft,l=n-s,h=s+t.collisionWidth-o-n;t.collisionWidth>o?l>0&&0>=h?(i=e.left+l+t.collisionWidth-o-n,e.left+=l-i):e.left=h>0&&0>=l?n:l>h?n+o-t.collisionWidth:n:l>0?e.left+=l:h>0?e.left-=h:e.left=a(e.left-s,e.left)},top:function(e,t){var i,r=t.within,n=r.isWindow?r.scrollTop:r.offset.top,o=t.within.height,s=e.top-t.collisionPosition.marginTop,l=n-s,h=s+t.collisionHeight-o-n;t.collisionHeight>o?l>0&&0>=h?(i=e.top+l+t.collisionHeight-o-n,e.top+=l-i):e.top=h>0&&0>=l?n:l>h?n+o-t.collisionHeight:n:l>0?e.top+=l:h>0?e.top-=h:e.top=a(e.top-s,e.top)}},flip:{left:function(e,t){var i,r,n=t.within,o=n.offset.left+n.scrollLeft,a=n.width,l=n.isWindow?n.scrollLeft:n.offset.left,h=e.left-t.collisionPosition.marginLeft,c=h-l,u=h+t.collisionWidth-a-l,d="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>c?(i=e.left+d+p+f+t.collisionWidth-a-o,(0>i||i<s(c))&&(e.left+=d+p+f)):u>0&&(r=e.left-t.collisionPosition.marginLeft+d+p+f-l,(r>0||s(r)<u)&&(e.left+=d+p+f))},top:function(e,t){var i,r,n=t.within,o=n.offset.top+n.scrollTop,a=n.height,l=n.isWindow?n.scrollTop:n.offset.top,h=e.top-t.collisionPosition.marginTop,c=h-l,u=h+t.collisionHeight-a-l,d="top"===t.my[1],p=d?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>c?(r=e.top+p+f+m+t.collisionHeight-a-o,e.top+p+f+m>c&&(0>r||r<s(c))&&(e.top+=p+f+m)):u>0&&(i=e.top-t.collisionPosition.marginTop+p+f+m-l,e.top+p+f+m>u&&(i>0||s(i)<u)&&(e.top+=p+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,r,n,o,a=document.getElementsByTagName("body")[0],s=document.createElement("div");t=document.createElement(a?"div":"body"),r={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},a&&e.extend(r,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in r)t.style[o]=r[o];t.appendChild(s),i=a||document.documentElement,i.insertBefore(t,i.firstChild),s.style.cssText="position: absolute; left: 10.7432222px;",n=e(s).offset().left,e.support.offsetFractions=n>10&&11>n,t.innerHTML="",i.removeChild(t)}()}(jQuery),function(e,t){e.widget("ui.progressbar",{version:"1.10.3",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return e===t?this.options.value:(this.options.value=this._constrainedValue(e),this._refreshValue(),void 0)},_constrainedValue:function(e){return e===t&&(e=this.options.value),this.indeterminate=e===!1,"number"!=typeof e&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}})}(jQuery),function(e){var t=5;e.widget("ui.slider",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,i,r=this.options,n=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),o="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",a=[];for(i=r.values&&r.values.length||1,n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),t=n.length;i>t;t++)a.push(o);this.handles=n.add(e(a.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,i="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):this.range=e([])},_setupEvents:function(){var e=this.handles.add(this.range).filter("a");this._off(e),this._on(e,this._handleEvents),this._hoverable(e),this._focusable(e)},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var i,r,n,o,a,s,l,h,c=this,u=this.options;return u.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:t.pageX,y:t.pageY},r=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var i=Math.abs(r-c.values(t));(n>i||n===i&&(t===c._lastChangedValue||c.values(t)===u.min))&&(n=i,o=e(this),a=t)}),s=this._start(t,a),s===!1?!1:(this._mouseSliding=!0,this._handleIndex=a,o.addClass("ui-state-active").focus(),l=o.offset(),h=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=h?{left:0,top:0}:{left:t.pageX-l.left-o.width()/2,top:t.pageY-l.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,a,r),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,i),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,r,n,o;return"horizontal"===this.orientation?(t=this.elementSize.width,i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),r=i/t,r>1&&(r=1),0>r&&(r=0),"vertical"===this.orientation&&(r=1-r),n=this._valueMax()-this._valueMin(),o=this._valueMin()+r*n,this._trimAlignValue(o)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("start",e,i)},_slide:function(e,t,i){var r,n,o;this.options.values&&this.options.values.length?(r=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&i>r||1===t&&r>i)&&(i=r),i!==this.values(t)&&(n=this.values(),n[t]=i,o=this._trigger("slide",e,{handle:this.handles[t],value:i,values:n}),r=this.values(t?0:1),o!==!1&&this.values(t,i,!0))):i!==this.value()&&(o=this._trigger("slide",e,{handle:this.handles[t],value:i}),o!==!1&&this.value(i))},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("stop",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,i)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(t,i){var r,n,o;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(i),this._refreshValue(),this._change(null,t),void 0;if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(r=this.options.values,n=arguments[0],o=0;o<r.length;o+=1)r[o]=this._trimAlignValue(n[o]),this._change(null,o);this._refreshValue()},_setOption:function(t,i){var r,n=0;switch("range"===t&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(n=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),r=0;n>r;r+=1)this._change(null,r);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,i,r;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),r=0;r<i.length;r+=1)i[r]=this._trimAlignValue(i[r]);return i}return[]},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,r=e-i;return 2*Math.abs(i)>=t&&(r+=i>0?t:-t),parseFloat(r.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,i,r,n,o,a=this.options.range,s=this.options,l=this,h=this._animateOff?!1:s.animate,c={};this.options.values&&this.options.values.length?this.handles.each(function(r){i=100*((l.values(r)-l._valueMin())/(l._valueMax()-l._valueMin())),c["horizontal"===l.orientation?"left":"bottom"]=i+"%",e(this).stop(1,1)[h?"animate":"css"](c,s.animate),l.options.range===!0&&("horizontal"===l.orientation?(0===r&&l.range.stop(1,1)[h?"animate":"css"]({left:i+"%"},s.animate),1===r&&l.range[h?"animate":"css"]({width:i-t+"%"},{queue:!1,duration:s.animate})):(0===r&&l.range.stop(1,1)[h?"animate":"css"]({bottom:i+"%"},s.animate),1===r&&l.range[h?"animate":"css"]({height:i-t+"%"},{queue:!1,duration:s.animate}))),t=i}):(r=this.value(),n=this._valueMin(),o=this._valueMax(),i=o!==n?100*((r-n)/(o-n)):0,c["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[h?"animate":"css"](c,s.animate),"min"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[h?"animate":"css"]({width:i+"%"},s.animate),"max"===a&&"horizontal"===this.orientation&&this.range[h?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:s.animate}),"min"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[h?"animate":"css"]({height:i+"%"},s.animate),"max"===a&&"vertical"===this.orientation&&this.range[h?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:s.animate}))},_handleEvents:{keydown:function(i){var r,n,o,a,s=e(i.target).data("ui-slider-handle-index");switch(i.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(i.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(i.target).addClass("ui-state-active"),r=this._start(i,s),r===!1))return}switch(a=this.options.step,n=o=this.options.values&&this.options.values.length?this.values(s):this.value(),i.keyCode){case e.ui.keyCode.HOME:o=this._valueMin();break;case e.ui.keyCode.END:o=this._valueMax();break;case e.ui.keyCode.PAGE_UP:o=this._trimAlignValue(n+(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.PAGE_DOWN:o=this._trimAlignValue(n-(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(n===this._valueMax())return;o=this._trimAlignValue(n+a);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(n===this._valueMin())return;o=this._trimAlignValue(n-a)}this._slide(i,s,o)},click:function(e){e.preventDefault()},keyup:function(t){var i=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,i),this._change(t,i),e(t.target).removeClass("ui-state-active"))}}})}(jQuery),function(e){function t(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")
}}e.widget("ui.spinner",{version:"1.10.3",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},i=this.element;return e.each(["min","max","step"],function(e,r){var n=i.attr(r);void 0!==n&&n.length&&(t[r]=n)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",e),void 0)},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(t){function i(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=r,this._delay(function(){this.previous=r}))}var r;r=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(t)!==!1&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return e(t.currentTarget).hasClass("ui-state-active")?this._start(t)===!1?!1:(this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t),void 0):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var i=this.options,r=e.ui.keyCode;switch(t.keyCode){case r.UP:return this._repeat(null,1,t),!0;case r.DOWN:return this._repeat(null,-1,t),!0;case r.PAGE_UP:return this._repeat(null,i.page,t),!0;case r.PAGE_DOWN:return this._repeat(null,-i.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>"},_start:function(e){return this.spinning||this._trigger("start",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,i){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,i)},e),this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+e*this._increment(this.counter)),this.spinning&&this._trigger("spin",t,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(t){var i=this.options.incremental;return i?e.isFunction(i)?i(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),i=t.indexOf(".");return-1===i?0:t.length-i-1},_adjustValue:function(e){var t,i,r=this.options;return t=null!==r.min?r.min:0,i=e-t,i=Math.round(i/r.step)*r.step,e=t+i,e=parseFloat(e.toFixed(this._precision())),null!==r.max&&e>r.max?r.max:null!==r.min&&e<r.min?r.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var i=this._parse(this.element.val());return this.options[e]=t,this.element.val(this._format(i)),void 0}("max"===e||"min"===e||"step"===e)&&"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(t?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:t(function(e){this._super(e),this._value(this.element.val())}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(e,t){var i;""!==e&&(i=this._parse(e),null!==i&&(t||(i=this._adjustValue(i)),e=this._format(i))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:t(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:t(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:t(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:t(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?(t(this._value).call(this,e),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})}(jQuery),function(e,t){function i(){return++n}function r(e){return e.hash.length>1&&decodeURIComponent(e.href.replace(o,""))===decodeURIComponent(location.href.replace(o,""))}var n=0,o=/#.*$/;e.widget("ui.tabs",{version:"1.10.3",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),i.active=this._initialActive(),e.isArray(i.disabled)&&(i.disabled=e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):e(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var t=this.options.active,i=this.options.collapsible,r=location.hash.substring(1);return null===t&&(r&&this.tabs.each(function(i,n){return e(n).attr("aria-controls")===r?(t=i,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=i?!1:0)),!i&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var i=e(this.document[0].activeElement).closest("li"),r=this.tabs.index(i),n=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:r++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:n=!1,r--;break;case e.ui.keyCode.END:r=this.anchors.length-1;break;case e.ui.keyCode.HOME:r=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),this._activate(r),void 0;case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),this._activate(r===this.options.active?!1:r),void 0;default:return}t.preventDefault(),clearTimeout(this.activating),r=this._focusNextTab(r,n),t.ctrlKey||(i.attr("aria-selected","false"),this.tabs.eq(r).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",r)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,i){function r(){return t>n&&(t=0),0>t&&(t=n),t}for(var n=this.tabs.length-1;-1!==e.inArray(r(),this.options.disabled);)t=i?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):"disabled"===e?(this._setupDisabled(t),void 0):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(t),"heightStyle"===e&&this._setupHeightStyle(t),void 0)},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+i()},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,i=this.tablist.children(":has(a[href])");t.disabled=e.map(i.filter(".ui-state-disabled"),function(e){return i.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(i,n){var o,a,s,l=e(n).uniqueId().attr("id"),h=e(n).closest("li"),c=h.attr("aria-controls");r(n)?(o=n.hash,a=t.element.find(t._sanitizeSelector(o))):(s=t._tabId(h),o="#"+s,a=t.element.find(o),a.length||(a=t._createPanel(s),a.insertAfter(t.panels[i-1]||t.tablist)),a.attr("aria-live","polite")),a.length&&(t.panels=t.panels.add(a)),c&&h.data("ui-tabs-aria-controls",c),h.attr({"aria-controls":o.substring(1),"aria-labelledby":l}),a.attr("aria-labelledby",l)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var i,r=0;i=this.tabs[r];r++)t===!0||-1!==e.inArray(r,t)?e(i).addClass("ui-state-disabled").attr("aria-disabled","true"):e(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var i={click:function(e){e.preventDefault()}};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,r=this.element.parent();"fill"===t?(i=r.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),r=t.css("position");"absolute"!==r&&"fixed"!==r&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.panels.each(function(){i=Math.max(i,e(this).height("").height())}).height(i))},_eventHandler:function(t){var i=this.options,r=this.active,n=e(t.currentTarget),o=n.closest("li"),a=o[0]===r[0],s=a&&i.collapsible,l=s?e():this._getPanelForTab(o),h=r.length?this._getPanelForTab(r):e(),c={oldTab:r,oldPanel:h,newTab:s?e():o,newPanel:l};t.preventDefault(),o.hasClass("ui-state-disabled")||o.hasClass("ui-tabs-loading")||this.running||a&&!i.collapsible||this._trigger("beforeActivate",t,c)===!1||(i.active=s?!1:this.tabs.index(o),this.active=a?e():o,this.xhr&&this.xhr.abort(),h.length||l.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),l.length&&this.load(this.tabs.index(o),t),this._toggle(t,c))},_toggle:function(t,i){function r(){o.running=!1,o._trigger("activate",t,i)}function n(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),a.length&&o.options.show?o._show(a,o.options.show,r):(a.show(),r())}var o=this,a=i.newPanel,s=i.oldPanel;this.running=!0,s.length&&this.options.hide?this._hide(s,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),s.hide(),n()),s.attr({"aria-expanded":"false","aria-hidden":"true"}),i.oldTab.attr("aria-selected","false"),a.length&&s.length?i.oldTab.attr("tabIndex",-1):a.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),a.attr({"aria-expanded":"true","aria-hidden":"false"}),i.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(t){var i,r=this._findActive(t);r[0]!==this.active[0]&&(r.length||(r=this.active),i=r.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),i=t.data("ui-tabs-aria-controls");i?t.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(i){var r=this.options.disabled;r!==!1&&(i===t?r=!1:(i=this._getIndex(i),r=e.isArray(r)?e.map(r,function(e){return e!==i?e:null}):e.map(this.tabs,function(e,t){return t!==i?t:null})),this._setupDisabled(r))},disable:function(i){var r=this.options.disabled;if(r!==!0){if(i===t)r=!0;else{if(i=this._getIndex(i),-1!==e.inArray(i,r))return;r=e.isArray(r)?e.merge([i],r).sort():[i]}this._setupDisabled(r)}},load:function(t,i){t=this._getIndex(t);var n=this,o=this.tabs.eq(t),a=o.find(".ui-tabs-anchor"),s=this._getPanelForTab(o),l={tab:o,panel:s};r(a[0])||(this.xhr=e.ajax(this._ajaxSettings(a,i,l)),this.xhr&&"canceled"!==this.xhr.statusText&&(o.addClass("ui-tabs-loading"),s.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){s.html(e),n._trigger("load",i,l)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&n.panels.stop(!1,!0),o.removeClass("ui-tabs-loading"),s.removeAttr("aria-busy"),e===n.xhr&&delete n.xhr},1)})))},_ajaxSettings:function(t,i,r){var n=this;return{url:t.attr("href"),beforeSend:function(t,o){return n._trigger("beforeLoad",i,e.extend({jqXHR:t,ajaxSettings:o},r))}}},_getPanelForTab:function(t){var i=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}})}(jQuery),function(e){function t(t,i){var r=(t.attr("aria-describedby")||"").split(/\s+/);r.push(i),t.data("ui-tooltip-id",i).attr("aria-describedby",e.trim(r.join(" ")))}function i(t){var i=t.data("ui-tooltip-id"),r=(t.attr("aria-describedby")||"").split(/\s+/),n=e.inArray(i,r);-1!==n&&r.splice(n,1),t.removeData("ui-tooltip-id"),r=e.trim(r.join(" ")),r?t.attr("aria-describedby",r):t.removeAttr("aria-describedby")}var r=0;e.widget("ui.tooltip",{version:"1.10.3",options:{content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(t,i){var r=this;return"disabled"===t?(this[i?"_disable":"_enable"](),this.options[t]=i,void 0):(this._super(t,i),"content"===t&&e.each(this.tooltips,function(e,t){r._updateContent(t)}),void 0)},_disable:function(){var t=this;e.each(this.tooltips,function(i,r){var n=e.Event("blur");n.target=n.currentTarget=r[0],t.close(n,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var i=this,r=e(t?t.target:this.element).closest(this.options.items);r.length&&!r.data("ui-tooltip-id")&&(r.attr("title")&&r.data("ui-tooltip-title",r.attr("title")),r.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&r.parents().each(function(){var t,r=e(this);r.data("ui-tooltip-open")&&(t=e.Event("blur"),t.target=t.currentTarget=this,i.close(t,!0)),r.attr("title")&&(r.uniqueId(),i.parents[this.id]={element:this,title:r.attr("title")},r.attr("title",""))}),this._updateContent(r,t))},_updateContent:function(e,t){var i,r=this.options.content,n=this,o=t?t.type:null;return"string"==typeof r?this._open(t,e,r):(i=r.call(e[0],function(i){e.data("ui-tooltip-open")&&n._delay(function(){t&&(t.type=o),this._open(t,e,i)})}),i&&this._open(t,e,i),void 0)},_open:function(i,r,n){function o(e){h.of=e,a.is(":hidden")||a.position(h)}var a,s,l,h=e.extend({},this.options.position);if(n){if(a=this._find(r),a.length)return a.find(".ui-tooltip-content").html(n),void 0;r.is("[title]")&&(i&&"mouseover"===i.type?r.attr("title",""):r.removeAttr("title")),a=this._tooltip(r),t(r,a.attr("id")),a.find(".ui-tooltip-content").html(n),this.options.track&&i&&/^mouse/.test(i.type)?(this._on(this.document,{mousemove:o}),o(i)):a.position(e.extend({of:r},this.options.position)),a.hide(),this._show(a,this.options.show),this.options.show&&this.options.show.delay&&(l=this.delayedShow=setInterval(function(){a.is(":visible")&&(o(h.of),clearInterval(l))},e.fx.interval)),this._trigger("open",i,{tooltip:a}),s={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var i=e.Event(t);i.currentTarget=r[0],this.close(i,!0)}},remove:function(){this._removeTooltip(a)}},i&&"mouseover"!==i.type||(s.mouseleave="close"),i&&"focusin"!==i.type||(s.focusout="close"),this._on(!0,r,s)}},close:function(t){var r=this,n=e(t?t.currentTarget:this.element),o=this._find(n);this.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&n.attr("title",n.data("ui-tooltip-title")),i(n),o.stop(!0),this._hide(o,this.options.hide,function(){r._removeTooltip(e(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,function(t,i){e(i.element).attr("title",i.title),delete r.parents[t]}),this.closing=!0,this._trigger("close",t,{tooltip:o}),this.closing=!1)},_tooltip:function(t){var i="ui-tooltip-"+r++,n=e("<div>").attr({id:i,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return e("<div>").addClass("ui-tooltip-content").appendTo(n),n.appendTo(this.document[0].body),this.tooltips[i]=t,n},_find:function(t){var i=t.data("ui-tooltip-id");return i?e("#"+i):e()},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(i,r){var n=e.Event("blur");n.target=n.currentTarget=r[0],t.close(n,!0),e("#"+i).remove(),r.data("ui-tooltip-title")&&(r.attr("title",r.data("ui-tooltip-title")),r.removeData("ui-tooltip-title"))})}})}(jQuery),define("libs/jquery-ui",function(){}),define("text",["module"],function(e){var t,i,r,n,o,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,h="undefined"!=typeof location&&location.href,c=h&&location.protocol&&location.protocol.replace(/\:/,""),u=h&&location.hostname,d=h&&(location.port||void 0),p={},f=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(s,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){i=a[t];try{e=new ActiveXObject(i)}catch(r){}if(e){a=[i];break}}return e},parseName:function(e){var t,i,r,n=!1,o=e.indexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!a||o>1)?(t=e.substring(0,o),i=e.substring(o+1,e.length)):t=e,r=i||t,o=r.indexOf("!"),-1!==o&&(n="strip"===r.substring(o+1),r=r.substring(0,o),i?i=r:t=r),{moduleName:t,ext:i,strip:n}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,i,r,n){var o,a,s,l=t.xdRegExp.exec(e);return l?(o=l[2],a=l[3],a=a.split(":"),s=a[1],a=a[0],!(o&&o!==i||a&&a.toLowerCase()!==r.toLowerCase()||(s||a)&&s!==n)):!0},finishLoad:function(e,i,r,n){r=i?t.strip(r):r,f.isBuild&&(p[e]=r),n(r)},load:function(e,i,r,n){if(n.isBuild&&!n.inlineText)return r(),void 0;f.isBuild=n.isBuild;var o=t.parseName(e),a=o.moduleName+(o.ext?"."+o.ext:""),s=i.toUrl(a),l=f.useXhr||t.useXhr;return 0===s.indexOf("empty:")?(r(),void 0):(!h||l(s,c,u,d)?t.get(s,function(i){t.finishLoad(e,o.strip,i,r)},function(e){r.error&&r.error(e)}):i([a],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,r)}),void 0)},write:function(e,i,r){if(p.hasOwnProperty(i)){var n=t.jsEscape(p[i]);r.asModule(e+"!"+i,"define(function () { return '"+n+"';});\n")}},writeFile:function(e,i,r,n,o){var a=t.parseName(i),s=a.ext?"."+a.ext:"",l=a.moduleName+s,h=r.toUrl(a.moduleName+s)+".js";t.load(l,r,function(){var i=function(e){return n(h,e)};i.asModule=function(e,t){return n.asModule(e,h,t)},t.write(e,l,i,o)},o)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(i=require.nodeRequire("fs"),t.get=function(e,t,r){try{var n=i.readFileSync(e,"utf8");0===n.indexOf("")&&(n=n.substring(1)),t(n)}catch(o){r(o)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,i,r,n){var o,a=t.createXhr();if(a.open("GET",e,!0),n)for(o in n)n.hasOwnProperty(o)&&a.setRequestHeader(o.toLowerCase(),n[o]);f.onXhr&&f.onXhr(a,e),a.onreadystatechange=function(){var t,n;4===a.readyState&&(t=a.status,t>399&&600>t?(n=new Error(e+" HTTP status: "+t),n.xhr=a,r(n)):i(a.responseText),f.onXhrComplete&&f.onXhrComplete(a,e))},a.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var i,r,n="utf-8",o=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),n)),l="";try{for(i=new java.lang.StringBuffer,r=s.readLine(),r&&r.length()&&65279===r.charAt(0)&&(r=r.substring(1)),null!==r&&i.append(r);null!==(r=s.readLine());)i.append(a),i.append(r);l=String(i.toString())}finally{s.close()}t(l)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(r=Components.classes,n=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var i,a,s,l={};o&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{i=r["@mozilla.org/network/file-input-stream;1"].createInstance(n.nsIFileInputStream),i.init(s,1,0,!1),a=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(n.nsIConverterInputStream),a.init(i,"utf-8",i.available(),n.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(i.available(),l),a.close(),i.close(),t(l.value)}catch(h){throw new Error((s&&s.path||"")+": "+h)}}),t}),define("glsl",["text"],function(){function e(e){for(var t="",i="",r=e.split("\n"),n="",o=0;o<r.length;o++)if(r[o].indexOf("//#")>-1)r[o].indexOf("Fragment")>-1&&(t=n,n="");else{var a=r[o];a.indexOf("//")>-1&&(a=a.substring(0,a.indexOf("//"))),-1===a.indexOf(";")&&(a+="\n"),n+=a}return i=n,{fragmentShader:"#ifdef GL_ES\nprecision highp float;\n#endif\n"+i,vertexShader:t}}var t={load:function(t,i,r,n){i(["template!"+t],function(t){return n.isBuild?(r(t),void 0):(r(e(t)),void 0)})}};return t}),define("template",["text"],function(e){function t(e,t,i){var r=i.match(/\{\{(.+?)\}\}/g);if(null===r)return null;for(var n=r.slice(0),o=n.length,a=0;o>a;)n[a]="template!"+t+n[a].replace(/\s/g,"").replace(/\{\{/g,"").replace(/\}\}/g,""),a++;return{modules:n,matches:r}}var i=[],r={write:function(e,t,n){if(i.hasOwnProperty(t)){var o=r.jsEscape(i[t]);n.asModule(e+"!"+t,"define(function () { return '"+o+"';});\n")}},load:function(r,n,o,a){e.get(n.toUrl(r),function(e){var s=r.split("/");s=s.slice(0,s.length-1).join("/")+"/";var l=t(n,s,e);return l?(n(l.modules,function(){for(var t=l.matches.length;t-->0;)e=e.split(l.matches[t]).join(arguments[t]);a.isBuild&&(i[s]=e),o(e)}),void 0):(a.isBuild&&(i[s]=e),o(e),void 0)})}};return r}),define("utils/math",[],function(){const e=Math.cos,t=2*Math.PI,i=.5*Math.PI,r=Math.PI/180,n=180/Math.PI,o=1e-5;var a={PI2:t,HALF_PI:i,DEG2RAD:r,RAD2DEG:n,EPS:o,lerp:function(e,t,i){return t*(1-e)+i*e},cosineInterpolation:function(t,i,r){var n=.5*(1-e(t*Math.PI));return i*(1-n)+r*n},map:function(e,t,i,r,n){return r+(e-t)*(n-r)/(i-t)},normalize:function(e,t,i){return a.map(e,t,i,0,1)},clamp:function(e,t,i){return t>e?t:e>i?i:e},random:function(e,t){return void 0===t?Math.random()*e:Math.random()*(t-e)+e}};return a}),define("utils/shader",[],function(){function e(e,n,o,a){function s(t,i){e=t,n=i,l.style.width=t+"px",l.style.height=i+"px",l.width=t*h,l.height=i*h,c.uniform2f(p.uResolution,t*h,i*h),c.viewport(0,0,e,n)}var l=document.createElement("canvas"),h=1,c=l.getContext("experimental-webgl",{alpha:!0,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:a||!1}),u=c.createShader(c.VERTEX_SHADER),d=c.createShader(c.FRAGMENT_SHADER),p=c.createProgram();if(c.clearColor(0,0,0,0),c.disable(c.DEPTH_TEST),c.shaderSource(u,i),c.compileShader(u),c.shaderSource(d,t+o),c.compileShader(d),!c.getShaderParameter(d,c.COMPILE_STATUS))return console.error("You fucked up... "+c.getShaderInfoLog(d)),null;c.attachShader(p,u),c.attachShader(p,d),c.linkProgram(p),c.useProgram(p),p.aVertex=c.getAttribLocation(p,"aVertex"),p.uResolution=c.getUniformLocation(p,"uResolution"),p.uTime=c.getUniformLocation(p,"uTime");var f=c.createBuffer();return c.bindBuffer(c.ARRAY_BUFFER,f),c.bufferData(c.ARRAY_BUFFER,r,c.STATIC_DRAW),c.vertexAttribPointer(p.aVertex,2,c.FLOAT,!1,0,0),c.enableVertexAttribArray(p.aVertex),{draw:function(t){c.viewport(0,0,e,n),c.uniform1fv(p.uTime,[t||0]),c.drawArrays(c.TRIANGLES,0,6)},size:s,gl:c,getUniformLocation:function(e){return c.getUniformLocation(p,e)},uniformFloat:function(e,t){c.uniform1fv(e,[t])},domElement:l}}var t="#ifdef GL_ES\nprecision highp float;\n#endif\n",i=["attribute highp vec2 aVertex;","void main(void) {","gl_Position = vec4( aVertex, 1.0, 1.0);","}"].join("\n"),r=new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]);return new Uint16Array([0,1,3,3,1,2]),{create:e}}),define("utils/noise",["./shader"],function(e){var t=e.create(100,100,["vec4 encodeFloat(float v)","{","vec4 c = vec4(0.0, 0.0, 0.0, 0.0);","if (v < 0.0) {","c[0] += 64.0;","v = -v;","}","float f = 0.0;","float e = ceil(log2(v));","float m = v * exp2(-e);","if (e < 0.0) {","e = -e;","c[0] += 128.0;","}","c[0] += e;","m *= 255.0;","f = floor(m);","c[1] = f;","m  -= f;","m *= 255.0;","f = floor(m);","c[2] = f;","m  -= f;","m *= 255.0;","c[3] = floor(m);","return c * 3.921569E-03;","}","vec4 mod289(vec4 x) {return x - floor(x * (1.0 / 289.0)) * 289.0; }","float mod289(float x) {return x - floor(x * (1.0 / 289.0)) * 289.0; }","vec4 permute(vec4 x) {return mod289(((x*34.0)+1.0)*x); }","float permute(float x) {return mod289(((x*34.0)+1.0)*x); }","vec4 taylorInvSqrt(vec4 r) {return 1.79284291400159 - 0.85373472095314 * r; }","float taylorInvSqrt(float r) {return 1.79284291400159 - 0.85373472095314 * r; }","vec4 grad4(float j, vec4 ip) {const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0); vec4 p,s; p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0; p.w = 1.5 - dot(abs(p.xyz), ones.xyz); s = vec4(lessThan(p, vec4(0.0))); p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www; return p; }","#define F4 0.309016994374947451","float snoise(vec4 v) {const vec4  C = vec4( 0.138196601125011, 0.276393202250021, 0.414589803375032, -0.447213595499958); vec4 i  = floor(v + dot(v, vec4(F4)) ); vec4 x0 = v -   i + dot(i, C.xxxx); vec4 i0; vec3 isX = step( x0.yzw, x0.xxx ); vec3 isYZ = step( x0.zww, x0.yyz ); i0.x = isX.x + isX.y + isX.z; i0.yzw = 1.0 - isX; i0.y += isYZ.x + isYZ.y; i0.zw += 1.0 - isYZ.xy; i0.z += isYZ.z; i0.w += 1.0 - isYZ.z; vec4 i3 = clamp( i0, 0.0, 1.0 ); vec4 i2 = clamp( i0-1.0, 0.0, 1.0 ); vec4 i1 = clamp( i0-2.0, 0.0, 1.0 ); vec4 x1 = x0 - i1 + C.xxxx; vec4 x2 = x0 - i2 + C.yyyy; vec4 x3 = x0 - i3 + C.zzzz; vec4 x4 = x0 + C.wwww; i = mod289(i); float j0 = permute( permute( permute( permute(i.w) + i.z) + i.y) + i.x); vec4 j1 = permute( permute( permute( permute (i.w + vec4(i1.w, i2.w, i3.w, 1.0 )) + i.z + vec4(i1.z, i2.z, i3.z, 1.0 )) + i.y + vec4(i1.y, i2.y, i3.y, 1.0 )) + i.x + vec4(i1.x, i2.x, i3.x, 1.0 )); vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ; vec4 p0 = grad4(j0,   ip); vec4 p1 = grad4(j1.x, ip); vec4 p2 = grad4(j1.y, ip); vec4 p3 = grad4(j1.z, ip); vec4 p4 = grad4(j1.w, ip); vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3))); p0 *= norm.x; p1 *= norm.y; p2 *= norm.z; p3 *= norm.w; p4 *= taylorInvSqrt(dot(p4,p4)); vec3 m0 = max(0.6 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0); vec2 m1 = max(0.6 - vec2(dot(x3,x3), dot(x4,x4)            ), 0.0); m0 = m0 * m0; m1 = m1 * m1; return 49.0 * ( dot(m0*m0, vec3( dot( p0, x0 ), dot( p1, x1 ), dot( p2, x2 ))) + dot(m1*m1, vec2( dot( p3, x3 ), dot( p4, x4 ) ) ) ) ; }","uniform vec2 uResolution;","uniform float uFrequency;","uniform float uOffset;","uniform float uDivisor;","uniform float uTime;","uniform float uComplexity;","float fbm( vec3 p ){","return snoise( vec4( p * uFrequency , uTime )) + ( snoise( vec4( p * uFrequency * 2.0, uTime )) * 0.5 );","}","float volume( vec3 p ){","vec3 q = vec3( fbm( p * 2.0  + vec3(0.0, 0.0, 0.0 )),","fbm( p * 2.0 + vec3(0.2, -2.0, 0.1 )),","fbm( p * 2.0 + vec3(0.2, 0.3, 0.2 )));","return fbm( p + uComplexity * q );","}","void main(void) {","vec3 origin = vec3( 0.5 );","vec2 uv = gl_FragCoord.xy / uResolution.xy * uDivisor;","vec2 tile = floor( uv );","float z = tile.y * uDivisor + tile.x;","vec2 m = fract( uv );","z /= pow( uDivisor, 2.0 );","float noise = volume( vec3( m, z ));","float d = 1.0 - length( origin - vec3( m, z ));","gl_FragColor = vec4( vec3( d * 0.4 + noise * d * 1.9) , 1.0 );","}"].join("\n"),!0),i=(t.getUniformLocation("uOffset"),t.getUniformLocation("uDivisor")),r=t.getUniformLocation("uComplexity"),n=t.getUniformLocation("uFrequency");
return document.body.appendChild(t.domElement),t.domElement.style.display="none",{noise3D:function(e,o,a,s,l,h){var c=Math.ceil(Math.sqrt(a)),a=Math.pow(c,2);size=4*e*o*a,volume=new Uint8Array(size),s=s||1,h|=Math.random(),t.uniformFloat(i,c),t.uniformFloat(n,s),t.uniformFloat(r,l),t.size(e*c,o*c),t.draw(h),t.gl.readPixels(0,0,e*c,o*c,t.gl.RGBA,t.gl.UNSIGNED_BYTE,volume);var u=function(t,i,r){var n=Math.floor(r/c)*c*e*o,a=r%c*e,s=a+n,l=i*c*e;return volume[4*(s+l+t)]/256};return u.volume=volume,u}}});var THREE=THREE||{REVISION:"59"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}},String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},THREE.extend=function(e,t){if(Object.keys)for(var i=Object.keys(t),r=0,n=i.length;n>r;r++){var o=i[r];Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))}else{var a={}.hasOwnProperty;for(var o in t)a.call(t,o)&&(e[o]=t[o])}return e},function(){for(var e=0,t=["ms","moz","webkit","o"],i=0;i<t.length&&!self.requestAnimationFrame;++i)self.requestAnimationFrame=self[t[i]+"RequestAnimationFrame"],self.cancelAnimationFrame=self[t[i]+"CancelAnimationFrame"]||self[t[i]+"CancelRequestAnimationFrame"];void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(t){var i=Date.now(),r=Math.max(0,16-(i-e)),n=self.setTimeout(function(){t(i+r)},r);return e=i+r,n}),void 0===self.cancelAnimationFrame&&void 0!==self.clearTimeout&&(self.cancelAnimationFrame=function(e){self.clearTimeout(e)})}(),THREE.CullFaceNone=0,THREE.CullFaceBack=1,THREE.CullFaceFront=2,THREE.CullFaceFrontBack=3,THREE.FrontFaceDirectionCW=0,THREE.FrontFaceDirectionCCW=1,THREE.BasicShadowMap=0,THREE.PCFShadowMap=1,THREE.PCFSoftShadowMap=2,THREE.FrontSide=0,THREE.BackSide=1,THREE.DoubleSide=2,THREE.NoShading=0,THREE.FlatShading=1,THREE.SmoothShading=2,THREE.NoColors=0,THREE.FaceColors=1,THREE.VertexColors=2,THREE.NoBlending=0,THREE.NormalBlending=1,THREE.AdditiveBlending=2,THREE.SubtractiveBlending=3,THREE.MultiplyBlending=4,THREE.CustomBlending=5,THREE.AddEquation=100,THREE.SubtractEquation=101,THREE.ReverseSubtractEquation=102,THREE.ZeroFactor=200,THREE.OneFactor=201,THREE.SrcColorFactor=202,THREE.OneMinusSrcColorFactor=203,THREE.SrcAlphaFactor=204,THREE.OneMinusSrcAlphaFactor=205,THREE.DstAlphaFactor=206,THREE.OneMinusDstAlphaFactor=207,THREE.DstColorFactor=208,THREE.OneMinusDstColorFactor=209,THREE.SrcAlphaSaturateFactor=210,THREE.MultiplyOperation=0,THREE.MixOperation=1,THREE.AddOperation=2,THREE.UVMapping=function(){},THREE.CubeReflectionMapping=function(){},THREE.CubeRefractionMapping=function(){},THREE.SphericalReflectionMapping=function(){},THREE.SphericalRefractionMapping=function(){},THREE.RepeatWrapping=1e3,THREE.ClampToEdgeWrapping=1001,THREE.MirroredRepeatWrapping=1002,THREE.NearestFilter=1003,THREE.NearestMipMapNearestFilter=1004,THREE.NearestMipMapLinearFilter=1005,THREE.LinearFilter=1006,THREE.LinearMipMapNearestFilter=1007,THREE.LinearMipMapLinearFilter=1008,THREE.UnsignedByteType=1009,THREE.ByteType=1010,THREE.ShortType=1011,THREE.UnsignedShortType=1012,THREE.IntType=1013,THREE.UnsignedIntType=1014,THREE.FloatType=1015,THREE.UnsignedShort4444Type=1016,THREE.UnsignedShort5551Type=1017,THREE.UnsignedShort565Type=1018,THREE.AlphaFormat=1019,THREE.RGBFormat=1020,THREE.RGBAFormat=1021,THREE.LuminanceFormat=1022,THREE.LuminanceAlphaFormat=1023,THREE.RGB_S3TC_DXT1_Format=2001,THREE.RGBA_S3TC_DXT1_Format=2002,THREE.RGBA_S3TC_DXT3_Format=2003,THREE.RGBA_S3TC_DXT5_Format=2004,THREE.Color=function(e){return void 0!==e&&this.set(e),this},THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(e){return e instanceof THREE.Color?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setHex:function(e){return e=Math.floor(e),this.r=(255&e>>16)/255,this.g=(255&e>>8)/255,this.b=(255&e)/255,this},setRGB:function(e,t,i){return this.r=e,this.g=t,this.b=i,this},setHSL:function(e,t,i){if(0===t)this.r=this.g=this.b=i;else{var r=function(e,t,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?e+6*(t-e)*i:.5>i?t:2/3>i?e+6*(t-e)*(2/3-i):e},n=.5>=i?i*(1+t):i+t-i*t,o=2*i-n;this.r=r(o,n,e+1/3),this.g=r(o,n,e),this.b=r(o,n,e-1/3)}return this},setStyle:function(e){if(/^rgb\((\d+),(\d+),(\d+)\)$/i.test(e)){var t=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(e);return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,this}if(/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(e)){var t=/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(e);return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,this}if(/^\#([0-9a-f]{6})$/i.test(e)){var t=/^\#([0-9a-f]{6})$/i.exec(e);return this.setHex(parseInt(t[1],16)),this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(e)){var t=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e);return this.setHex(parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3],16)),this}return/^(\w+)$/i.test(e)?(this.setHex(THREE.ColorKeywords[e]),this):void 0},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e){return this.r=e.r*e.r,this.g=e.g*e.g,this.b=e.b*e.b,this},copyLinearToGamma:function(e){return this.r=Math.sqrt(e.r),this.g=Math.sqrt(e.g),this.b=Math.sqrt(e.b),this},convertGammaToLinear:function(){var e=this.r,t=this.g,i=this.b;return this.r=e*e,this.g=t*t,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(){var e={h:0,s:0,l:0};return function(){var t,i,r=this.r,n=this.g,o=this.b,a=Math.max(r,n,o),s=Math.min(r,n,o),l=(s+a)/2;if(s===a)t=0,i=0;else{var h=a-s;switch(i=.5>=l?h/(a+s):h/(2-a-s),a){case r:t=(n-o)/h+(o>n?6:0);break;case n:t=(o-r)/h+2;break;case o:t=(r-n)/h+4}t/=6}return e.h=t,e.s=i,e.l=l,e}}(),getStyle:function(){return"rgb("+(0|255*this.r)+","+(0|255*this.g)+","+(0|255*this.b)+")"},offsetHSL:function(e,t,i){var r=this.getHSL();return r.h+=e,r.s+=t,r.l+=i,this.setHSL(r.h,r.s,r.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}},THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},THREE.Quaternion=function(e,t,i,r){this._x=e||0,this._y=t||0,this._z=i||0,this._w=void 0!==r?r:1},THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,_euler:void 0,_updateEuler:function(){void 0!==this._euler&&this._euler.setFromQuaternion(this,void 0,!1)},get x(){return this._x},set x(e){this._x=e,this._updateEuler()},get y(){return this._y},set y(e){this._y=e,this._updateEuler()},get z(){return this._z},set z(e){this._z=e,this._updateEuler()},get w(){return this._w},set w(e){this._w=e,this._updateEuler()},set:function(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._updateEuler(),this},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._w=e._w,this._updateEuler(),this},setFromEuler:function(e,t){void 0===typeof e.order&&console.error("ERROR: Quaternion's .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var i=Math.cos(e._x/2),r=Math.cos(e._y/2),n=Math.cos(e._z/2),o=Math.sin(e._x/2),a=Math.sin(e._y/2),s=Math.sin(e._z/2);return void 0===e.order||"XYZ"===e.order?(this._x=o*r*n+i*a*s,this._y=i*a*n-o*r*s,this._z=i*r*s+o*a*n,this._w=i*r*n-o*a*s):"YXZ"===e.order?(this._x=o*r*n+i*a*s,this._y=i*a*n-o*r*s,this._z=i*r*s-o*a*n,this._w=i*r*n+o*a*s):"ZXY"===e.order?(this._x=o*r*n-i*a*s,this._y=i*a*n+o*r*s,this._z=i*r*s+o*a*n,this._w=i*r*n-o*a*s):"ZYX"===e.order?(this._x=o*r*n-i*a*s,this._y=i*a*n+o*r*s,this._z=i*r*s-o*a*n,this._w=i*r*n+o*a*s):"YZX"===e.order?(this._x=o*r*n+i*a*s,this._y=i*a*n+o*r*s,this._z=i*r*s-o*a*n,this._w=i*r*n-o*a*s):"XZY"===e.order&&(this._x=o*r*n-i*a*s,this._y=i*a*n-o*r*s,this._z=i*r*s+o*a*n,this._w=i*r*n+o*a*s),t!==!1&&this._updateEuler(),this},setFromAxisAngle:function(e,t){var i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._updateEuler(),this},setFromRotationMatrix:function(e){var t,i=e.elements,r=i[0],n=i[4],o=i[8],a=i[1],s=i[5],l=i[9],h=i[2],c=i[6],u=i[10],d=r+s+u;return d>0?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(c-l)*t,this._y=(o-h)*t,this._z=(a-n)*t):r>s&&r>u?(t=2*Math.sqrt(1+r-s-u),this._w=(c-l)/t,this._x=.25*t,this._y=(n+a)/t,this._z=(o+h)/t):s>u?(t=2*Math.sqrt(1+s-r-u),this._w=(o-h)/t,this._x=(n+a)/t,this._y=.25*t,this._z=(l+c)/t):(t=2*Math.sqrt(1+u-r-s),this._w=(a-n)/t,this._x=(o+h)/t,this._y=(l+c)/t,this._z=.25*t),this._updateEuler(),this},inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._updateEuler(),this},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this},multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var i=e._x,r=e._y,n=e._z,o=e._w,a=t._x,s=t._y,l=t._z,h=t._w;return this._x=i*h+o*a+r*l-n*s,this._y=r*h+o*s+n*a-i*l,this._z=n*h+o*l+i*s-r*a,this._w=o*h-i*a-r*s-n*l,this._updateEuler(),this},multiplyVector3:function(e){return console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},slerp:function(e,t){var i=this._x,r=this._y,n=this._z,o=this._w,a=o*e._w+i*e._x+r*e._y+n*e._z;if(0>a?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=n,this;var s=Math.acos(a),l=Math.sqrt(1-a*a);if(Math.abs(l)<.001)return this._w=.5*(o+this._w),this._x=.5*(i+this._x),this._y=.5*(r+this._y),this._z=.5*(n+this._z),this;var h=Math.sin((1-t)*s)/l,c=Math.sin(t*s)/l;return this._w=o*h+this._w*c,this._x=i*h+this._x*c,this._y=r*h+this._y*c,this._z=n*h+this._z*c,this._updateEuler(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],this._w=e[3],this._updateEuler(),this},toArray:function(){return[this._x,this._y,this._z,this._w]},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}},THREE.Quaternion.slerp=function(e,t,i,r){return i.copy(e).slerp(t,r)},THREE.Vector2=function(e,t){this.x=e||0,this.y=t||0},THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(e,t){return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScalar:function(e){return this.x+=e,this.y+=e,this},sub:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t}else this.x=0,this.y=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e){return this.x=e[0],this.y=e[1],this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}},THREE.Vector3=function(e,t,i){this.x=e||0,this.y=t||0,this.z=i||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(e,t,i){return this.x=e,this.y=t,this.z=i,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},sub:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyMatrix3:function(e){var t=this.x,i=this.y,r=this.z,n=e.elements;return this.x=n[0]*t+n[3]*i+n[6]*r,this.y=n[1]*t+n[4]*i+n[7]*r,this.z=n[2]*t+n[5]*i+n[8]*r,this},applyMatrix4:function(e){var t=this.x,i=this.y,r=this.z,n=e.elements;return this.x=n[0]*t+n[4]*i+n[8]*r+n[12],this.y=n[1]*t+n[5]*i+n[9]*r+n[13],this.z=n[2]*t+n[6]*i+n[10]*r+n[14],this},applyProjection:function(e){var t=this.x,i=this.y,r=this.z,n=e.elements,o=1/(n[3]*t+n[7]*i+n[11]*r+n[15]);return this.x=(n[0]*t+n[4]*i+n[8]*r+n[12])*o,this.y=(n[1]*t+n[5]*i+n[9]*r+n[13])*o,this.z=(n[2]*t+n[6]*i+n[10]*r+n[14])*o,this},applyQuaternion:function(e){var t=this.x,i=this.y,r=this.z,n=e.x,o=e.y,a=e.z,s=e.w,l=s*t+o*r-a*i,h=s*i+a*t-n*r,c=s*r+n*i-o*t,u=-n*t-o*i-a*r;return this.x=l*s+u*-n+h*-a-c*-o,this.y=h*s+u*-o+c*-n-l*-a,this.z=c*s+u*-a+l*-o-h*-n,this},transformDirection:function(e){var t=this.x,i=this.y,r=this.z,n=e.elements;return this.x=n[0]*t+n[4]*i+n[8]*r,this.y=n[1]*t+n[5]*i+n[9]*r,this.z=n[2]*t+n[6]*i+n[10]*r,this.normalize(),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},cross:function(e,t){if(void 0!==t)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var i=this.x,r=this.y,n=this.z;return this.x=r*e.z-n*e.y,this.y=n*e.x-i*e.z,this.z=i*e.y-r*e.x,this},crossVectors:function(e,t){return this.x=e.y*t.z-e.z*t.y,this.y=e.z*t.x-e.x*t.z,this.z=e.x*t.y-e.y*t.x,this},angleTo:function(e){var t=this.dot(e)/(this.length()*e.length());return Math.acos(THREE.Math.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r},setEulerFromRotationMatrix:function(){console.error("REMOVED: Vector3's setEulerFromRotationMatrix has been removed in favor of Euler.setFromRotationMatrix(), please update your code.")},setEulerFromQuaternion:function(){console.error("REMOVED: Vector3's setEulerFromQuaternion: has been removed in favor of Euler.setFromQuaternion(), please update your code.")},getPositionFromMatrix:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},getScaleFromMatrix:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),i=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),r=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=i,this.z=r,this},getColumnFromMatrix:function(e,t){var i=4*e,r=t.elements;return this.x=r[i],this.y=r[i+1],this.z=r[i+2],this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}},THREE.extend(THREE.Vector3.prototype,{applyEuler:function(){var e=new THREE.Quaternion;return function(t){void 0===typeof t.order&&console.error("ERROR: Vector3's .applyEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var i=e.setFromEuler(t);return this.applyQuaternion(i),this}}(),applyAxisAngle:function(){var e=new THREE.Quaternion;return function(t,i){var r=e.setFromAxisAngle(t,i);return this.applyQuaternion(r),this}}(),projectOnVector:function(){var e=new THREE.Vector3;return function(t){e.copy(t).normalize();var i=this.dot(e);return this.copy(e).multiplyScalar(i)}}(),projectOnPlane:function(){var e=new THREE.Vector3;return function(t){return e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=new THREE.Vector3;return function(t){return e.copy(this).projectOnVector(t).multiplyScalar(2),this.subVectors(e,this)}}()}),THREE.Vector4=function(e,t,i,r){this.x=e||0,this.y=t||0,this.z=i||0,this.w=void 0!==r?r:1},THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},sub:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,i=this.y,r=this.z,n=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*n,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*n,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*n,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*n,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t,this.w*=t}else this.x=0,this.y=0,this.z=0,this.w=1;return this},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return 1e-4>t?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,i,r,n,o=.01,a=.1,s=e.elements,l=s[0],h=s[4],c=s[8],u=s[1],d=s[5],p=s[9],f=s[2],m=s[6],g=s[10];if(Math.abs(h-u)<o&&Math.abs(c-f)<o&&Math.abs(p-m)<o){if(Math.abs(h+u)<a&&Math.abs(c+f)<a&&Math.abs(p+m)<a&&Math.abs(l+d+g-3)<a)return this.set(1,0,0,0),this;t=Math.PI;var v=(l+1)/2,E=(d+1)/2,y=(g+1)/2,T=(h+u)/4,_=(c+f)/4,b=(p+m)/4;return v>E&&v>y?o>v?(i=0,r=.707106781,n=.707106781):(i=Math.sqrt(v),r=T/i,n=_/i):E>y?o>E?(i=.707106781,r=0,n=.707106781):(r=Math.sqrt(E),i=T/r,n=b/r):o>y?(i=.707106781,r=.707106781,n=0):(n=Math.sqrt(y),i=_/n,r=b/n),this.set(i,r,n,t),this}var x=Math.sqrt((m-p)*(m-p)+(c-f)*(c-f)+(u-h)*(u-h));return Math.abs(x)<.001&&(x=1),this.x=(m-p)/x,this.y=(c-f)/x,this.z=(u-h)/x,this.w=Math.acos((l+d+g-1)/2),this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this.w>e.w&&(this.w=e.w),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this.w<e.w&&(this.w=e.w),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this.w<e.w?this.w=e.w:this.w>t.w&&(this.w=t.w),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this.w=e[3],this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}},THREE.Euler=function(e,t,i,r){this._x=e||0,this._y=t||0,this._z=i||0,this._order=r||THREE.Euler.DefaultOrder},THREE.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],THREE.Euler.DefaultOrder="XYZ",THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,_quaternion:void 0,_updateQuaternion:function(){void 0!==this._quaternion&&this._quaternion.setFromEuler(this,!1)},get x(){return this._x},set x(e){this._x=e,this._updateQuaternion()},get y(){return this._y},set y(e){this._y=e,this._updateQuaternion()},get z(){return this._z},set z(e){this._z=e,this._updateQuaternion()},get order(){return this._order},set order(e){this._order=e,this._updateQuaternion()},set:function(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._order=r||this._order,this._updateQuaternion(),this},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._updateQuaternion(),this},setFromRotationMatrix:function(e,t){function i(e){return Math.min(Math.max(e,-1),1)}var r=e.elements,n=r[0],o=r[4],a=r[8],s=r[1],l=r[5],h=r[9],c=r[2],u=r[6],d=r[10];return t=t||this._order,"XYZ"===t?(this._y=Math.asin(i(a)),Math.abs(a)<.99999?(this._x=Math.atan2(-h,d),this._z=Math.atan2(-o,n)):(this._x=Math.atan2(u,l),this._z=0)):"YXZ"===t?(this._x=Math.asin(-i(h)),Math.abs(h)<.99999?(this._y=Math.atan2(a,d),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-c,n),this._z=0)):"ZXY"===t?(this._x=Math.asin(i(u)),Math.abs(u)<.99999?(this._y=Math.atan2(-c,d),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(s,n))):"ZYX"===t?(this._y=Math.asin(-i(c)),Math.abs(c)<.99999?(this._x=Math.atan2(u,d),this._z=Math.atan2(s,n)):(this._x=0,this._z=Math.atan2(-o,l))):"YZX"===t?(this._z=Math.asin(i(s)),Math.abs(s)<.99999?(this._x=Math.atan2(-h,l),this._y=Math.atan2(-c,n)):(this._x=0,this._y=Math.atan2(a,d))):"XZY"===t?(this._z=Math.asin(-i(o)),Math.abs(o)<.99999?(this._x=Math.atan2(u,l),this._y=Math.atan2(a,n)):(this._x=Math.atan2(-h,d),this._y=0)):console.warn("WARNING: Euler.setFromRotationMatrix() given unsupported order: "+t),this._order=t,this._updateQuaternion(),this},setFromQuaternion:function(e,t,i){function r(e){return Math.min(Math.max(e,-1),1)}var n=e.x*e.x,o=e.y*e.y,a=e.z*e.z,s=e.w*e.w;return t=t||this._order,"XYZ"===t?(this._x=Math.atan2(2*(e.x*e.w-e.y*e.z),s-n-o+a),this._y=Math.asin(r(2*(e.x*e.z+e.y*e.w))),this._z=Math.atan2(2*(e.z*e.w-e.x*e.y),s+n-o-a)):"YXZ"===t?(this._x=Math.asin(r(2*(e.x*e.w-e.y*e.z))),this._y=Math.atan2(2*(e.x*e.z+e.y*e.w),s-n-o+a),this._z=Math.atan2(2*(e.x*e.y+e.z*e.w),s-n+o-a)):"ZXY"===t?(this._x=Math.asin(r(2*(e.x*e.w+e.y*e.z))),this._y=Math.atan2(2*(e.y*e.w-e.z*e.x),s-n-o+a),this._z=Math.atan2(2*(e.z*e.w-e.x*e.y),s-n+o-a)):"ZYX"===t?(this._x=Math.atan2(2*(e.x*e.w+e.z*e.y),s-n-o+a),this._y=Math.asin(r(2*(e.y*e.w-e.x*e.z))),this._z=Math.atan2(2*(e.x*e.y+e.z*e.w),s+n-o-a)):"YZX"===t?(this._x=Math.atan2(2*(e.x*e.w-e.z*e.y),s-n+o-a),this._y=Math.atan2(2*(e.y*e.w-e.x*e.z),s+n-o-a),this._z=Math.asin(r(2*(e.x*e.y+e.z*e.w)))):"XZY"===t?(this._x=Math.atan2(2*(e.x*e.w+e.y*e.z),s-n+o-a),this._y=Math.atan2(2*(e.x*e.z+e.y*e.w),s+n-o-a),this._z=Math.asin(r(2*(e.z*e.w-e.x*e.y)))):console.warn("WARNING: Euler.setFromQuaternion() given unsupported order: "+t),this._order=t,i!==!1&&this._updateQuaternion(),this},reorder:function(){var e=new THREE.Quaternion;return function(t){e.setFromEuler(this),this.setFromQuaternion(e,t)}}(),fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._updateQuaternion(),this},toArray:function(){return[this._x,this._y,this._z,this._order]},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},clone:function(){return new THREE.Euler(this._x,this._y,this._z,this._order)}},THREE.Line3=function(e,t){this.start=void 0!==e?e:new THREE.Vector3,this.end=void 0!==t?t:new THREE.Vector3},THREE.Line3.prototype={constructor:THREE.Line3,set:function(e,t){return this.start.copy(e),this.end.copy(t),this},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},center:function(e){var t=e||new THREE.Vector3;return t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){var t=e||new THREE.Vector3;return t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var i=t||new THREE.Vector3;return this.delta(i).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new THREE.Vector3,t=new THREE.Vector3;
return function(i,r){e.subVectors(i,this.start),t.subVectors(this.end,this.start);var n=t.dot(t),o=t.dot(e),a=o/n;return r&&(a=THREE.Math.clamp(a,0,1)),a}}(),closestPointToPoint:function(e,t,i){var r=this.closestPointToPointParameter(e,t),n=i||new THREE.Vector3;return this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}},THREE.Box2=function(e,t){this.min=void 0!==e?e:new THREE.Vector2(1/0,1/0),this.max=void 0!==t?t:new THREE.Vector2(-1/0,-1/0)},THREE.Box2.prototype={constructor:THREE.Box2,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){if(e.length>0){var t=e[0];this.min.copy(t),this.max.copy(t);for(var i=1,r=e.length;r>i;i++)t=e[i],t.x<this.min.x?this.min.x=t.x:t.x>this.max.x&&(this.max.x=t.x),t.y<this.min.y?this.min.y=t.y:t.y>this.max.y&&(this.max.y=t.y)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var e=new THREE.Vector2;return function(t,i){var r=e.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(e){var t=e||new THREE.Vector2;return t.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){var t=e||new THREE.Vector2;return t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y?!0:!1},getParameter:function(e){return new THREE.Vector2((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y?!1:!0},clampPoint:function(e,t){var i=t||new THREE.Vector2;return i.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new THREE.Vector2;return function(t){var i=e.copy(t).clamp(this.min,this.max);return i.sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}},THREE.Box3=function(e,t){this.min=void 0!==e?e:new THREE.Vector3(1/0,1/0,1/0),this.max=void 0!==t?t:new THREE.Vector3(-1/0,-1/0,-1/0)},THREE.Box3.prototype={constructor:THREE.Box3,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){if(e.length>0){var t=e[0];this.min.copy(t),this.max.copy(t);for(var i=1,r=e.length;r>i;i++)t=e[i],t.x<this.min.x?this.min.x=t.x:t.x>this.max.x&&(this.max.x=t.x),t.y<this.min.y?this.min.y=t.y:t.y>this.max.y&&(this.max.y=t.y),t.z<this.min.z?this.min.z=t.z:t.z>this.max.z&&(this.max.z=t.z)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var e=new THREE.Vector3;return function(t,i){var r=e.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),setFromObject:function(){var e=new THREE.Vector3;return function(t){var i=this;return t.updateMatrixWorld(!0),this.makeEmpty(),t.traverse(function(t){if(void 0!==t.geometry&&void 0!==t.geometry.vertices)for(var r=t.geometry.vertices,n=0,o=r.length;o>n;n++)e.copy(r[n]),e.applyMatrix4(t.matrixWorld),i.expandByPoint(e)}),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(e){var t=e||new THREE.Vector3;return t.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){var t=e||new THREE.Vector3;return t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z?!0:!1},getParameter:function(e){return new THREE.Vector3((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z?!1:!0},clampPoint:function(e,t){var i=t||new THREE.Vector3;return i.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new THREE.Vector3;return function(t){var i=e.copy(t).clamp(this.min,this.max);return i.sub(t).length()}}(),getBoundingSphere:function(){var e=new THREE.Vector3;return function(t){var i=t||new THREE.Sphere;return i.center=this.center(),i.radius=.5*this.size(e).length(),i}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(t){return e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.makeEmpty(),this.setFromPoints(e),this}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}},THREE.Matrix3=function(e,t,i,r,n,o,a,s,l){this.elements=new Float32Array(9),this.set(void 0!==e?e:1,t||0,i||0,r||0,void 0!==n?n:1,o||0,a||0,s||0,void 0!==l?l:1)},THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(e,t,i,r,n,o,a,s,l){var h=this.elements;return h[0]=e,h[3]=t,h[6]=i,h[1]=r,h[4]=n,h[7]=o,h[2]=a,h[5]=s,h[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]),this},multiplyVector3:function(e){return console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){var e=new THREE.Vector3;return function(t){for(var i=0,r=t.length;r>i;i+=3)e.x=t[i],e.y=t[i+1],e.z=t[i+2],e.applyMatrix3(this),t[i]=e.x,t[i+1]=e.y,t[i+2]=e.z;return t}}(),multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],i=e[1],r=e[2],n=e[3],o=e[4],a=e[5],s=e[6],l=e[7],h=e[8];return t*o*h-t*a*l-i*n*h+i*a*s+r*n*l-r*o*s},getInverse:function(e,t){var i=e.elements,r=this.elements;r[0]=i[10]*i[5]-i[6]*i[9],r[1]=-i[10]*i[1]+i[2]*i[9],r[2]=i[6]*i[1]-i[2]*i[5],r[3]=-i[10]*i[4]+i[6]*i[8],r[4]=i[10]*i[0]-i[2]*i[8],r[5]=-i[6]*i[0]+i[2]*i[4],r[6]=i[9]*i[4]-i[5]*i[8],r[7]=-i[9]*i[0]+i[1]*i[8],r[8]=i[5]*i[0]-i[1]*i[4];var n=i[0]*r[0]+i[1]*r[3]+i[2]*r[6];if(0===n){var o="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(o);return console.warn(o),this.identity(),this}return this.multiplyScalar(1/n),this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.getInverse(e).transpose(),this},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},clone:function(){var e=this.elements;return new THREE.Matrix3(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])}},THREE.Matrix4=function(e,t,i,r,n,o,a,s,l,h,c,u,d,p,f,m){this.elements=new Float32Array(16);var g=this.elements;g[0]=void 0!==e?e:1,g[4]=t||0,g[8]=i||0,g[12]=r||0,g[1]=n||0,g[5]=void 0!==o?o:1,g[9]=a||0,g[13]=s||0,g[2]=l||0,g[6]=h||0,g[10]=void 0!==c?c:1,g[14]=u||0,g[3]=d||0,g[7]=p||0,g[11]=f||0,g[15]=void 0!==m?m:1},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(e,t,i,r,n,o,a,s,l,h,c,u,d,p,f,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=r,g[1]=n,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=h,g[10]=c,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(e){return this.elements.set(e.elements),this},extractPosition:function(e){return console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},copyPosition:function(e){var t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this},extractRotation:function(){var e=new THREE.Vector3;return function(t){var i=this.elements,r=t.elements,n=1/e.set(r[0],r[1],r[2]).length(),o=1/e.set(r[4],r[5],r[6]).length(),a=1/e.set(r[8],r[9],r[10]).length();return i[0]=r[0]*n,i[1]=r[1]*n,i[2]=r[2]*n,i[4]=r[4]*o,i[5]=r[5]*o,i[6]=r[6]*o,i[8]=r[8]*a,i[9]=r[9]*a,i[10]=r[10]*a,this}}(),makeRotationFromEuler:function(e){void 0===typeof e.order&&console.error("ERROR: Matrix's .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var t=this.elements,i=e.x,r=e.y,n=e.z,o=Math.cos(i),a=Math.sin(i),s=Math.cos(r),l=Math.sin(r),h=Math.cos(n),c=Math.sin(n);if(void 0===e.order||"XYZ"===e.order){var u=o*h,d=o*c,p=a*h,f=a*c;t[0]=s*h,t[4]=-s*c,t[8]=l,t[1]=d+p*l,t[5]=u-f*l,t[9]=-a*s,t[2]=f-u*l,t[6]=p+d*l,t[10]=o*s}else if("YXZ"===e.order){var m=s*h,g=s*c,v=l*h,E=l*c;t[0]=m+E*a,t[4]=v*a-g,t[8]=o*l,t[1]=o*c,t[5]=o*h,t[9]=-a,t[2]=g*a-v,t[6]=E+m*a,t[10]=o*s}else if("ZXY"===e.order){var m=s*h,g=s*c,v=l*h,E=l*c;t[0]=m-E*a,t[4]=-o*c,t[8]=v+g*a,t[1]=g+v*a,t[5]=o*h,t[9]=E-m*a,t[2]=-o*l,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){var u=o*h,d=o*c,p=a*h,f=a*c;t[0]=s*h,t[4]=p*l-d,t[8]=u*l+f,t[1]=s*c,t[5]=f*l+u,t[9]=d*l-p,t[2]=-l,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){var y=o*s,T=o*l,_=a*s,b=a*l;t[0]=s*h,t[4]=b-y*c,t[8]=_*c+T,t[1]=c,t[5]=o*h,t[9]=-a*h,t[2]=-l*h,t[6]=T*c+_,t[10]=y-b*c}else if("XZY"===e.order){var y=o*s,T=o*l,_=a*s,b=a*l;t[0]=s*h,t[4]=-c,t[8]=l*h,t[1]=y*c+b,t[5]=o*h,t[9]=T*c-_,t[2]=_*c-T,t[6]=a*h,t[10]=b*c+y}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},setRotationFromQuaternion:function(e){return console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code."),this.makeRotationFromQuaternion(e)},makeRotationFromQuaternion:function(e){var t=this.elements,i=e.x,r=e.y,n=e.z,o=e.w,a=i+i,s=r+r,l=n+n,h=i*a,c=i*s,u=i*l,d=r*s,p=r*l,f=n*l,m=o*a,g=o*s,v=o*l;return t[0]=1-(d+f),t[4]=c-v,t[8]=u+g,t[1]=c+v,t[5]=1-(h+f),t[9]=p-m,t[2]=u-g,t[6]=p+m,t[10]=1-(h+d),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:function(){var e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3;return function(r,n,o){var a=this.elements;return i.subVectors(r,n).normalize(),0===i.length()&&(i.z=1),e.crossVectors(o,i).normalize(),0===e.length()&&(i.x+=1e-4,e.crossVectors(o,i).normalize()),t.crossVectors(i,e),a[0]=e.x,a[4]=t.x,a[8]=i.x,a[1]=e.y,a[5]=t.y,a[9]=i.y,a[2]=e.z,a[6]=t.z,a[10]=i.z,this}}(),multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var i=e.elements,r=t.elements,n=this.elements,o=i[0],a=i[4],s=i[8],l=i[12],h=i[1],c=i[5],u=i[9],d=i[13],p=i[2],f=i[6],m=i[10],g=i[14],v=i[3],E=i[7],y=i[11],T=i[15],_=r[0],b=r[4],x=r[8],R=r[12],w=r[1],H=r[5],M=r[9],S=r[13],C=r[2],A=r[6],D=r[10],P=r[14],L=r[3],k=r[7],F=r[11],z=r[15];return n[0]=o*_+a*w+s*C+l*L,n[4]=o*b+a*H+s*A+l*k,n[8]=o*x+a*M+s*D+l*F,n[12]=o*R+a*S+s*P+l*z,n[1]=h*_+c*w+u*C+d*L,n[5]=h*b+c*H+u*A+d*k,n[9]=h*x+c*M+u*D+d*F,n[13]=h*R+c*S+u*P+d*z,n[2]=p*_+f*w+m*C+g*L,n[6]=p*b+f*H+m*A+g*k,n[10]=p*x+f*M+m*D+g*F,n[14]=p*R+f*S+m*P+g*z,n[3]=v*_+E*w+y*C+T*L,n[7]=v*b+E*H+y*A+T*k,n[11]=v*x+E*M+y*D+T*F,n[15]=v*R+E*S+y*P+T*z,this},multiplyToArray:function(e,t,i){var r=this.elements;return this.multiplyMatrices(e,t),i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},multiplyVector3:function(e){return console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),e.applyProjection(this)},multiplyVector4:function(e){return console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){var e=new THREE.Vector3;return function(t){for(var i=0,r=t.length;r>i;i+=3)e.x=t[i],e.y=t[i+1],e.z=t[i+2],e.applyProjection(this),t[i]=e.x,t[i+1]=e.y,t[i+2]=e.z;return t}}(),rotateAxis:function(e){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},determinant:function(){var e=this.elements,t=e[0],i=e[4],r=e[8],n=e[12],o=e[1],a=e[5],s=e[9],l=e[13],h=e[2],c=e[6],u=e[10],d=e[14],p=e[3],f=e[7],m=e[11],g=e[15];return p*(+n*s*c-r*l*c-n*a*u+i*l*u+r*a*d-i*s*d)+f*(+t*s*d-t*l*u+n*o*u-r*o*d+r*l*h-n*s*h)+m*(+t*l*c-t*a*d-n*o*c+i*o*d+n*a*h-i*l*h)+g*(-r*a*h-t*s*c+t*a*u+r*o*c-i*o*u+i*s*h)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},flattenToArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},flattenToArrayOffset:function(e,t){var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e},getPosition:function(){var e=new THREE.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");var t=this.elements;return e.set(t[12],t[13],t[14])}}(),setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var i=this.elements,r=e.elements,n=r[0],o=r[4],a=r[8],s=r[12],l=r[1],h=r[5],c=r[9],u=r[13],d=r[2],p=r[6],f=r[10],m=r[14],g=r[3],v=r[7],E=r[11],y=r[15];i[0]=c*m*v-u*f*v+u*p*E-h*m*E-c*p*y+h*f*y,i[4]=s*f*v-a*m*v-s*p*E+o*m*E+a*p*y-o*f*y,i[8]=a*u*v-s*c*v+s*h*E-o*u*E-a*h*y+o*c*y,i[12]=s*c*p-a*u*p-s*h*f+o*u*f+a*h*m-o*c*m,i[1]=u*f*g-c*m*g-u*d*E+l*m*E+c*d*y-l*f*y,i[5]=a*m*g-s*f*g+s*d*E-n*m*E-a*d*y+n*f*y,i[9]=s*c*g-a*u*g-s*l*E+n*u*E+a*l*y-n*c*y,i[13]=a*u*d-s*c*d+s*l*f-n*u*f-a*l*m+n*c*m,i[2]=h*m*g-u*p*g+u*d*v-l*m*v-h*d*y+l*p*y,i[6]=s*p*g-o*m*g-s*d*v+n*m*v+o*d*y-n*p*y,i[10]=o*u*g-s*h*g+s*l*v-n*u*v-o*l*y+n*h*y,i[14]=s*h*d-o*u*d-s*l*p+n*u*p+o*l*m-n*h*m,i[3]=c*p*g-h*f*g-c*d*v+l*f*v+h*d*E-l*p*E,i[7]=o*f*g-a*p*g+a*d*v-n*f*v-o*d*E+n*p*E,i[11]=a*h*g-o*c*g-a*l*v+n*c*v+o*l*E-n*h*E,i[15]=o*c*d-a*h*d+a*l*p-n*c*p-o*l*f+n*h*f;var T=n*i[0]+l*i[4]+d*i[8]+g*i[12];if(0==T){var _="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(_);return console.warn(_),this.identity(),this}return this.multiplyScalar(1/T),this},translate:function(){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},scale:function(e){var t=this.elements,i=e.x,r=e.y,n=e.z;return t[0]*=i,t[4]*=r,t[8]*=n,t[1]*=i,t[5]*=r,t[9]*=n,t[2]*=i,t[6]*=r,t[10]*=n,t[3]*=i,t[7]*=r,t[11]*=n,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,Math.max(i,r)))},makeTranslation:function(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var i=Math.cos(t),r=Math.sin(t),n=1-i,o=e.x,a=e.y,s=e.z,l=n*o,h=n*a;return this.set(l*o+i,l*a-r*s,l*s+r*a,0,l*a+r*s,h*a+i,h*s-r*o,0,l*s-r*a,h*s+r*o,n*s*s+i,0,0,0,0,1),this},makeScale:function(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this},compose:function(e,t,i){return this.makeRotationFromQuaternion(t),this.scale(i),this.setPosition(e),this},decompose:function(){var e=new THREE.Vector3,t=new THREE.Matrix4;return function(i,r,n){var o=this.elements,a=e.set(o[0],o[1],o[2]).length(),s=e.set(o[4],o[5],o[6]).length(),l=e.set(o[8],o[9],o[10]).length();i.x=o[12],i.y=o[13],i.z=o[14],t.elements.set(this.elements);var h=1/a,c=1/s,u=1/l;return t.elements[0]*=h,t.elements[1]*=h,t.elements[2]*=h,t.elements[4]*=c,t.elements[5]*=c,t.elements[6]*=c,t.elements[8]*=u,t.elements[9]*=u,t.elements[10]*=u,r.setFromRotationMatrix(t),n.x=a,n.y=s,n.z=l,this}}(),makeFrustum:function(e,t,i,r,n,o){var a=this.elements,s=2*n/(t-e),l=2*n/(r-i),h=(t+e)/(t-e),c=(r+i)/(r-i),u=-(o+n)/(o-n),d=-2*o*n/(o-n);return a[0]=s,a[4]=0,a[8]=h,a[12]=0,a[1]=0,a[5]=l,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(e,t,i,r){var n=i*Math.tan(THREE.Math.degToRad(.5*e)),o=-n,a=o*t,s=n*t;return this.makeFrustum(a,s,o,n,i,r)},makeOrthographic:function(e,t,i,r,n,o){var a=this.elements,s=t-e,l=i-r,h=o-n,c=(t+e)/s,u=(i+r)/l,d=(o+n)/h;return a[0]=2/s,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2/l,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2/h,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},clone:function(){var e=this.elements;return new THREE.Matrix4(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])}},THREE.Ray=function(e,t){this.origin=void 0!==e?e:new THREE.Vector3,this.direction=void 0!==t?t:new THREE.Vector3},THREE.Ray.prototype={constructor:THREE.Ray,set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){var i=t||new THREE.Vector3;return i.copy(this.direction).multiplyScalar(e).add(this.origin)},recast:function(){var e=new THREE.Vector3;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){var i=t||new THREE.Vector3;i.subVectors(e,this.origin);var r=i.dot(this.direction);return 0>r?i.copy(this.origin):i.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(){var e=new THREE.Vector3;return function(t){var i=e.subVectors(t,this.origin).dot(this.direction);return 0>i?this.origin.distanceTo(t):(e.copy(this.direction).multiplyScalar(i).add(this.origin),e.distanceTo(t))}}(),distanceSqToSegment:function(e,t,i,r){var n,o,a,s,l=e.clone().add(t).multiplyScalar(.5),h=t.clone().sub(e).normalize(),c=.5*e.distanceTo(t),u=this.origin.clone().sub(l),d=-this.direction.dot(h),p=u.dot(this.direction),f=-u.dot(h),m=u.lengthSq(),g=Math.abs(1-d*d);if(g>=0)if(n=d*f-p,o=d*p-f,s=c*g,n>=0)if(o>=-s)if(s>=o){var v=1/g;n*=v,o*=v,a=n*(n+d*o+2*p)+o*(d*n+o+2*f)+m}else o=c,n=Math.max(0,-(d*o+p)),a=-n*n+o*(o+2*f)+m;else o=-c,n=Math.max(0,-(d*o+p)),a=-n*n+o*(o+2*f)+m;else-s>=o?(n=Math.max(0,-(-d*c+p)),o=n>0?-c:Math.min(Math.max(-c,-f),c),a=-n*n+o*(o+2*f)+m):s>=o?(n=0,o=Math.min(Math.max(-c,-f),c),a=o*(o+2*f)+m):(n=Math.max(0,-(d*c+p)),o=n>0?c:Math.min(Math.max(-c,-f),c),a=-n*n+o*(o+2*f)+m);else o=d>0?-c:c,n=Math.max(0,-(d*o+p)),a=-n*n+o*(o+2*f)+m;return i&&i.copy(this.direction.clone().multiplyScalar(n).add(this.origin)),r&&r.copy(h.clone().multiplyScalar(o).add(l)),a},isIntersectionSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},isIntersectionPlane:function(e){var t=e.distanceToPoint(this.origin);if(0===t)return!0;var i=e.normal.dot(this.direction);return 0>i*t?!0:!1},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0==t)return 0==e.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null},intersectPlane:function(e,t){var i=this.distanceToPlane(e);return null===i?null:this.at(i,t)},applyMatrix4:function(e){return this.direction.add(this.origin).applyMatrix4(e),this.origin.applyMatrix4(e),this.direction.sub(this.origin),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}},THREE.Sphere=function(e,t){this.center=void 0!==e?e:new THREE.Vector3,this.radius=void 0!==t?t:0},THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(e){for(var t,i=0,r=0,n=e.length;n>r;r++)t=e[r].lengthSq(),i=Math.max(i,t);return this.center.set(0,0,0),this.radius=Math.sqrt(i),this},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},clampPoint:function(e,t){var i=this.center.distanceToSquared(e),r=t||new THREE.Vector3;return r.copy(e),i>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r},getBoundingBox:function(e){var t=e||new THREE.Box3;return t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}},THREE.Frustum=function(e,t,i,r,n,o){this.planes=[void 0!==e?e:new THREE.Plane,void 0!==t?t:new THREE.Plane,void 0!==i?i:new THREE.Plane,void 0!==r?r:new THREE.Plane,void 0!==n?n:new THREE.Plane,void 0!==o?o:new THREE.Plane]},THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(e,t,i,r,n,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(n),a[5].copy(o),this},copy:function(e){for(var t=this.planes,i=0;6>i;i++)t[i].copy(e.planes[i]);return this},setFromMatrix:function(e){var t=this.planes,i=e.elements,r=i[0],n=i[1],o=i[2],a=i[3],s=i[4],l=i[5],h=i[6],c=i[7],u=i[8],d=i[9],p=i[10],f=i[11],m=i[12],g=i[13],v=i[14],E=i[15];return t[0].setComponents(a-r,c-s,f-u,E-m).normalize(),t[1].setComponents(a+r,c+s,f+u,E+m).normalize(),t[2].setComponents(a+n,c+l,f+d,E+g).normalize(),t[3].setComponents(a-n,c-l,f-d,E-g).normalize(),t[4].setComponents(a-o,c-h,f-p,E-v).normalize(),t[5].setComponents(a+o,c+h,f+p,E+v).normalize(),this},intersectsObject:function(){var e=new THREE.Vector3;return function(t){var i=t.geometry,r=t.matrixWorld;null===i.boundingSphere&&i.computeBoundingSphere();var n=-i.boundingSphere.radius*r.getMaxScaleOnAxis();e.getPositionFromMatrix(r);for(var o=this.planes,a=0;6>a;a++){var s=o[a].distanceToPoint(e);if(n>s)return!1}return!0}}(),intersectsSphere:function(e){for(var t=this.planes,i=e.center,r=-e.radius,n=0;6>n;n++){var o=t[n].distanceToPoint(i);if(r>o)return!1}return!0},intersectsBox:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(i){for(var r=this.planes,n=0;6>n;n++){var o=r[n];e.x=o.normal.x>0?i.min.x:i.max.x,t.x=o.normal.x>0?i.max.x:i.min.x,e.y=o.normal.y>0?i.min.y:i.max.y,t.y=o.normal.y>0?i.max.y:i.min.y,e.z=o.normal.z>0?i.min.z:i.max.z,t.z=o.normal.z>0?i.max.z:i.min.z;var a=o.distanceToPoint(e),s=o.distanceToPoint(t);if(0>a&&0>s)return!1}return!0}}(),containsPoint:function(e){for(var t=this.planes,i=0;6>i;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}},THREE.Plane=function(e,t){this.normal=void 0!==e?e:new THREE.Vector3(1,0,0),this.constant=void 0!==t?t:0},THREE.Plane.prototype={constructor:THREE.Plane,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(i,r,n){var o=e.subVectors(n,r).cross(t.subVectors(i,r)).normalize();return this.setFromNormalAndCoplanarPoint(o,i),this}}(),copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var i=this.distanceToPoint(e),r=t||new THREE.Vector3;return r.copy(this.normal).multiplyScalar(i)},isIntersectionLine:function(e){var t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return 0>t&&i>0||0>i&&t>0},intersectLine:function(){var e=new THREE.Vector3;return function(t,i){var r=i||new THREE.Vector3,n=t.delta(e),o=this.normal.dot(n);if(0==o)return 0==this.distanceToPoint(t.start)?r.copy(t.start):void 0;var a=-(t.start.dot(this.normal)+this.constant)/o;return 0>a||a>1?void 0:r.copy(n).multiplyScalar(a).add(t.start)}}(),coplanarPoint:function(e){var t=e||new THREE.Vector3;return t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(i,r){r=r||(new THREE.Matrix3).getNormalMatrix(i);var n=e.copy(this.normal).applyMatrix3(r),o=this.coplanarPoint(t);return o.applyMatrix4(i),this.setFromNormalAndCoplanarPoint(n,o),this}}(),translate:function(e){return this.constant=this.constant-e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}},THREE.Math={PI2:2*Math.PI,generateUUID:function(){var e,t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=new Array(36),r=0;return function(){for(var n=0;36>n;n++)8==n||13==n||18==n||23==n?i[n]="-":14==n?i[n]="4":(2>=r&&(r=0|33554432+16777216*Math.random()),e=15&r,r>>=4,i[n]=t[19==n?8|3&e:e]);return i.join("")}}(),clamp:function(e,t,i){return t>e?t:e>i?i:e},clampBottom:function(e,t){return t>e?t:e},mapLinear:function(e,t,i,r,n){return r+(e-t)*(n-r)/(i-t)},smoothstep:function(e,t,i){return t>=e?0:e>=i?1:(e=(e-t)/(i-t),e*e*(3-2*e))},smootherstep:function(e,t,i){return t>=e?0:e>=i?1:(e=(e-t)/(i-t),e*e*e*(e*(6*e-15)+10))},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},sign:function(e){return 0>e?-1:e>0?1:0},degToRad:function(){var e=Math.PI/180;return function(t){return t*e}}(),radToDeg:function(){var e=180/Math.PI;return function(t){return t*e}}()},THREE.Spline=function(e){function t(e,t,i,r,n,o,a){var s=.5*(i-e),l=.5*(r-t);return(2*(t-i)+s+l)*a+(-3*(t-i)-2*s-l)*o+s*n+t}this.points=e;var i,r,n,o,a,s,l,h,c,u=[],d={x:0,y:0,z:0};this.initFromArray=function(e){this.points=[];for(var t=0;t<e.length;t++)this.points[t]={x:e[t][0],y:e[t][1],z:e[t][2]}},this.getPoint=function(e){return i=(this.points.length-1)*e,r=Math.floor(i),n=i-r,u[0]=0===r?r:r-1,u[1]=r,u[2]=r>this.points.length-2?this.points.length-1:r+1,u[3]=r>this.points.length-3?this.points.length-1:r+2,s=this.points[u[0]],l=this.points[u[1]],h=this.points[u[2]],c=this.points[u[3]],o=n*n,a=n*o,d.x=t(s.x,l.x,h.x,c.x,n,o,a),d.y=t(s.y,l.y,h.y,c.y,n,o,a),d.z=t(s.z,l.z,h.z,c.z,n,o,a),d},this.getControlPointsArray=function(){var e,t,i=this.points.length,r=[];for(e=0;i>e;e++)t=this.points[e],r[e]=[t.x,t.y,t.z];return r},this.getLength=function(e){var t,i,r,n,o=0,a=0,s=0,l=new THREE.Vector3,h=new THREE.Vector3,c=[],u=0;for(c[0]=0,e||(e=100),r=this.points.length*e,l.copy(this.points[0]),t=1;r>t;t++)i=t/r,n=this.getPoint(i),h.copy(n),u+=h.distanceTo(l),l.copy(n),o=(this.points.length-1)*i,a=Math.floor(o),a!=s&&(c[a]=u,s=a);return c[c.length]=u,{chunks:c,total:u}},this.reparametrizeByArcLength=function(e){var t,i,r,n,o,a,s,l,h=[],c=new THREE.Vector3,u=this.getLength();for(h.push(c.copy(this.points[0]).clone()),t=1;t<this.points.length;t++){for(a=u.chunks[t]-u.chunks[t-1],s=Math.ceil(e*a/u.total),n=(t-1)/(this.points.length-1),o=t/(this.points.length-1),i=1;s-1>i;i++)r=n+i*(1/s)*(o-n),l=this.getPoint(r),h.push(c.copy(l).clone());h.push(c.copy(this.points[t]).clone())}this.points=h}},THREE.Triangle=function(e,t,i){this.a=void 0!==e?e:new THREE.Vector3,this.b=void 0!==t?t:new THREE.Vector3,this.c=void 0!==i?i:new THREE.Vector3},THREE.Triangle.normal=function(){var e=new THREE.Vector3;return function(t,i,r,n){var o=n||new THREE.Vector3;o.subVectors(r,i),e.subVectors(t,i),o.cross(e);var a=o.lengthSq();return a>0?o.multiplyScalar(1/Math.sqrt(a)):o.set(0,0,0)}}(),THREE.Triangle.barycoordFromPoint=function(){var e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3;return function(r,n,o,a,s){e.subVectors(a,n),t.subVectors(o,n),i.subVectors(r,n);var l=e.dot(e),h=e.dot(t),c=e.dot(i),u=t.dot(t),d=t.dot(i),p=l*u-h*h,f=s||new THREE.Vector3;
if(0==p)return f.set(-2,-1,-1);var m=1/p,g=(u*c-h*d)*m,v=(l*d-h*c)*m;return f.set(1-g-v,v,g)}}(),THREE.Triangle.containsPoint=function(){var e=new THREE.Vector3;return function(t,i,r,n){var o=THREE.Triangle.barycoordFromPoint(t,i,r,n,e);return o.x>=0&&o.y>=0&&o.x+o.y<=1}}(),THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this},setFromPointsAndIndices:function(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),midpoint:function(e){var t=e||new THREE.Vector3;return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return THREE.Triangle.normal(this.a,this.b,this.c,e)},plane:function(e){var t=e||new THREE.Plane;return t.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return THREE.Triangle.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return THREE.Triangle.containsPoint(e,this.a,this.b,this.c)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)},clone:function(){return(new THREE.Triangle).copy(this)}},THREE.Vertex=function(e){return console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead."),e},THREE.UV=function(e,t){return console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead."),new THREE.Vector2(e,t)},THREE.Clock=function(e){this.autoStart=void 0!==e?e:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running&&this.start(),this.running){var t=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();e=.001*(t-this.oldTime),this.oldTime=t,this.elapsedTime+=e}return e}},THREE.EventDispatcher=function(){},THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(e){e.addEventListener=THREE.EventDispatcher.prototype.addEventListener,e.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener,e.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener,e.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)?!0:!1},removeEventListener:function(e,t){if(void 0!==this._listeners){var i=this._listeners,r=i[e].indexOf(t);-1!==r&&i[e].splice(r,1)}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners,i=t[e.type];if(void 0!==i){e.target=this;for(var r=0,n=i.length;n>r;r++)i[r].call(this,e)}}}},function(e){e.Raycaster=function(t,i,r,n){this.ray=new e.Ray(t,i),this.ray.direction.lengthSq()>0&&this.ray.direction.normalize(),this.near=r||0,this.far=n||1/0};var t=new e.Sphere,i=new e.Ray,r=new e.Plane,n=new e.Vector3,o=new e.Vector3,a=new e.Matrix4,s=function(e,t){return e.distance-t.distance},l=function(s,h,c){if(s instanceof e.Particle){o.getPositionFromMatrix(s.matrixWorld);var u=h.ray.distanceToPoint(o);if(u>s.scale.x)return c;c.push({distance:u,point:s.position,face:null,object:s})}else if(s instanceof e.LOD){o.getPositionFromMatrix(s.matrixWorld);var u=h.ray.origin.distanceTo(o);l(s.getObjectForDistance(u),h,c)}else if(s instanceof e.Mesh){var d=s.geometry;if(o.getPositionFromMatrix(s.matrixWorld),null===d.boundingSphere&&d.computeBoundingSphere(),t.set(o,d.boundingSphere.radius*s.matrixWorld.getMaxScaleOnAxis()),h.ray.isIntersectionSphere(t)===!1)return c;var p=d.vertices;if(d instanceof e.BufferGeometry){var f=s.material;if(void 0===f)return c;if(d.dynamic===!1)return c;var m,g,v,E=s.material instanceof e.MeshFaceMaterial,y=E===!0?s.material.materials:null,T=s.material.side,_=h.precision;a.getInverse(s.matrixWorld),i.copy(h.ray).applyMatrix4(a);var b,x=!1;d.attributes.index?(x=!0,b=d.attributes.index.numItems/3):b=d.attributes.position.numItems/9;var R=new e.Vector3,w=new e.Vector3,H=new e.Vector3;new e.Vector3,new e.Vector3;for(var M=0;M<d.offsets.length;++M)for(var S=d.offsets[M].start,C=d.offsets[M].count,A=d.offsets[M].index,D=S,P=S+C;P>D;D+=3){x?(m=A+d.attributes.index.array[D],g=A+d.attributes.index.array[D+1],v=A+d.attributes.index.array[D+2]):(m=A,g=A+1,v=A+2),R.set(d.attributes.position.array[3*m],d.attributes.position.array[3*m+1],d.attributes.position.array[3*m+2]),w.set(d.attributes.position.array[3*g],d.attributes.position.array[3*g+1],d.attributes.position.array[3*g+2]),H.set(d.attributes.position.array[3*v],d.attributes.position.array[3*v+1],d.attributes.position.array[3*v+2]),r.setFromCoplanarPoints(R,w,H);var L=i.distanceToPlane(r);if(!(_>L)&&null!==L){if(T=f.side,T!==e.DoubleSide){var k=i.direction.dot(r.normal);if(!(T===e.FrontSide?0>k:k>0))continue}L<h.near||L>h.far||(n=i.at(L,n),e.Triangle.containsPoint(n,R,w,H)!==!1&&c.push({distance:L,point:h.ray.at(L),face:null,faceIndex:null,object:s}))}}}else if(d instanceof e.Geometry){var m,g,v,F,E=s.material instanceof e.MeshFaceMaterial,y=E===!0?s.material.materials:null,T=s.material.side,_=h.precision;a.getInverse(s.matrixWorld),i.copy(h.ray).applyMatrix4(a);for(var z=0,b=d.faces.length;b>z;z++){var N=d.faces[z],f=E===!0?y[N.materialIndex]:s.material;if(void 0!==f){r.setFromNormalAndCoplanarPoint(N.normal,p[N.a]);var L=i.distanceToPlane(r);if(!(_>L)&&null!==L){if(T=f.side,T!==e.DoubleSide){var k=i.direction.dot(r.normal);if(!(T===e.FrontSide?0>k:k>0))continue}if(!(L<h.near||L>h.far)){if(n=i.at(L,n),N instanceof e.Face3){if(m=p[N.a],g=p[N.b],v=p[N.c],e.Triangle.containsPoint(n,m,g,v)===!1)continue}else{if(!(N instanceof e.Face4))throw Error("face type not supported");if(m=p[N.a],g=p[N.b],v=p[N.c],F=p[N.d],e.Triangle.containsPoint(n,m,g,F)===!1&&e.Triangle.containsPoint(n,g,v,F)===!1)continue}c.push({distance:L,point:h.ray.at(L),face:N,faceIndex:z,object:s})}}}}}}else if(s instanceof e.Line){var _=h.linePrecision,I=_*_,d=s.geometry;if(null===d.boundingSphere&&d.computeBoundingSphere(),o.getPositionFromMatrix(s.matrixWorld),t.set(o,d.boundingSphere.radius*s.matrixWorld.getMaxScaleOnAxis()),h.ray.isIntersectionSphere(t)===!1)return c;a.getInverse(s.matrixWorld),i.copy(h.ray).applyMatrix4(a),i.direction.normalize();for(var p=d.vertices,O=p.length,U=new e.Vector3,V=new e.Vector3,B=s.type===e.LineStrip?1:2,D=0;O-1>D;D+=B){var j=i.distanceSqToSegment(p[D],p[D+1],V,U);if(I>=j){var u=i.origin.distanceTo(V);h.near<=u&&u<=h.far&&c.push({distance:u,point:U.clone().applyMatrix4(s.matrixWorld),face:null,faceIndex:null,object:s})}}}},h=function(e,t,i){for(var r=e.getDescendants(),n=0,o=r.length;o>n;n++)l(r[n],t,i)};e.Raycaster.prototype.precision=1e-4,e.Raycaster.prototype.linePrecision=1,e.Raycaster.prototype.set=function(e,t){this.ray.set(e,t),this.ray.direction.length()>0&&this.ray.direction.normalize()},e.Raycaster.prototype.intersectObject=function(e,t){var i=[];return t===!0&&h(e,this,i),l(e,this,i),i.sort(s),i},e.Raycaster.prototype.intersectObjects=function(e,t){for(var i=[],r=0,n=e.length;n>r;r++)l(e[r],this,i),t===!0&&h(e[r],this,i);return i.sort(s),i}}(THREE),THREE.Object3D=function(){this.id=THREE.Object3DIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.parent=void 0,this.children=[],this.up=new THREE.Vector3(0,1,0),this.position=new THREE.Vector3,this.rotation=new THREE.Euler,this.quaternion=new THREE.Quaternion,this.scale=new THREE.Vector3(1,1,1),this.rotation._quaternion=this.quaternion,this.quaternion._euler=this.rotation,this.renderDepth=null,this.rotationAutoUpdate=!0,this.matrix=new THREE.Matrix4,this.matrixWorld=new THREE.Matrix4,this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.userData={}},THREE.Object3D.prototype={constructor:THREE.Object3D,get eulerOrder(){return console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order."),this.rotation.order},set eulerOrder(e){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order."),this.rotation.order=e},get useQuaternion(){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(){var e=new THREE.Matrix4;return function(t){this.matrix.multiplyMatrices(t,this.matrix),this.position.getPositionFromMatrix(this.matrix),this.scale.getScaleFromMatrix(this.matrix),e.extractRotation(this.matrix),this.quaternion.setFromRotationMatrix(e)}}(),setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new THREE.Quaternion;return function(t,i){return e.setFromAxisAngle(t,i),this.quaternion.multiply(e),this}}(),rotateX:function(){var e=new THREE.Vector3(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new THREE.Vector3(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new THREE.Vector3(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new THREE.Vector3;return function(t,i){return e.copy(t),e.applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(i)),this}}(),translate:function(e,t){return console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed."),this.translateOnAxis(t,e)},translateX:function(){var e=new THREE.Vector3(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new THREE.Vector3(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new THREE.Vector3(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new THREE.Matrix4;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new THREE.Matrix4;return function(t){e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(e===this)return console.warn("THREE.Object3D.add: An object can't be added as a child of itself."),void 0;if(e instanceof THREE.Object3D){void 0!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e);for(var t=this;void 0!==t.parent;)t=t.parent;void 0!==t&&t instanceof THREE.Scene&&t.__addObject(e)}},remove:function(e){var t=this.children.indexOf(e);if(-1!==t){e.parent=void 0,e.dispatchEvent({type:"removed"}),this.children.splice(t,1);for(var i=this;void 0!==i.parent;)i=i.parent;void 0!==i&&i instanceof THREE.Scene&&i.__removeObject(e)}},traverse:function(e){e(this);for(var t=0,i=this.children.length;i>t;t++)this.children[t].traverse(e)},getObjectById:function(e,t){for(var i=0,r=this.children.length;r>i;i++){var n=this.children[i];if(n.id===e)return n;if(t===!0&&(n=n.getObjectById(e,t),void 0!==n))return n}return void 0},getObjectByName:function(e,t){for(var i=0,r=this.children.length;r>i;i++){var n=this.children[i];if(n.name===e)return n;if(t===!0&&(n=n.getObjectByName(e,t),void 0!==n))return n}return void 0},getChildByName:function(e,t){return console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e,t)},getDescendants:function(e){void 0===e&&(e=[]),Array.prototype.push.apply(e,this.children);for(var t=0,i=this.children.length;i>t;t++)this.children[t].getDescendants(e);return e},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||e===!0)&&(void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=0,i=this.children.length;i>t;t++)this.children[t].updateMatrixWorld(e)},clone:function(e,t){if(void 0===e&&(e=new THREE.Object3D),void 0===t&&(t=!0),e.name=this.name,e.up.copy(this.up),e.position.copy(this.position),e.quaternion.copy(this.quaternion),e.scale.copy(this.scale),e.renderDepth=this.renderDepth,e.rotationAutoUpdate=this.rotationAutoUpdate,e.matrix.copy(this.matrix),e.matrixWorld.copy(this.matrixWorld),e.matrixAutoUpdate=this.matrixAutoUpdate,e.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,e.visible=this.visible,e.castShadow=this.castShadow,e.receiveShadow=this.receiveShadow,e.frustumCulled=this.frustumCulled,e.userData=JSON.parse(JSON.stringify(this.userData)),t===!0)for(var i=0;i<this.children.length;i++){var r=this.children[i];e.add(r.clone())}return e}},THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype),THREE.Object3DIdCount=0,THREE.Projector=function(){function e(){if(h===_){var e=new THREE.RenderableObject;return T.push(e),_++,h++,e}return T[h++]}function t(){if(u===x){var e=new THREE.RenderableVertex;return b.push(e),x++,u++,e}return b[u++]}function i(){if(p===w){var e=new THREE.RenderableFace3;return R.push(e),w++,p++,e}return R[p++]}function r(){if(f===M){var e=new THREE.RenderableFace4;return H.push(e),M++,f++,e}return H[f++]}function n(){if(g===C){var e=new THREE.RenderableLine;return S.push(e),C++,g++,e}return S[g++]}function o(){if(E===D){var e=new THREE.RenderableParticle;return A.push(e),D++,E++,e}return A[E++]}function a(e,t){return e.z!==t.z?t.z-e.z:e.id!==t.id?e.id-t.id:0}function s(e,t){var i=0,r=1,n=e.z+e.w,o=t.z+t.w,a=-e.z+e.w,s=-t.z+t.w;return n>=0&&o>=0&&a>=0&&s>=0?!0:0>n&&0>o||0>a&&0>s?!1:(0>n?i=Math.max(i,n/(n-o)):0>o&&(r=Math.min(r,n/(n-o))),0>a?i=Math.max(i,a/(a-s)):0>s&&(r=Math.min(r,a/(a-s))),i>r?!1:(e.lerp(t,i),t.lerp(e,1-r),!0))}var l,h,c,u,d,p,f,m,g,v,E,y,T=[],_=0,b=[],x=0,R=[],w=0,H=[],M=0,S=[],C=0,A=[],D=0,P={objects:[],sprites:[],lights:[],elements:[]},L=new THREE.Vector3,k=new THREE.Vector4,F=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),z=new THREE.Box3,N=new Array(3),I=new Array(4),O=new THREE.Matrix4,U=new THREE.Matrix4,V=new THREE.Matrix4,B=new THREE.Matrix3,j=new THREE.Matrix3,W=new THREE.Vector3,G=new THREE.Frustum,X=new THREE.Vector4,Y=new THREE.Vector4;this.projectVector=function(e,t){return t.matrixWorldInverse.getInverse(t.matrixWorld),U.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),e.applyProjection(U)},this.unprojectVector=function(e,t){return t.projectionMatrixInverse.getInverse(t.projectionMatrix),U.multiplyMatrices(t.matrixWorld,t.projectionMatrixInverse),e.applyProjection(U)},this.pickingRay=function(e,t){e.z=-1;var i=new THREE.Vector3(e.x,e.y,1);return this.unprojectVector(e,t),this.unprojectVector(i,t),i.sub(e).normalize(),new THREE.Raycaster(e,i)};var q=function(t){return l=e(),l.id=t.id,l.object=t,null!==t.renderDepth?l.z=t.renderDepth:(L.getPositionFromMatrix(t.matrixWorld),L.applyProjection(U),l.z=L.z),l},K=function(e){if(e.visible!==!1){e instanceof THREE.Light?P.lights.push(e):e instanceof THREE.Mesh||e instanceof THREE.Line?(e.frustumCulled===!1||G.intersectsObject(e)===!0)&&P.objects.push(q(e)):(e instanceof THREE.Sprite||e instanceof THREE.Particle)&&P.sprites.push(q(e));for(var t=0,i=e.children.length;i>t;t++)K(e.children[t])}},Q=function(e,t){h=0,P.objects.length=0,P.sprites.length=0,P.lights.length=0,K(e),t===!0&&P.objects.sort(a)};this.projectScene=function(e,l,h,T){var _,x,R,w,H,M,S,C,A,D,L,q,K,$,Z,J,et,tt,it,rt,nt,ot,at,st,lt,ht,ct=!1;for(p=0,f=0,g=0,E=0,P.elements.length=0,e.autoUpdate===!0&&e.updateMatrixWorld(),void 0===l.parent&&l.updateMatrixWorld(),O.copy(l.matrixWorldInverse.getInverse(l.matrixWorld)),U.multiplyMatrices(l.projectionMatrix,O),j.getNormalMatrix(O),G.setFromMatrix(U),Q(e,h),_=0,x=P.objects.length;x>_;_++)if(K=P.objects[_].object,y=K.matrixWorld,u=0,K instanceof THREE.Mesh){for($=K.geometry,Z=$.vertices,J=$.faces,it=$.faceVertexUvs,B.getNormalMatrix(y),lt=K.material instanceof THREE.MeshFaceMaterial,ht=lt===!0?K.material:null,R=0,w=Z.length;w>R;R++){c=t(),c.positionWorld.copy(Z[R]).applyMatrix4(y),c.positionScreen.copy(c.positionWorld).applyMatrix4(U);var ut=1/c.positionScreen.w;c.positionScreen.x*=ut,c.positionScreen.y*=ut,c.positionScreen.z*=ut,c.visible=!(c.positionScreen.x<-1||c.positionScreen.x>1||c.positionScreen.y<-1||c.positionScreen.y>1||c.positionScreen.z<-1||c.positionScreen.z>1)}for(H=0,M=J.length;M>H;H++){et=J[H];var dt=lt===!0?ht.materials[et.materialIndex]:K.material;if(void 0!==dt){var pt=dt.side;if(et instanceof THREE.Face3){if(nt=b[et.a],ot=b[et.b],at=b[et.c],N[0]=nt.positionScreen,N[1]=ot.positionScreen,N[2]=at.positionScreen,nt.visible!==!0&&ot.visible!==!0&&at.visible!==!0&&!F.isIntersectionBox(z.setFromPoints(N)))continue;if(ct=(at.positionScreen.x-nt.positionScreen.x)*(ot.positionScreen.y-nt.positionScreen.y)-(at.positionScreen.y-nt.positionScreen.y)*(ot.positionScreen.x-nt.positionScreen.x)<0,pt!==THREE.DoubleSide&&ct!==(pt===THREE.FrontSide))continue;d=i(),d.id=K.id,d.v1.copy(nt),d.v2.copy(ot),d.v3.copy(at)}else if(et instanceof THREE.Face4){if(nt=b[et.a],ot=b[et.b],at=b[et.c],st=b[et.d],I[0]=nt.positionScreen,I[1]=ot.positionScreen,I[2]=at.positionScreen,I[3]=st.positionScreen,nt.visible!==!0&&ot.visible!==!0&&at.visible!==!0&&st.visible!==!0&&!F.isIntersectionBox(z.setFromPoints(I)))continue;if(ct=(st.positionScreen.x-nt.positionScreen.x)*(ot.positionScreen.y-nt.positionScreen.y)-(st.positionScreen.y-nt.positionScreen.y)*(ot.positionScreen.x-nt.positionScreen.x)<0||(ot.positionScreen.x-at.positionScreen.x)*(st.positionScreen.y-at.positionScreen.y)-(ot.positionScreen.y-at.positionScreen.y)*(st.positionScreen.x-at.positionScreen.x)<0,pt!==THREE.DoubleSide&&ct!==(pt===THREE.FrontSide))continue;d=r(),d.id=K.id,d.v1.copy(nt),d.v2.copy(ot),d.v3.copy(at),d.v4.copy(st)}for(d.normalModel.copy(et.normal),ct!==!1||pt!==THREE.BackSide&&pt!==THREE.DoubleSide||d.normalModel.negate(),d.normalModel.applyMatrix3(B).normalize(),d.normalModelView.copy(d.normalModel).applyMatrix3(j),d.centroidModel.copy(et.centroid).applyMatrix4(y),tt=et.vertexNormals,S=0,C=tt.length;C>S;S++){var ft=d.vertexNormalsModel[S];ft.copy(tt[S]),ct!==!1||pt!==THREE.BackSide&&pt!==THREE.DoubleSide||ft.negate(),ft.applyMatrix3(B).normalize();var mt=d.vertexNormalsModelView[S];mt.copy(ft).applyMatrix3(j)}for(d.vertexNormalsLength=tt.length,A=0,D=it.length;D>A;A++)if(rt=it[A][H],void 0!==rt)for(L=0,q=rt.length;q>L;L++)d.uvs[A][L]=rt[L];d.color=et.color,d.material=dt,W.copy(d.centroidModel).applyProjection(U),d.z=W.z,P.elements.push(d)}}}else if(K instanceof THREE.Line){V.multiplyMatrices(U,y),Z=K.geometry.vertices,nt=t(),nt.positionScreen.copy(Z[0]).applyMatrix4(V);var gt=K.type===THREE.LinePieces?2:1;for(R=1,w=Z.length;w>R;R++)nt=t(),nt.positionScreen.copy(Z[R]).applyMatrix4(V),(R+1)%gt>0||(ot=b[u-2],X.copy(nt.positionScreen),Y.copy(ot.positionScreen),s(X,Y)===!0&&(X.multiplyScalar(1/X.w),Y.multiplyScalar(1/Y.w),m=n(),m.id=K.id,m.v1.positionScreen.copy(X),m.v2.positionScreen.copy(Y),m.z=Math.max(X.z,Y.z),m.material=K.material,K.material.vertexColors===THREE.VertexColors&&(m.vertexColors[0].copy(K.geometry.colors[R]),m.vertexColors[1].copy(K.geometry.colors[R-1])),P.elements.push(m)))}for(_=0,x=P.sprites.length;x>_;_++)if(K=P.sprites[_].object,y=K.matrixWorld,K instanceof THREE.Particle){k.set(y.elements[12],y.elements[13],y.elements[14],1),k.applyMatrix4(U);var ut=1/k.w;k.z*=ut,k.z>0&&k.z<1&&(v=o(),v.id=K.id,v.x=k.x*ut,v.y=k.y*ut,v.z=k.z,v.object=K,v.rotation=K.rotation.z,v.scale.x=K.scale.x*Math.abs(v.x-(k.x+l.projectionMatrix.elements[0])/(k.w+l.projectionMatrix.elements[12])),v.scale.y=K.scale.y*Math.abs(v.y-(k.y+l.projectionMatrix.elements[5])/(k.w+l.projectionMatrix.elements[13])),v.material=K.material,P.elements.push(v))}return T===!0&&P.elements.sort(a),P}},THREE.Face3=function(e,t,i,r,n,o){this.a=e,this.b=t,this.c=i,this.normal=r instanceof THREE.Vector3?r:new THREE.Vector3,this.vertexNormals=r instanceof Array?r:[],this.color=n instanceof THREE.Color?n:new THREE.Color,this.vertexColors=n instanceof Array?n:[],this.vertexTangents=[],this.materialIndex=void 0!==o?o:0,this.centroid=new THREE.Vector3},THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var e=new THREE.Face3(this.a,this.b,this.c);e.normal.copy(this.normal),e.color.copy(this.color),e.centroid.copy(this.centroid),e.materialIndex=this.materialIndex;var t,i;for(t=0,i=this.vertexNormals.length;i>t;t++)e.vertexNormals[t]=this.vertexNormals[t].clone();for(t=0,i=this.vertexColors.length;i>t;t++)e.vertexColors[t]=this.vertexColors[t].clone();for(t=0,i=this.vertexTangents.length;i>t;t++)e.vertexTangents[t]=this.vertexTangents[t].clone();return e}},THREE.Face4=function(e,t,i,r,n,o,a){this.a=e,this.b=t,this.c=i,this.d=r,this.normal=n instanceof THREE.Vector3?n:new THREE.Vector3,this.vertexNormals=n instanceof Array?n:[],this.color=o instanceof THREE.Color?o:new THREE.Color,this.vertexColors=o instanceof Array?o:[],this.vertexTangents=[],this.materialIndex=void 0!==a?a:0,this.centroid=new THREE.Vector3},THREE.Face4.prototype={constructor:THREE.Face4,clone:function(){var e=new THREE.Face4(this.a,this.b,this.c,this.d);e.normal.copy(this.normal),e.color.copy(this.color),e.centroid.copy(this.centroid),e.materialIndex=this.materialIndex;var t,i;for(t=0,i=this.vertexNormals.length;i>t;t++)e.vertexNormals[t]=this.vertexNormals[t].clone();for(t=0,i=this.vertexColors.length;i>t;t++)e.vertexColors[t]=this.vertexColors[t].clone();for(t=0,i=this.vertexTangents.length;i>t;t++)e.vertexTangents[t]=this.vertexTangents[t].clone();return e}},THREE.Geometry=function(){this.id=THREE.GeometryIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.vertices=[],this.colors=[],this.normals=[],this.faces=[],this.faceUvs=[[]],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.tangentsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.buffersNeedUpdate=!1},THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(e){for(var t=(new THREE.Matrix3).getNormalMatrix(e),i=0,r=this.vertices.length;r>i;i++){var n=this.vertices[i];n.applyMatrix4(e)}for(var i=0,r=this.faces.length;r>i;i++){var o=this.faces[i];o.normal.applyMatrix3(t).normalize();for(var a=0,s=o.vertexNormals.length;s>a;a++)o.vertexNormals[a].applyMatrix3(t).normalize();o.centroid.applyMatrix4(e)}this.boundingBox instanceof THREE.Box3&&this.computeBoundingBox(),this.boundingSphere instanceof THREE.Sphere&&this.computeBoundingSphere()},computeCentroids:function(){var e,t,i;for(e=0,t=this.faces.length;t>e;e++)i=this.faces[e],i.centroid.set(0,0,0),i instanceof THREE.Face3?(i.centroid.add(this.vertices[i.a]),i.centroid.add(this.vertices[i.b]),i.centroid.add(this.vertices[i.c]),i.centroid.divideScalar(3)):i instanceof THREE.Face4&&(i.centroid.add(this.vertices[i.a]),i.centroid.add(this.vertices[i.b]),i.centroid.add(this.vertices[i.c]),i.centroid.add(this.vertices[i.d]),i.centroid.divideScalar(4))},computeFaceNormals:function(){for(var e=new THREE.Vector3,t=new THREE.Vector3,i=0,r=this.faces.length;r>i;i++){var n=this.faces[i],o=this.vertices[n.a],a=this.vertices[n.b],s=this.vertices[n.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),n.normal.copy(e)}},computeVertexNormals:function(e){var t,i,r,n,o,a;if(void 0===this.__tmpVertices){for(this.__tmpVertices=new Array(this.vertices.length),a=this.__tmpVertices,t=0,i=this.vertices.length;i>t;t++)a[t]=new THREE.Vector3;for(r=0,n=this.faces.length;n>r;r++)o=this.faces[r],o instanceof THREE.Face3?o.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]:o instanceof THREE.Face4&&(o.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3])}else for(a=this.__tmpVertices,t=0,i=this.vertices.length;i>t;t++)a[t].set(0,0,0);if(e){var s,l,h,c,u=new THREE.Vector3,d=new THREE.Vector3,p=new THREE.Vector3,f=new THREE.Vector3,m=new THREE.Vector3;for(r=0,n=this.faces.length;n>r;r++)o=this.faces[r],o instanceof THREE.Face3?(s=this.vertices[o.a],l=this.vertices[o.b],h=this.vertices[o.c],u.subVectors(h,l),d.subVectors(s,l),u.cross(d),a[o.a].add(u),a[o.b].add(u),a[o.c].add(u)):o instanceof THREE.Face4&&(s=this.vertices[o.a],l=this.vertices[o.b],h=this.vertices[o.c],c=this.vertices[o.d],p.subVectors(c,l),d.subVectors(s,l),p.cross(d),a[o.a].add(p),a[o.b].add(p),a[o.d].add(p),f.subVectors(c,h),m.subVectors(l,h),f.cross(m),a[o.b].add(f),a[o.c].add(f),a[o.d].add(f))}else for(r=0,n=this.faces.length;n>r;r++)o=this.faces[r],o instanceof THREE.Face3?(a[o.a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal)):o instanceof THREE.Face4&&(a[o.a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal),a[o.d].add(o.normal));for(t=0,i=this.vertices.length;i>t;t++)a[t].normalize();for(r=0,n=this.faces.length;n>r;r++)o=this.faces[r],o instanceof THREE.Face3?(o.vertexNormals[0].copy(a[o.a]),o.vertexNormals[1].copy(a[o.b]),o.vertexNormals[2].copy(a[o.c])):o instanceof THREE.Face4&&(o.vertexNormals[0].copy(a[o.a]),o.vertexNormals[1].copy(a[o.b]),o.vertexNormals[2].copy(a[o.c]),o.vertexNormals[3].copy(a[o.d]))},computeMorphNormals:function(){var e,t,i,r,n;for(i=0,r=this.faces.length;r>i;i++)for(n=this.faces[i],n.__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone(),n.__originalVertexNormals||(n.__originalVertexNormals=[]),e=0,t=n.vertexNormals.length;t>e;e++)n.__originalVertexNormals[e]?n.__originalVertexNormals[e].copy(n.vertexNormals[e]):n.__originalVertexNormals[e]=n.vertexNormals[e].clone();var o=new THREE.Geometry;for(o.faces=this.faces,e=0,t=this.morphTargets.length;t>e;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a,s,l=this.morphNormals[e].faceNormals,h=this.morphNormals[e].vertexNormals;for(i=0,r=this.faces.length;r>i;i++)n=this.faces[i],a=new THREE.Vector3,s=n instanceof THREE.Face3?{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3}:{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3,d:new THREE.Vector3},l.push(a),h.push(s)}var c=this.morphNormals[e];o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals();var a,s;for(i=0,r=this.faces.length;r>i;i++)n=this.faces[i],a=c.faceNormals[i],s=c.vertexNormals[i],a.copy(n.normal),n instanceof THREE.Face3?(s.a.copy(n.vertexNormals[0]),s.b.copy(n.vertexNormals[1]),s.c.copy(n.vertexNormals[2])):(s.a.copy(n.vertexNormals[0]),s.b.copy(n.vertexNormals[1]),s.c.copy(n.vertexNormals[2]),s.d.copy(n.vertexNormals[3]))}for(i=0,r=this.faces.length;r>i;i++)n=this.faces[i],n.normal=n.__originalFaceNormal,n.vertexNormals=n.__originalVertexNormals},computeTangents:function(){function e(e,t,i,r,n,o,a){h=e.vertices[t],c=e.vertices[i],u=e.vertices[r],d=l[n],p=l[o],f=l[a],m=c.x-h.x,g=u.x-h.x,v=c.y-h.y,E=u.y-h.y,y=c.z-h.z,T=u.z-h.z,_=p.x-d.x,b=f.x-d.x,x=p.y-d.y,R=f.y-d.y,w=1/(_*R-b*x),D.set((R*m-x*g)*w,(R*v-x*E)*w,(R*y-x*T)*w),P.set((_*g-b*m)*w,(_*E-b*v)*w,(_*T-b*y)*w),C[t].add(D),C[i].add(D),C[r].add(D),A[t].add(P),A[i].add(P),A[r].add(P)}var t,i,r,n,o,a,s,l,h,c,u,d,p,f,m,g,v,E,y,T,_,b,x,R,w,H,M,S,C=[],A=[],D=new THREE.Vector3,P=new THREE.Vector3,L=new THREE.Vector3,k=new THREE.Vector3,F=new THREE.Vector3;for(r=0,n=this.vertices.length;n>r;r++)C[r]=new THREE.Vector3,A[r]=new THREE.Vector3;for(t=0,i=this.faces.length;i>t;t++)s=this.faces[t],l=this.faceVertexUvs[0][t],s instanceof THREE.Face3?e(this,s.a,s.b,s.c,0,1,2):s instanceof THREE.Face4&&(e(this,s.a,s.b,s.d,0,1,3),e(this,s.b,s.c,s.d,1,2,3));var z=["a","b","c","d"];for(t=0,i=this.faces.length;i>t;t++)for(s=this.faces[t],o=0;o<s.vertexNormals.length;o++)F.copy(s.vertexNormals[o]),a=s[z[o]],H=C[a],L.copy(H),L.sub(F.multiplyScalar(F.dot(H))).normalize(),k.crossVectors(s.vertexNormals[o],H),M=k.dot(A[a]),S=0>M?-1:1,s.vertexTangents[o]=new THREE.Vector4(L.x,L.y,L.z,S);this.hasTangents=!0},computeLineDistances:function(){for(var e=0,t=this.vertices,i=0,r=t.length;r>i;i++)i>0&&(e+=t[i].distanceTo(t[i-1])),this.lineDistances[i]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),this.boundingSphere.setFromPoints(this.vertices)},mergeVertices:function(){var e,t,i,r,n,o,a,s,l,h={},c=[],u=[],d=4,p=Math.pow(10,d);for(this.__tmpVertices=void 0,i=0,r=this.vertices.length;r>i;i++)e=this.vertices[i],t=Math.round(e.x*p)+"_"+Math.round(e.y*p)+"_"+Math.round(e.z*p),void 0===h[t]?(h[t]=i,c.push(this.vertices[i]),u[i]=c.length-1):u[i]=u[h[t]];var f=[];for(i=0,r=this.faces.length;r>i;i++)if(n=this.faces[i],n instanceof THREE.Face3){n.a=u[n.a],n.b=u[n.b],n.c=u[n.c],o=[n.a,n.b,n.c];for(var m=-1,g=0;3>g;g++)if(o[g]==o[(g+1)%3]){m=g,f.push(i);break}}else if(n instanceof THREE.Face4){n.a=u[n.a],n.b=u[n.b],n.c=u[n.c],n.d=u[n.d],o=[n.a,n.b,n.c,n.d];for(var m=-1,g=0;4>g;g++)o[g]==o[(g+1)%4]&&(m>=0&&f.push(i),m=g);if(m>=0){o.splice(m,1);var v=new THREE.Face3(o[0],o[1],o[2],n.normal,n.color,n.materialIndex);for(a=0,s=this.faceVertexUvs.length;s>a;a++)l=this.faceVertexUvs[a][i],l&&l.splice(m,1);n.vertexNormals&&n.vertexNormals.length>0&&(v.vertexNormals=n.vertexNormals,v.vertexNormals.splice(m,1)),n.vertexColors&&n.vertexColors.length>0&&(v.vertexColors=n.vertexColors,v.vertexColors.splice(m,1)),this.faces[i]=v}}for(i=f.length-1;i>=0;i--)for(this.faces.splice(i,1),a=0,s=this.faceVertexUvs.length;s>a;a++)this.faceVertexUvs[a].splice(i,1);var E=this.vertices.length-c.length;return this.vertices=c,E},clone:function(){for(var e=new THREE.Geometry,t=this.vertices,i=0,r=t.length;r>i;i++)e.vertices.push(t[i].clone());for(var n=this.faces,i=0,r=n.length;r>i;i++)e.faces.push(n[i].clone());for(var o=this.faceVertexUvs[0],i=0,r=o.length;r>i;i++){for(var a=o[i],s=[],l=0,h=a.length;h>l;l++)s.push(new THREE.Vector2(a[l].x,a[l].y));e.faceVertexUvs[0].push(s)}return e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype),THREE.GeometryIdCount=0,THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++,this.uuid=THREE.Math.generateUUID(),this.attributes={},this.dynamic=!1,this.offsets=[],this.boundingBox=null,this.boundingSphere=null,this.hasTangents=!1,this.morphTargets=[]},THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,applyMatrix:function(e){var t,i;if(this.attributes.position&&(t=this.attributes.position.array),this.attributes.normal&&(i=this.attributes.normal.array),void 0!==t&&(e.multiplyVector3Array(t),this.verticesNeedUpdate=!0),void 0!==i){var r=(new THREE.Matrix3).getNormalMatrix(e);r.multiplyVector3Array(i),this.normalizeNormals(),this.normalsNeedUpdate=!0}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);
var e=this.attributes.position.array;if(e){var t,i,r,n=this.boundingBox;e.length>=3&&(n.min.x=n.max.x=e[0],n.min.y=n.max.y=e[1],n.min.z=n.max.z=e[2]);for(var o=3,a=e.length;a>o;o+=3)t=e[o],i=e[o+1],r=e[o+2],t<n.min.x?n.min.x=t:t>n.max.x&&(n.max.x=t),i<n.min.y?n.min.y=i:i>n.max.y&&(n.max.y=i),r<n.min.z?n.min.z=r:r>n.max.z&&(n.max.z=r)}(void 0===e||0===e.length)&&(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0))},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var e=this.attributes.position.array;if(e){for(var t,i,r,n,o=0,a=0,s=e.length;s>a;a+=3)i=e[a],r=e[a+1],n=e[a+2],t=i*i+r*r+n*n,t>o&&(o=t);this.boundingSphere.radius=Math.sqrt(o)}},computeVertexNormals:function(){if(this.attributes.position){var e,t,i,r,n=this.attributes.position.array.length;if(void 0===this.attributes.normal)this.attributes.normal={itemSize:3,array:new Float32Array(n)};else for(e=0,t=this.attributes.normal.array.length;t>e;e++)this.attributes.normal.array[e]=0;var o,a,s,l,h,c,u=this.attributes.position.array,d=this.attributes.normal.array,p=new THREE.Vector3,f=new THREE.Vector3,m=new THREE.Vector3,g=new THREE.Vector3,v=new THREE.Vector3;if(this.attributes.index){var E=this.attributes.index.array,y=this.offsets;for(i=0,r=y.length;r>i;++i){var T=y[i].start,_=y[i].count,b=y[i].index;for(e=T,t=T+_;t>e;e+=3)o=b+E[e],a=b+E[e+1],s=b+E[e+2],l=u[3*o],h=u[3*o+1],c=u[3*o+2],p.set(l,h,c),l=u[3*a],h=u[3*a+1],c=u[3*a+2],f.set(l,h,c),l=u[3*s],h=u[3*s+1],c=u[3*s+2],m.set(l,h,c),g.subVectors(m,f),v.subVectors(p,f),g.cross(v),d[3*o]+=g.x,d[3*o+1]+=g.y,d[3*o+2]+=g.z,d[3*a]+=g.x,d[3*a+1]+=g.y,d[3*a+2]+=g.z,d[3*s]+=g.x,d[3*s+1]+=g.y,d[3*s+2]+=g.z}}else for(e=0,t=u.length;t>e;e+=9)l=u[e],h=u[e+1],c=u[e+2],p.set(l,h,c),l=u[e+3],h=u[e+4],c=u[e+5],f.set(l,h,c),l=u[e+6],h=u[e+7],c=u[e+8],m.set(l,h,c),g.subVectors(m,f),v.subVectors(p,f),g.cross(v),d[e]=g.x,d[e+1]=g.y,d[e+2]=g.z,d[e+3]=g.x,d[e+4]=g.y,d[e+5]=g.z,d[e+6]=g.x,d[e+7]=g.y,d[e+8]=g.z;this.normalizeNormals(),this.normalsNeedUpdate=!0}},normalizeNormals:function(){for(var e,t,i,r,n=this.attributes.normal.array,o=0,a=n.length;a>o;o+=3)e=n[o],t=n[o+1],i=n[o+2],r=1/Math.sqrt(e*e+t*t+i*i),n[o]*=r,n[o+1]*=r,n[o+2]*=r},computeTangents:function(){function e(e,t,i){d=r[3*e],p=r[3*e+1],f=r[3*e+2],m=r[3*t],g=r[3*t+1],v=r[3*t+2],E=r[3*i],y=r[3*i+1],T=r[3*i+2],_=o[2*e],b=o[2*e+1],x=o[2*t],R=o[2*t+1],w=o[2*i],H=o[2*i+1],M=m-d,S=E-d,C=g-p,A=y-p,D=v-f,P=T-f,L=x-_,k=w-_,F=R-b,z=H-b,N=1/(L*z-k*F),G.set((z*M-F*S)*N,(z*C-F*A)*N,(z*D-F*P)*N),X.set((L*S-k*M)*N,(L*A-k*C)*N,(L*P-k*D)*N),h[e].add(G),h[t].add(G),h[i].add(G),c[e].add(X),c[t].add(X),c[i].add(X)}function t(e){it.x=n[3*e],it.y=n[3*e+1],it.z=n[3*e+2],rt.copy(it),Z=h[e],et.copy(Z),et.sub(it.multiplyScalar(it.dot(Z))).normalize(),tt.crossVectors(rt,Z),J=tt.dot(c[e]),$=0>J?-1:1,l[4*e]=et.x,l[4*e+1]=et.y,l[4*e+2]=et.z,l[4*e+3]=$}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)return console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()"),void 0;var i=this.attributes.index.array,r=this.attributes.position.array,n=this.attributes.normal.array,o=this.attributes.uv.array,a=r.length/3;if(void 0===this.attributes.tangent){var s=4*a;this.attributes.tangent={itemSize:4,array:new Float32Array(s)}}for(var l=this.attributes.tangent.array,h=[],c=[],u=0;a>u;u++)h[u]=new THREE.Vector3,c[u]=new THREE.Vector3;var d,p,f,m,g,v,E,y,T,_,b,x,R,w,H,M,S,C,A,D,P,L,k,F,z,N,I,O,U,V,B,j,W,G=new THREE.Vector3,X=new THREE.Vector3,Y=this.offsets;for(U=0,V=Y.length;V>U;++U){var q=Y[U].start,K=Y[U].count,Q=Y[U].index;for(I=q,O=q+K;O>I;I+=3)B=Q+i[I],j=Q+i[I+1],W=Q+i[I+2],e(B,j,W)}var $,Z,J,et=new THREE.Vector3,tt=new THREE.Vector3,it=new THREE.Vector3,rt=new THREE.Vector3;for(U=0,V=Y.length;V>U;++U){var q=Y[U].start,K=Y[U].count,Q=Y[U].index;for(I=q,O=q+K;O>I;I+=3)B=Q+i[I],j=Q+i[I+1],W=Q+i[I+2],t(B),t(j),t(W)}this.hasTangents=!0,this.tangentsNeedUpdate=!0},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype),THREE.Camera=function(){THREE.Object3D.call(this),this.matrixWorldInverse=new THREE.Matrix4,this.projectionMatrix=new THREE.Matrix4,this.projectionMatrixInverse=new THREE.Matrix4},THREE.Camera.prototype=Object.create(THREE.Object3D.prototype),THREE.Camera.prototype.lookAt=function(){var e=new THREE.Matrix4;return function(t){e.lookAt(this.position,t,this.up),this.quaternion.setFromRotationMatrix(e)}}(),THREE.OrthographicCamera=function(e,t,i,r,n,o){THREE.Camera.call(this),this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=void 0!==n?n:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()},THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype),THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)},THREE.PerspectiveCamera=function(e,t,i,r){THREE.Camera.call(this),this.fov=void 0!==e?e:50,this.aspect=void 0!==t?t:1,this.near=void 0!==i?i:.1,this.far=void 0!==r?r:2e3,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype),THREE.PerspectiveCamera.prototype.setLens=function(e,t){void 0===t&&(t=24),this.fov=2*THREE.Math.radToDeg(Math.atan(t/(2*e))),this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.setViewOffset=function(e,t,i,r,n,o){this.fullWidth=e,this.fullHeight=t,this.x=i,this.y=r,this.width=n,this.height=o,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var e=this.fullWidth/this.fullHeight,t=Math.tan(THREE.Math.degToRad(.5*this.fov))*this.near,i=-t,r=e*i,n=e*t,o=Math.abs(n-r),a=Math.abs(t-i);this.projectionMatrix.makeFrustum(r+this.x*o/this.fullWidth,r+(this.x+this.width)*o/this.fullWidth,t-(this.y+this.height)*a/this.fullHeight,t-this.y*a/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)},THREE.Light=function(e){THREE.Object3D.call(this),this.color=new THREE.Color(e)},THREE.Light.prototype=Object.create(THREE.Object3D.prototype),THREE.Light.prototype.clone=function(e){return void 0===e&&(e=new THREE.Light),THREE.Object3D.prototype.clone.call(this,e),e.color.copy(this.color),e},THREE.AmbientLight=function(e){THREE.Light.call(this,e)},THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype),THREE.AmbientLight.prototype.clone=function(){var e=new THREE.AmbientLight;return THREE.Light.prototype.clone.call(this,e),e},THREE.AreaLight=function(e,t){THREE.Light.call(this,e),this.normal=new THREE.Vector3(0,-1,0),this.right=new THREE.Vector3(1,0,0),this.intensity=void 0!==t?t:1,this.width=1,this.height=1,this.constantAttenuation=1.5,this.linearAttenuation=.5,this.quadraticAttenuation=.1},THREE.AreaLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight=function(e,t){THREE.Light.call(this,e),this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==t?t:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraRight=500,this.shadowCameraTop=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowCascade=!1,this.shadowCascadeOffset=new THREE.Vector3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,.99,.998],this.shadowCascadeFarZ=[.99,.998,1],this.shadowCascadeArray=[],this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight.prototype.clone=function(){var e=new THREE.DirectionalLight;return THREE.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e},THREE.HemisphereLight=function(e,t,i){THREE.Light.call(this,e),this.position.set(0,100,0),this.groundColor=new THREE.Color(t),this.intensity=void 0!==i?i:1},THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype),THREE.HemisphereLight.prototype.clone=function(){var e=new THREE.PointLight;return THREE.Light.prototype.clone.call(this,e),e.groundColor.copy(this.groundColor),e.intensity=this.intensity,e},THREE.PointLight=function(e,t,i){THREE.Light.call(this,e),this.intensity=void 0!==t?t:1,this.distance=void 0!==i?i:0},THREE.PointLight.prototype=Object.create(THREE.Light.prototype),THREE.PointLight.prototype.clone=function(){var e=new THREE.PointLight;return THREE.Light.prototype.clone.call(this,e),e.intensity=this.intensity,e.distance=this.distance,e},THREE.SpotLight=function(e,t,i,r,n){THREE.Light.call(this,e),this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==t?t:1,this.distance=void 0!==i?i:0,this.angle=void 0!==r?r:Math.PI/3,this.exponent=void 0!==n?n:10,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},THREE.SpotLight.prototype=Object.create(THREE.Light.prototype),THREE.SpotLight.prototype.clone=function(){var e=new THREE.SpotLight;return THREE.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.distance=this.distance,e.angle=this.angle,e.exponent=this.exponent,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e},THREE.Loader=function(e){this.showStatus=e,this.statusDomElement=e?THREE.Loader.prototype.addStatusElement():null,this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:"anonymous",addStatusElement:function(){var e=document.createElement("div");return e.style.position="absolute",e.style.right="0px",e.style.top="0px",e.style.fontSize="0.8em",e.style.textAlign="left",e.style.background="rgba(0,0,0,0.25)",e.style.color="#fff",e.style.width="120px",e.style.padding="0.5em 0.5em 0.5em 0.5em",e.style.zIndex=1e3,e.innerHTML="Loading ...",e},updateProgress:function(e){var t="Loaded ";t+=e.total?(100*e.loaded/e.total).toFixed(0)+"%":(e.loaded/1e3).toFixed(2)+" KB",this.statusDomElement.innerHTML=t},extractUrlBase:function(e){var t=e.split("/");return t.pop(),(t.length<1?".":t.join("/"))+"/"},initMaterials:function(e,t){for(var i=[],r=0;r<e.length;++r)i[r]=THREE.Loader.prototype.createMaterial(e[r],t);return i},needsTangents:function(e){for(var t=0,i=e.length;i>t;t++){var r=e[t];if(r instanceof THREE.ShaderMaterial)return!0}return!1},createMaterial:function(e,t){function i(e){var t=Math.log(e)/Math.LN2;return Math.floor(t)==t}function r(e){var t=Math.log(e)/Math.LN2;return Math.pow(2,Math.round(t))}function n(e,t){var n=new Image;n.onload=function(){if(i(this.width)&&i(this.height))e.image=this;else{var t=r(this.width),n=r(this.height);e.image.width=t,e.image.height=n,e.image.getContext("2d").drawImage(this,0,0,t,n)}e.needsUpdate=!0},n.crossOrigin=s.crossOrigin,n.src=t}function o(e,i,r,o,a,s,l){var h=/\.dds$/i.test(r),c=t+"/"+r;if(h){var u=THREE.ImageUtils.loadCompressedTexture(c);e[i]=u}else{var u=document.createElement("canvas");e[i]=new THREE.Texture(u)}if(e[i].sourceFile=r,o&&(e[i].repeat.set(o[0],o[1]),1!==o[0]&&(e[i].wrapS=THREE.RepeatWrapping),1!==o[1]&&(e[i].wrapT=THREE.RepeatWrapping)),a&&e[i].offset.set(a[0],a[1]),s){var d={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping};void 0!==d[s[0]]&&(e[i].wrapS=d[s[0]]),void 0!==d[s[1]]&&(e[i].wrapT=d[s[1]])}l&&(e[i].anisotropy=l),h||n(e[i],c)}function a(e){return(255*e[0]<<16)+(255*e[1]<<8)+255*e[2]}var s=this,l="MeshLambertMaterial",h={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(e.shading){var c=e.shading.toLowerCase();"phong"===c?l="MeshPhongMaterial":"basic"===c&&(l="MeshBasicMaterial")}if(void 0!==e.blending&&void 0!==THREE[e.blending]&&(h.blending=THREE[e.blending]),(void 0!==e.transparent||e.opacity<1)&&(h.transparent=e.transparent),void 0!==e.depthTest&&(h.depthTest=e.depthTest),void 0!==e.depthWrite&&(h.depthWrite=e.depthWrite),void 0!==e.visible&&(h.visible=e.visible),void 0!==e.flipSided&&(h.side=THREE.BackSide),void 0!==e.doubleSided&&(h.side=THREE.DoubleSide),void 0!==e.wireframe&&(h.wireframe=e.wireframe),void 0!==e.vertexColors&&("face"===e.vertexColors?h.vertexColors=THREE.FaceColors:e.vertexColors&&(h.vertexColors=THREE.VertexColors)),e.colorDiffuse?h.color=a(e.colorDiffuse):e.DbgColor&&(h.color=e.DbgColor),e.colorSpecular&&(h.specular=a(e.colorSpecular)),e.colorAmbient&&(h.ambient=a(e.colorAmbient)),e.transparency&&(h.opacity=e.transparency),e.specularCoef&&(h.shininess=e.specularCoef),e.mapDiffuse&&t&&o(h,"map",e.mapDiffuse,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy),e.mapLight&&t&&o(h,"lightMap",e.mapLight,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy),e.mapBump&&t&&o(h,"bumpMap",e.mapBump,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy),e.mapNormal&&t&&o(h,"normalMap",e.mapNormal,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy),e.mapSpecular&&t&&o(h,"specularMap",e.mapSpecular,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy),e.mapBumpScale&&(h.bumpScale=e.mapBumpScale),e.mapNormal){var u=THREE.ShaderLib.normalmap,d=THREE.UniformsUtils.clone(u.uniforms);d.tNormal.value=h.normalMap,e.mapNormalFactor&&d.uNormalScale.value.set(e.mapNormalFactor,e.mapNormalFactor),h.map&&(d.tDiffuse.value=h.map,d.enableDiffuse.value=!0),h.specularMap&&(d.tSpecular.value=h.specularMap,d.enableSpecular.value=!0),h.lightMap&&(d.tAO.value=h.lightMap,d.enableAO.value=!0),d.uDiffuseColor.value.setHex(h.color),d.uSpecularColor.value.setHex(h.specular),d.uAmbientColor.value.setHex(h.ambient),d.uShininess.value=h.shininess,void 0!==h.opacity&&(d.uOpacity.value=h.opacity);var p={fragmentShader:u.fragmentShader,vertexShader:u.vertexShader,uniforms:d,lights:!0,fog:!0},f=new THREE.ShaderMaterial(p);h.transparent&&(f.transparent=!0)}else var f=new THREE[l](h);return void 0!==e.DbgName&&(f.name=e.DbgName),f}},THREE.XHRLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(e,t,i,r){var n=this,o=new XMLHttpRequest;void 0!==t&&o.addEventListener("load",function(i){n.manager.itemEnd(e),t(i.target.responseText)},!1),void 0!==i&&o.addEventListener("progress",function(e){i(e)},!1),void 0!==r&&o.addEventListener("error",function(e){r(e)},!1),void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),o.open("GET",e,!0),o.send(null),n.manager.itemStart(e)},setCrossOrigin:function(e){this.crossOrigin=e}},THREE.ImageLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(e,t,i,r){var n=this,o=document.createElement("img");void 0!==t&&o.addEventListener("load",function(){n.manager.itemEnd(e),t(this)},!1),void 0!==i&&o.addEventListener("progress",function(e){i(e)},!1),void 0!==r&&o.addEventListener("error",function(e){r(e)},!1),void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),o.src=e,n.manager.itemStart(e)},setCrossOrigin:function(e){this.crossOrigin=e}},THREE.JSONLoader=function(e){THREE.Loader.call(this,e),this.withCredentials=!1},THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype),THREE.JSONLoader.prototype.load=function(e,t,i){i=i&&"string"==typeof i?i:this.extractUrlBase(e),this.onLoadStart(),this.loadAjaxJSON(this,e,t,i)},THREE.JSONLoader.prototype.loadAjaxJSON=function(e,t,i,r,n){var o=new XMLHttpRequest,a=0;o.onreadystatechange=function(){if(o.readyState===o.DONE)if(200===o.status||0===o.status){if(o.responseText){var s=JSON.parse(o.responseText),l=e.parse(s,r);i(l.geometry,l.materials)}else console.warn("THREE.JSONLoader: ["+t+"] seems to be unreachable or file there is empty");e.onLoadComplete()}else console.error("THREE.JSONLoader: Couldn't load ["+t+"] ["+o.status+"]");else o.readyState===o.LOADING?n&&(0===a&&(a=o.getResponseHeader("Content-Length")),n({total:a,loaded:o.responseText.length})):o.readyState===o.HEADERS_RECEIVED&&void 0!==n&&(a=o.getResponseHeader("Content-Length"))},o.open("GET",t,!0),o.withCredentials=this.withCredentials,o.send(null)},THREE.JSONLoader.prototype.parse=function(e,t){function i(t){function i(e,t){return e&1<<t}var r,n,a,s,l,h,c,u,d,p,f,m,g,v,E,y,T,_,b,x,R,w,H,M,S,C,A,D=e.faces,P=e.vertices,L=e.normals,k=e.colors,F=0;if(void 0!==e.uvs){for(r=0;r<e.uvs.length;r++)e.uvs[r].length&&F++;for(r=0;F>r;r++)o.faceUvs[r]=[],o.faceVertexUvs[r]=[]}for(s=0,l=P.length;l>s;)x=new THREE.Vector3,x.x=P[s++]*t,x.y=P[s++]*t,x.z=P[s++]*t,o.vertices.push(x);for(s=0,l=D.length;l>s;){if(f=D[s++],m=i(f,0),g=i(f,1),v=i(f,2),E=i(f,3),y=i(f,4),T=i(f,5),_=i(f,6),b=i(f,7),m?(R=new THREE.Face4,R.a=D[s++],R.b=D[s++],R.c=D[s++],R.d=D[s++],h=4):(R=new THREE.Face3,R.a=D[s++],R.b=D[s++],R.c=D[s++],h=3),g&&(p=D[s++],R.materialIndex=p),a=o.faces.length,v)for(r=0;F>r;r++)M=e.uvs[r],d=D[s++],C=M[2*d],A=M[2*d+1],o.faceUvs[r][a]=new THREE.Vector2(C,A);if(E)for(r=0;F>r;r++){for(M=e.uvs[r],S=[],n=0;h>n;n++)d=D[s++],C=M[2*d],A=M[2*d+1],S[n]=new THREE.Vector2(C,A);o.faceVertexUvs[r][a]=S}if(y&&(u=3*D[s++],H=new THREE.Vector3,H.x=L[u++],H.y=L[u++],H.z=L[u],R.normal=H),T)for(r=0;h>r;r++)u=3*D[s++],H=new THREE.Vector3,H.x=L[u++],H.y=L[u++],H.z=L[u],R.vertexNormals.push(H);if(_&&(c=D[s++],w=new THREE.Color(k[c]),R.color=w),b)for(r=0;h>r;r++)c=D[s++],w=new THREE.Color(k[c]),R.vertexColors.push(w);o.faces.push(R)}}function r(){var t,i,r,n,a,s,l,h,c,u;if(e.skinWeights)for(t=0,i=e.skinWeights.length;i>t;t+=2)r=e.skinWeights[t],n=e.skinWeights[t+1],a=0,s=0,o.skinWeights.push(new THREE.Vector4(r,n,a,s));if(e.skinIndices)for(t=0,i=e.skinIndices.length;i>t;t+=2)l=e.skinIndices[t],h=e.skinIndices[t+1],c=0,u=0,o.skinIndices.push(new THREE.Vector4(l,h,c,u));o.bones=e.bones,o.animation=e.animation}function n(t){if(void 0!==e.morphTargets){var i,r,n,a,s,l;for(i=0,r=e.morphTargets.length;r>i;i++)for(o.morphTargets[i]={},o.morphTargets[i].name=e.morphTargets[i].name,o.morphTargets[i].vertices=[],s=o.morphTargets[i].vertices,l=e.morphTargets[i].vertices,n=0,a=l.length;a>n;n+=3){var h=new THREE.Vector3;h.x=l[n]*t,h.y=l[n+1]*t,h.z=l[n+2]*t,s.push(h)}}if(void 0!==e.morphColors){var i,r,c,u,d,p,f;for(i=0,r=e.morphColors.length;r>i;i++)for(o.morphColors[i]={},o.morphColors[i].name=e.morphColors[i].name,o.morphColors[i].colors=[],d=o.morphColors[i].colors,p=e.morphColors[i].colors,c=0,u=p.length;u>c;c+=3)f=new THREE.Color(16755200),f.setRGB(p[c],p[c+1],p[c+2]),d.push(f)}}var o=new THREE.Geometry,a=void 0!==e.scale?1/e.scale:1;if(i(a),r(),n(a),o.computeCentroids(),o.computeFaceNormals(),o.computeBoundingSphere(),void 0===e.materials)return{geometry:o};var s=this.initMaterials(e.materials,t);return this.needsTangents(s)&&o.computeTangents(),{geometry:o,materials:s}},THREE.LoadingManager=function(e,t,i){var r=this,n=0,o=0;this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(){o++},this.itemEnd=function(e){n++,void 0!==r.onProgress&&r.onProgress(e,n,o),n===o&&void 0!==r.onLoad&&r.onLoad()}},THREE.DefaultLoadingManager=new THREE.LoadingManager,THREE.GeometryLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.GeometryLoader.prototype={constructor:THREE.GeometryLoader,load:function(e,t){var i=this,r=new THREE.XHRLoader;r.setCrossOrigin(this.crossOrigin),r.load(e,function(e){t(i.parse(JSON.parse(e)))})},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(){}},THREE.MaterialLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(e,t){var i=this,r=new THREE.XHRLoader;r.setCrossOrigin(this.crossOrigin),r.load(e,function(e){t(i.parse(JSON.parse(e)))})},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t;switch(e.type){case"MeshBasicMaterial":t=new THREE.MeshBasicMaterial({color:e.color,opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshLambertMaterial":t=new THREE.MeshLambertMaterial({color:e.color,ambient:e.ambient,emissive:e.emissive,opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshPhongMaterial":t=new THREE.MeshPhongMaterial({color:e.color,ambient:e.ambient,emissive:e.emissive,specular:e.specular,shininess:e.shininess,opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshNormalMaterial":t=new THREE.MeshNormalMaterial({opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshDepthMaterial":t=new THREE.MeshDepthMaterial({opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe})}return void 0!==e.vertexColors&&(t.vertexColors=e.vertexColors),t}},THREE.ObjectLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(e,t){var i=this,r=new THREE.XHRLoader(i.manager);r.setCrossOrigin(this.crossOrigin),r.load(e,function(e){t(i.parse(JSON.parse(e)))})},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t=this.parseGeometries(e.geometries),i=this.parseMaterials(e.materials),r=this.parseObject(e.object,t,i);return r},parseGeometries:function(e){var t={};if(void 0!==e)for(var i=new THREE.JSONLoader,r=0,n=e.length;n>r;r++){var o,a=e[r];switch(a.type){case"PlaneGeometry":o=new THREE.PlaneGeometry(a.width,a.height,a.widthSegments,a.heightSegments);break;case"CubeGeometry":o=new THREE.CubeGeometry(a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments);break;case"CylinderGeometry":o=new THREE.CylinderGeometry(a.radiusTop,a.radiusBottom,a.height,a.radiusSegments,a.heightSegments,a.openEnded);break;case"SphereGeometry":o=new THREE.SphereGeometry(a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength);break;case"IcosahedronGeometry":o=new THREE.IcosahedronGeometry(a.radius,a.detail);break;case"TorusGeometry":o=new THREE.TorusGeometry(a.radius,a.tube,a.radialSegments,a.tubularSegments,a.arc);break;case"TorusKnotGeometry":o=new THREE.TorusKnotGeometry(a.radius,a.tube,a.radialSegments,a.tubularSegments,a.p,a.q,a.heightScale);break;case"Geometry":o=i.parse(a.data).geometry}o.uuid=a.uuid,void 0!==a.name&&(o.name=a.name),t[a.uuid]=o}return t},parseMaterials:function(e){var t={};if(void 0!==e)for(var i=new THREE.MaterialLoader,r=0,n=e.length;n>r;r++){var o=e[r],a=i.parse(o);a.uuid=o.uuid,void 0!==o.name&&(a.name=o.name),t[o.uuid]=a}return t},parseObject:function(){var e=new THREE.Matrix4;return function(t,i,r){var n;switch(t.type){case"Scene":n=new THREE.Scene;break;case"PerspectiveCamera":n=new THREE.PerspectiveCamera(t.fov,t.aspect,t.near,t.far);break;case"OrthographicCamera":n=new THREE.OrthographicCamera(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":n=new THREE.AmbientLight(t.color);break;case"DirectionalLight":n=new THREE.DirectionalLight(t.color,t.intensity);break;case"PointLight":n=new THREE.PointLight(t.color,t.intensity,t.distance);break;case"SpotLight":n=new THREE.SpotLight(t.color,t.intensity,t.distance,t.angle,t.exponent);break;case"HemisphereLight":n=new THREE.HemisphereLight(t.color,t.groundColor,t.intensity);break;case"Mesh":var o=i[t.geometry],a=r[t.material];void 0===o&&console.error("THREE.ObjectLoader: Undefined geometry "+t.geometry),void 0===a&&console.error("THREE.ObjectLoader: Undefined material "+t.material),n=new THREE.Mesh(o,a);break;default:n=new THREE.Object3D}if(n.uuid=t.uuid,void 0!==t.name&&(n.name=t.name),void 0!==t.matrix?(e.fromArray(t.matrix),e.decompose(n.position,n.quaternion,n.scale)):(void 0!==t.position&&n.position.fromArray(t.position),void 0!==t.rotation&&n.rotation.fromArray(t.rotation),void 0!==t.scale&&n.scale.fromArray(t.scale)),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.children)for(var s in t.children)n.add(this.parseObject(t.children[s],i,r));return n}}()},THREE.SceneLoader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){},this.callbackSync=function(){},this.callbackProgress=function(){},this.geometryHandlers={},this.hierarchyHandlers={},this.addGeometryHandler("ascii",THREE.JSONLoader)},THREE.SceneLoader.prototype={constructor:THREE.SceneLoader,load:function(e,t){var i=this,r=new THREE.XHRLoader(i.manager);r.setCrossOrigin(this.crossOrigin),r.load(e,function(r){i.parse(JSON.parse(r),t,e)})},setCrossOrigin:function(e){this.crossOrigin=e},addGeometryHandler:function(e,t){this.geometryHandlers[e]={loaderClass:t}},addHierarchyHandler:function(e,t){this.hierarchyHandlers[e]={loaderClass:t}},parse:function(e,t,i){function r(e,t){return"relativeToHTML"==t?e:C+"/"+e}function n(){o(M.scene,D.objects)}function o(e,t){var i,n,a,s,l,c;for(var u in t){var d=M.objects[u],p=t[u];if(void 0===d){if(p.type&&p.type in S.hierarchyHandlers){if(void 0===p.loading){var v={type:1,url:1,material:1,position:1,rotation:1,scale:1,visible:1,children:1,userData:1,skin:1,morph:1,mirroredLoop:1,duration:1},E={};for(var y in p)y in v||(E[y]=p[y]);m=M.materials[p.material],p.loading=!0;var x=S.hierarchyHandlers[p.type].loaderObject;x.options?x.load(r(p.url,D.urlBaseType),h(u,e,m,p)):x.load(r(p.url,D.urlBaseType),h(u,e,m,p),E)}}else if(void 0!==p.geometry){if(f=M.geometries[p.geometry]){var R=!1;if(m=M.materials[p.material],R=m instanceof THREE.ShaderMaterial,a=p.position,s=p.rotation,l=p.scale,i=p.matrix,c=p.quaternion,p.material||(m=new THREE.MeshFaceMaterial(M.face_materials[p.geometry])),m instanceof THREE.MeshFaceMaterial&&0===m.materials.length&&(m=new THREE.MeshFaceMaterial(M.face_materials[p.geometry])),m instanceof THREE.MeshFaceMaterial)for(var w=0;w<m.materials.length;w++)R=R||m.materials[w]instanceof THREE.ShaderMaterial;R&&f.computeTangents(),p.skin?d=new THREE.SkinnedMesh(f,m):p.morph?(d=new THREE.MorphAnimMesh(f,m),void 0!==p.duration&&(d.duration=p.duration),void 0!==p.time&&(d.time=p.time),void 0!==p.mirroredLoop&&(d.mirroredLoop=p.mirroredLoop),m.morphNormals&&f.computeMorphNormals()):d=new THREE.Mesh(f,m),d.name=u,i?(d.matrixAutoUpdate=!1,d.matrix.set(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9],i[10],i[11],i[12],i[13],i[14],i[15])):(d.position.fromArray(a),c?d.quaternion.fromArray(c):d.rotation.fromArray(s),d.scale.fromArray(l)),d.visible=p.visible,d.castShadow=p.castShadow,d.receiveShadow=p.receiveShadow,e.add(d),M.objects[u]=d}}else"DirectionalLight"===p.type||"PointLight"===p.type||"AmbientLight"===p.type?(_=void 0!==p.color?p.color:16777215,b=void 0!==p.intensity?p.intensity:1,"DirectionalLight"===p.type?(a=p.direction,T=new THREE.DirectionalLight(_,b),T.position.fromArray(a),p.target&&(A.push({object:T,targetName:p.target}),T.target=null)):"PointLight"===p.type?(a=p.position,n=p.distance,T=new THREE.PointLight(_,b,n),T.position.fromArray(a)):"AmbientLight"===p.type&&(T=new THREE.AmbientLight(_)),e.add(T),T.name=u,M.lights[u]=T,M.objects[u]=T):"PerspectiveCamera"===p.type||"OrthographicCamera"===p.type?(a=p.position,s=p.rotation,c=p.quaternion,"PerspectiveCamera"===p.type?g=new THREE.PerspectiveCamera(p.fov,p.aspect,p.near,p.far):"OrthographicCamera"===p.type&&(g=new THREE.OrthographicCamera(p.left,p.right,p.top,p.bottom,p.near,p.far)),g.name=u,g.position.fromArray(a),void 0!==c?g.quaternion.fromArray(c):void 0!==s&&g.rotation.fromArray(s),e.add(g),M.cameras[u]=g,M.objects[u]=g):(a=p.position,s=p.rotation,l=p.scale,c=p.quaternion,d=new THREE.Object3D,d.name=u,d.position.fromArray(a),c?d.quaternion.fromArray(c):d.rotation.fromArray(s),d.scale.fromArray(l),d.visible=void 0!==p.visible?p.visible:!1,e.add(d),M.objects[u]=d,M.empties[u]=d);if(d){if(void 0!==p.userData)for(var H in p.userData){var C=p.userData[H];d.userData[H]=C}if(void 0!==p.groups)for(var w=0;w<p.groups.length;w++){var P=p.groups[w];void 0===M.groups[P]&&(M.groups[P]=[]),M.groups[P].push(u)}}}void 0!==d&&void 0!==p.children&&o(d,p.children)}}function a(e,t,i){M.geometries[i]=e,M.face_materials[i]=t,n()}function s(e,t,i,r,o){var a=o.position,s=o.rotation,l=o.quaternion,h=o.scale;e.position.fromArray(a),l?e.quaternion.fromArray(l):e.rotation.fromArray(s),e.scale.fromArray(h),r&&e.traverse(function(e){e.material=r});var c=void 0!==o.visible?o.visible:!0;e.traverse(function(e){e.visible=c}),i.add(e),e.name=t,M.objects[t]=e,n()}function l(e){return function(t,i){t.name=e,a(t,i,e),x-=1,S.onLoadComplete(),u()}}function h(e,t,i,r){return function(n){var o;o=n.content?n.content:n.dae?n.scene:n,s(o,e,t,i,r),x-=1,S.onLoadComplete(),u()}}function c(e){return function(t,i){t.name=e,M.geometries[e]=t,M.face_materials[e]=i}}function u(){var e={totalModels:w,totalTextures:H,loadedModels:w-x,loadedTextures:H-R};S.callbackProgress(e,M),S.onLoadProgress(),0===x&&0===R&&(d(),t(M))}function d(){for(var e=0;e<A.length;e++){var t=A[e],i=M.objects[t.targetName];i?t.object.target=i:(t.object.target=new THREE.Object3D,M.scene.add(t.object.target)),t.object.target.userData.targetInverse=t.object}}function p(e,t){if(t(e),void 0!==e.children)for(var i in e.children)p(e.children[i],t)}var f,m,g,v,E,y,T,_,b,x,R,w,H,M,S=this,C=THREE.Loader.prototype.extractUrlBase(i),A=[],D=e;for(var P in this.geometryHandlers){var L=this.geometryHandlers[P].loaderClass;this.geometryHandlers[P].loaderObject=new L}for(var P in this.hierarchyHandlers){var L=this.hierarchyHandlers[P].loaderClass;this.hierarchyHandlers[P].loaderObject=new L}if(x=0,R=0,M={scene:new THREE.Scene,geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}},D.transform){var k=D.transform.position,F=D.transform.rotation,z=D.transform.scale;k&&M.scene.position.fromArray(k),F&&M.scene.rotation.fromArray(F),z&&M.scene.scale.fromArray(z),(k||F||z)&&(M.scene.updateMatrix(),M.scene.updateMatrixWorld())}var N,I,O=function(e){R-=e,u(),S.onLoadComplete()},U=function(e){return function(){O(e)}};for(N in D.fogs)I=D.fogs[N],"linear"===I.type?v=new THREE.Fog(0,I.near,I.far):"exp2"===I.type&&(v=new THREE.FogExp2(0,I.density)),y=I.color,v.color.setRGB(y[0],y[1],y[2]),M.fogs[N]=v;var V,B;for(V in D.geometries)B=D.geometries[V],B.type in this.geometryHandlers&&(x+=1,S.onLoadStart());for(var j in D.objects)p(D.objects[j],function(e){e.type&&e.type in S.hierarchyHandlers&&(x+=1,S.onLoadStart())});w=x;for(V in D.geometries)if(B=D.geometries[V],"cube"===B.type)f=new THREE.CubeGeometry(B.width,B.height,B.depth,B.widthSegments,B.heightSegments,B.depthSegments),f.name=V,M.geometries[V]=f;else if("plane"===B.type)f=new THREE.PlaneGeometry(B.width,B.height,B.widthSegments,B.heightSegments),f.name=V,M.geometries[V]=f;else if("sphere"===B.type)f=new THREE.SphereGeometry(B.radius,B.widthSegments,B.heightSegments),f.name=V,M.geometries[V]=f;else if("cylinder"===B.type)f=new THREE.CylinderGeometry(B.topRad,B.botRad,B.height,B.radSegs,B.heightSegs),f.name=V,M.geometries[V]=f;else if("torus"===B.type)f=new THREE.TorusGeometry(B.radius,B.tube,B.segmentsR,B.segmentsT),f.name=V,M.geometries[V]=f;else if("icosahedron"===B.type)f=new THREE.IcosahedronGeometry(B.radius,B.subdivisions),f.name=V,M.geometries[V]=f;else if(B.type in this.geometryHandlers){var W={};for(var G in B)"type"!==G&&"url"!==G&&(W[G]=B[G]);var X=this.geometryHandlers[B.type].loaderObject;X.load(r(B.url,D.urlBaseType),l(V),W)}else if("embedded"===B.type){var Y=D.embeds[B.id],q="";if(Y.metadata=D.metadata,Y){var K=this.geometryHandlers.ascii.loaderObject,Q=K.parse(Y,q);
c(V)(Q.geometry,Q.materials)}}var $,Z;for($ in D.textures)if(Z=D.textures[$],Z.url instanceof Array){R+=Z.url.length;for(var J=0;J<Z.url.length;J++)S.onLoadStart()}else R+=1,S.onLoadStart();H=R;for($ in D.textures){if(Z=D.textures[$],void 0!==Z.mapping&&void 0!==THREE[Z.mapping]&&(Z.mapping=new THREE[Z.mapping]),Z.url instanceof Array){for(var et=Z.url.length,tt=[],it=0;et>it;it++)tt[it]=r(Z.url[it],D.urlBaseType);var rt=/\.dds$/i.test(tt[0]);E=rt?THREE.ImageUtils.loadCompressedTextureCube(tt,Z.mapping,U(et)):THREE.ImageUtils.loadTextureCube(tt,Z.mapping,U(et))}else{var rt=/\.dds$/i.test(Z.url),nt=r(Z.url,D.urlBaseType),ot=U(1);if(E=rt?THREE.ImageUtils.loadCompressedTexture(nt,Z.mapping,ot):THREE.ImageUtils.loadTexture(nt,Z.mapping,ot),void 0!==THREE[Z.minFilter]&&(E.minFilter=THREE[Z.minFilter]),void 0!==THREE[Z.magFilter]&&(E.magFilter=THREE[Z.magFilter]),Z.anisotropy&&(E.anisotropy=Z.anisotropy),Z.repeat&&(E.repeat.set(Z.repeat[0],Z.repeat[1]),1!==Z.repeat[0]&&(E.wrapS=THREE.RepeatWrapping),1!==Z.repeat[1]&&(E.wrapT=THREE.RepeatWrapping)),Z.offset&&E.offset.set(Z.offset[0],Z.offset[1]),Z.wrap){var at={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping};void 0!==at[Z.wrap[0]]&&(E.wrapS=at[Z.wrap[0]]),void 0!==at[Z.wrap[1]]&&(E.wrapT=at[Z.wrap[1]])}}M.textures[$]=E}var st,lt,ht;for(st in D.materials){lt=D.materials[st];for(ht in lt.parameters)if("envMap"===ht||"map"===ht||"lightMap"===ht||"bumpMap"===ht)lt.parameters[ht]=M.textures[lt.parameters[ht]];else if("shading"===ht)lt.parameters[ht]="flat"===lt.parameters[ht]?THREE.FlatShading:THREE.SmoothShading;else if("side"===ht)lt.parameters[ht]="double"==lt.parameters[ht]?THREE.DoubleSide:"back"==lt.parameters[ht]?THREE.BackSide:THREE.FrontSide;else if("blending"===ht)lt.parameters[ht]=lt.parameters[ht]in THREE?THREE[lt.parameters[ht]]:THREE.NormalBlending;else if("combine"===ht)lt.parameters[ht]=lt.parameters[ht]in THREE?THREE[lt.parameters[ht]]:THREE.MultiplyOperation;else if("vertexColors"===ht)"face"==lt.parameters[ht]?lt.parameters[ht]=THREE.FaceColors:lt.parameters[ht]&&(lt.parameters[ht]=THREE.VertexColors);else if("wrapRGB"===ht){var ct=lt.parameters[ht];lt.parameters[ht]=new THREE.Vector3(ct[0],ct[1],ct[2])}if(void 0!==lt.parameters.opacity&&lt.parameters.opacity<1&&(lt.parameters.transparent=!0),lt.parameters.normalMap){var ut=THREE.ShaderLib.normalmap,dt=THREE.UniformsUtils.clone(ut.uniforms),pt=lt.parameters.color,ft=lt.parameters.specular,mt=lt.parameters.ambient,gt=lt.parameters.shininess;dt.tNormal.value=M.textures[lt.parameters.normalMap],lt.parameters.normalScale&&dt.uNormalScale.value.set(lt.parameters.normalScale[0],lt.parameters.normalScale[1]),lt.parameters.map&&(dt.tDiffuse.value=lt.parameters.map,dt.enableDiffuse.value=!0),lt.parameters.envMap&&(dt.tCube.value=lt.parameters.envMap,dt.enableReflection.value=!0,dt.uReflectivity.value=lt.parameters.reflectivity),lt.parameters.lightMap&&(dt.tAO.value=lt.parameters.lightMap,dt.enableAO.value=!0),lt.parameters.specularMap&&(dt.tSpecular.value=M.textures[lt.parameters.specularMap],dt.enableSpecular.value=!0),lt.parameters.displacementMap&&(dt.tDisplacement.value=M.textures[lt.parameters.displacementMap],dt.enableDisplacement.value=!0,dt.uDisplacementBias.value=lt.parameters.displacementBias,dt.uDisplacementScale.value=lt.parameters.displacementScale),dt.uDiffuseColor.value.setHex(pt),dt.uSpecularColor.value.setHex(ft),dt.uAmbientColor.value.setHex(mt),dt.uShininess.value=gt,lt.parameters.opacity&&(dt.uOpacity.value=lt.parameters.opacity);var vt={fragmentShader:ut.fragmentShader,vertexShader:ut.vertexShader,uniforms:dt,lights:!0,fog:!0};m=new THREE.ShaderMaterial(vt)}else m=new THREE[lt.type](lt.parameters);m.name=st,M.materials[st]=m}for(st in D.materials)if(lt=D.materials[st],lt.parameters.materials){for(var Et=[],it=0;it<lt.parameters.materials.length;it++){var yt=lt.parameters.materials[it];Et.push(M.materials[yt])}M.materials[st].materials=Et}n(),M.cameras&&D.defaults.camera&&(M.currentCamera=M.cameras[D.defaults.camera]),M.fogs&&D.defaults.fog&&(M.scene.fog=M.fogs[D.defaults.fog]),S.callbackSync(M),u()}},THREE.TextureLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(e,t){var i=this,r=new THREE.ImageLoader(i.manager);r.setCrossOrigin(this.crossOrigin),r.load(e,function(e){var i=new THREE.Texture(e);i.needsUpdate=!0,void 0!==t&&t(i)})},setCrossOrigin:function(e){this.crossOrigin=e}},THREE.Material=function(){this.id=THREE.MaterialIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.side=THREE.FrontSide,this.opacity=1,this.transparent=!1,this.blending=THREE.NormalBlending,this.blendSrc=THREE.SrcAlphaFactor,this.blendDst=THREE.OneMinusSrcAlphaFactor,this.blendEquation=THREE.AddEquation,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.overdraw=0,this.visible=!0,this.needsUpdate=!0},THREE.Material.prototype={constructor:THREE.Material,setValues:function(e){if(void 0!==e)for(var t in e){var i=e[t];if(void 0!==i){if(t in this){var r=this[t];r instanceof THREE.Color?r.set(i):r instanceof THREE.Vector3&&i instanceof THREE.Vector3?r.copy(i):this[t]="overdraw"==t?Number(i):i}}else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},clone:function(e){return void 0===e&&(e=new THREE.Material),e.name=this.name,e.side=this.side,e.opacity=this.opacity,e.transparent=this.transparent,e.blending=this.blending,e.blendSrc=this.blendSrc,e.blendDst=this.blendDst,e.blendEquation=this.blendEquation,e.depthTest=this.depthTest,e.depthWrite=this.depthWrite,e.polygonOffset=this.polygonOffset,e.polygonOffsetFactor=this.polygonOffsetFactor,e.polygonOffsetUnits=this.polygonOffsetUnits,e.alphaTest=this.alphaTest,e.overdraw=this.overdraw,e.visible=this.visible,e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Material.prototype),THREE.MaterialIdCount=0,THREE.LineBasicMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.setValues(e)},THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineBasicMaterial.prototype.clone=function(){var e=new THREE.LineBasicMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.linecap=this.linecap,e.linejoin=this.linejoin,e.vertexColors=this.vertexColors,e.fog=this.fog,e},THREE.LineDashedMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(e)},THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineDashedMaterial.prototype.clone=function(){var e=new THREE.LineDashedMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.scale=this.scale,e.dashSize=this.dashSize,e.gapSize=this.gapSize,e.vertexColors=this.vertexColors,e.fog=this.fog,e},THREE.MeshBasicMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=null,this.lightMap=null,this.specularMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(e)},THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshBasicMaterial.prototype.clone=function(){var e=new THREE.MeshBasicMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e},THREE.MeshLambertMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=null,this.lightMap=null,this.specularMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshLambertMaterial.prototype.clone=function(){var e=new THREE.MeshLambertMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.ambient.copy(this.ambient),e.emissive.copy(this.emissive),e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},THREE.MeshPhongMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.specular=new THREE.Color(1118481),this.shininess=30,this.metal=!1,this.perPixel=!0,this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=null,this.lightMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.specularMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshPhongMaterial.prototype.clone=function(){var e=new THREE.MeshPhongMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.ambient.copy(this.ambient),e.emissive.copy(this.emissive),e.specular.copy(this.specular),e.shininess=this.shininess,e.metal=this.metal,e.perPixel=this.perPixel,e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.bumpMap=this.bumpMap,e.bumpScale=this.bumpScale,e.normalMap=this.normalMap,e.normalScale.copy(this.normalScale),e.specularMap=this.specularMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},THREE.MeshDepthMaterial=function(e){THREE.Material.call(this),this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)},THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshDepthMaterial.prototype.clone=function(){var e=new THREE.MeshDepthMaterial;return THREE.Material.prototype.clone.call(this,e),e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},THREE.MeshNormalMaterial=function(e){THREE.Material.call(this,e),this.shading=THREE.FlatShading,this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(e)},THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshNormalMaterial.prototype.clone=function(){var e=new THREE.MeshNormalMaterial;return THREE.Material.prototype.clone.call(this,e),e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},THREE.MeshFaceMaterial=function(e){this.materials=e instanceof Array?e:[]},THREE.MeshFaceMaterial.prototype.clone=function(){return new THREE.MeshFaceMaterial(this.materials.slice(0))},THREE.ParticleBasicMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=!1,this.fog=!0,this.setValues(e)},THREE.ParticleBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ParticleBasicMaterial.prototype.clone=function(){var e=new THREE.ParticleBasicMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.size=this.size,e.sizeAttenuation=this.sizeAttenuation,e.vertexColors=this.vertexColors,e.fog=this.fog,e},THREE.ParticleCanvasMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.program=function(){},this.setValues(e)},THREE.ParticleCanvasMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ParticleCanvasMaterial.prototype.clone=function(){var e=new THREE.ParticleCanvasMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.program=this.program,e},THREE.ShaderMaterial=function(e){THREE.Material.call(this),this.fragmentShader="void main() {}",this.vertexShader="void main() {}",this.uniforms={},this.defines={},this.attributes=null,this.shading=THREE.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ShaderMaterial.prototype.clone=function(){var e=new THREE.ShaderMaterial;return THREE.Material.prototype.clone.call(this,e),e.fragmentShader=this.fragmentShader,e.vertexShader=this.vertexShader,e.uniforms=THREE.UniformsUtils.clone(this.uniforms),e.attributes=this.attributes,e.defines=this.defines,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.fog=this.fog,e.lights=this.lights,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},THREE.SpriteMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=new THREE.Texture,this.useScreenCoordinates=!0,this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.scaleByViewport=!this.sizeAttenuation,this.alignment=THREE.SpriteAlignment.center.clone(),this.fog=!1,this.uvOffset=new THREE.Vector2(0,0),this.uvScale=new THREE.Vector2(1,1),this.setValues(e),e=e||{},void 0===e.depthTest&&(this.depthTest=!this.useScreenCoordinates),void 0===e.sizeAttenuation&&(this.sizeAttenuation=!this.useScreenCoordinates),void 0===e.scaleByViewport&&(this.scaleByViewport=!this.sizeAttenuation)},THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteMaterial.prototype.clone=function(){var e=new THREE.SpriteMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.useScreenCoordinates=this.useScreenCoordinates,e.sizeAttenuation=this.sizeAttenuation,e.scaleByViewport=this.scaleByViewport,e.alignment.copy(this.alignment),e.uvOffset.copy(this.uvOffset),e.uvScale.copy(this.uvScale),e.fog=this.fog,e},THREE.SpriteAlignment={},THREE.SpriteAlignment.topLeft=new THREE.Vector2(1,-1),THREE.SpriteAlignment.topCenter=new THREE.Vector2(0,-1),THREE.SpriteAlignment.topRight=new THREE.Vector2(-1,-1),THREE.SpriteAlignment.centerLeft=new THREE.Vector2(1,0),THREE.SpriteAlignment.center=new THREE.Vector2(0,0),THREE.SpriteAlignment.centerRight=new THREE.Vector2(-1,0),THREE.SpriteAlignment.bottomLeft=new THREE.Vector2(1,1),THREE.SpriteAlignment.bottomCenter=new THREE.Vector2(0,1),THREE.SpriteAlignment.bottomRight=new THREE.Vector2(-1,1),THREE.Texture=function(e,t,i,r,n,o,a,s,l){this.id=THREE.TextureIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.image=e,this.mipmaps=[],this.mapping=void 0!==t?t:new THREE.UVMapping,this.wrapS=void 0!==i?i:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==r?r:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==n?n:THREE.LinearFilter,this.minFilter=void 0!==o?o:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:THREE.RGBAFormat,this.type=void 0!==s?s:THREE.UnsignedByteType,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.needsUpdate=!1,this.onUpdate=null},THREE.Texture.prototype={constructor:THREE.Texture,clone:function(e){return void 0===e&&(e=new THREE.Texture),e.image=this.image,e.mipmaps=this.mipmaps.slice(0),e.mapping=this.mapping,e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.format=this.format,e.type=this.type,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.generateMipmaps=this.generateMipmaps,e.premultiplyAlpha=this.premultiplyAlpha,e.flipY=this.flipY,e.unpackAlignment=this.unpackAlignment,e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype),THREE.TextureIdCount=0,THREE.CompressedTexture=function(e,t,i,r,n,o,a,s,l,h,c){THREE.Texture.call(this,null,o,a,s,l,h,r,n,c),this.image={width:t,height:i},this.mipmaps=e,this.generateMipmaps=!1},THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CompressedTexture.prototype.clone=function(){var e=new THREE.CompressedTexture;return THREE.Texture.prototype.clone.call(this,e),e},THREE.DataTexture=function(e,t,i,r,n,o,a,s,l,h,c){THREE.Texture.call(this,null,o,a,s,l,h,r,n,c),this.image={data:e,width:t,height:i}},THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype),THREE.DataTexture.prototype.clone=function(){var e=new THREE.DataTexture;return THREE.Texture.prototype.clone.call(this,e),e},THREE.Particle=function(e){THREE.Object3D.call(this),this.material=e},THREE.Particle.prototype=Object.create(THREE.Object3D.prototype),THREE.Particle.prototype.clone=function(e){return void 0===e&&(e=new THREE.Particle(this.material)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.ParticleSystem=function(e,t){THREE.Object3D.call(this),this.geometry=void 0!==e?e:new THREE.Geometry,this.material=void 0!==t?t:new THREE.ParticleBasicMaterial({color:16777215*Math.random()}),this.sortParticles=!1,this.frustumCulled=!1},THREE.ParticleSystem.prototype=Object.create(THREE.Object3D.prototype),THREE.ParticleSystem.prototype.clone=function(e){return void 0===e&&(e=new THREE.ParticleSystem(this.geometry,this.material)),e.sortParticles=this.sortParticles,THREE.Object3D.prototype.clone.call(this,e),e},THREE.Line=function(e,t,i){THREE.Object3D.call(this),this.geometry=void 0!==e?e:new THREE.Geometry,this.material=void 0!==t?t:new THREE.LineBasicMaterial({color:16777215*Math.random()}),this.type=void 0!==i?i:THREE.LineStrip},THREE.LineStrip=0,THREE.LinePieces=1,THREE.Line.prototype=Object.create(THREE.Object3D.prototype),THREE.Line.prototype.clone=function(e){return void 0===e&&(e=new THREE.Line(this.geometry,this.material,this.type)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.Mesh=function(e,t){THREE.Object3D.call(this),this.geometry=void 0!==e?e:new THREE.Geometry,this.material=void 0!==t?t:new THREE.MeshBasicMaterial({color:16777215*Math.random()}),this.updateMorphTargets()},THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype),THREE.Mesh.prototype.updateMorphTargets=function(){if(this.geometry.morphTargets.length>0){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,t=this.geometry.morphTargets.length;t>e;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[e].name]=e}},THREE.Mesh.prototype.getMorphTargetIndexByName=function(e){return void 0!==this.morphTargetDictionary[e]?this.morphTargetDictionary[e]:(console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+e+" does not exist. Returning 0."),0)},THREE.Mesh.prototype.clone=function(e){return void 0===e&&(e=new THREE.Mesh(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.Bone=function(e){THREE.Object3D.call(this),this.skin=e,this.skinMatrix=new THREE.Matrix4},THREE.Bone.prototype=Object.create(THREE.Object3D.prototype),THREE.Bone.prototype.update=function(e,t){this.matrixAutoUpdate&&(t|=this.updateMatrix()),(t||this.matrixWorldNeedsUpdate)&&(e?this.skinMatrix.multiplyMatrices(e,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);var i,r=this.children.length;for(i=0;r>i;i++)this.children[i].update(this.skinMatrix,t)},THREE.SkinnedMesh=function(e,t,i){THREE.Mesh.call(this,e,t),this.useVertexTexture=void 0!==i?i:!0,this.identityMatrix=new THREE.Matrix4,this.bones=[],this.boneMatrices=[];var r,n,o,a,s,l;if(this.geometry&&void 0!==this.geometry.bones){for(r=0;r<this.geometry.bones.length;r++)o=this.geometry.bones[r],a=o.pos,s=o.rotq,l=o.scl,n=this.addBone(),n.name=o.name,n.position.set(a[0],a[1],a[2]),n.quaternion.set(s[0],s[1],s[2],s[3]),void 0!==l?n.scale.set(l[0],l[1],l[2]):n.scale.set(1,1,1);for(r=0;r<this.bones.length;r++)o=this.geometry.bones[r],n=this.bones[r],-1===o.parent?this.add(n):this.bones[o.parent].add(n);var h=this.bones.length;if(this.useVertexTexture){var c;c=h>256?64:h>64?32:h>16?16:8,this.boneTextureWidth=c,this.boneTextureHeight=c,this.boneMatrices=new Float32Array(4*this.boneTextureWidth*this.boneTextureHeight),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType),this.boneTexture.minFilter=THREE.NearestFilter,this.boneTexture.magFilter=THREE.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1}else this.boneMatrices=new Float32Array(16*h);this.pose()}},THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.SkinnedMesh.prototype.addBone=function(e){return void 0===e&&(e=new THREE.Bone(this)),this.bones.push(e),e},THREE.SkinnedMesh.prototype.updateMatrixWorld=function(){var e=new THREE.Matrix4;return function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var i=0,r=this.children.length;r>i;i++){var n=this.children[i];n instanceof THREE.Bone?n.update(this.identityMatrix,!1):n.updateMatrixWorld(!0)}if(void 0==this.boneInverses){this.boneInverses=[];for(var o=0,a=this.bones.length;a>o;o++){var s=new THREE.Matrix4;s.getInverse(this.bones[o].skinMatrix),this.boneInverses.push(s)}}for(var o=0,a=this.bones.length;a>o;o++)e.multiplyMatrices(this.bones[o].skinMatrix,this.boneInverses[o]),e.flattenToArrayOffset(this.boneMatrices,16*o);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),THREE.SkinnedMesh.prototype.pose=function(){this.updateMatrixWorld(!0),this.normalizeSkinWeights()},THREE.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof THREE.Geometry)for(var e=0;e<this.geometry.skinIndices.length;e++){var t=this.geometry.skinWeights[e],i=1/t.lengthManhattan();1/0!==i?t.multiplyScalar(i):t.set(1)}},THREE.SkinnedMesh.prototype.clone=function(e){return void 0===e&&(e=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)),THREE.Mesh.prototype.clone.call(this,e),e},THREE.MorphAnimMesh=function(e,t){THREE.Mesh.call(this,e,t),this.duration=1e3,this.mirroredLoop=!1,this.time=0,this.lastKeyframe=0,this.currentKeyframe=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,this.geometry.morphTargets.length-1)},THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphAnimMesh.prototype.setFrameRange=function(e,t){this.startKeyframe=e,this.endKeyframe=t,this.length=this.endKeyframe-this.startKeyframe+1},THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},THREE.MorphAnimMesh.prototype.parseAnimations=function(){var e=this.geometry;e.animations||(e.animations={});for(var t,i=e.animations,r=/([a-z]+)(\d+)/,n=0,o=e.morphTargets.length;o>n;n++){var a=e.morphTargets[n],s=a.name.match(r);if(s&&s.length>1){var l=s[1];s[2],i[l]||(i[l]={start:1/0,end:-1/0});var h=i[l];n<h.start&&(h.start=n),n>h.end&&(h.end=n),t||(t=l)}}e.firstAnimation=t},THREE.MorphAnimMesh.prototype.setAnimationLabel=function(e,t,i){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[e]={start:t,end:i}},THREE.MorphAnimMesh.prototype.playAnimation=function(e,t){var i=this.geometry.animations[e];i?(this.setFrameRange(i.start,i.end),this.duration=1e3*((i.end-i.start)/t),this.time=0):console.warn("animation["+e+"] undefined")},THREE.MorphAnimMesh.prototype.updateAnimation=function(e){var t=this.duration/this.length;this.time+=this.direction*e,this.mirroredLoop?(this.time>this.duration||this.time<0)&&(this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),this.time<0&&(this.time=0,this.directionBackwards=!1)):(this.time=this.time%this.duration,this.time<0&&(this.time+=this.duration));var i=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/t),0,this.length-1);i!==this.currentKeyframe&&(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[i]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=i);var r=this.time%t/t;this.directionBackwards&&(r=1-r),this.morphTargetInfluences[this.currentKeyframe]=r,this.morphTargetInfluences[this.lastKeyframe]=1-r},THREE.MorphAnimMesh.prototype.clone=function(e){return void 0===e&&(e=new THREE.MorphAnimMesh(this.geometry,this.material)),e.duration=this.duration,e.mirroredLoop=this.mirroredLoop,e.time=this.time,e.lastKeyframe=this.lastKeyframe,e.currentKeyframe=this.currentKeyframe,e.direction=this.direction,e.directionBackwards=this.directionBackwards,THREE.Mesh.prototype.clone.call(this,e),e},THREE.Ribbon=function(e,t){THREE.Object3D.call(this),this.geometry=e,this.material=t},THREE.Ribbon.prototype=Object.create(THREE.Object3D.prototype),THREE.Ribbon.prototype.clone=function(e){return void 0===e&&(e=new THREE.Ribbon(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.LOD=function(){THREE.Object3D.call(this),this.objects=[]},THREE.LOD.prototype=Object.create(THREE.Object3D.prototype),THREE.LOD.prototype.addLevel=function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var i=0;i<this.objects.length&&!(t<this.objects[i].distance);i++);this.objects.splice(i,0,{distance:t,object:e}),this.add(e)},THREE.LOD.prototype.getObjectForDistance=function(e){for(var t=1,i=this.objects.length;i>t&&!(e<this.objects[t].distance);t++);return this.objects[t-1].object},THREE.LOD.prototype.update=function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(i){if(this.objects.length>1){e.getPositionFromMatrix(i.matrixWorld),t.getPositionFromMatrix(this.matrixWorld);var r=e.distanceTo(t);this.objects[0].object.visible=!0;for(var n=1,o=this.objects.length;o>n&&r>=this.objects[n].distance;n++)this.objects[n-1].object.visible=!1,this.objects[n].object.visible=!0;for(;o>n;n++)this.objects[n].object.visible=!1}}}(),THREE.LOD.prototype.clone=function(){},THREE.Sprite=function(e){THREE.Object3D.call(this),this.material=void 0!==e?e:new THREE.SpriteMaterial,this.rotation3d=this.rotation,this.rotation=0},THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype),THREE.Sprite.prototype.updateMatrix=function(){this.rotation3d.set(0,0,this.rotation,this.rotation3d.order),this.quaternion.setFromEuler(this.rotation3d),this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},THREE.Sprite.prototype.clone=function(e){return void 0===e&&(e=new THREE.Sprite(this.material)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.Scene=function(){THREE.Object3D.call(this),this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]},THREE.Scene.prototype=Object.create(THREE.Object3D.prototype),THREE.Scene.prototype.__addObject=function(e){if(e instanceof THREE.Light)-1===this.__lights.indexOf(e)&&this.__lights.push(e),e.target&&void 0===e.target.parent&&this.add(e.target);else if(!(e instanceof THREE.Camera||e instanceof THREE.Bone)&&-1===this.__objects.indexOf(e)){this.__objects.push(e),this.__objectsAdded.push(e);var t=this.__objectsRemoved.indexOf(e);-1!==t&&this.__objectsRemoved.splice(t,1)}for(var i=0;i<e.children.length;i++)this.__addObject(e.children[i])},THREE.Scene.prototype.__removeObject=function(e){if(e instanceof THREE.Light){var t=this.__lights.indexOf(e);-1!==t&&this.__lights.splice(t,1)}else if(!(e instanceof THREE.Camera)){var t=this.__objects.indexOf(e);if(-1!==t){this.__objects.splice(t,1),this.__objectsRemoved.push(e);var i=this.__objectsAdded.indexOf(e);-1!==i&&this.__objectsAdded.splice(i,1)}}for(var r=0;r<e.children.length;r++)this.__removeObject(e.children[r])},THREE.Scene.prototype.clone=function(e){return void 0===e&&(e=new THREE.Scene),THREE.Object3D.prototype.clone.call(this,e),null!==this.fog&&(e.fog=this.fog.clone()),null!==this.overrideMaterial&&(e.overrideMaterial=this.overrideMaterial.clone()),e.autoUpdate=this.autoUpdate,e.matrixAutoUpdate=this.matrixAutoUpdate,e},THREE.Fog=function(e,t,i){this.name="",this.color=new THREE.Color(e),this.near=void 0!==t?t:1,this.far=void 0!==i?i:1e3},THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)},THREE.FogExp2=function(e,t){this.name="",this.color=new THREE.Color(e),this.density=void 0!==t?t:25e-5},THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)},THREE.CanvasRenderer=function(e){function t(){Ut.setRGB(0,0,0),Vt.setRGB(0,0,0),Bt.setRGB(0,0,0);for(var e=0,t=H.length;t>e;e++){var i=H[e],r=i.color;i instanceof THREE.AmbientLight?Ut.add(r):i instanceof THREE.DirectionalLight?Vt.add(r):i instanceof THREE.PointLight&&Bt.add(r)}}function i(e,t,i){for(var r=0,n=H.length;n>r;r++){var o=H[r];if(kt.copy(o.color),o instanceof THREE.DirectionalLight){var a=jt.getPositionFromMatrix(o.matrixWorld).normalize(),s=t.dot(a);if(0>=s)continue;s*=o.intensity,i.add(kt.multiplyScalar(s))}else if(o instanceof THREE.PointLight){var a=jt.getPositionFromMatrix(o.matrixWorld),s=t.dot(jt.subVectors(a,e).normalize());if(0>=s)continue;if(s*=0==o.distance?1:1-Math.min(e.distanceTo(a)/o.distance,1),0==s)continue;s*=o.intensity,i.add(kt.multiplyScalar(s))}}}function r(e,t,i){m(i.opacity),g(i.blending);var r,n,o,a,s,l,h;if(i instanceof THREE.ParticleBasicMaterial)if(null===i.map){if(o=t.object.scale.x,a=t.object.scale.y,o*=t.scale.x*C,a*=t.scale.y*A,Ot.min.set(e.x-o,e.y-a),Ot.max.set(e.x+o,e.y+a),Nt.isIntersectionBox(Ot)===!1)return Ot.makeEmpty(),void 0;_(i.color.getStyle()),pt.save(),pt.translate(e.x,e.y),pt.rotate(-t.rotation),pt.scale(o,a),pt.fillRect(-1,-1,2,2),pt.restore()
}else{if(s=i.map.image,l=s.width>>1,h=s.height>>1,o=t.scale.x*C,a=t.scale.y*A,r=o*l,n=a*h,Ot.min.set(e.x-r,e.y-n),Ot.max.set(e.x+r,e.y+n),Nt.isIntersectionBox(Ot)===!1)return Ot.makeEmpty(),void 0;pt.save(),pt.translate(e.x,e.y),pt.rotate(-t.rotation),pt.scale(o,-a),pt.translate(-l,-h),pt.drawImage(s,0,0),pt.restore()}else if(i instanceof THREE.ParticleCanvasMaterial){if(r=t.scale.x*C,n=t.scale.y*A,Ot.min.set(e.x-r,e.y-n),Ot.max.set(e.x+r,e.y+n),Nt.isIntersectionBox(Ot)===!1)return Ot.makeEmpty(),void 0;T(i.color.getStyle()),_(i.color.getStyle()),pt.save(),pt.translate(e.x,e.y),pt.rotate(-t.rotation),pt.scale(r,n),i.program(pt),pt.restore()}}function n(e,t,i,r){if(m(r.opacity),g(r.blending),pt.beginPath(),pt.moveTo(e.positionScreen.x,e.positionScreen.y),pt.lineTo(t.positionScreen.x,t.positionScreen.y),r instanceof THREE.LineBasicMaterial){if(v(r.linewidth),E(r.linecap),y(r.linejoin),r.vertexColors!==THREE.VertexColors)T(r.color.getStyle());else{var n=i.vertexColors[0].getStyle(),o=i.vertexColors[1].getStyle();if(n===o)T(n);else{try{var a=pt.createLinearGradient(e.positionScreen.x,e.positionScreen.y,t.positionScreen.x,t.positionScreen.y);a.addColorStop(0,n),a.addColorStop(1,o)}catch(s){a=n}T(a)}}pt.stroke(),Ot.expandByScalar(2*r.linewidth)}else r instanceof THREE.LineDashedMaterial&&(v(r.linewidth),E(r.linecap),y(r.linejoin),T(r.color.getStyle()),b(r.dashSize,r.gapSize),pt.stroke(),Ot.expandByScalar(2*r.linewidth),b(null,null))}function o(e,t,r,n,o,a,l,f){if(ct.info.render.vertices+=3,ct.info.render.faces++,m(f.opacity),g(f.blending),z=e.positionScreen.x,N=e.positionScreen.y,I=t.positionScreen.x,O=t.positionScreen.y,U=r.positionScreen.x,V=r.positionScreen.y,s(z,N,I,O,U,V),(f instanceof THREE.MeshLambertMaterial||f instanceof THREE.MeshPhongMaterial)&&null===f.map)Pt.copy(f.color),Lt.copy(f.emissive),f.vertexColors===THREE.FaceColors&&Pt.multiply(l.color),f.wireframe===!1&&f.shading==THREE.SmoothShading&&3==l.vertexNormalsLength?(St.copy(Ut),Ct.copy(Ut),At.copy(Ut),i(l.v1.positionWorld,l.vertexNormalsModel[0],St),i(l.v2.positionWorld,l.vertexNormalsModel[1],Ct),i(l.v3.positionWorld,l.vertexNormalsModel[2],At),St.multiply(Pt).add(Lt),Ct.multiply(Pt).add(Lt),At.multiply(Pt).add(Lt),Dt.addColors(Ct,At).multiplyScalar(.5),Q=p(St,Ct,At,Dt),d(z,N,I,O,U,V,0,0,1,0,0,1,Q)):(Mt.copy(Ut),i(l.centroidModel,l.normalModel,Mt),Mt.multiply(Pt).add(Lt),f.wireframe===!0?h(Mt,f.wireframeLinewidth,f.wireframeLinecap,f.wireframeLinejoin):c(Mt));else if(f instanceof THREE.MeshBasicMaterial||f instanceof THREE.MeshLambertMaterial||f instanceof THREE.MeshPhongMaterial)null!==f.map?f.map.mapping instanceof THREE.UVMapping&&($=l.uvs[0],u(z,N,I,O,U,V,$[n].x,$[n].y,$[o].x,$[o].y,$[a].x,$[a].y,f.map)):null!==f.envMap?f.envMap.mapping instanceof THREE.SphericalReflectionMapping&&(jt.copy(l.vertexNormalsModelView[n]),Z=.5*jt.x+.5,J=.5*jt.y+.5,jt.copy(l.vertexNormalsModelView[o]),et=.5*jt.x+.5,tt=.5*jt.y+.5,jt.copy(l.vertexNormalsModelView[a]),it=.5*jt.x+.5,rt=.5*jt.y+.5,u(z,N,I,O,U,V,Z,J,et,tt,it,rt,f.envMap)):(Mt.copy(f.color),f.vertexColors===THREE.FaceColors&&Mt.multiply(l.color),f.wireframe===!0?h(Mt,f.wireframeLinewidth,f.wireframeLinecap,f.wireframeLinejoin):c(Mt));else if(f instanceof THREE.MeshDepthMaterial)q=D.near,K=D.far,St.r=St.g=St.b=1-x(e.positionScreen.z*e.positionScreen.w,q,K),Ct.r=Ct.g=Ct.b=1-x(t.positionScreen.z*t.positionScreen.w,q,K),At.r=At.g=At.b=1-x(r.positionScreen.z*r.positionScreen.w,q,K),Dt.addColors(Ct,At).multiplyScalar(.5),Q=p(St,Ct,At,Dt),d(z,N,I,O,U,V,0,0,1,0,0,1,Q);else if(f instanceof THREE.MeshNormalMaterial){var v;f.shading==THREE.FlatShading?(v=l.normalModelView,Mt.setRGB(v.x,v.y,v.z).multiplyScalar(.5).addScalar(.5),f.wireframe===!0?h(Mt,f.wireframeLinewidth,f.wireframeLinecap,f.wireframeLinejoin):c(Mt)):f.shading==THREE.SmoothShading&&(v=l.vertexNormalsModelView[n],St.setRGB(v.x,v.y,v.z).multiplyScalar(.5).addScalar(.5),v=l.vertexNormalsModelView[o],Ct.setRGB(v.x,v.y,v.z).multiplyScalar(.5).addScalar(.5),v=l.vertexNormalsModelView[a],At.setRGB(v.x,v.y,v.z).multiplyScalar(.5).addScalar(.5),Dt.addColors(Ct,At).multiplyScalar(.5),Q=p(St,Ct,At,Dt),d(z,N,I,O,U,V,0,0,1,0,0,1,Q))}}function a(e,t,r,n,a,u,f,v){if(ct.info.render.vertices+=4,ct.info.render.faces++,m(v.opacity),g(v.blending),void 0!==v.map&&null!==v.map||void 0!==v.envMap&&null!==v.envMap)return o(e,t,n,0,1,3,f,v),o(a,r,u,1,2,3,f,v),void 0;if(z=e.positionScreen.x,N=e.positionScreen.y,I=t.positionScreen.x,O=t.positionScreen.y,U=r.positionScreen.x,V=r.positionScreen.y,B=n.positionScreen.x,j=n.positionScreen.y,W=a.positionScreen.x,G=a.positionScreen.y,X=u.positionScreen.x,Y=u.positionScreen.y,v instanceof THREE.MeshLambertMaterial||v instanceof THREE.MeshPhongMaterial)Pt.copy(v.color),Lt.copy(v.emissive),v.vertexColors===THREE.FaceColors&&Pt.multiply(f.color),v.wireframe===!1&&v.shading==THREE.SmoothShading&&4==f.vertexNormalsLength?(St.copy(Ut),Ct.copy(Ut),At.copy(Ut),Dt.copy(Ut),i(f.v1.positionWorld,f.vertexNormalsModel[0],St),i(f.v2.positionWorld,f.vertexNormalsModel[1],Ct),i(f.v4.positionWorld,f.vertexNormalsModel[3],At),i(f.v3.positionWorld,f.vertexNormalsModel[2],Dt),St.multiply(Pt).add(Lt),Ct.multiply(Pt).add(Lt),At.multiply(Pt).add(Lt),Dt.multiply(Pt).add(Lt),Q=p(St,Ct,At,Dt),s(z,N,I,O,B,j),d(z,N,I,O,B,j,0,0,1,0,0,1,Q),s(W,G,U,V,X,Y),d(W,G,U,V,X,Y,1,0,1,1,0,1,Q)):(Mt.copy(Ut),i(f.centroidModel,f.normalModel,Mt),Mt.multiply(Pt).add(Lt),l(z,N,I,O,U,V,B,j),v.wireframe===!0?h(Mt,v.wireframeLinewidth,v.wireframeLinecap,v.wireframeLinejoin):c(Mt));else if(v instanceof THREE.MeshBasicMaterial)Mt.copy(v.color),v.vertexColors===THREE.FaceColors&&Mt.multiply(f.color),l(z,N,I,O,U,V,B,j),v.wireframe===!0?h(Mt,v.wireframeLinewidth,v.wireframeLinecap,v.wireframeLinejoin):c(Mt);else if(v instanceof THREE.MeshNormalMaterial){var E;v.shading==THREE.FlatShading?(E=f.normalModelView,Mt.setRGB(E.x,E.y,E.z).multiplyScalar(.5).addScalar(.5),l(z,N,I,O,U,V,B,j),v.wireframe===!0?h(Mt,v.wireframeLinewidth,v.wireframeLinecap,v.wireframeLinejoin):c(Mt)):v.shading==THREE.SmoothShading&&(E=f.vertexNormalsModelView[0],St.setRGB(E.x,E.y,E.z).multiplyScalar(.5).addScalar(.5),E=f.vertexNormalsModelView[1],Ct.setRGB(E.x,E.y,E.z).multiplyScalar(.5).addScalar(.5),E=f.vertexNormalsModelView[3],At.setRGB(E.x,E.y,E.z).multiplyScalar(.5).addScalar(.5),E=f.vertexNormalsModelView[2],Dt.setRGB(E.x,E.y,E.z).multiplyScalar(.5).addScalar(.5),Q=p(St,Ct,At,Dt),s(z,N,I,O,B,j),d(z,N,I,O,B,j,0,0,1,0,0,1,Q),s(W,G,U,V,X,Y),d(W,G,U,V,X,Y,1,0,1,1,0,1,Q))}else v instanceof THREE.MeshDepthMaterial&&(q=D.near,K=D.far,St.r=St.g=St.b=1-x(e.positionScreen.z*e.positionScreen.w,q,K),Ct.r=Ct.g=Ct.b=1-x(t.positionScreen.z*t.positionScreen.w,q,K),At.r=At.g=At.b=1-x(n.positionScreen.z*n.positionScreen.w,q,K),Dt.r=Dt.g=Dt.b=1-x(r.positionScreen.z*r.positionScreen.w,q,K),Q=p(St,Ct,At,Dt),s(z,N,I,O,B,j),d(z,N,I,O,B,j,0,0,1,0,0,1,Q),s(W,G,U,V,X,Y),d(W,G,U,V,X,Y,1,0,1,1,0,1,Q))}function s(e,t,i,r,n,o){pt.beginPath(),pt.moveTo(e,t),pt.lineTo(i,r),pt.lineTo(n,o),pt.closePath()}function l(e,t,i,r,n,o,a,s){pt.beginPath(),pt.moveTo(e,t),pt.lineTo(i,r),pt.lineTo(n,o),pt.lineTo(a,s),pt.closePath()}function h(e,t,i,r){v(t),E(i),y(r),T(e.getStyle()),pt.stroke(),Ot.expandByScalar(2*t)}function c(e){_(e.getStyle()),pt.fill()}function u(e,t,i,r,n,o,a,s,l,h,u,d,p){if(!(p instanceof THREE.DataTexture||void 0===p.image||0==p.image.width)){if(p.needsUpdate===!0){var f=p.wrapS==THREE.RepeatWrapping,m=p.wrapT==THREE.RepeatWrapping;Ft[p.id]=pt.createPattern(p.image,f===!0&&m===!0?"repeat":f===!0&&m===!1?"repeat-x":f===!1&&m===!0?"repeat-y":"no-repeat"),p.needsUpdate=!1}void 0===Ft[p.id]?_("rgba(0,0,0,1)"):_(Ft[p.id]);var g,v,E,y,T,b,x,R,w=p.offset.x/p.repeat.x,H=p.offset.y/p.repeat.y,M=p.image.width*p.repeat.x,S=p.image.height*p.repeat.y;if(a=(a+w)*M,s=(1-s+H)*S,l=(l+w)*M,h=(1-h+H)*S,u=(u+w)*M,d=(1-d+H)*S,i-=e,r-=t,n-=e,o-=t,l-=a,h-=s,u-=a,d-=s,x=l*d-u*h,0===x){if(void 0===zt[p.id]){var C=document.createElement("canvas");C.width=p.image.width,C.height=p.image.height;var A=C.getContext("2d");A.drawImage(p.image,0,0),zt[p.id]=A.getImageData(0,0,p.image.width,p.image.height).data}var D=zt[p.id],P=4*(Math.floor(a)+Math.floor(s)*p.image.width);return Mt.setRGB(D[P]/255,D[P+1]/255,D[P+2]/255),c(Mt),void 0}R=1/x,g=(d*i-h*n)*R,v=(d*r-h*o)*R,E=(l*n-u*i)*R,y=(l*o-u*r)*R,T=e-g*a-E*s,b=t-v*a-y*s,pt.save(),pt.transform(g,v,E,y,T,b),pt.fill(),pt.restore()}}function d(e,t,i,r,n,o,a,s,l,h,c,u,d){var p,f,m,g,v,E,y,T,_=d.width-1,b=d.height-1;a*=_,s*=b,l*=_,h*=b,c*=_,u*=b,i-=e,r-=t,n-=e,o-=t,l-=a,h-=s,c-=a,u-=s,y=l*u-c*h,T=1/y,p=(u*i-h*n)*T,f=(u*r-h*o)*T,m=(l*n-c*i)*T,g=(l*o-c*r)*T,v=e-p*a-m*s,E=t-f*a-g*s,pt.save(),pt.transform(p,f,m,g,v,E),pt.clip(),pt.drawImage(d,0,0),pt.restore()}function p(e,t,i,r){return st[0]=0|255*e.r,st[1]=0|255*e.g,st[2]=0|255*e.b,st[4]=0|255*t.r,st[5]=0|255*t.g,st[6]=0|255*t.b,st[8]=0|255*i.r,st[9]=0|255*i.g,st[10]=0|255*i.b,st[12]=0|255*r.r,st[13]=0|255*r.g,st[14]=0|255*r.b,ot.putImageData(at,0,0),ht.drawImage(nt,0,0),lt}function f(e,t,i){var r,n=t.x-e.x,o=t.y-e.y,a=n*n+o*o;0!==a&&(r=i/Math.sqrt(a),n*=r,o*=r,t.x+=n,t.y+=o,e.x-=n,e.y-=o)}function m(e){gt!==e&&(pt.globalAlpha=e,gt=e)}function g(e){vt!==e&&(e===THREE.NormalBlending?pt.globalCompositeOperation="source-over":e===THREE.AdditiveBlending?pt.globalCompositeOperation="lighter":e===THREE.SubtractiveBlending&&(pt.globalCompositeOperation="darker"),vt=e)}function v(e){Tt!==e&&(pt.lineWidth=e,Tt=e)}function E(e){_t!==e&&(pt.lineCap=e,_t=e)}function y(e){bt!==e&&(pt.lineJoin=e,bt=e)}function T(e){Et!==e&&(pt.strokeStyle=e,Et=e)}function _(e){yt!==e&&(pt.fillStyle=e,yt=e)}function b(e,t){(xt!==e||Rt!==t)&&(pt.setLineDash([e,t]),xt=e,Rt=t)}console.log("THREE.CanvasRenderer",THREE.REVISION);var x=THREE.Math.smoothstep;e=e||{};var R,w,H,M,S,C,A,D,P,L,k,F,z,N,I,O,U,V,B,j,W,G,X,Y,q,K,Q,$,Z,J,et,tt,it,rt,nt,ot,at,st,lt,ht,ct=this,ut=new THREE.Projector,dt=void 0!==e.canvas?e.canvas:document.createElement("canvas"),pt=dt.getContext("2d"),ft=new THREE.Color(0),mt=0,gt=1,vt=0,Et=null,yt=null,Tt=null,_t=null,bt=null,xt=null,Rt=0,wt=new THREE.RenderableVertex,Ht=new THREE.RenderableVertex,Mt=new THREE.Color,St=new THREE.Color,Ct=new THREE.Color,At=new THREE.Color,Dt=new THREE.Color,Pt=new THREE.Color,Lt=new THREE.Color,kt=new THREE.Color,Ft={},zt={},Nt=new THREE.Box2,It=new THREE.Box2,Ot=new THREE.Box2,Ut=new THREE.Color,Vt=new THREE.Color,Bt=new THREE.Color,jt=new THREE.Vector3,Wt=16;nt=document.createElement("canvas"),nt.width=nt.height=2,ot=nt.getContext("2d"),ot.fillStyle="rgba(0,0,0,1)",ot.fillRect(0,0,2,2),at=ot.getImageData(0,0,2,2),st=at.data,lt=document.createElement("canvas"),lt.width=lt.height=Wt,ht=lt.getContext("2d"),ht.translate(-Wt/2,-Wt/2),ht.scale(Wt,Wt),Wt--,void 0===pt.setLineDash&&(pt.setLineDash=void 0!==pt.mozDash?function(e){pt.mozDash=null!==e[0]?e:null}:function(){}),this.domElement=dt,this.devicePixelRatio=void 0!==e.devicePixelRatio?e.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.info={render:{vertices:0,faces:0}},this.supportsVertexTextures=function(){},this.setFaceCulling=function(){},this.setSize=function(e,t,i){M=e*this.devicePixelRatio,S=t*this.devicePixelRatio,C=Math.floor(M/2),A=Math.floor(S/2),dt.width=M,dt.height=S,1!==this.devicePixelRatio&&i!==!1&&(dt.style.width=e+"px",dt.style.height=t+"px"),Nt.set(new THREE.Vector2(-C,-A),new THREE.Vector2(C,A)),It.set(new THREE.Vector2(-C,-A),new THREE.Vector2(C,A)),gt=1,vt=0,Et=null,yt=null,Tt=null,_t=null,bt=null},this.setClearColor=function(e,t){ft.set(e),mt=void 0!==t?t:1,It.set(new THREE.Vector2(-C,-A),new THREE.Vector2(C,A))},this.setClearColorHex=function(e,t){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(e,t)},this.getMaxAnisotropy=function(){return 0},this.clear=function(){pt.setTransform(1,0,0,-1,C,A),It.empty()===!1&&(It.intersect(Nt),It.expandByScalar(2),1>mt&&pt.clearRect(0|It.min.x,0|It.min.y,0|It.max.x-It.min.x,0|It.max.y-It.min.y),mt>0&&(g(THREE.NormalBlending),m(1),_("rgba("+Math.floor(255*ft.r)+","+Math.floor(255*ft.g)+","+Math.floor(255*ft.b)+","+mt+")"),pt.fillRect(0|It.min.x,0|It.min.y,0|It.max.x-It.min.x,0|It.max.y-It.min.y)),It.makeEmpty())},this.render=function(e,i){if(i instanceof THREE.Camera==!1)return console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera."),void 0;this.autoClear===!0&&this.clear(),pt.setTransform(1,0,0,-1,C,A),ct.info.render.vertices=0,ct.info.render.faces=0,R=ut.projectScene(e,i,this.sortObjects,this.sortElements),w=R.elements,H=R.lights,D=i,t();for(var s=0,l=w.length;l>s;s++){var h=w[s],c=h.material;if(void 0!==c&&c.visible!==!1){if(Ot.makeEmpty(),h instanceof THREE.RenderableParticle)P=h,P.x*=C,P.y*=A,r(P,h,c);else if(h instanceof THREE.RenderableLine)P=h.v1,L=h.v2,P.positionScreen.x*=C,P.positionScreen.y*=A,L.positionScreen.x*=C,L.positionScreen.y*=A,Ot.setFromPoints([P.positionScreen,L.positionScreen]),Nt.isIntersectionBox(Ot)===!0&&n(P,L,h,c);else if(h instanceof THREE.RenderableFace3){if(P=h.v1,L=h.v2,k=h.v3,P.positionScreen.z<-1||P.positionScreen.z>1)continue;if(L.positionScreen.z<-1||L.positionScreen.z>1)continue;if(k.positionScreen.z<-1||k.positionScreen.z>1)continue;P.positionScreen.x*=C,P.positionScreen.y*=A,L.positionScreen.x*=C,L.positionScreen.y*=A,k.positionScreen.x*=C,k.positionScreen.y*=A,c.overdraw>0&&(f(P.positionScreen,L.positionScreen,c.overdraw),f(L.positionScreen,k.positionScreen,c.overdraw),f(k.positionScreen,P.positionScreen,c.overdraw)),Ot.setFromPoints([P.positionScreen,L.positionScreen,k.positionScreen]),Nt.isIntersectionBox(Ot)===!0&&o(P,L,k,0,1,2,h,c)}else if(h instanceof THREE.RenderableFace4){if(P=h.v1,L=h.v2,k=h.v3,F=h.v4,P.positionScreen.z<-1||P.positionScreen.z>1)continue;if(L.positionScreen.z<-1||L.positionScreen.z>1)continue;if(k.positionScreen.z<-1||k.positionScreen.z>1)continue;if(F.positionScreen.z<-1||F.positionScreen.z>1)continue;P.positionScreen.x*=C,P.positionScreen.y*=A,L.positionScreen.x*=C,L.positionScreen.y*=A,k.positionScreen.x*=C,k.positionScreen.y*=A,F.positionScreen.x*=C,F.positionScreen.y*=A,wt.positionScreen.copy(L.positionScreen),Ht.positionScreen.copy(F.positionScreen),c.overdraw>0&&(f(P.positionScreen,L.positionScreen,c.overdraw),f(L.positionScreen,F.positionScreen,c.overdraw),f(F.positionScreen,P.positionScreen,c.overdraw),f(k.positionScreen,wt.positionScreen,c.overdraw),f(k.positionScreen,Ht.positionScreen,c.overdraw)),Ot.setFromPoints([P.positionScreen,L.positionScreen,k.positionScreen,F.positionScreen]),Nt.isIntersectionBox(Ot)===!0&&a(P,L,k,F,wt,Ht,h,c)}It.union(Ot)}}pt.setTransform(1,0,0,1,0,0)}},THREE.ShaderChunk={fog_pars_fragment:["#ifdef USE_FOG","uniform vec3 fogColor;","#ifdef FOG_EXP2","uniform float fogDensity;","#else","uniform float fogNear;","uniform float fogFar;","#endif","#endif"].join("\n"),fog_fragment:["#ifdef USE_FOG","float depth = gl_FragCoord.z / gl_FragCoord.w;","#ifdef FOG_EXP2","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","#else","float fogFactor = smoothstep( fogNear, fogFar, depth );","#endif","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","#endif"].join("\n"),envmap_pars_fragment:["#ifdef USE_ENVMAP","uniform float reflectivity;","uniform samplerCube envMap;","uniform float flipEnvMap;","uniform int combine;","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","uniform bool useRefract;","uniform float refractionRatio;","#else","varying vec3 vReflect;","#endif","#endif"].join("\n"),envmap_fragment:["#ifdef USE_ENVMAP","vec3 reflectVec;","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","if ( useRefract ) {","reflectVec = refract( cameraToVertex, normal, refractionRatio );","} else { ","reflectVec = reflect( cameraToVertex, normal );","}","#else","reflectVec = vReflect;","#endif","#ifdef DOUBLE_SIDED","float flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );","vec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );","#else","vec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );","#endif","#ifdef GAMMA_INPUT","cubeColor.xyz *= cubeColor.xyz;","#endif","#ifdef FLIP","cubeColor.rgb = vec3( max((cubeColor.r + cubeColor.g + cubeColor.b ) * 0.3333, 0.15 )) ;","#endif","if ( combine == 1 ) {","gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );","} else if ( combine == 2 ) {","gl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;","} else {","gl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );","}","#endif"].join("\n"),envmap_pars_vertex:["#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )","varying vec3 vReflect;","uniform float refractionRatio;","uniform bool useRefract;","#endif"].join("\n"),worldpos_vertex:["#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )","#ifdef USE_SKINNING","vec4 worldPosition = modelMatrix * skinned;","#endif","#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )","vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );","#endif","#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","#endif","#endif"].join("\n"),envmap_vertex:["#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )","vec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;","worldNormal = normalize( worldNormal );","vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );","if ( useRefract ) {","vReflect = refract( cameraToVertex, worldNormal, refractionRatio );","} else {","vReflect = reflect( cameraToVertex, worldNormal );","}","#endif"].join("\n"),map_particle_pars_fragment:["#ifdef USE_MAP","uniform sampler2D map;","#endif"].join("\n"),map_particle_fragment:["#ifdef USE_MAP","gl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );","#endif"].join("\n"),map_pars_vertex:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","varying vec2 vUv;","uniform vec4 offsetRepeat;","#endif"].join("\n"),map_pars_fragment:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","varying vec2 vUv;","#endif","#ifdef USE_MAP","uniform sampler2D map;","#endif"].join("\n"),map_vertex:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","vUv = uv * offsetRepeat.zw + offsetRepeat.xy;","#endif"].join("\n"),map_fragment:["#ifdef USE_MAP","vec4 texelColor = texture2D( map, vUv );","#ifdef GAMMA_INPUT","texelColor.xyz *= texelColor.xyz;","#endif","gl_FragColor = gl_FragColor * texelColor;","#endif"].join("\n"),lightmap_pars_fragment:["#ifdef USE_LIGHTMAP","varying vec2 vUv2;","uniform sampler2D lightMap;","#endif"].join("\n"),lightmap_pars_vertex:["#ifdef USE_LIGHTMAP","varying vec2 vUv2;","#endif"].join("\n"),lightmap_fragment:["#ifdef USE_LIGHTMAP","gl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );","#endif"].join("\n"),lightmap_vertex:["#ifdef USE_LIGHTMAP","vUv2 = uv2;","#endif"].join("\n"),bumpmap_pars_fragment:["#ifdef USE_BUMPMAP","uniform sampler2D bumpMap;","uniform float bumpScale;","vec2 dHdxy_fwd() {","vec2 dSTdx = dFdx( vUv );","vec2 dSTdy = dFdy( vUv );","float Hll = bumpScale * texture2D( bumpMap, vUv ).x;","float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;","float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;","return vec2( dBx, dBy );","}","vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {","vec3 vSigmaX = dFdx( surf_pos );","vec3 vSigmaY = dFdy( surf_pos );","vec3 vN = surf_norm;","vec3 R1 = cross( vSigmaY, vN );","vec3 R2 = cross( vN, vSigmaX );","float fDet = dot( vSigmaX, R1 );","vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );","return normalize( abs( fDet ) * surf_norm - vGrad );","}","#endif"].join("\n"),normalmap_pars_fragment:["#ifdef USE_NORMALMAP","uniform sampler2D normalMap;","uniform vec2 normalScale;","vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {","vec3 q0 = dFdx( eye_pos.xyz );","vec3 q1 = dFdy( eye_pos.xyz );","vec2 st0 = dFdx( vUv.st );","vec2 st1 = dFdy( vUv.st );","vec3 S = normalize(  q0 * st1.t - q1 * st0.t );","vec3 T = normalize( -q0 * st1.s + q1 * st0.s );","vec3 N = normalize( surf_norm );","vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;","mapN.xy = normalScale * mapN.xy;","mat3 tsn = mat3( S, T, N );","return normalize( tsn * mapN );","}","#endif"].join("\n"),specularmap_pars_fragment:["#ifdef USE_SPECULARMAP","uniform sampler2D specularMap;","#endif"].join("\n"),specularmap_fragment:["float specularStrength;","#ifdef USE_SPECULARMAP","vec4 texelSpecular = texture2D( specularMap, vUv );","specularStrength = texelSpecular.r;","#else","specularStrength = 1.0;","#endif"].join("\n"),lights_lambert_pars_vertex:["uniform vec3 ambient;","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif"].join("\n"),lights_lambert_vertex:["vLightFront = vec3( 0.0 );","#ifdef DOUBLE_SIDED","vLightBack = vec3( 0.0 );","#endif","transformedNormal = normalize( transformedNormal );","#if MAX_DIR_LIGHTS > 0","for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","float dotProduct = dot( transformedNormal, dirVector );","vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","directionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","directionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += directionalLightColor[ i ] * directionalLightWeighting;","#ifdef DOUBLE_SIDED","vLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;","#endif","}","#endif","#if MAX_POINT_LIGHTS > 0","for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","float dotProduct = dot( transformedNormal, lVector );","vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","pointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","pointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;","#ifdef DOUBLE_SIDED","vLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","float dotProduct = dot( transformedNormal, lVector );","vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","spotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","spotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;","#ifdef DOUBLE_SIDED","vLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;","#endif","}","}","#endif","#if MAX_HEMI_LIGHTS > 0","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( transformedNormal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","float hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;","vLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","#ifdef DOUBLE_SIDED","vLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );","#endif","}","#endif","vLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;","#ifdef DOUBLE_SIDED","vLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;","#endif"].join("\n"),lights_phong_pars_vertex:["#ifndef PHONG_PER_PIXEL","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","varying vec4 vPointLight[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","varying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","varying vec3 vWorldPosition;","#endif"].join("\n"),lights_phong_vertex:["#ifndef PHONG_PER_PIXEL","#if MAX_POINT_LIGHTS > 0","for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","vPointLight[ i ] = vec4( lVector, lDistance );","}","#endif","#if MAX_SPOT_LIGHTS > 0","for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","vSpotLight[ i ] = vec4( lVector, lDistance );","}","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","vWorldPosition = worldPosition.xyz;","#endif"].join("\n"),lights_phong_pars_fragment:["uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","#ifdef PHONG_PER_PIXEL","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#else","varying vec4 vPointLight[ MAX_POINT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","#ifdef PHONG_PER_PIXEL","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#else","varying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","varying vec3 vWorldPosition;","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif","varying vec3 vViewPosition;","varying vec3 vNormal;"].join("\n"),lights_phong_fragment:["vec3 normal = normalize( vNormal );","vec3 viewPosition = normalize( vViewPosition );","#ifdef DOUBLE_SIDED","normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );","#endif","#ifdef USE_NORMALMAP","normal = perturbNormal2Arb( -vViewPosition, normal );","#elif defined( USE_BUMPMAP )","normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );","#endif","#if MAX_POINT_LIGHTS > 0","vec3 pointDiffuse  = vec3( 0.0 );","vec3 pointSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","#ifdef PHONG_PER_PIXEL","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","#else","vec3 lVector = normalize( vPointLight[ i ].xyz );","float lDistance = vPointLight[ i ].w;","#endif","float dotProduct = dot( normal, lVector );","#ifdef WRAP_AROUND","float pointDiffuseWeightFull = max( dotProduct, 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","#else","#ifdef FLIP","float pointDiffuseWeight = abs( dotProduct );","#else","float pointDiffuseWeight = max( dotProduct, 0.0 );","#endif","#endif","pointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;","vec3 pointHalfVector = normalize( lVector + viewPosition );","#ifdef FLIP","float pointDotNormalHalf = abs( dot( normal, pointHalfVector ) );","#else","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","#endif","float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );","pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;","#else","pointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","vec3 spotDiffuse  = vec3( 0.0 );","vec3 spotSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","#ifdef PHONG_PER_PIXEL","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","#else","vec3 lVector = normalize( vSpotLight[ i ].xyz );","float lDistance = vSpotLight[ i ].w;","#endif","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","float dotProduct = dot( normal, lVector );","#ifdef WRAP_AROUND","float spotDiffuseWeightFull = max( dotProduct, 0.0 );","float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","#else","float spotDiffuseWeight = max( dotProduct, 0.0 );","#endif","spotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;","vec3 spotHalfVector = normalize( lVector + viewPosition );","float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );","spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;","#else","spotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;","#endif","}","}","#endif","#if MAX_DIR_LIGHTS > 0","vec3 dirDiffuse  = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, dirVector );","#ifdef WRAP_AROUND","float dirDiffuseWeightFull = max( dotProduct, 0.0 );","float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );","#else","float dirDiffuseWeight = max( dotProduct, 0.0 );","#endif","dirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );","dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","#else","dirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;","#endif","}","#endif","#if MAX_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","hemiDiffuse += diffuse * hemiColor;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","float hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","float hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float dotProductGround = dot( normal, lVectorGround );","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );","vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );","hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );","#else","hemiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;","#endif","}","#endif","vec3 totalDiffuse = vec3( 0.0 );","vec3 totalSpecular = vec3( 0.0 );","#if MAX_DIR_LIGHTS > 0","totalDiffuse += dirDiffuse;","totalSpecular += dirSpecular;","#endif","#if MAX_HEMI_LIGHTS > 0","totalDiffuse += hemiDiffuse;","totalSpecular += hemiSpecular;","#endif","#if MAX_POINT_LIGHTS > 0","totalDiffuse += pointDiffuse;","totalSpecular += pointSpecular;","#endif","#if MAX_SPOT_LIGHTS > 0","totalDiffuse += spotDiffuse;","totalSpecular += spotSpecular;","#endif","#ifdef METAL","gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );","#else","gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;","#endif"].join("\n"),color_pars_fragment:["#ifdef USE_COLOR","varying vec3 vColor;","#endif"].join("\n"),color_fragment:["#ifdef USE_COLOR","gl_FragColor = gl_FragColor * vec4( vColor, opacity );","#endif"].join("\n"),color_pars_vertex:["#ifdef USE_COLOR","varying vec3 vColor;","#endif"].join("\n"),color_vertex:["#ifdef USE_COLOR","#ifdef GAMMA_INPUT","vColor = color * color;","#else","vColor = color;","#endif","#endif"].join("\n"),skinning_pars_vertex:["#ifdef USE_SKINNING","#ifdef BONE_TEXTURE","uniform sampler2D boneTexture;","mat4 getBoneMatrix( const in float i ) {","float j = i * 4.0;","float x = mod( j, N_BONE_PIXEL_X );","float y = floor( j / N_BONE_PIXEL_X );","const float dx = 1.0 / N_BONE_PIXEL_X;","const float dy = 1.0 / N_BONE_PIXEL_Y;","y = dy * ( y + 0.5 );","vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );","vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );","vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );","vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );","mat4 bone = mat4( v1, v2, v3, v4 );","return bone;","}","#else","uniform mat4 boneGlobalMatrices[ MAX_BONES ];","mat4 getBoneMatrix( const in float i ) {","mat4 bone = boneGlobalMatrices[ int(i) ];","return bone;","}","#endif","#endif"].join("\n"),skinbase_vertex:["#ifdef USE_SKINNING","mat4 boneMatX = getBoneMatrix( skinIndex.x );","mat4 boneMatY = getBoneMatrix( skinIndex.y );","#endif"].join("\n"),skinning_vertex:["#ifdef USE_SKINNING","#ifdef USE_MORPHTARGETS","vec4 skinVertex = vec4( morphed, 1.0 );","#else","vec4 skinVertex = vec4( position, 1.0 );","#endif","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","#endif"].join("\n"),morphtarget_pars_vertex:["#ifdef USE_MORPHTARGETS","#ifndef USE_MORPHNORMALS","uniform float morphTargetInfluences[ 8 ];","#else","uniform float morphTargetInfluences[ 4 ];","#endif","#endif"].join("\n"),morphtarget_vertex:["#ifdef USE_MORPHTARGETS","vec3 morphed = vec3( 0.0 );","morphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];","morphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];","morphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];","morphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];","#ifndef USE_MORPHNORMALS","morphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];","morphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];","morphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];","morphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];","#endif","morphed += position;","#endif"].join("\n"),default_vertex:["vec4 mvPosition;","#ifdef USE_SKINNING","mvPosition = modelViewMatrix * skinned;","#endif","#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )","mvPosition = modelViewMatrix * vec4( morphed, 1.0 );","#endif","#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )","mvPosition = modelViewMatrix * vec4( position, 1.0 );","#endif","gl_Position = projectionMatrix * mvPosition;"].join("\n"),morphnormal_vertex:["#ifdef USE_MORPHNORMALS","vec3 morphedNormal = vec3( 0.0 );","morphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];","morphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];","morphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];","morphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];","morphedNormal += normal;","#endif"].join("\n"),skinnormal_vertex:["#ifdef USE_SKINNING","mat4 skinMatrix = skinWeight.x * boneMatX;","skinMatrix 	+= skinWeight.y * boneMatY;","#ifdef USE_MORPHNORMALS","vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );","#else","vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );","#endif","#endif"].join("\n"),defaultnormal_vertex:["vec3 objectNormal;","#ifdef USE_SKINNING","objectNormal = skinnedNormal.xyz;","#endif","#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )","objectNormal = morphedNormal;","#endif","#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )","objectNormal = normal;","#endif","#ifdef FLIP_SIDED","objectNormal = -objectNormal;","#endif","vec3 transformedNormal = normalMatrix * objectNormal;"].join("\n"),shadowmap_pars_fragment:["#ifdef USE_SHADOWMAP","uniform sampler2D shadowMap[ MAX_SHADOWS ];","uniform vec2 shadowMapSize[ MAX_SHADOWS ];","uniform float shadowDarkness[ MAX_SHADOWS ];","uniform float shadowBias[ MAX_SHADOWS ];","varying vec4 vShadowCoord[ MAX_SHADOWS ];","float unpackDepth( const in vec4 rgba_depth ) {","const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );","float depth = dot( rgba_depth, bit_shift );","return depth;","}","#endif"].join("\n"),shadowmap_fragment:["#ifdef USE_SHADOWMAP","#ifdef SHADOWMAP_DEBUG","vec3 frustumColors[3];","frustumColors[0] = vec3( 1.0, 0.5, 0.0 );","frustumColors[1] = vec3( 0.0, 1.0, 0.8 );","frustumColors[2] = vec3( 0.0, 0.5, 1.0 );","#endif","#ifdef SHADOWMAP_CASCADE","int inFrustumCount = 0;","#endif","float fDepth;","vec3 shadowColor = vec3( 1.0 );","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;","bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );","bool inFrustum = all( inFrustumVec );","#ifdef SHADOWMAP_CASCADE","inFrustumCount += int( inFrustum );","bvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );","#else","bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );","#endif","bool frustumTest = all( frustumTestVec );","if ( frustumTest ) {","shadowCoord.z += shadowBias[ i ];","#if defined( SHADOWMAP_TYPE_PCF )","float shadow = 0.0;","const float shadowDelta = 1.0 / 9.0;","float xPixelOffset = 1.0 / shadowMapSize[ i ].x;","float yPixelOffset = 1.0 / shadowMapSize[ i ].y;","float dx0 = -1.25 * xPixelOffset;","float dy0 = -1.25 * yPixelOffset;","float dx1 = 1.25 * xPixelOffset;","float dy1 = 1.25 * yPixelOffset;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );","#elif defined( SHADOWMAP_TYPE_PCF_SOFT )","float shadow = 0.0;","float xPixelOffset = 1.0 / shadowMapSize[ i ].x;","float yPixelOffset = 1.0 / shadowMapSize[ i ].y;","float dx0 = -1.0 * xPixelOffset;","float dy0 = -1.0 * yPixelOffset;","float dx1 = 1.0 * xPixelOffset;","float dy1 = 1.0 * yPixelOffset;","mat3 shadowKernel;","mat3 depthKernel;","depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );","depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );","depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );","depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );","depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );","depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );","depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );","depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );","depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );","vec3 shadowZ = vec3( shadowCoord.z );","shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));","shadowKernel[0] *= vec3(0.25);","shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));","shadowKernel[1] *= vec3(0.25);","shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));","shadowKernel[2] *= vec3(0.25);","vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );","shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );","shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );","vec4 shadowValues;","shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );","shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );","shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );","shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );","shadow = dot( shadowValues, vec4( 1.0 ) );","shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );","#else","vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );","float fDepth = unpackDepth( rgbaDepth );","if ( fDepth < shadowCoord.z )","shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );","#endif","}","#ifdef SHADOWMAP_DEBUG","#ifdef SHADOWMAP_CASCADE","if ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];","#else","if ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];","#endif","#endif","}","#ifdef GAMMA_OUTPUT","shadowColor *= shadowColor;","#endif","gl_FragColor.xyz = gl_FragColor.xyz * shadowColor;","#endif"].join("\n"),shadowmap_pars_vertex:["#ifdef USE_SHADOWMAP","varying vec4 vShadowCoord[ MAX_SHADOWS ];","uniform mat4 shadowMatrix[ MAX_SHADOWS ];","#endif"].join("\n"),shadowmap_vertex:["#ifdef USE_SHADOWMAP","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;","}","#endif"].join("\n"),alphatest_fragment:["#ifdef ALPHATEST","if ( gl_FragColor.a < ALPHATEST ) discard;","#endif"].join("\n"),linear_to_gamma_fragment:["#ifdef GAMMA_OUTPUT","gl_FragColor.xyz = sqrt( gl_FragColor.xyz );","#endif"].join("\n")},THREE.UniformsUtils={merge:function(e){var t,i,r,n={};
for(t=0;t<e.length;t++){r=this.clone(e[t]);for(i in r)n[i]=r[i]}return n},clone:function(e){var t,i,r,n={};for(t in e){n[t]={};for(i in e[t])r=e[t][i],n[t][i]=r instanceof THREE.Color||r instanceof THREE.Vector2||r instanceof THREE.Vector3||r instanceof THREE.Vector4||r instanceof THREE.Matrix4||r instanceof THREE.Texture?r.clone():r instanceof Array?r.slice():r}return n}},THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {","gl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","varying vec3 vLightBack;","#endif",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","varying vec3 vLightBack;","#endif",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {","gl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"#ifdef DOUBLE_SIDED","if ( gl_FrontFacing )","gl_FragColor.xyz *= vLightFront;","else","gl_FragColor.xyz *= vLightBack;","#else","gl_FragColor.xyz *= vLightFront;","#endif",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","varying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"vNormal = normalize( transformedNormal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform vec3 ambient;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {","gl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;","uniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","#ifdef USE_SIZEATTENUATION","gl_PointSize = size * ( scale / length( mvPosition.xyz ) );","#else","gl_PointSize = size;","#endif","gl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {","gl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",THREE.ShaderChunk.color_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vLineDistance = scale * lineDistance;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {","if ( mod( vLineDistance, totalSize ) > dashSize ) {","discard;","}","gl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:["void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;","void main() {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float color = 1.0 - smoothstep( mNear, mFar, depth );","gl_FragColor = vec4( vec3( color ), opacity );","}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {","vNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;","void main() {","gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );","}"].join("\n")},normalmap:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new THREE.Vector2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new THREE.Color(16777215)},uSpecularColor:{type:"c",value:new THREE.Color(1118481)},uAmbientColor:{type:"c",value:new THREE.Color(16777215)},uShininess:{type:"f",value:30},uOpacity:{type:"f",value:1},useRefract:{type:"i",value:0},uRefractionRatio:{type:"f",value:.98},uReflectivity:{type:"f",value:.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 uAmbientColor;","uniform vec3 uDiffuseColor;","uniform vec3 uSpecularColor;","uniform float uShininess;","uniform float uOpacity;","uniform bool enableDiffuse;","uniform bool enableSpecular;","uniform bool enableAO;","uniform bool enableReflection;","uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tSpecular;","uniform sampler2D tAO;","uniform samplerCube tCube;","uniform vec2 uNormalScale;","uniform bool useRefract;","uniform float uRefractionRatio;","uniform float uReflectivity;","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {","gl_FragColor = vec4( vec3( 1.0 ), uOpacity );","vec3 specularTex = vec3( 1.0 );","vec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;","normalTex.xy *= uNormalScale;","normalTex = normalize( normalTex );","if( enableDiffuse ) {","#ifdef GAMMA_INPUT","vec4 texelColor = texture2D( tDiffuse, vUv );","texelColor.xyz *= texelColor.xyz;","gl_FragColor = gl_FragColor * texelColor;","#else","gl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );","#endif","}","if( enableAO ) {","#ifdef GAMMA_INPUT","vec4 aoColor = texture2D( tAO, vUv );","aoColor.xyz *= aoColor.xyz;","gl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;","#else","gl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;","#endif","}","if( enableSpecular )","specularTex = texture2D( tSpecular, vUv ).xyz;","mat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );","vec3 finalNormal = tsb * normalTex;","#ifdef FLIP_SIDED","finalNormal = -finalNormal;","#endif","vec3 normal = normalize( finalNormal );","vec3 viewPosition = normalize( vViewPosition );","#if MAX_POINT_LIGHTS > 0","vec3 pointDiffuse = vec3( 0.0 );","vec3 pointSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 pointVector = lPosition.xyz + vViewPosition.xyz;","float pointDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","pointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );","pointVector = normalize( pointVector );","#ifdef WRAP_AROUND","float pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","#else","float pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );","#endif","pointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;","vec3 pointHalfVector = normalize( pointVector + viewPosition );","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );","pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;","#else","pointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","vec3 spotDiffuse = vec3( 0.0 );","vec3 spotSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 spotVector = lPosition.xyz + vViewPosition.xyz;","float spotDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","spotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );","spotVector = normalize( spotVector );","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","#ifdef WRAP_AROUND","float spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );","float spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );","vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","#else","float spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );","#endif","spotDiffuse += spotDistance * spotLightColor[ i ] * uDiffuseColor * spotDiffuseWeight * spotEffect;","vec3 spotHalfVector = normalize( spotVector + viewPosition );","float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","float spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );","spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;","#else","spotSpecular += spotDistance * spotLightColor[ i ] * uSpecularColor * spotSpecularWeight * spotDiffuseWeight * spotEffect;","#endif","}","}","#endif","#if MAX_DIR_LIGHTS > 0","vec3 dirDiffuse = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","#ifdef WRAP_AROUND","float directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );","float directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );","#else","float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );","#endif","dirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );","dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","#else","dirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;","#endif","}","#endif","#if MAX_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","hemiDiffuse += uDiffuseColor * hemiColor;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","float hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","float hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float dotProductGround = dot( normal, lVectorGround );","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlickSky = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );","vec3 schlickGround = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );","hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );","#else","hemiSpecular += uSpecularColor * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;","#endif","}","#endif","vec3 totalDiffuse = vec3( 0.0 );","vec3 totalSpecular = vec3( 0.0 );","#if MAX_DIR_LIGHTS > 0","totalDiffuse += dirDiffuse;","totalSpecular += dirSpecular;","#endif","#if MAX_HEMI_LIGHTS > 0","totalDiffuse += hemiDiffuse;","totalSpecular += hemiSpecular;","#endif","#if MAX_POINT_LIGHTS > 0","totalDiffuse += pointDiffuse;","totalSpecular += pointSpecular;","#endif","#if MAX_SPOT_LIGHTS > 0","totalDiffuse += spotDiffuse;","totalSpecular += spotSpecular;","#endif","#ifdef METAL","gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor + totalSpecular );","#else","gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor ) + totalSpecular;","#endif","if ( enableReflection ) {","vec3 vReflect;","vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","if ( useRefract ) {","vReflect = refract( cameraToVertex, normal, uRefractionRatio );","} else {","vReflect = reflect( cameraToVertex, normal );","}","vec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );","#ifdef GAMMA_INPUT","cubeColor.xyz *= cubeColor.xyz;","#endif","gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );","}",THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;","uniform vec2 uOffset;","uniform vec2 uRepeat;","uniform bool enableDisplacement;","#ifdef VERTEX_TEXTURES","uniform sampler2D tDisplacement;","uniform float uDisplacementScale;","uniform float uDisplacementBias;","#endif","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,"#ifdef USE_SKINNING","vNormal = normalize( normalMatrix * skinnedNormal.xyz );","vec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );","vTangent = normalize( normalMatrix * skinnedTangent.xyz );","#else","vNormal = normalize( normalMatrix * normal );","vTangent = normalize( normalMatrix * tangent.xyz );","#endif","vBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );","vUv = uv * uRepeat + uOffset;","vec3 displacedPosition;","#ifdef VERTEX_TEXTURES","if ( enableDisplacement ) {","vec3 dv = texture2D( tDisplacement, uv ).xyz;","float df = uDisplacementScale * dv.x + uDisplacementBias;","displacedPosition = position + normalize( normal ) * df;","} else {","#ifdef USE_SKINNING","vec4 skinVertex = vec4( position, 1.0 );","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","displacedPosition  = skinned.xyz;","#else","displacedPosition = position;","#endif","}","#else","#ifdef USE_SKINNING","vec4 skinVertex = vec4( position, 1.0 );","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","displacedPosition  = skinned.xyz;","#else","displacedPosition = position;","#endif","#endif","vec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );","vec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );","gl_Position = projectionMatrix * mvPosition;","vWorldPosition = worldPosition.xyz;","vViewPosition = -mvPosition.xyz;","#ifdef USE_SHADOWMAP","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;","}","#endif","}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;","void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vWorldPosition = worldPosition.xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;","void main() {","gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );","}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:["vec4 pack_depth( const in float depth ) {","const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","const vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","vec4 res = fract( depth * bit_shift );","res -= res.xxyz * bit_mask;","return res;","}","void main() {","gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","}"].join("\n")}},THREE.WebGLRenderer=function(e){function t(e){e.__webglVertexBuffer=It.createBuffer(),e.__webglColorBuffer=It.createBuffer(),Wt.info.memory.geometries++}function i(e){e.__webglVertexBuffer=It.createBuffer(),e.__webglColorBuffer=It.createBuffer(),e.__webglLineDistanceBuffer=It.createBuffer(),Wt.info.memory.geometries++}function r(e){e.__webglVertexBuffer=It.createBuffer(),e.__webglColorBuffer=It.createBuffer(),e.__webglNormalBuffer=It.createBuffer(),Wt.info.memory.geometries++}function n(e){e.__webglVertexBuffer=It.createBuffer(),e.__webglNormalBuffer=It.createBuffer(),e.__webglTangentBuffer=It.createBuffer(),e.__webglColorBuffer=It.createBuffer(),e.__webglUVBuffer=It.createBuffer(),e.__webglUV2Buffer=It.createBuffer(),e.__webglSkinIndicesBuffer=It.createBuffer(),e.__webglSkinWeightsBuffer=It.createBuffer(),e.__webglFaceBuffer=It.createBuffer(),e.__webglLineBuffer=It.createBuffer();var t,i;if(e.numMorphTargets)for(e.__webglMorphTargetsBuffers=[],t=0,i=e.numMorphTargets;i>t;t++)e.__webglMorphTargetsBuffers.push(It.createBuffer());if(e.numMorphNormals)for(e.__webglMorphNormalsBuffers=[],t=0,i=e.numMorphNormals;i>t;t++)e.__webglMorphNormalsBuffers.push(It.createBuffer());Wt.info.memory.geometries++}function o(e){if(e.__webglCustomAttributesList)for(var t in e.__webglCustomAttributesList)It.deleteBuffer(e.__webglCustomAttributesList[t].buffer)}function a(e,t){var i=e.vertices.length,r=t.material;if(r.attributes){void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]);for(var n in r.attributes){var o=r.attributes[n];if(!o.__webglInitialized||o.createUniqueBuffers){o.__webglInitialized=!0;var a=1;"v2"===o.type?a=2:"v3"===o.type?a=3:"v4"===o.type?a=4:"c"===o.type&&(a=3),o.size=a,o.array=new Float32Array(i*a),o.buffer=It.createBuffer(),o.buffer.belongsToAttribute=n,o.needsUpdate=!0}e.__webglCustomAttributesList.push(o)}}}function s(e,t){var i=e.vertices.length;e.__vertexArray=new Float32Array(3*i),e.__colorArray=new Float32Array(3*i),e.__sortArray=[],e.__webglParticleCount=i,a(e,t)}function l(e,t){var i=e.vertices.length;e.__vertexArray=new Float32Array(3*i),e.__colorArray=new Float32Array(3*i),e.__lineDistanceArray=new Float32Array(1*i),e.__webglLineCount=i,a(e,t)}function h(e,t){var i=e.vertices.length;e.__vertexArray=new Float32Array(3*i),e.__colorArray=new Float32Array(3*i),e.__normalArray=new Float32Array(3*i),e.__webglVertexCount=i,a(e,t)}function c(e,t){var i=t.geometry,r=e.faces3,n=e.faces4,o=3*r.length+4*n.length,a=1*r.length+2*n.length,s=3*r.length+4*n.length,l=u(t,e),h=m(l),c=p(l),d=f(l);e.__vertexArray=new Float32Array(3*o),c&&(e.__normalArray=new Float32Array(3*o)),i.hasTangents&&(e.__tangentArray=new Float32Array(4*o)),d&&(e.__colorArray=new Float32Array(3*o)),h&&((i.faceUvs.length>0||i.faceVertexUvs.length>0)&&(e.__uvArray=new Float32Array(2*o)),(i.faceUvs.length>1||i.faceVertexUvs.length>1)&&(e.__uv2Array=new Float32Array(2*o))),t.geometry.skinWeights.length&&t.geometry.skinIndices.length&&(e.__skinIndexArray=new Float32Array(4*o),e.__skinWeightArray=new Float32Array(4*o)),e.__faceArray=new Uint16Array(3*a),e.__lineArray=new Uint16Array(2*s);var g,v;if(e.numMorphTargets)for(e.__morphTargetsArrays=[],g=0,v=e.numMorphTargets;v>g;g++)e.__morphTargetsArrays.push(new Float32Array(3*o));if(e.numMorphNormals)for(e.__morphNormalsArrays=[],g=0,v=e.numMorphNormals;v>g;g++)e.__morphNormalsArrays.push(new Float32Array(3*o));if(e.__webglFaceCount=3*a,e.__webglLineCount=2*s,l.attributes){void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]);for(var E in l.attributes){var y=l.attributes[E],T={};for(var _ in y)T[_]=y[_];if(!T.__webglInitialized||T.createUniqueBuffers){T.__webglInitialized=!0;var b=1;"v2"===T.type?b=2:"v3"===T.type?b=3:"v4"===T.type?b=4:"c"===T.type&&(b=3),T.size=b,T.array=new Float32Array(o*b),T.buffer=It.createBuffer(),T.buffer.belongsToAttribute=E,y.needsUpdate=!0,T.__original=y}e.__webglCustomAttributesList.push(T)}}e.__inittedArrays=!0}function u(e,t){return e.material instanceof THREE.MeshFaceMaterial?e.material.materials[t.materialIndex]:e.material}function d(e){return e&&void 0!==e.shading&&e.shading===THREE.SmoothShading}function p(e){return e instanceof THREE.MeshBasicMaterial&&!e.envMap||e instanceof THREE.MeshDepthMaterial?!1:d(e)?THREE.SmoothShading:THREE.FlatShading}function f(e){return e.vertexColors?e.vertexColors:!1}function m(e){return e.map||e.lightMap||e.bumpMap||e.normalMap||e.specularMap||e instanceof THREE.ShaderMaterial?!0:!1}function g(e){var t,i,r;for(t in e.attributes)r="index"===t?It.ELEMENT_ARRAY_BUFFER:It.ARRAY_BUFFER,i=e.attributes[t],void 0===i.numItems&&(i.numItems=i.array.length),i.buffer=It.createBuffer(),It.bindBuffer(r,i.buffer),It.bufferData(r,i.array,It.STATIC_DRAW)}function v(e,t,i){var r,n,o,a,s,l,h,c,u,d,p,f,m=e.vertices,g=m.length,v=e.colors,E=v.length,y=e.__vertexArray,T=e.__colorArray,_=e.__sortArray,b=e.verticesNeedUpdate,x=(e.elementsNeedUpdate,e.colorsNeedUpdate),R=e.__webglCustomAttributesList;
if(i.sortParticles){for(_i.copy(Ti),_i.multiply(i.matrixWorld),r=0;g>r;r++)o=m[r],bi.copy(o),bi.applyProjection(_i),_[r]=[bi.z,r];for(_.sort(H),r=0;g>r;r++)o=m[_[r][1]],a=3*r,y[a]=o.x,y[a+1]=o.y,y[a+2]=o.z;for(n=0;E>n;n++)a=3*n,l=v[_[n][1]],T[a]=l.r,T[a+1]=l.g,T[a+2]=l.b;if(R)for(h=0,c=R.length;c>h;h++)if(f=R[h],void 0===f.boundTo||"vertices"===f.boundTo)if(a=0,d=f.value.length,1===f.size)for(u=0;d>u;u++)s=_[u][1],f.array[u]=f.value[s];else if(2===f.size)for(u=0;d>u;u++)s=_[u][1],p=f.value[s],f.array[a]=p.x,f.array[a+1]=p.y,a+=2;else if(3===f.size)if("c"===f.type)for(u=0;d>u;u++)s=_[u][1],p=f.value[s],f.array[a]=p.r,f.array[a+1]=p.g,f.array[a+2]=p.b,a+=3;else for(u=0;d>u;u++)s=_[u][1],p=f.value[s],f.array[a]=p.x,f.array[a+1]=p.y,f.array[a+2]=p.z,a+=3;else if(4===f.size)for(u=0;d>u;u++)s=_[u][1],p=f.value[s],f.array[a]=p.x,f.array[a+1]=p.y,f.array[a+2]=p.z,f.array[a+3]=p.w,a+=4}else{if(b)for(r=0;g>r;r++)o=m[r],a=3*r,y[a]=o.x,y[a+1]=o.y,y[a+2]=o.z;if(x)for(n=0;E>n;n++)l=v[n],a=3*n,T[a]=l.r,T[a+1]=l.g,T[a+2]=l.b;if(R)for(h=0,c=R.length;c>h;h++)if(f=R[h],f.needsUpdate&&(void 0===f.boundTo||"vertices"===f.boundTo))if(d=f.value.length,a=0,1===f.size)for(u=0;d>u;u++)f.array[u]=f.value[u];else if(2===f.size)for(u=0;d>u;u++)p=f.value[u],f.array[a]=p.x,f.array[a+1]=p.y,a+=2;else if(3===f.size)if("c"===f.type)for(u=0;d>u;u++)p=f.value[u],f.array[a]=p.r,f.array[a+1]=p.g,f.array[a+2]=p.b,a+=3;else for(u=0;d>u;u++)p=f.value[u],f.array[a]=p.x,f.array[a+1]=p.y,f.array[a+2]=p.z,a+=3;else if(4===f.size)for(u=0;d>u;u++)p=f.value[u],f.array[a]=p.x,f.array[a+1]=p.y,f.array[a+2]=p.z,f.array[a+3]=p.w,a+=4}if((b||i.sortParticles)&&(It.bindBuffer(It.ARRAY_BUFFER,e.__webglVertexBuffer),It.bufferData(It.ARRAY_BUFFER,y,t)),(x||i.sortParticles)&&(It.bindBuffer(It.ARRAY_BUFFER,e.__webglColorBuffer),It.bufferData(It.ARRAY_BUFFER,T,t)),R)for(h=0,c=R.length;c>h;h++)f=R[h],(f.needsUpdate||i.sortParticles)&&(It.bindBuffer(It.ARRAY_BUFFER,f.buffer),It.bufferData(It.ARRAY_BUFFER,f.array,t))}function E(e,t){var i,r,n,o,a,s,l,h,c,u,d,p,f=e.vertices,m=e.colors,g=e.lineDistances,v=f.length,E=m.length,y=g.length,T=e.__vertexArray,_=e.__colorArray,b=e.__lineDistanceArray,x=e.verticesNeedUpdate,R=e.colorsNeedUpdate,w=e.lineDistancesNeedUpdate,H=e.__webglCustomAttributesList;if(x){for(i=0;v>i;i++)o=f[i],a=3*i,T[a]=o.x,T[a+1]=o.y,T[a+2]=o.z;It.bindBuffer(It.ARRAY_BUFFER,e.__webglVertexBuffer),It.bufferData(It.ARRAY_BUFFER,T,t)}if(R){for(r=0;E>r;r++)s=m[r],a=3*r,_[a]=s.r,_[a+1]=s.g,_[a+2]=s.b;It.bindBuffer(It.ARRAY_BUFFER,e.__webglColorBuffer),It.bufferData(It.ARRAY_BUFFER,_,t)}if(w){for(n=0;y>n;n++)b[n]=g[n];It.bindBuffer(It.ARRAY_BUFFER,e.__webglLineDistanceBuffer),It.bufferData(It.ARRAY_BUFFER,b,t)}if(H)for(l=0,h=H.length;h>l;l++)if(p=H[l],p.needsUpdate&&(void 0===p.boundTo||"vertices"===p.boundTo)){if(a=0,u=p.value.length,1===p.size)for(c=0;u>c;c++)p.array[c]=p.value[c];else if(2===p.size)for(c=0;u>c;c++)d=p.value[c],p.array[a]=d.x,p.array[a+1]=d.y,a+=2;else if(3===p.size)if("c"===p.type)for(c=0;u>c;c++)d=p.value[c],p.array[a]=d.r,p.array[a+1]=d.g,p.array[a+2]=d.b,a+=3;else for(c=0;u>c;c++)d=p.value[c],p.array[a]=d.x,p.array[a+1]=d.y,p.array[a+2]=d.z,a+=3;else if(4===p.size)for(c=0;u>c;c++)d=p.value[c],p.array[a]=d.x,p.array[a+1]=d.y,p.array[a+2]=d.z,p.array[a+3]=d.w,a+=4;It.bindBuffer(It.ARRAY_BUFFER,p.buffer),It.bufferData(It.ARRAY_BUFFER,p.array,t)}}function y(e,t){var i,r,n,o,a,s,l,h,c,u,d,p,f,m=e.vertices,g=e.colors,v=e.normals,E=m.length,y=g.length,T=v.length,_=e.__vertexArray,b=e.__colorArray,x=e.__normalArray,R=e.verticesNeedUpdate,w=e.colorsNeedUpdate,H=e.normalsNeedUpdate,M=e.__webglCustomAttributesList;if(R){for(i=0;E>i;i++)o=m[i],a=3*i,_[a]=o.x,_[a+1]=o.y,_[a+2]=o.z;It.bindBuffer(It.ARRAY_BUFFER,e.__webglVertexBuffer),It.bufferData(It.ARRAY_BUFFER,_,t)}if(w){for(r=0;y>r;r++)s=g[r],a=3*r,b[a]=s.r,b[a+1]=s.g,b[a+2]=s.b;It.bindBuffer(It.ARRAY_BUFFER,e.__webglColorBuffer),It.bufferData(It.ARRAY_BUFFER,b,t)}if(H){for(n=0;T>n;n++)l=v[n],a=3*n,x[a]=l.x,x[a+1]=l.y,x[a+2]=l.z;It.bindBuffer(It.ARRAY_BUFFER,e.__webglNormalBuffer),It.bufferData(It.ARRAY_BUFFER,x,t)}if(M)for(h=0,c=M.length;c>h;h++)if(p=M[h],p.needsUpdate&&(void 0===p.boundTo||"vertices"===p.boundTo)){if(a=0,d=p.value.length,1===p.size)for(u=0;d>u;u++)p.array[u]=p.value[u];else if(2===p.size)for(u=0;d>u;u++)f=p.value[u],p.array[a]=f.x,p.array[a+1]=f.y,a+=2;else if(3===p.size)if("c"===p.type)for(u=0;d>u;u++)f=p.value[u],p.array[a]=f.r,p.array[a+1]=f.g,p.array[a+2]=f.b,a+=3;else for(u=0;d>u;u++)f=p.value[u],p.array[a]=f.x,p.array[a+1]=f.y,p.array[a+2]=f.z,a+=3;else if(4===p.size)for(u=0;d>u;u++)f=p.value[u],p.array[a]=f.x,p.array[a+1]=f.y,p.array[a+2]=f.z,p.array[a+3]=f.w,a+=4;It.bindBuffer(It.ARRAY_BUFFER,p.buffer),It.bufferData(It.ARRAY_BUFFER,p.array,t)}}function T(e,t,i,r,n){if(e.__inittedArrays){var o,a,s,l,h,c,u,d,g,v,E,y,T,_,b,x,R,w,H,M,S,C,A,D,P,L,k,F,z,N,I,O,U,V,B,j,W,G,X,Y,q,K,Q,$,Z,J,et,tt,it=p(n),rt=f(n),nt=m(n),ot=it===THREE.SmoothShading,at=0,st=0,lt=0,ht=0,ct=0,ut=0,dt=0,pt=0,ft=0,mt=0,gt=0,vt=0,Et=0,yt=e.__vertexArray,Tt=e.__uvArray,_t=e.__uv2Array,bt=e.__normalArray,xt=e.__tangentArray,Rt=e.__colorArray,wt=e.__skinIndexArray,Ht=e.__skinWeightArray,Mt=e.__morphTargetsArrays,St=e.__morphNormalsArrays,Ct=e.__webglCustomAttributesList,At=e.__faceArray,Dt=e.__lineArray,Pt=t.geometry,Lt=Pt.verticesNeedUpdate,kt=Pt.elementsNeedUpdate,Ft=Pt.uvsNeedUpdate,zt=Pt.normalsNeedUpdate,Nt=Pt.tangentsNeedUpdate,Ot=Pt.colorsNeedUpdate,Ut=Pt.morphTargetsNeedUpdate,Vt=Pt.vertices,Bt=e.faces3,jt=e.faces4,Wt=Pt.faces,Gt=Pt.faceVertexUvs[0],Xt=Pt.faceVertexUvs[1],Yt=(Pt.colors,Pt.skinIndices),qt=Pt.skinWeights,Kt=Pt.morphTargets,Qt=Pt.morphNormals;if(Lt){for(o=0,a=Bt.length;a>o;o++)l=Wt[Bt[o]],y=Vt[l.a],T=Vt[l.b],_=Vt[l.c],yt[st]=y.x,yt[st+1]=y.y,yt[st+2]=y.z,yt[st+3]=T.x,yt[st+4]=T.y,yt[st+5]=T.z,yt[st+6]=_.x,yt[st+7]=_.y,yt[st+8]=_.z,st+=9;for(o=0,a=jt.length;a>o;o++)l=Wt[jt[o]],y=Vt[l.a],T=Vt[l.b],_=Vt[l.c],b=Vt[l.d],yt[st]=y.x,yt[st+1]=y.y,yt[st+2]=y.z,yt[st+3]=T.x,yt[st+4]=T.y,yt[st+5]=T.z,yt[st+6]=_.x,yt[st+7]=_.y,yt[st+8]=_.z,yt[st+9]=b.x,yt[st+10]=b.y,yt[st+11]=b.z,st+=12;It.bindBuffer(It.ARRAY_BUFFER,e.__webglVertexBuffer),It.bufferData(It.ARRAY_BUFFER,yt,i)}if(Ut)for(q=0,K=Kt.length;K>q;q++){for(gt=0,o=0,a=Bt.length;a>o;o++)Z=Bt[o],l=Wt[Z],y=Kt[q].vertices[l.a],T=Kt[q].vertices[l.b],_=Kt[q].vertices[l.c],Q=Mt[q],Q[gt]=y.x,Q[gt+1]=y.y,Q[gt+2]=y.z,Q[gt+3]=T.x,Q[gt+4]=T.y,Q[gt+5]=T.z,Q[gt+6]=_.x,Q[gt+7]=_.y,Q[gt+8]=_.z,n.morphNormals&&(ot?(J=Qt[q].vertexNormals[Z],M=J.a,S=J.b,C=J.c):(M=Qt[q].faceNormals[Z],S=M,C=M),$=St[q],$[gt]=M.x,$[gt+1]=M.y,$[gt+2]=M.z,$[gt+3]=S.x,$[gt+4]=S.y,$[gt+5]=S.z,$[gt+6]=C.x,$[gt+7]=C.y,$[gt+8]=C.z),gt+=9;for(o=0,a=jt.length;a>o;o++)Z=jt[o],l=Wt[Z],y=Kt[q].vertices[l.a],T=Kt[q].vertices[l.b],_=Kt[q].vertices[l.c],b=Kt[q].vertices[l.d],Q=Mt[q],Q[gt]=y.x,Q[gt+1]=y.y,Q[gt+2]=y.z,Q[gt+3]=T.x,Q[gt+4]=T.y,Q[gt+5]=T.z,Q[gt+6]=_.x,Q[gt+7]=_.y,Q[gt+8]=_.z,Q[gt+9]=b.x,Q[gt+10]=b.y,Q[gt+11]=b.z,n.morphNormals&&(ot?(J=Qt[q].vertexNormals[Z],M=J.a,S=J.b,C=J.c,A=J.d):(M=Qt[q].faceNormals[Z],S=M,C=M,A=M),$=St[q],$[gt]=M.x,$[gt+1]=M.y,$[gt+2]=M.z,$[gt+3]=S.x,$[gt+4]=S.y,$[gt+5]=S.z,$[gt+6]=C.x,$[gt+7]=C.y,$[gt+8]=C.z,$[gt+9]=A.x,$[gt+10]=A.y,$[gt+11]=A.z),gt+=12;It.bindBuffer(It.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[q]),It.bufferData(It.ARRAY_BUFFER,Mt[q],i),n.morphNormals&&(It.bindBuffer(It.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[q]),It.bufferData(It.ARRAY_BUFFER,St[q],i))}if(qt.length){for(o=0,a=Bt.length;a>o;o++)l=Wt[Bt[o]],F=qt[l.a],z=qt[l.b],N=qt[l.c],Ht[mt]=F.x,Ht[mt+1]=F.y,Ht[mt+2]=F.z,Ht[mt+3]=F.w,Ht[mt+4]=z.x,Ht[mt+5]=z.y,Ht[mt+6]=z.z,Ht[mt+7]=z.w,Ht[mt+8]=N.x,Ht[mt+9]=N.y,Ht[mt+10]=N.z,Ht[mt+11]=N.w,O=Yt[l.a],U=Yt[l.b],V=Yt[l.c],wt[mt]=O.x,wt[mt+1]=O.y,wt[mt+2]=O.z,wt[mt+3]=O.w,wt[mt+4]=U.x,wt[mt+5]=U.y,wt[mt+6]=U.z,wt[mt+7]=U.w,wt[mt+8]=V.x,wt[mt+9]=V.y,wt[mt+10]=V.z,wt[mt+11]=V.w,mt+=12;for(o=0,a=jt.length;a>o;o++)l=Wt[jt[o]],F=qt[l.a],z=qt[l.b],N=qt[l.c],I=qt[l.d],Ht[mt]=F.x,Ht[mt+1]=F.y,Ht[mt+2]=F.z,Ht[mt+3]=F.w,Ht[mt+4]=z.x,Ht[mt+5]=z.y,Ht[mt+6]=z.z,Ht[mt+7]=z.w,Ht[mt+8]=N.x,Ht[mt+9]=N.y,Ht[mt+10]=N.z,Ht[mt+11]=N.w,Ht[mt+12]=I.x,Ht[mt+13]=I.y,Ht[mt+14]=I.z,Ht[mt+15]=I.w,O=Yt[l.a],U=Yt[l.b],V=Yt[l.c],B=Yt[l.d],wt[mt]=O.x,wt[mt+1]=O.y,wt[mt+2]=O.z,wt[mt+3]=O.w,wt[mt+4]=U.x,wt[mt+5]=U.y,wt[mt+6]=U.z,wt[mt+7]=U.w,wt[mt+8]=V.x,wt[mt+9]=V.y,wt[mt+10]=V.z,wt[mt+11]=V.w,wt[mt+12]=B.x,wt[mt+13]=B.y,wt[mt+14]=B.z,wt[mt+15]=B.w,mt+=16;mt>0&&(It.bindBuffer(It.ARRAY_BUFFER,e.__webglSkinIndicesBuffer),It.bufferData(It.ARRAY_BUFFER,wt,i),It.bindBuffer(It.ARRAY_BUFFER,e.__webglSkinWeightsBuffer),It.bufferData(It.ARRAY_BUFFER,Ht,i))}if(Ot&&rt){for(o=0,a=Bt.length;a>o;o++)l=Wt[Bt[o]],u=l.vertexColors,d=l.color,3===u.length&&rt===THREE.VertexColors?(D=u[0],P=u[1],L=u[2]):(D=d,P=d,L=d),Rt[ft]=D.r,Rt[ft+1]=D.g,Rt[ft+2]=D.b,Rt[ft+3]=P.r,Rt[ft+4]=P.g,Rt[ft+5]=P.b,Rt[ft+6]=L.r,Rt[ft+7]=L.g,Rt[ft+8]=L.b,ft+=9;for(o=0,a=jt.length;a>o;o++)l=Wt[jt[o]],u=l.vertexColors,d=l.color,4===u.length&&rt===THREE.VertexColors?(D=u[0],P=u[1],L=u[2],k=u[3]):(D=d,P=d,L=d,k=d),Rt[ft]=D.r,Rt[ft+1]=D.g,Rt[ft+2]=D.b,Rt[ft+3]=P.r,Rt[ft+4]=P.g,Rt[ft+5]=P.b,Rt[ft+6]=L.r,Rt[ft+7]=L.g,Rt[ft+8]=L.b,Rt[ft+9]=k.r,Rt[ft+10]=k.g,Rt[ft+11]=k.b,ft+=12;ft>0&&(It.bindBuffer(It.ARRAY_BUFFER,e.__webglColorBuffer),It.bufferData(It.ARRAY_BUFFER,Rt,i))}if(Nt&&Pt.hasTangents){for(o=0,a=Bt.length;a>o;o++)l=Wt[Bt[o]],g=l.vertexTangents,x=g[0],R=g[1],w=g[2],xt[dt]=x.x,xt[dt+1]=x.y,xt[dt+2]=x.z,xt[dt+3]=x.w,xt[dt+4]=R.x,xt[dt+5]=R.y,xt[dt+6]=R.z,xt[dt+7]=R.w,xt[dt+8]=w.x,xt[dt+9]=w.y,xt[dt+10]=w.z,xt[dt+11]=w.w,dt+=12;for(o=0,a=jt.length;a>o;o++)l=Wt[jt[o]],g=l.vertexTangents,x=g[0],R=g[1],w=g[2],H=g[3],xt[dt]=x.x,xt[dt+1]=x.y,xt[dt+2]=x.z,xt[dt+3]=x.w,xt[dt+4]=R.x,xt[dt+5]=R.y,xt[dt+6]=R.z,xt[dt+7]=R.w,xt[dt+8]=w.x,xt[dt+9]=w.y,xt[dt+10]=w.z,xt[dt+11]=w.w,xt[dt+12]=H.x,xt[dt+13]=H.y,xt[dt+14]=H.z,xt[dt+15]=H.w,dt+=16;It.bindBuffer(It.ARRAY_BUFFER,e.__webglTangentBuffer),It.bufferData(It.ARRAY_BUFFER,xt,i)}if(zt&&it){for(o=0,a=Bt.length;a>o;o++)if(l=Wt[Bt[o]],h=l.vertexNormals,c=l.normal,3===h.length&&ot)for(j=0;3>j;j++)G=h[j],bt[ut]=G.x,bt[ut+1]=G.y,bt[ut+2]=G.z,ut+=3;else for(j=0;3>j;j++)bt[ut]=c.x,bt[ut+1]=c.y,bt[ut+2]=c.z,ut+=3;for(o=0,a=jt.length;a>o;o++)if(l=Wt[jt[o]],h=l.vertexNormals,c=l.normal,4===h.length&&ot)for(j=0;4>j;j++)G=h[j],bt[ut]=G.x,bt[ut+1]=G.y,bt[ut+2]=G.z,ut+=3;else for(j=0;4>j;j++)bt[ut]=c.x,bt[ut+1]=c.y,bt[ut+2]=c.z,ut+=3;It.bindBuffer(It.ARRAY_BUFFER,e.__webglNormalBuffer),It.bufferData(It.ARRAY_BUFFER,bt,i)}if(Ft&&Gt&&nt){for(o=0,a=Bt.length;a>o;o++)if(s=Bt[o],v=Gt[s],void 0!==v)for(j=0;3>j;j++)X=v[j],Tt[lt]=X.x,Tt[lt+1]=X.y,lt+=2;for(o=0,a=jt.length;a>o;o++)if(s=jt[o],v=Gt[s],void 0!==v)for(j=0;4>j;j++)X=v[j],Tt[lt]=X.x,Tt[lt+1]=X.y,lt+=2;lt>0&&(It.bindBuffer(It.ARRAY_BUFFER,e.__webglUVBuffer),It.bufferData(It.ARRAY_BUFFER,Tt,i))}if(Ft&&Xt&&nt){for(o=0,a=Bt.length;a>o;o++)if(s=Bt[o],E=Xt[s],void 0!==E)for(j=0;3>j;j++)Y=E[j],_t[ht]=Y.x,_t[ht+1]=Y.y,ht+=2;for(o=0,a=jt.length;a>o;o++)if(s=jt[o],E=Xt[s],void 0!==E)for(j=0;4>j;j++)Y=E[j],_t[ht]=Y.x,_t[ht+1]=Y.y,ht+=2;ht>0&&(It.bindBuffer(It.ARRAY_BUFFER,e.__webglUV2Buffer),It.bufferData(It.ARRAY_BUFFER,_t,i))}if(kt){for(o=0,a=Bt.length;a>o;o++)At[ct]=at,At[ct+1]=at+1,At[ct+2]=at+2,ct+=3,Dt[pt]=at,Dt[pt+1]=at+1,Dt[pt+2]=at,Dt[pt+3]=at+2,Dt[pt+4]=at+1,Dt[pt+5]=at+2,pt+=6,at+=3;for(o=0,a=jt.length;a>o;o++)At[ct]=at,At[ct+1]=at+1,At[ct+2]=at+3,At[ct+3]=at+1,At[ct+4]=at+2,At[ct+5]=at+3,ct+=6,Dt[pt]=at,Dt[pt+1]=at+1,Dt[pt+2]=at,Dt[pt+3]=at+3,Dt[pt+4]=at+1,Dt[pt+5]=at+2,Dt[pt+6]=at+2,Dt[pt+7]=at+3,pt+=8,at+=4;It.bindBuffer(It.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer),It.bufferData(It.ELEMENT_ARRAY_BUFFER,At,i),It.bindBuffer(It.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer),It.bufferData(It.ELEMENT_ARRAY_BUFFER,Dt,i)}if(Ct)for(j=0,W=Ct.length;W>j;j++)if(tt=Ct[j],tt.__original.needsUpdate){if(vt=0,Et=0,1===tt.size){if(void 0===tt.boundTo||"vertices"===tt.boundTo){for(o=0,a=Bt.length;a>o;o++)l=Wt[Bt[o]],tt.array[vt]=tt.value[l.a],tt.array[vt+1]=tt.value[l.b],tt.array[vt+2]=tt.value[l.c],vt+=3;for(o=0,a=jt.length;a>o;o++)l=Wt[jt[o]],tt.array[vt]=tt.value[l.a],tt.array[vt+1]=tt.value[l.b],tt.array[vt+2]=tt.value[l.c],tt.array[vt+3]=tt.value[l.d],vt+=4}else if("faces"===tt.boundTo){for(o=0,a=Bt.length;a>o;o++)et=tt.value[Bt[o]],tt.array[vt]=et,tt.array[vt+1]=et,tt.array[vt+2]=et,vt+=3;for(o=0,a=jt.length;a>o;o++)et=tt.value[jt[o]],tt.array[vt]=et,tt.array[vt+1]=et,tt.array[vt+2]=et,tt.array[vt+3]=et,vt+=4}}else if(2===tt.size){if(void 0===tt.boundTo||"vertices"===tt.boundTo){for(o=0,a=Bt.length;a>o;o++)l=Wt[Bt[o]],y=tt.value[l.a],T=tt.value[l.b],_=tt.value[l.c],tt.array[vt]=y.x,tt.array[vt+1]=y.y,tt.array[vt+2]=T.x,tt.array[vt+3]=T.y,tt.array[vt+4]=_.x,tt.array[vt+5]=_.y,vt+=6;for(o=0,a=jt.length;a>o;o++)l=Wt[jt[o]],y=tt.value[l.a],T=tt.value[l.b],_=tt.value[l.c],b=tt.value[l.d],tt.array[vt]=y.x,tt.array[vt+1]=y.y,tt.array[vt+2]=T.x,tt.array[vt+3]=T.y,tt.array[vt+4]=_.x,tt.array[vt+5]=_.y,tt.array[vt+6]=b.x,tt.array[vt+7]=b.y,vt+=8}else if("faces"===tt.boundTo){for(o=0,a=Bt.length;a>o;o++)et=tt.value[Bt[o]],y=et,T=et,_=et,tt.array[vt]=y.x,tt.array[vt+1]=y.y,tt.array[vt+2]=T.x,tt.array[vt+3]=T.y,tt.array[vt+4]=_.x,tt.array[vt+5]=_.y,vt+=6;for(o=0,a=jt.length;a>o;o++)et=tt.value[jt[o]],y=et,T=et,_=et,b=et,tt.array[vt]=y.x,tt.array[vt+1]=y.y,tt.array[vt+2]=T.x,tt.array[vt+3]=T.y,tt.array[vt+4]=_.x,tt.array[vt+5]=_.y,tt.array[vt+6]=b.x,tt.array[vt+7]=b.y,vt+=8}}else if(3===tt.size){var $t;if($t="c"===tt.type?["r","g","b"]:["x","y","z"],void 0===tt.boundTo||"vertices"===tt.boundTo){for(o=0,a=Bt.length;a>o;o++)l=Wt[Bt[o]],y=tt.value[l.a],T=tt.value[l.b],_=tt.value[l.c],tt.array[vt]=y[$t[0]],tt.array[vt+1]=y[$t[1]],tt.array[vt+2]=y[$t[2]],tt.array[vt+3]=T[$t[0]],tt.array[vt+4]=T[$t[1]],tt.array[vt+5]=T[$t[2]],tt.array[vt+6]=_[$t[0]],tt.array[vt+7]=_[$t[1]],tt.array[vt+8]=_[$t[2]],vt+=9;for(o=0,a=jt.length;a>o;o++)l=Wt[jt[o]],y=tt.value[l.a],T=tt.value[l.b],_=tt.value[l.c],b=tt.value[l.d],tt.array[vt]=y[$t[0]],tt.array[vt+1]=y[$t[1]],tt.array[vt+2]=y[$t[2]],tt.array[vt+3]=T[$t[0]],tt.array[vt+4]=T[$t[1]],tt.array[vt+5]=T[$t[2]],tt.array[vt+6]=_[$t[0]],tt.array[vt+7]=_[$t[1]],tt.array[vt+8]=_[$t[2]],tt.array[vt+9]=b[$t[0]],tt.array[vt+10]=b[$t[1]],tt.array[vt+11]=b[$t[2]],vt+=12}else if("faces"===tt.boundTo){for(o=0,a=Bt.length;a>o;o++)et=tt.value[Bt[o]],y=et,T=et,_=et,tt.array[vt]=y[$t[0]],tt.array[vt+1]=y[$t[1]],tt.array[vt+2]=y[$t[2]],tt.array[vt+3]=T[$t[0]],tt.array[vt+4]=T[$t[1]],tt.array[vt+5]=T[$t[2]],tt.array[vt+6]=_[$t[0]],tt.array[vt+7]=_[$t[1]],tt.array[vt+8]=_[$t[2]],vt+=9;for(o=0,a=jt.length;a>o;o++)et=tt.value[jt[o]],y=et,T=et,_=et,b=et,tt.array[vt]=y[$t[0]],tt.array[vt+1]=y[$t[1]],tt.array[vt+2]=y[$t[2]],tt.array[vt+3]=T[$t[0]],tt.array[vt+4]=T[$t[1]],tt.array[vt+5]=T[$t[2]],tt.array[vt+6]=_[$t[0]],tt.array[vt+7]=_[$t[1]],tt.array[vt+8]=_[$t[2]],tt.array[vt+9]=b[$t[0]],tt.array[vt+10]=b[$t[1]],tt.array[vt+11]=b[$t[2]],vt+=12}else if("faceVertices"===tt.boundTo){for(o=0,a=Bt.length;a>o;o++)et=tt.value[Bt[o]],y=et[0],T=et[1],_=et[2],tt.array[vt]=y[$t[0]],tt.array[vt+1]=y[$t[1]],tt.array[vt+2]=y[$t[2]],tt.array[vt+3]=T[$t[0]],tt.array[vt+4]=T[$t[1]],tt.array[vt+5]=T[$t[2]],tt.array[vt+6]=_[$t[0]],tt.array[vt+7]=_[$t[1]],tt.array[vt+8]=_[$t[2]],vt+=9;for(o=0,a=jt.length;a>o;o++)et=tt.value[jt[o]],y=et[0],T=et[1],_=et[2],b=et[3],tt.array[vt]=y[$t[0]],tt.array[vt+1]=y[$t[1]],tt.array[vt+2]=y[$t[2]],tt.array[vt+3]=T[$t[0]],tt.array[vt+4]=T[$t[1]],tt.array[vt+5]=T[$t[2]],tt.array[vt+6]=_[$t[0]],tt.array[vt+7]=_[$t[1]],tt.array[vt+8]=_[$t[2]],tt.array[vt+9]=b[$t[0]],tt.array[vt+10]=b[$t[1]],tt.array[vt+11]=b[$t[2]],vt+=12}}else if(4===tt.size)if(void 0===tt.boundTo||"vertices"===tt.boundTo){for(o=0,a=Bt.length;a>o;o++)l=Wt[Bt[o]],y=tt.value[l.a],T=tt.value[l.b],_=tt.value[l.c],tt.array[vt]=y.x,tt.array[vt+1]=y.y,tt.array[vt+2]=y.z,tt.array[vt+3]=y.w,tt.array[vt+4]=T.x,tt.array[vt+5]=T.y,tt.array[vt+6]=T.z,tt.array[vt+7]=T.w,tt.array[vt+8]=_.x,tt.array[vt+9]=_.y,tt.array[vt+10]=_.z,tt.array[vt+11]=_.w,vt+=12;for(o=0,a=jt.length;a>o;o++)l=Wt[jt[o]],y=tt.value[l.a],T=tt.value[l.b],_=tt.value[l.c],b=tt.value[l.d],tt.array[vt]=y.x,tt.array[vt+1]=y.y,tt.array[vt+2]=y.z,tt.array[vt+3]=y.w,tt.array[vt+4]=T.x,tt.array[vt+5]=T.y,tt.array[vt+6]=T.z,tt.array[vt+7]=T.w,tt.array[vt+8]=_.x,tt.array[vt+9]=_.y,tt.array[vt+10]=_.z,tt.array[vt+11]=_.w,tt.array[vt+12]=b.x,tt.array[vt+13]=b.y,tt.array[vt+14]=b.z,tt.array[vt+15]=b.w,vt+=16}else if("faces"===tt.boundTo){for(o=0,a=Bt.length;a>o;o++)et=tt.value[Bt[o]],y=et,T=et,_=et,tt.array[vt]=y.x,tt.array[vt+1]=y.y,tt.array[vt+2]=y.z,tt.array[vt+3]=y.w,tt.array[vt+4]=T.x,tt.array[vt+5]=T.y,tt.array[vt+6]=T.z,tt.array[vt+7]=T.w,tt.array[vt+8]=_.x,tt.array[vt+9]=_.y,tt.array[vt+10]=_.z,tt.array[vt+11]=_.w,vt+=12;for(o=0,a=jt.length;a>o;o++)et=tt.value[jt[o]],y=et,T=et,_=et,b=et,tt.array[vt]=y.x,tt.array[vt+1]=y.y,tt.array[vt+2]=y.z,tt.array[vt+3]=y.w,tt.array[vt+4]=T.x,tt.array[vt+5]=T.y,tt.array[vt+6]=T.z,tt.array[vt+7]=T.w,tt.array[vt+8]=_.x,tt.array[vt+9]=_.y,tt.array[vt+10]=_.z,tt.array[vt+11]=_.w,tt.array[vt+12]=b.x,tt.array[vt+13]=b.y,tt.array[vt+14]=b.z,tt.array[vt+15]=b.w,vt+=16}else if("faceVertices"===tt.boundTo){for(o=0,a=Bt.length;a>o;o++)et=tt.value[Bt[o]],y=et[0],T=et[1],_=et[2],tt.array[vt]=y.x,tt.array[vt+1]=y.y,tt.array[vt+2]=y.z,tt.array[vt+3]=y.w,tt.array[vt+4]=T.x,tt.array[vt+5]=T.y,tt.array[vt+6]=T.z,tt.array[vt+7]=T.w,tt.array[vt+8]=_.x,tt.array[vt+9]=_.y,tt.array[vt+10]=_.z,tt.array[vt+11]=_.w,vt+=12;for(o=0,a=jt.length;a>o;o++)et=tt.value[jt[o]],y=et[0],T=et[1],_=et[2],b=et[3],tt.array[vt]=y.x,tt.array[vt+1]=y.y,tt.array[vt+2]=y.z,tt.array[vt+3]=y.w,tt.array[vt+4]=T.x,tt.array[vt+5]=T.y,tt.array[vt+6]=T.z,tt.array[vt+7]=T.w,tt.array[vt+8]=_.x,tt.array[vt+9]=_.y,tt.array[vt+10]=_.z,tt.array[vt+11]=_.w,tt.array[vt+12]=b.x,tt.array[vt+13]=b.y,tt.array[vt+14]=b.z,tt.array[vt+15]=b.w,vt+=16}It.bindBuffer(It.ARRAY_BUFFER,tt.buffer),It.bufferData(It.ARRAY_BUFFER,tt.array,i)}r&&(delete e.__inittedArrays,delete e.__colorArray,delete e.__normalArray,delete e.__tangentArray,delete e.__uvArray,delete e.__uv2Array,delete e.__faceArray,delete e.__vertexArray,delete e.__lineArray,delete e.__skinIndexArray,delete e.__skinWeightArray)}}function _(e,t,i){var r,n,o=e.attributes;for(r in o)n=o[r],n.needsUpdate&&("index"===r?(It.bindBuffer(It.ELEMENT_ARRAY_BUFFER,n.buffer),It.bufferData(It.ELEMENT_ARRAY_BUFFER,n.array,t)):(It.bindBuffer(It.ARRAY_BUFFER,n.buffer),It.bufferData(It.ARRAY_BUFFER,n.array,t)),n.needsUpdate=!1),i&&!n.dynamic&&(n.array=null)}function b(e){Ei[e]||(It.enableVertexAttribArray(e),Ei[e]=!0)}function x(){for(var e in Ei)Ei[e]&&(It.disableVertexAttribArray(e),Ei[e]=!1)}function R(e,t,i){var r=e.program.attributes;if(-1!==i.morphTargetBase&&r.position>=0?(It.bindBuffer(It.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[i.morphTargetBase]),b(r.position),It.vertexAttribPointer(r.position,3,It.FLOAT,!1,0,0)):r.position>=0&&(It.bindBuffer(It.ARRAY_BUFFER,t.__webglVertexBuffer),b(r.position),It.vertexAttribPointer(r.position,3,It.FLOAT,!1,0,0)),i.morphTargetForcedOrder.length)for(var n=0,o=i.morphTargetForcedOrder,a=i.morphTargetInfluences;n<e.numSupportedMorphTargets&&n<o.length;)r["morphTarget"+n]>=0&&(It.bindBuffer(It.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[o[n]]),b(r["morphTarget"+n]),It.vertexAttribPointer(r["morphTarget"+n],3,It.FLOAT,!1,0,0)),r["morphNormal"+n]>=0&&e.morphNormals&&(It.bindBuffer(It.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[o[n]]),b(r["morphNormal"+n]),It.vertexAttribPointer(r["morphNormal"+n],3,It.FLOAT,!1,0,0)),i.__webglMorphTargetInfluences[n]=a[o[n]],n++;else{var s,l,h=[],a=i.morphTargetInfluences,c=a.length;for(l=0;c>l;l++)s=a[l],s>0&&h.push([s,l]);h.length>e.numSupportedMorphTargets?(h.sort(H),h.length=e.numSupportedMorphTargets):h.length>e.numSupportedMorphNormals?h.sort(H):0===h.length&&h.push([0,0]);for(var u,n=0;n<e.numSupportedMorphTargets;)h[n]?(u=h[n][1],r["morphTarget"+n]>=0&&(It.bindBuffer(It.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[u]),b(r["morphTarget"+n]),It.vertexAttribPointer(r["morphTarget"+n],3,It.FLOAT,!1,0,0)),r["morphNormal"+n]>=0&&e.morphNormals&&(It.bindBuffer(It.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[u]),b(r["morphNormal"+n]),It.vertexAttribPointer(r["morphNormal"+n],3,It.FLOAT,!1,0,0)),i.__webglMorphTargetInfluences[n]=a[u]):i.__webglMorphTargetInfluences[n]=0,n++}null!==e.program.uniforms.morphTargetInfluences&&It.uniform1fv(e.program.uniforms.morphTargetInfluences,i.__webglMorphTargetInfluences)}function w(e,t){return e.z!==t.z?t.z-e.z:e.id-t.id}function H(e,t){return t[0]-e[0]}function M(e,t,i){if(e.length)for(var r=0,n=e.length;n>r;r++)Yt=null,$t=null,ii=-1,ai=-1,si=-1,ei=-1,ti=-1,Qt=-1,Kt=-1,Ri=!0,e[r].render(t,i,gi,vi),Yt=null,$t=null,ii=-1,ai=-1,si=-1,ei=-1,ti=-1,Qt=-1,Kt=-1,Ri=!0}function S(e,t,i,r,n,o,a,s){var l,h,c,u,d,p,f;t?(d=e.length-1,p=-1,f=-1):(d=0,p=e.length,f=1);for(var m=d;m!==p;m+=f)if(l=e[m],l.render){if(h=l.object,c=l.buffer,s)u=s;else{if(u=l[i],!u)continue;a&&Wt.setBlending(u.blending,u.blendEquation,u.blendSrc,u.blendDst),Wt.setDepthTest(u.depthTest),Wt.setDepthWrite(u.depthWrite),st(u.polygonOffset,u.polygonOffsetFactor,u.polygonOffsetUnits)}Wt.setMaterialFaces(u),c instanceof THREE.BufferGeometry?Wt.renderBufferDirect(r,n,o,u,c,h):Wt.renderBuffer(r,n,o,u,c,h)}}function C(e,t,i,r,n,o,a){for(var s,l,h,c=0,u=e.length;u>c;c++)if(s=e[c],l=s.object,l.visible){if(a)h=a;else{if(h=s[t],!h)continue;o&&Wt.setBlending(h.blending,h.blendEquation,h.blendSrc,h.blendDst),Wt.setDepthTest(h.depthTest),Wt.setDepthWrite(h.depthWrite),st(h.polygonOffset,h.polygonOffsetFactor,h.polygonOffsetUnits)}Wt.renderImmediateObject(i,r,n,h,l)}}function A(e){var t=e.object,i=t.material;i.transparent?(e.transparent=i,e.opaque=null):(e.opaque=i,e.transparent=null)}function D(e){var t,i,r,n=e.object,o=e.buffer;r=n.material,r instanceof THREE.MeshFaceMaterial?(i=o.materialIndex,t=r.materials[i],t.transparent?(e.transparent=t,e.opaque=null):(e.opaque=t,e.transparent=null)):(t=r,t&&(t.transparent?(e.transparent=t,e.opaque=null):(e.opaque=t,e.transparent=null)))}function P(e,t){var i,r,n,o,a,s,l={},h=e.morphTargets.length,c=e.morphNormals.length,u=t instanceof THREE.MeshFaceMaterial;for(e.geometryGroups={},i=0,r=e.faces.length;r>i;i++)n=e.faces[i],o=u?n.materialIndex:0,void 0===l[o]&&(l[o]={hash:o,counter:0}),s=l[o].hash+"_"+l[o].counter,void 0===e.geometryGroups[s]&&(e.geometryGroups[s]={faces3:[],faces4:[],materialIndex:o,vertices:0,numMorphTargets:h,numMorphNormals:c}),a=n instanceof THREE.Face3?3:4,e.geometryGroups[s].vertices+a>65535&&(l[o].counter+=1,s=l[o].hash+"_"+l[o].counter,void 0===e.geometryGroups[s]&&(e.geometryGroups[s]={faces3:[],faces4:[],materialIndex:o,vertices:0,numMorphTargets:h,numMorphNormals:c})),n instanceof THREE.Face3?e.geometryGroups[s].faces3.push(i):e.geometryGroups[s].faces4.push(i),e.geometryGroups[s].vertices+=a;e.geometryGroupsList=[];for(var d in e.geometryGroups)e.geometryGroups[d].id=Zt++,e.geometryGroupsList.push(e.geometryGroups[d])}function L(e,o){var a,u,d,p;if(void 0===e.__webglInit)if(e.__webglInit=!0,e._modelViewMatrix=new THREE.Matrix4,e._normalMatrix=new THREE.Matrix3,void 0!==e.geometry&&void 0===e.geometry.__webglInit&&(e.geometry.__webglInit=!0,e.geometry.addEventListener("dispose",Ii)),u=e.geometry,void 0===u);else if(u instanceof THREE.BufferGeometry)g(u);else if(e instanceof THREE.Mesh){d=e.material,void 0===u.geometryGroups&&P(u,d);for(a in u.geometryGroups)p=u.geometryGroups[a],p.__webglVertexBuffer||(n(p),c(p,e),u.verticesNeedUpdate=!0,u.morphTargetsNeedUpdate=!0,u.elementsNeedUpdate=!0,u.uvsNeedUpdate=!0,u.normalsNeedUpdate=!0,u.tangentsNeedUpdate=!0,u.colorsNeedUpdate=!0)}else e instanceof THREE.Ribbon?u.__webglVertexBuffer||(r(u),h(u,e),u.verticesNeedUpdate=!0,u.colorsNeedUpdate=!0,u.normalsNeedUpdate=!0):e instanceof THREE.Line?u.__webglVertexBuffer||(i(u),l(u,e),u.verticesNeedUpdate=!0,u.colorsNeedUpdate=!0,u.lineDistancesNeedUpdate=!0):e instanceof THREE.ParticleSystem&&(u.__webglVertexBuffer||(t(u),s(u,e),u.verticesNeedUpdate=!0,u.colorsNeedUpdate=!0));if(void 0===e.__webglActive){if(e instanceof THREE.Mesh){if(u=e.geometry,u instanceof THREE.BufferGeometry)k(o.__webglObjects,u,e);else if(u instanceof THREE.Geometry)for(a in u.geometryGroups)p=u.geometryGroups[a],k(o.__webglObjects,p,e)}else e instanceof THREE.Ribbon||e instanceof THREE.Line||e instanceof THREE.ParticleSystem?(u=e.geometry,k(o.__webglObjects,u,e)):e instanceof THREE.ImmediateRenderObject||e.immediateRenderCallback?F(o.__webglObjectsImmediate,e):e instanceof THREE.Sprite?o.__webglSprites.push(e):e instanceof THREE.LensFlare&&o.__webglFlares.push(e);e.__webglActive=!0}}function k(e,t,i){e.push({id:null,buffer:t,object:i,opaque:null,transparent:null,z:0})}function F(e,t){e.push({id:null,object:t,opaque:null,transparent:null,z:0})}function z(e){var t,i,r,n=e.geometry;if(n instanceof THREE.BufferGeometry)_(n,It.DYNAMIC_DRAW,!n.dynamic);else if(e instanceof THREE.Mesh){for(var o=0,a=n.geometryGroupsList.length;a>o;o++)t=n.geometryGroupsList[o],r=u(e,t),n.buffersNeedUpdate&&c(t,e),i=r.attributes&&N(r),(n.verticesNeedUpdate||n.morphTargetsNeedUpdate||n.elementsNeedUpdate||n.uvsNeedUpdate||n.normalsNeedUpdate||n.colorsNeedUpdate||n.tangentsNeedUpdate||i)&&T(t,e,It.DYNAMIC_DRAW,!n.dynamic,r);n.verticesNeedUpdate=!1,n.morphTargetsNeedUpdate=!1,n.elementsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.tangentsNeedUpdate=!1,n.buffersNeedUpdate=!1,r.attributes&&I(r)}else e instanceof THREE.Ribbon?(r=u(e,n),i=r.attributes&&N(r),(n.verticesNeedUpdate||n.colorsNeedUpdate||n.normalsNeedUpdate||i)&&y(n,It.DYNAMIC_DRAW),n.verticesNeedUpdate=!1,n.colorsNeedUpdate=!1,n.normalsNeedUpdate=!1,r.attributes&&I(r)):e instanceof THREE.Line?(r=u(e,n),i=r.attributes&&N(r),(n.verticesNeedUpdate||n.colorsNeedUpdate||n.lineDistancesNeedUpdate||i)&&E(n,It.DYNAMIC_DRAW),n.verticesNeedUpdate=!1,n.colorsNeedUpdate=!1,n.lineDistancesNeedUpdate=!1,r.attributes&&I(r)):e instanceof THREE.ParticleSystem&&(r=u(e,n),i=r.attributes&&N(r),(n.verticesNeedUpdate||n.colorsNeedUpdate||e.sortParticles||i)&&v(n,It.DYNAMIC_DRAW,e),n.verticesNeedUpdate=!1,n.colorsNeedUpdate=!1,r.attributes&&I(r))}function N(e){for(var t in e.attributes)if(e.attributes[t].needsUpdate)return!0;return!1}function I(e){for(var t in e.attributes)e.attributes[t].needsUpdate=!1}function O(e,t){e instanceof THREE.Mesh||e instanceof THREE.ParticleSystem||e instanceof THREE.Ribbon||e instanceof THREE.Line?U(t.__webglObjects,e):e instanceof THREE.Sprite?V(t.__webglSprites,e):e instanceof THREE.LensFlare?V(t.__webglFlares,e):(e instanceof THREE.ImmediateRenderObject||e.immediateRenderCallback)&&U(t.__webglObjectsImmediate,e),delete e.__webglActive}function U(e,t){for(var i=e.length-1;i>=0;i--)e[i].object===t&&e.splice(i,1)}function V(e,t){for(var i=e.length-1;i>=0;i--)e[i]===t&&e.splice(i,1)}function B(e,t){e.uniforms=THREE.UniformsUtils.clone(t.uniforms),e.vertexShader=t.vertexShader,e.fragmentShader=t.fragmentShader}function j(e,t,i,r,n){Jt=0,r.needsUpdate&&(r.program&&Gi(r),Wt.initMaterial(r,t,i,n),r.needsUpdate=!1),r.morphTargets&&(n.__webglMorphTargetInfluences||(n.__webglMorphTargetInfluences=new Float32Array(Wt.maxMorphTargets)));var o=!1,a=r.program,s=a.uniforms,l=r.uniforms;if(a!==Yt&&(It.useProgram(a),Yt=a,o=!0),r.id!==Kt&&(Kt=r.id,o=!0),(o||e!==$t)&&(It.uniformMatrix4fv(s.projectionMatrix,!1,e.projectionMatrix.elements),e!==$t&&($t=e)),r.skinning)if(Di&&n.useVertexTexture){if(null!==s.boneTexture){var h=et();It.uniform1i(s.boneTexture,h),Wt.setTexture(n.boneTexture,h)}}else null!==s.boneGlobalMatrices&&It.uniformMatrix4fv(s.boneGlobalMatrices,!1,n.boneMatrices);return o&&(i&&r.fog&&q(l,i),(r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshLambertMaterial||r.lights)&&(Ri&&(ot(a,t),Ri=!1),$(l,wi)),(r instanceof THREE.MeshBasicMaterial||r instanceof THREE.MeshLambertMaterial||r instanceof THREE.MeshPhongMaterial)&&W(l,r),r instanceof THREE.LineBasicMaterial?G(l,r):r instanceof THREE.LineDashedMaterial?(G(l,r),X(l,r)):r instanceof THREE.ParticleBasicMaterial?Y(l,r):r instanceof THREE.MeshPhongMaterial?K(l,r):r instanceof THREE.MeshLambertMaterial?Q(l,r):r instanceof THREE.MeshDepthMaterial?(l.mNear.value=e.near,l.mFar.value=e.far,l.opacity.value=r.opacity):r instanceof THREE.MeshNormalMaterial&&(l.opacity.value=r.opacity),n.receiveShadow&&!r._shadowPass&&Z(l,t),tt(a,r.uniformsList),(r instanceof THREE.ShaderMaterial||r instanceof THREE.MeshPhongMaterial||r.envMap)&&null!==s.cameraPosition&&(bi.getPositionFromMatrix(e.matrixWorld),It.uniform3f(s.cameraPosition,bi.x,bi.y,bi.z)),(r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshLambertMaterial||r instanceof THREE.ShaderMaterial||r.skinning)&&null!==s.viewMatrix&&It.uniformMatrix4fv(s.viewMatrix,!1,e.matrixWorldInverse.elements)),J(s,n),null!==s.modelMatrix&&It.uniformMatrix4fv(s.modelMatrix,!1,n.matrixWorld.elements),a}function W(e,t){e.opacity.value=t.opacity,Wt.gammaInput?e.diffuse.value.copyGammaToLinear(t.color):e.diffuse.value=t.color,e.map.value=t.map,e.lightMap.value=t.lightMap,e.specularMap.value=t.specularMap,t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale));var i;if(t.map?i=t.map:t.specularMap?i=t.specularMap:t.normalMap?i=t.normalMap:t.bumpMap&&(i=t.bumpMap),void 0!==i){var r=i.offset,n=i.repeat;e.offsetRepeat.value.set(r.x,r.y,n.x,n.y)}e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,e.reflectivity.value=Wt.gammaInput?t.reflectivity:t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.combine.value=t.combine,e.useRefract.value=t.envMap&&t.envMap.mapping instanceof THREE.CubeRefractionMapping}function G(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}function X(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}function Y(e,t){e.psColor.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size,e.scale.value=Ct.height/2,e.map.value=t.map}function q(e,t){e.fogColor.value=t.color,t instanceof THREE.Fog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t instanceof THREE.FogExp2&&(e.fogDensity.value=t.density)}function K(e,t){e.shininess.value=t.shininess,Wt.gammaInput?(e.ambient.value.copyGammaToLinear(t.ambient),e.emissive.value.copyGammaToLinear(t.emissive),e.specular.value.copyGammaToLinear(t.specular)):(e.ambient.value=t.ambient,e.emissive.value=t.emissive,e.specular.value=t.specular),t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}function Q(e,t){Wt.gammaInput?(e.ambient.value.copyGammaToLinear(t.ambient),e.emissive.value.copyGammaToLinear(t.emissive)):(e.ambient.value=t.ambient,e.emissive.value=t.emissive),t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}function $(e,t){e.ambientLightColor.value=t.ambient,e.directionalLightColor.value=t.directional.colors,e.directionalLightDirection.value=t.directional.positions,e.pointLightColor.value=t.point.colors,e.pointLightPosition.value=t.point.positions,e.pointLightDistance.value=t.point.distances,e.spotLightColor.value=t.spot.colors,e.spotLightPosition.value=t.spot.positions,e.spotLightDistance.value=t.spot.distances,e.spotLightDirection.value=t.spot.directions,e.spotLightAngleCos.value=t.spot.anglesCos,e.spotLightExponent.value=t.spot.exponents,e.hemisphereLightSkyColor.value=t.hemi.skyColors,e.hemisphereLightGroundColor.value=t.hemi.groundColors,e.hemisphereLightDirection.value=t.hemi.positions}function Z(e,t){if(e.shadowMatrix)for(var i=0,r=0,n=t.length;n>r;r++){var o=t[r];o.castShadow&&(o instanceof THREE.SpotLight||o instanceof THREE.DirectionalLight&&!o.shadowCascade)&&(e.shadowMap.value[i]=o.shadowMap,e.shadowMapSize.value[i]=o.shadowMapSize,e.shadowMatrix.value[i]=o.shadowMatrix,e.shadowDarkness.value[i]=o.shadowDarkness,e.shadowBias.value[i]=o.shadowBias,i++)}}function J(e,t){It.uniformMatrix4fv(e.modelViewMatrix,!1,t._modelViewMatrix.elements),e.normalMatrix&&It.uniformMatrix3fv(e.normalMatrix,!1,t._normalMatrix.elements)
}function et(){var e=Jt;return e>=Hi&&console.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+Hi),Jt+=1,e}function tt(e,t){var i,r,n,o,a,s,l,h,c,u,d;for(c=0,u=t.length;u>c;c++)if(o=e.uniforms[t[c][1]])if(i=t[c][0],n=i.type,r=i.value,"i"===n)It.uniform1i(o,r);else if("f"===n)It.uniform1f(o,r);else if("v2"===n)It.uniform2f(o,r.x,r.y);else if("v3"===n)It.uniform3f(o,r.x,r.y,r.z);else if("v4"===n)It.uniform4f(o,r.x,r.y,r.z,r.w);else if("c"===n)It.uniform3f(o,r.r,r.g,r.b);else if("iv1"===n)It.uniform1iv(o,r);else if("iv"===n)It.uniform3iv(o,r);else if("fv1"===n)It.uniform1fv(o,r);else if("fv"===n)It.uniform3fv(o,r);else if("v2v"===n){for(void 0===i._array&&(i._array=new Float32Array(2*r.length)),l=0,h=r.length;h>l;l++)d=2*l,i._array[d]=r[l].x,i._array[d+1]=r[l].y;It.uniform2fv(o,i._array)}else if("v3v"===n){for(void 0===i._array&&(i._array=new Float32Array(3*r.length)),l=0,h=r.length;h>l;l++)d=3*l,i._array[d]=r[l].x,i._array[d+1]=r[l].y,i._array[d+2]=r[l].z;It.uniform3fv(o,i._array)}else if("v4v"===n){for(void 0===i._array&&(i._array=new Float32Array(4*r.length)),l=0,h=r.length;h>l;l++)d=4*l,i._array[d]=r[l].x,i._array[d+1]=r[l].y,i._array[d+2]=r[l].z,i._array[d+3]=r[l].w;It.uniform4fv(o,i._array)}else if("m4"===n)void 0===i._array&&(i._array=new Float32Array(16)),r.flattenToArray(i._array),It.uniformMatrix4fv(o,!1,i._array);else if("m4v"===n){for(void 0===i._array&&(i._array=new Float32Array(16*r.length)),l=0,h=r.length;h>l;l++)r[l].flattenToArrayOffset(i._array,16*l);It.uniformMatrix4fv(o,!1,i._array)}else if("t"===n){if(a=r,s=et(),It.uniform1i(o,s),!a)continue;a.image instanceof Array&&6===a.image.length?vt(a,s):a instanceof THREE.WebGLRenderTargetCube?Et(a,s):Wt.setTexture(a,s)}else if("tv"===n){for(void 0===i._array&&(i._array=[]),l=0,h=i.value.length;h>l;l++)i._array[l]=et();for(It.uniform1iv(o,i._array),l=0,h=i.value.length;h>l;l++)a=i.value[l],s=i._array[l],a&&Wt.setTexture(a,s)}else console.warn("THREE.WebGLRenderer: Unknown uniform type: "+n)}function it(e,t){e._modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld),e._normalMatrix.getNormalMatrix(e._modelViewMatrix)}function rt(e,t,i,r){e[t]=i.r*i.r*r,e[t+1]=i.g*i.g*r,e[t+2]=i.b*i.b*r}function nt(e,t,i,r){e[t]=i.r*r,e[t+1]=i.g*r,e[t+2]=i.b*r}function ot(e,t){var i,r,n,o,a,s,l,h,c,u=0,d=0,p=0,f=wi,m=f.directional.colors,g=f.directional.positions,v=f.point.colors,E=f.point.positions,y=f.point.distances,T=f.spot.colors,_=f.spot.positions,b=f.spot.distances,x=f.spot.directions,R=f.spot.anglesCos,w=f.spot.exponents,H=f.hemi.skyColors,M=f.hemi.groundColors,S=f.hemi.positions,C=0,A=0,D=0,P=0,L=0,k=0,F=0,z=0,N=0,I=0,O=0,U=0;for(i=0,r=t.length;r>i;i++)if(n=t[i],!n.onlyShadow)if(o=n.color,l=n.intensity,c=n.distance,n instanceof THREE.AmbientLight){if(!n.visible)continue;Wt.gammaInput?(u+=o.r*o.r,d+=o.g*o.g,p+=o.b*o.b):(u+=o.r,d+=o.g,p+=o.b)}else if(n instanceof THREE.DirectionalLight){if(L+=1,!n.visible)continue;if(xi.getPositionFromMatrix(n.matrixWorld),bi.getPositionFromMatrix(n.target.matrixWorld),xi.sub(bi),xi.normalize(),0===xi.x&&0===xi.y&&0===xi.z)continue;N=3*C,g[N]=xi.x,g[N+1]=xi.y,g[N+2]=xi.z,Wt.gammaInput?rt(m,N,o,l*l):nt(m,N,o,l),C+=1}else if(n instanceof THREE.PointLight){if(k+=1,!n.visible)continue;I=3*A,Wt.gammaInput?rt(v,I,o,l*l):nt(v,I,o,l),bi.getPositionFromMatrix(n.matrixWorld),E[I]=bi.x,E[I+1]=bi.y,E[I+2]=bi.z,y[A]=c,A+=1}else if(n instanceof THREE.SpotLight){if(F+=1,!n.visible)continue;O=3*D,Wt.gammaInput?rt(T,O,o,l*l):nt(T,O,o,l),bi.getPositionFromMatrix(n.matrixWorld),_[O]=bi.x,_[O+1]=bi.y,_[O+2]=bi.z,b[D]=c,xi.copy(bi),bi.getPositionFromMatrix(n.target.matrixWorld),xi.sub(bi),xi.normalize(),x[O]=xi.x,x[O+1]=xi.y,x[O+2]=xi.z,R[D]=Math.cos(n.angle),w[D]=n.exponent,D+=1}else if(n instanceof THREE.HemisphereLight){if(z+=1,!n.visible)continue;if(xi.getPositionFromMatrix(n.matrixWorld),xi.normalize(),0===xi.x&&0===xi.y&&0===xi.z)continue;U=3*P,S[U]=xi.x,S[U+1]=xi.y,S[U+2]=xi.z,a=n.color,s=n.groundColor,Wt.gammaInput?(h=l*l,rt(H,U,a,h),rt(M,U,s,h)):(nt(H,U,a,l),nt(M,U,s,l)),P+=1}for(i=3*C,r=Math.max(m.length,3*L);r>i;i++)m[i]=0;for(i=3*A,r=Math.max(v.length,3*k);r>i;i++)v[i]=0;for(i=3*D,r=Math.max(T.length,3*F);r>i;i++)T[i]=0;for(i=3*P,r=Math.max(H.length,3*z);r>i;i++)H[i]=0;for(i=3*P,r=Math.max(M.length,3*z);r>i;i++)M[i]=0;f.directional.length=C,f.point.length=A,f.spot.length=D,f.hemi.length=P,f.ambient[0]=u,f.ambient[1]=d,f.ambient[2]=p}function at(e){e!==ui&&(It.lineWidth(e),ui=e)}function st(e,t,i){li!==e&&(e?It.enable(It.POLYGON_OFFSET_FILL):It.disable(It.POLYGON_OFFSET_FILL),li=e),!e||hi===t&&ci===i||(It.polygonOffset(t,i),hi=t,ci=i)}function lt(e){var t,i,r=[];for(var n in e)t=e[n],t!==!1&&(i="#define "+n+" "+t,r.push(i));return r.join("\n")}function ht(e,t,i,r,n,o,a){var s,l,h,c,u,d=[];e?d.push(e):(d.push(t),d.push(i));for(h in o)d.push(h),d.push(o[h]);for(s in a)d.push(s),d.push(a[s]);for(u=d.join(),s=0,l=Gt.length;l>s;s++){var p=Gt[s];if(p.code===u)return p.usedTimes++,p.program}var f="SHADOWMAP_TYPE_BASIC";a.shadowMapType===THREE.PCFShadowMap?f="SHADOWMAP_TYPE_PCF":a.shadowMapType===THREE.PCFSoftShadowMap&&(f="SHADOWMAP_TYPE_PCF_SOFT");var m=lt(o);c=It.createProgram();var g=["precision "+At+" float;",m,Ai?"#define VERTEX_TEXTURES":"",Wt.gammaInput?"#define GAMMA_INPUT":"",Wt.gammaOutput?"#define GAMMA_OUTPUT":"",Wt.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+a.maxDirLights,"#define MAX_POINT_LIGHTS "+a.maxPointLights,"#define MAX_SPOT_LIGHTS "+a.maxSpotLights,"#define MAX_HEMI_LIGHTS "+a.maxHemiLights,"#define MAX_SHADOWS "+a.maxShadows,"#define MAX_BONES "+a.maxBones,a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.lightMap?"#define USE_LIGHTMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.vertexColors?"#define USE_COLOR":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.boneTextureWidth?"#define N_BONE_PIXEL_X "+a.boneTextureWidth.toFixed(1):"",a.boneTextureHeight?"#define N_BONE_PIXEL_Y "+a.boneTextureHeight.toFixed(1):"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals?"#define USE_MORPHNORMALS":"",a.perPixel?"#define PHONG_PER_PIXEL":"",a.wrapAround?"#define WRAP_AROUND":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+f:"",a.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",a.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","attribute vec3 morphTarget0;","attribute vec3 morphTarget1;","attribute vec3 morphTarget2;","attribute vec3 morphTarget3;","#ifdef USE_MORPHNORMALS","attribute vec3 morphNormal0;","attribute vec3 morphNormal1;","attribute vec3 morphNormal2;","attribute vec3 morphNormal3;","#else","attribute vec3 morphTarget4;","attribute vec3 morphTarget5;","attribute vec3 morphTarget6;","attribute vec3 morphTarget7;","#endif","#endif","#ifdef USE_SKINNING","attribute vec4 skinIndex;","attribute vec4 skinWeight;","#endif",""].join("\n"),v=["precision "+At+" float;",a.bumpMap||a.normalMap?"#extension GL_OES_standard_derivatives : enable":"",m,"#define MAX_DIR_LIGHTS "+a.maxDirLights,"#define MAX_POINT_LIGHTS "+a.maxPointLights,"#define MAX_SPOT_LIGHTS "+a.maxSpotLights,"#define MAX_HEMI_LIGHTS "+a.maxHemiLights,"#define MAX_SHADOWS "+a.maxShadows,a.alphaTest?"#define ALPHATEST "+a.alphaTest:"",Wt.gammaInput?"#define GAMMA_INPUT":"",Wt.gammaOutput?"#define GAMMA_OUTPUT":"",Wt.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"",a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.lightMap?"#define USE_LIGHTMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.vertexColors?"#define USE_COLOR":"",a.metal?"#define METAL":"",a.perPixel?"#define PHONG_PER_PIXEL":"",a.wrapAround?"#define WRAP_AROUND":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+f:"",a.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",a.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",""].join("\n"),E=pt("vertex",g+i),y=pt("fragment",v+t);It.attachShader(c,E),It.attachShader(c,y),It.linkProgram(c),It.getProgramParameter(c,It.LINK_STATUS)||console.error("Could not initialise shader\nVALIDATE_STATUS: "+It.getProgramParameter(c,It.VALIDATE_STATUS)+", gl error ["+It.getError()+"]"),It.deleteShader(y),It.deleteShader(E),c.uniforms={},c.attributes={};var T,_,b,x;T=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","morphTargetInfluences"],a.useVertexTexture?T.push("boneTexture"):T.push("boneGlobalMatrices");for(_ in r)T.push(_);for(ct(c,T),T=["position","normal","uv","uv2","tangent","color","skinIndex","skinWeight","lineDistance"],x=0;x<a.maxMorphTargets;x++)T.push("morphTarget"+x);for(x=0;x<a.maxMorphNormals;x++)T.push("morphNormal"+x);for(b in n)T.push(b);return ut(c,T),c.id=Xt++,Gt.push({program:c,code:u,usedTimes:1}),Wt.info.memory.programs=Gt.length,c}function ct(e,t){var i,r,n;for(i=0,r=t.length;r>i;i++)n=t[i],e.uniforms[n]=It.getUniformLocation(e,n)}function ut(e,t){var i,r,n;for(i=0,r=t.length;r>i;i++)n=t[i],e.attributes[n]=It.getAttribLocation(e,n)}function dt(e){for(var t=e.split("\n"),i=0,r=t.length;r>i;i++)t[i]=i+1+": "+t[i];return t.join("\n")}function pt(e,t){var i;return"fragment"===e?i=It.createShader(It.FRAGMENT_SHADER):"vertex"===e&&(i=It.createShader(It.VERTEX_SHADER)),It.shaderSource(i,t),It.compileShader(i),It.getShaderParameter(i,It.COMPILE_STATUS)?i:(console.error(It.getShaderInfoLog(i)),console.error(dt(t)),null)}function ft(e){return 0===(e&e-1)}function mt(e,t,i){i?(It.texParameteri(e,It.TEXTURE_WRAP_S,xt(t.wrapS)),It.texParameteri(e,It.TEXTURE_WRAP_T,xt(t.wrapT)),It.texParameteri(e,It.TEXTURE_MAG_FILTER,xt(t.magFilter)),It.texParameteri(e,It.TEXTURE_MIN_FILTER,xt(t.minFilter))):(It.texParameteri(e,It.TEXTURE_WRAP_S,It.CLAMP_TO_EDGE),It.texParameteri(e,It.TEXTURE_WRAP_T,It.CLAMP_TO_EDGE),It.texParameteri(e,It.TEXTURE_MAG_FILTER,bt(t.magFilter)),It.texParameteri(e,It.TEXTURE_MIN_FILTER,bt(t.minFilter))),Bt&&t.type!==THREE.FloatType&&(t.anisotropy>1||t.__oldAnisotropy)&&(It.texParameterf(e,Bt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,Ci)),t.__oldAnisotropy=t.anisotropy)}function gt(e,t){if(e.width<=t&&e.height<=t)return e;var i=Math.max(e.width,e.height),r=Math.floor(e.width*t/i),n=Math.floor(e.height*t/i),o=document.createElement("canvas");o.width=r,o.height=n;var a=o.getContext("2d");return a.drawImage(e,0,0,e.width,e.height,0,0,r,n),o}function vt(e,t){if(6===e.image.length)if(e.needsUpdate){e.image.__webglTextureCube||(e.addEventListener("dispose",Oi),e.image.__webglTextureCube=It.createTexture(),Wt.info.memory.textures++),It.activeTexture(It.TEXTURE0+t),It.bindTexture(It.TEXTURE_CUBE_MAP,e.image.__webglTextureCube),It.pixelStorei(It.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var i=e instanceof THREE.CompressedTexture,r=[],n=0;6>n;n++)r[n]=Wt.autoScaleCubemaps&&!i?gt(e.image[n],Si):e.image[n];var o=r[0],a=ft(o.width)&&ft(o.height),s=xt(e.format),l=xt(e.type);mt(It.TEXTURE_CUBE_MAP,e,a);for(var n=0;6>n;n++)if(i)for(var h,c=r[n].mipmaps,u=0,d=c.length;d>u;u++)h=c[u],It.compressedTexImage2D(It.TEXTURE_CUBE_MAP_POSITIVE_X+n,u,s,h.width,h.height,0,h.data);else It.texImage2D(It.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,s,s,l,r[n]);e.generateMipmaps&&a&&It.generateMipmap(It.TEXTURE_CUBE_MAP),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()}else It.activeTexture(It.TEXTURE0+t),It.bindTexture(It.TEXTURE_CUBE_MAP,e.image.__webglTextureCube)}function Et(e,t){It.activeTexture(It.TEXTURE0+t),It.bindTexture(It.TEXTURE_CUBE_MAP,e.__webglTexture)}function yt(e,t,i){It.bindFramebuffer(It.FRAMEBUFFER,e),It.framebufferTexture2D(It.FRAMEBUFFER,It.COLOR_ATTACHMENT0,i,t.__webglTexture,0)}function Tt(e,t){It.bindRenderbuffer(It.RENDERBUFFER,e),t.depthBuffer&&!t.stencilBuffer?(It.renderbufferStorage(It.RENDERBUFFER,It.DEPTH_COMPONENT16,t.width,t.height),It.framebufferRenderbuffer(It.FRAMEBUFFER,It.DEPTH_ATTACHMENT,It.RENDERBUFFER,e)):t.depthBuffer&&t.stencilBuffer?(It.renderbufferStorage(It.RENDERBUFFER,It.DEPTH_STENCIL,t.width,t.height),It.framebufferRenderbuffer(It.FRAMEBUFFER,It.DEPTH_STENCIL_ATTACHMENT,It.RENDERBUFFER,e)):It.renderbufferStorage(It.RENDERBUFFER,It.RGBA4,t.width,t.height)}function _t(e){e instanceof THREE.WebGLRenderTargetCube?(It.bindTexture(It.TEXTURE_CUBE_MAP,e.__webglTexture),It.generateMipmap(It.TEXTURE_CUBE_MAP),It.bindTexture(It.TEXTURE_CUBE_MAP,null)):(It.bindTexture(It.TEXTURE_2D,e.__webglTexture),It.generateMipmap(It.TEXTURE_2D),It.bindTexture(It.TEXTURE_2D,null))}function bt(e){return e===THREE.NearestFilter||e===THREE.NearestMipMapNearestFilter||e===THREE.NearestMipMapLinearFilter?It.NEAREST:It.LINEAR}function xt(e){if(e===THREE.RepeatWrapping)return It.REPEAT;if(e===THREE.ClampToEdgeWrapping)return It.CLAMP_TO_EDGE;if(e===THREE.MirroredRepeatWrapping)return It.MIRRORED_REPEAT;if(e===THREE.NearestFilter)return It.NEAREST;if(e===THREE.NearestMipMapNearestFilter)return It.NEAREST_MIPMAP_NEAREST;if(e===THREE.NearestMipMapLinearFilter)return It.NEAREST_MIPMAP_LINEAR;if(e===THREE.LinearFilter)return It.LINEAR;if(e===THREE.LinearMipMapNearestFilter)return It.LINEAR_MIPMAP_NEAREST;if(e===THREE.LinearMipMapLinearFilter)return It.LINEAR_MIPMAP_LINEAR;if(e===THREE.UnsignedByteType)return It.UNSIGNED_BYTE;if(e===THREE.UnsignedShort4444Type)return It.UNSIGNED_SHORT_4_4_4_4;if(e===THREE.UnsignedShort5551Type)return It.UNSIGNED_SHORT_5_5_5_1;if(e===THREE.UnsignedShort565Type)return It.UNSIGNED_SHORT_5_6_5;if(e===THREE.ByteType)return It.BYTE;if(e===THREE.ShortType)return It.SHORT;if(e===THREE.UnsignedShortType)return It.UNSIGNED_SHORT;if(e===THREE.IntType)return It.INT;if(e===THREE.UnsignedIntType)return It.UNSIGNED_INT;if(e===THREE.FloatType)return It.FLOAT;if(e===THREE.AlphaFormat)return It.ALPHA;if(e===THREE.RGBFormat)return It.RGB;if(e===THREE.RGBAFormat)return It.RGBA;if(e===THREE.LuminanceFormat)return It.LUMINANCE;if(e===THREE.LuminanceAlphaFormat)return It.LUMINANCE_ALPHA;if(e===THREE.AddEquation)return It.FUNC_ADD;if(e===THREE.SubtractEquation)return It.FUNC_SUBTRACT;if(e===THREE.ReverseSubtractEquation)return It.FUNC_REVERSE_SUBTRACT;if(e===THREE.ZeroFactor)return It.ZERO;if(e===THREE.OneFactor)return It.ONE;if(e===THREE.SrcColorFactor)return It.SRC_COLOR;if(e===THREE.OneMinusSrcColorFactor)return It.ONE_MINUS_SRC_COLOR;if(e===THREE.SrcAlphaFactor)return It.SRC_ALPHA;if(e===THREE.OneMinusSrcAlphaFactor)return It.ONE_MINUS_SRC_ALPHA;if(e===THREE.DstAlphaFactor)return It.DST_ALPHA;if(e===THREE.OneMinusDstAlphaFactor)return It.ONE_MINUS_DST_ALPHA;if(e===THREE.DstColorFactor)return It.DST_COLOR;if(e===THREE.OneMinusDstColorFactor)return It.ONE_MINUS_DST_COLOR;if(e===THREE.SrcAlphaSaturateFactor)return It.SRC_ALPHA_SATURATE;if(void 0!==jt){if(e===THREE.RGB_S3TC_DXT1_Format)return jt.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===THREE.RGBA_S3TC_DXT1_Format)return jt.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===THREE.RGBA_S3TC_DXT3_Format)return jt.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===THREE.RGBA_S3TC_DXT5_Format)return jt.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}function Rt(e){if(Di&&e&&e.useVertexTexture)return 1024;var t=It.getParameter(It.MAX_VERTEX_UNIFORM_VECTORS),i=Math.floor((t-20)/4),r=i;return void 0!==e&&e instanceof THREE.SkinnedMesh&&(r=Math.min(e.bones.length,r),r<e.bones.length&&console.warn("WebGLRenderer: too many bones - "+e.bones.length+", this GPU supports just "+r+" (try OpenGL instead of ANGLE)")),r}function wt(e){for(var t=0,i=0,r=0,n=0,o=0,a=e.length;a>o;o++){var s=e[o];s.onlyShadow||(s instanceof THREE.DirectionalLight&&t++,s instanceof THREE.PointLight&&i++,s instanceof THREE.SpotLight&&r++,s instanceof THREE.HemisphereLight&&n++)}return{directional:t,point:i,spot:r,hemi:n}}function Ht(e){for(var t=0,i=0,r=e.length;r>i;i++){var n=e[i];n.castShadow&&(n instanceof THREE.SpotLight&&t++,n instanceof THREE.DirectionalLight&&!n.shadowCascade&&t++)}return t}function Mt(){try{if(!(It=Ct.getContext("experimental-webgl",{alpha:Dt,premultipliedAlpha:Pt,antialias:Lt,stencil:kt,preserveDrawingBuffer:Ft})))throw"Error creating WebGL context."}catch(e){console.error(e)}Ot=It.getExtension("OES_texture_float"),Ut=It.getExtension("OES_texture_float_linear"),Vt=It.getExtension("OES_standard_derivatives"),Bt=It.getExtension("EXT_texture_filter_anisotropic")||It.getExtension("MOZ_EXT_texture_filter_anisotropic")||It.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),jt=It.getExtension("WEBGL_compressed_texture_s3tc")||It.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||It.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),Ot||console.log("THREE.WebGLRenderer: Float textures not supported."),Vt||console.log("THREE.WebGLRenderer: Standard derivatives not supported."),Bt||console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported."),jt||console.log("THREE.WebGLRenderer: S3TC compressed textures not supported."),void 0===It.getShaderPrecisionFormat&&(It.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}function St(){It.clearColor(0,0,0,1),It.clearDepth(1),It.clearStencil(0),It.enable(It.DEPTH_TEST),It.depthFunc(It.LEQUAL),It.frontFace(It.CCW),It.cullFace(It.BACK),It.enable(It.CULL_FACE),It.enable(It.BLEND),It.blendEquation(It.FUNC_ADD),It.blendFunc(It.SRC_ALPHA,It.ONE_MINUS_SRC_ALPHA),It.clearColor(zt.r,zt.g,zt.b,Nt)}console.log("THREE.WebGLRenderer",THREE.REVISION),e=e||{};var Ct=void 0!==e.canvas?e.canvas:document.createElement("canvas"),At=void 0!==e.precision?e.precision:"highp",Dt=void 0!==e.alpha?e.alpha:!0,Pt=void 0!==e.premultipliedAlpha?e.premultipliedAlpha:!0,Lt=void 0!==e.antialias?e.antialias:!1,kt=void 0!==e.stencil?e.stencil:!0,Ft=void 0!==e.preserveDrawingBuffer?e.preserveDrawingBuffer:!1,zt=new THREE.Color(0),Nt=0;void 0!==e.clearColor&&(console.warn("DEPRECATED: clearColor in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."),zt.setHex(e.clearColor)),void 0!==e.clearAlpha&&(console.warn("DEPRECATED: clearAlpha in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."),Nt=e.clearAlpha),this.domElement=Ct,this.context=null,this.devicePixelRatio=void 0!==e.devicePixelRatio?e.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.autoUpdateObjects=!0,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyBasedShading=!1,this.shadowMapEnabled=!1,this.shadowMapAutoUpdate=!0,this.shadowMapType=THREE.PCFShadowMap,this.shadowMapCullFace=THREE.CullFaceFront,this.shadowMapDebug=!1,this.shadowMapCascade=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.renderPluginsPre=[],this.renderPluginsPost=[],this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var It,Ot,Ut,Vt,Bt,jt,Wt=this,Gt=[],Xt=0,Yt=null,qt=null,Kt=-1,Qt=null,$t=null,Zt=0,Jt=0,ei=-1,ti=-1,ii=-1,ri=-1,ni=-1,oi=-1,ai=-1,si=-1,li=null,hi=null,ci=null,ui=null,di=0,pi=0,fi=0,mi=0,gi=0,vi=0,Ei={},yi=new THREE.Frustum,Ti=new THREE.Matrix4,_i=new THREE.Matrix4,bi=new THREE.Vector3,xi=new THREE.Vector3,Ri=!0,wi={ambient:[0,0,0],directional:{length:0,colors:new Array,positions:new Array},point:{length:0,colors:new Array,positions:new Array,distances:new Array},spot:{length:0,colors:new Array,positions:new Array,distances:new Array,directions:new Array,anglesCos:new Array,exponents:new Array},hemi:{length:0,skyColors:new Array,groundColors:new Array,positions:new Array}};Mt(),St(),this.context=It;var Hi=It.getParameter(It.MAX_TEXTURE_IMAGE_UNITS),Mi=It.getParameter(It.MAX_VERTEX_TEXTURE_IMAGE_UNITS);It.getParameter(It.MAX_TEXTURE_SIZE);var Si=It.getParameter(It.MAX_CUBE_MAP_TEXTURE_SIZE),Ci=Bt?It.getParameter(Bt.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,Ai=Mi>0,Di=Ai&&Ot;jt?It.getParameter(It.COMPRESSED_TEXTURE_FORMATS):[];var Pi=It.getShaderPrecisionFormat(It.VERTEX_SHADER,It.HIGH_FLOAT),Li=It.getShaderPrecisionFormat(It.VERTEX_SHADER,It.MEDIUM_FLOAT);It.getShaderPrecisionFormat(It.VERTEX_SHADER,It.LOW_FLOAT);var ki=It.getShaderPrecisionFormat(It.FRAGMENT_SHADER,It.HIGH_FLOAT),Fi=It.getShaderPrecisionFormat(It.FRAGMENT_SHADER,It.MEDIUM_FLOAT);It.getShaderPrecisionFormat(It.FRAGMENT_SHADER,It.LOW_FLOAT),It.getShaderPrecisionFormat(It.VERTEX_SHADER,It.HIGH_INT),It.getShaderPrecisionFormat(It.VERTEX_SHADER,It.MEDIUM_INT),It.getShaderPrecisionFormat(It.VERTEX_SHADER,It.LOW_INT),It.getShaderPrecisionFormat(It.FRAGMENT_SHADER,It.HIGH_INT),It.getShaderPrecisionFormat(It.FRAGMENT_SHADER,It.MEDIUM_INT),It.getShaderPrecisionFormat(It.FRAGMENT_SHADER,It.LOW_INT);var zi=Pi.precision>0&&ki.precision>0,Ni=Li.precision>0&&Fi.precision>0;"highp"!==At||zi||(Ni?(At="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(At="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp"))),"mediump"!==At||Ni||(At="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp")),this.getContext=function(){return It},this.supportsVertexTextures=function(){return Ai},this.supportsFloatTextures=function(){return Ot},this.supportsStandardDerivatives=function(){return Vt},this.supportsCompressedTextureS3TC=function(){return jt},this.getMaxAnisotropy=function(){return Ci},this.getPrecision=function(){return At},this.setSize=function(e,t,i){Ct.width=e*this.devicePixelRatio,Ct.height=t*this.devicePixelRatio,1!==this.devicePixelRatio&&i!==!1&&(Ct.style.width=e+"px",Ct.style.height=t+"px"),this.setViewport(0,0,Ct.width,Ct.height)},this.setViewport=function(e,t,i,r){di=void 0!==e?e:0,pi=void 0!==t?t:0,fi=void 0!==i?i:Ct.width,mi=void 0!==r?r:Ct.height,It.viewport(di,pi,fi,mi)},this.setScissor=function(e,t,i,r){It.scissor(e,t,i,r)},this.enableScissorTest=function(e){e?It.enable(It.SCISSOR_TEST):It.disable(It.SCISSOR_TEST)},this.setClearColor=function(e,t){zt.set(e),Nt=void 0!==t?t:1,It.clearColor(zt.r,zt.g,zt.b,Nt)},this.setClearColorHex=function(e,t){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(e,t)},this.getClearColor=function(){return zt},this.getClearAlpha=function(){return Nt},this.clear=function(e,t,i){var r=0;(void 0===e||e)&&(r|=It.COLOR_BUFFER_BIT),(void 0===t||t)&&(r|=It.DEPTH_BUFFER_BIT),(void 0===i||i)&&(r|=It.STENCIL_BUFFER_BIT),It.clear(r)},this.clearTarget=function(e,t,i,r){this.setRenderTarget(e),this.clear(t,i,r)},this.addPostPlugin=function(e){e.init(this),this.renderPluginsPost.push(e)},this.addPrePlugin=function(e){e.init(this),this.renderPluginsPre.push(e)},this.updateShadowMap=function(e,t){Yt=null,ii=-1,ai=-1,si=-1,Qt=-1,Kt=-1,Ri=!0,ei=-1,ti=-1,this.shadowMapPlugin.update(e,t)};var Ii=function(e){var t=e.target;t.removeEventListener("dispose",Ii),Bi(t),Wt.info.memory.geometries--},Oi=function(e){var t=e.target;t.removeEventListener("dispose",Oi),ji(t),Wt.info.memory.textures--},Ui=function(e){var t=e.target;t.removeEventListener("dispose",Ui),Wi(t),Wt.info.memory.textures--},Vi=function(e){var t=e.target;t.removeEventListener("dispose",Vi),Gi(t)},Bi=function(e){if(e.__webglInit=void 0,void 0!==e.__webglVertexBuffer&&It.deleteBuffer(e.__webglVertexBuffer),void 0!==e.__webglNormalBuffer&&It.deleteBuffer(e.__webglNormalBuffer),void 0!==e.__webglTangentBuffer&&It.deleteBuffer(e.__webglTangentBuffer),void 0!==e.__webglColorBuffer&&It.deleteBuffer(e.__webglColorBuffer),void 0!==e.__webglUVBuffer&&It.deleteBuffer(e.__webglUVBuffer),void 0!==e.__webglUV2Buffer&&It.deleteBuffer(e.__webglUV2Buffer),void 0!==e.__webglSkinIndicesBuffer&&It.deleteBuffer(e.__webglSkinIndicesBuffer),void 0!==e.__webglSkinWeightsBuffer&&It.deleteBuffer(e.__webglSkinWeightsBuffer),void 0!==e.__webglFaceBuffer&&It.deleteBuffer(e.__webglFaceBuffer),void 0!==e.__webglLineBuffer&&It.deleteBuffer(e.__webglLineBuffer),void 0!==e.__webglLineDistanceBuffer&&It.deleteBuffer(e.__webglLineDistanceBuffer),void 0!==e.geometryGroups)for(var t in e.geometryGroups){var i=e.geometryGroups[t];if(void 0!==i.numMorphTargets)for(var r=0,n=i.numMorphTargets;n>r;r++)It.deleteBuffer(i.__webglMorphTargetsBuffers[r]);if(void 0!==i.numMorphNormals)for(var r=0,n=i.numMorphNormals;n>r;r++)It.deleteBuffer(i.__webglMorphNormalsBuffers[r]);o(i)}o(e)},ji=function(e){if(e.image&&e.image.__webglTextureCube)It.deleteTexture(e.image.__webglTextureCube);else{if(!e.__webglInit)return;e.__webglInit=!1,It.deleteTexture(e.__webglTexture)}},Wi=function(e){if(e&&e.__webglTexture)if(It.deleteTexture(e.__webglTexture),e instanceof THREE.WebGLRenderTargetCube)for(var t=0;6>t;t++)It.deleteFramebuffer(e.__webglFramebuffer[t]),It.deleteRenderbuffer(e.__webglRenderbuffer[t]);else It.deleteFramebuffer(e.__webglFramebuffer),It.deleteRenderbuffer(e.__webglRenderbuffer)},Gi=function(e){var t=e.program;if(void 0!==t){e.program=void 0;var i,r,n,o=!1;for(i=0,r=Gt.length;r>i;i++)if(n=Gt[i],n.program===t){n.usedTimes--,0===n.usedTimes&&(o=!0);break}if(o===!0){var a=[];for(i=0,r=Gt.length;r>i;i++)n=Gt[i],n.program!==t&&a.push(n);Gt=a,It.deleteProgram(t),Wt.info.memory.programs--}}};this.renderBufferImmediate=function(e,t,i){if(e.hasPositions&&!e.__webglVertexBuffer&&(e.__webglVertexBuffer=It.createBuffer()),e.hasNormals&&!e.__webglNormalBuffer&&(e.__webglNormalBuffer=It.createBuffer()),e.hasUvs&&!e.__webglUvBuffer&&(e.__webglUvBuffer=It.createBuffer()),e.hasColors&&!e.__webglColorBuffer&&(e.__webglColorBuffer=It.createBuffer()),e.hasPositions&&(It.bindBuffer(It.ARRAY_BUFFER,e.__webglVertexBuffer),It.bufferData(It.ARRAY_BUFFER,e.positionArray,It.DYNAMIC_DRAW),It.enableVertexAttribArray(t.attributes.position),It.vertexAttribPointer(t.attributes.position,3,It.FLOAT,!1,0,0)),e.hasNormals){if(It.bindBuffer(It.ARRAY_BUFFER,e.__webglNormalBuffer),i.shading===THREE.FlatShading){var r,n,o,a,s,l,h,c,u,d,p,f,m,g,v=3*e.count;for(g=0;v>g;g+=9)m=e.normalArray,a=m[g],h=m[g+1],d=m[g+2],s=m[g+3],c=m[g+4],p=m[g+5],l=m[g+6],u=m[g+7],f=m[g+8],r=(a+s+l)/3,n=(h+c+u)/3,o=(d+p+f)/3,m[g]=r,m[g+1]=n,m[g+2]=o,m[g+3]=r,m[g+4]=n,m[g+5]=o,m[g+6]=r,m[g+7]=n,m[g+8]=o}It.bufferData(It.ARRAY_BUFFER,e.normalArray,It.DYNAMIC_DRAW),It.enableVertexAttribArray(t.attributes.normal),It.vertexAttribPointer(t.attributes.normal,3,It.FLOAT,!1,0,0)}e.hasUvs&&i.map&&(It.bindBuffer(It.ARRAY_BUFFER,e.__webglUvBuffer),It.bufferData(It.ARRAY_BUFFER,e.uvArray,It.DYNAMIC_DRAW),It.enableVertexAttribArray(t.attributes.uv),It.vertexAttribPointer(t.attributes.uv,2,It.FLOAT,!1,0,0)),e.hasColors&&i.vertexColors!==THREE.NoColors&&(It.bindBuffer(It.ARRAY_BUFFER,e.__webglColorBuffer),It.bufferData(It.ARRAY_BUFFER,e.colorArray,It.DYNAMIC_DRAW),It.enableVertexAttribArray(t.attributes.color),It.vertexAttribPointer(t.attributes.color,3,It.FLOAT,!1,0,0)),It.drawArrays(It.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,i,r,n,o){if(r.visible!==!1){var a,s,l,h,c=j(e,t,i,r,o),u=c.attributes,d=n.attributes,p=!1,f=r.wireframe?1:0,m=16777215*n.id+2*c.id+f;if(m!==Qt&&(Qt=m,p=!0),p&&x(),o instanceof THREE.Mesh){var g=d.index;if(g){var v=n.offsets;v.length>1&&(p=!0);for(var E=0,y=v.length;y>E;E++){var T=v[E].index;if(p){for(s in d)"index"!==s&&(l=u[s],a=d[s],h=a.itemSize,l>=0&&(It.bindBuffer(It.ARRAY_BUFFER,a.buffer),b(l),It.vertexAttribPointer(l,h,It.FLOAT,!1,0,4*T*h)));It.bindBuffer(It.ELEMENT_ARRAY_BUFFER,g.buffer)}It.drawElements(It.TRIANGLES,v[E].count,It.UNSIGNED_SHORT,2*v[E].start),Wt.info.render.calls++,Wt.info.render.vertices+=v[E].count,Wt.info.render.faces+=v[E].count/3}}else{if(p)for(s in d)"index"!==s&&(l=u[s],a=d[s],h=a.itemSize,l>=0&&(It.bindBuffer(It.ARRAY_BUFFER,a.buffer),b(l),It.vertexAttribPointer(l,h,It.FLOAT,!1,0,0)));var _=n.attributes.position;It.drawArrays(It.TRIANGLES,0,_.numItems/3),Wt.info.render.calls++,Wt.info.render.vertices+=_.numItems/3,Wt.info.render.faces+=_.numItems/3/3}}else if(o instanceof THREE.ParticleSystem){if(p){for(s in d)l=u[s],a=d[s],h=a.itemSize,l>=0&&(It.bindBuffer(It.ARRAY_BUFFER,a.buffer),b(l),It.vertexAttribPointer(l,h,It.FLOAT,!1,0,0));var _=d.position;It.drawArrays(It.POINTS,0,_.numItems/3),Wt.info.render.calls++,Wt.info.render.points+=_.numItems/3}}else if(o instanceof THREE.Line&&p){for(s in d)l=u[s],a=d[s],h=a.itemSize,l>=0&&(It.bindBuffer(It.ARRAY_BUFFER,a.buffer),b(l),It.vertexAttribPointer(l,h,It.FLOAT,!1,0,0));var R=o.type===THREE.LineStrip?It.LINE_STRIP:It.LINES;at(r.linewidth);var _=d.position;It.drawArrays(R,0,_.numItems/3),Wt.info.render.calls++,Wt.info.render.points+=_.numItems}}},this.renderBuffer=function(e,t,i,r,n,o){if(r.visible!==!1){var a,s,l,h=j(e,t,i,r,o),c=h.attributes,u=!1,d=r.wireframe?1:0,p=16777215*n.id+2*h.id+d;if(p!==Qt&&(Qt=p,u=!0),u&&x(),!r.morphTargets&&c.position>=0?u&&(It.bindBuffer(It.ARRAY_BUFFER,n.__webglVertexBuffer),b(c.position),It.vertexAttribPointer(c.position,3,It.FLOAT,!1,0,0)):o.morphTargetBase&&R(r,n,o),u){if(n.__webglCustomAttributesList)for(s=0,l=n.__webglCustomAttributesList.length;l>s;s++)a=n.__webglCustomAttributesList[s],c[a.buffer.belongsToAttribute]>=0&&(It.bindBuffer(It.ARRAY_BUFFER,a.buffer),b(c[a.buffer.belongsToAttribute]),It.vertexAttribPointer(c[a.buffer.belongsToAttribute],a.size,It.FLOAT,!1,0,0));c.color>=0&&(It.bindBuffer(It.ARRAY_BUFFER,n.__webglColorBuffer),b(c.color),It.vertexAttribPointer(c.color,3,It.FLOAT,!1,0,0)),c.normal>=0&&(It.bindBuffer(It.ARRAY_BUFFER,n.__webglNormalBuffer),b(c.normal),It.vertexAttribPointer(c.normal,3,It.FLOAT,!1,0,0)),c.tangent>=0&&(It.bindBuffer(It.ARRAY_BUFFER,n.__webglTangentBuffer),b(c.tangent),It.vertexAttribPointer(c.tangent,4,It.FLOAT,!1,0,0)),c.uv>=0&&(It.bindBuffer(It.ARRAY_BUFFER,n.__webglUVBuffer),b(c.uv),It.vertexAttribPointer(c.uv,2,It.FLOAT,!1,0,0)),c.uv2>=0&&(It.bindBuffer(It.ARRAY_BUFFER,n.__webglUV2Buffer),b(c.uv2),It.vertexAttribPointer(c.uv2,2,It.FLOAT,!1,0,0)),r.skinning&&c.skinIndex>=0&&c.skinWeight>=0&&(It.bindBuffer(It.ARRAY_BUFFER,n.__webglSkinIndicesBuffer),b(c.skinIndex),It.vertexAttribPointer(c.skinIndex,4,It.FLOAT,!1,0,0),It.bindBuffer(It.ARRAY_BUFFER,n.__webglSkinWeightsBuffer),b(c.skinWeight),It.vertexAttribPointer(c.skinWeight,4,It.FLOAT,!1,0,0)),c.lineDistance>=0&&(It.bindBuffer(It.ARRAY_BUFFER,n.__webglLineDistanceBuffer),b(c.lineDistance),It.vertexAttribPointer(c.lineDistance,1,It.FLOAT,!1,0,0))}if(o instanceof THREE.Mesh)r.wireframe?(at(r.wireframeLinewidth),u&&It.bindBuffer(It.ELEMENT_ARRAY_BUFFER,n.__webglLineBuffer),It.drawElements(It.LINES,n.__webglLineCount,It.UNSIGNED_SHORT,0)):(u&&It.bindBuffer(It.ELEMENT_ARRAY_BUFFER,n.__webglFaceBuffer),It.drawElements(It.TRIANGLES,n.__webglFaceCount,It.UNSIGNED_SHORT,0)),Wt.info.render.calls++,Wt.info.render.vertices+=n.__webglFaceCount,Wt.info.render.faces+=n.__webglFaceCount/3;else if(o instanceof THREE.Line){var f=o.type===THREE.LineStrip?It.LINE_STRIP:It.LINES;at(r.linewidth),It.drawArrays(f,0,n.__webglLineCount),Wt.info.render.calls++}else o instanceof THREE.ParticleSystem?(It.drawArrays(It.POINTS,0,n.__webglParticleCount),Wt.info.render.calls++,Wt.info.render.points+=n.__webglParticleCount):o instanceof THREE.Ribbon&&(It.drawArrays(It.TRIANGLE_STRIP,0,n.__webglVertexCount),Wt.info.render.calls++)}},this.render=function(e,t,i,r){if(t instanceof THREE.Camera==!1)return console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera."),void 0;var n,o,a,s,l,h=e.__lights,c=e.fog;for(Kt=-1,Ri=!0,e.autoUpdate===!0&&e.updateMatrixWorld(),void 0===t.parent&&t.updateMatrixWorld(),t.matrixWorldInverse.getInverse(t.matrixWorld),Ti.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),yi.setFromMatrix(Ti),this.autoUpdateObjects&&this.initWebGLObjects(e),M(this.renderPluginsPre,e,t),Wt.info.render.calls=0,Wt.info.render.vertices=0,Wt.info.render.faces=0,Wt.info.render.points=0,this.setRenderTarget(i),(this.autoClear||r)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),l=e.__webglObjects,n=0,o=l.length;o>n;n++)a=l[n],s=a.object,a.id=n,a.render=!1,s.visible&&((s instanceof THREE.Mesh||s instanceof THREE.ParticleSystem)&&s.frustumCulled&&!yi.intersectsObject(s)||(it(s,t),D(a),a.render=!0,this.sortObjects===!0&&(null!==s.renderDepth?a.z=s.renderDepth:(bi.getPositionFromMatrix(s.matrixWorld),bi.applyProjection(Ti),a.z=bi.z))));
for(this.sortObjects&&l.sort(w),l=e.__webglObjectsImmediate,n=0,o=l.length;o>n;n++)a=l[n],s=a.object,s.visible&&(it(s,t),A(a));if(e.overrideMaterial){var u=e.overrideMaterial;this.setBlending(u.blending,u.blendEquation,u.blendSrc,u.blendDst),this.setDepthTest(u.depthTest),this.setDepthWrite(u.depthWrite),st(u.polygonOffset,u.polygonOffsetFactor,u.polygonOffsetUnits),S(e.__webglObjects,!1,"",t,h,c,!0,u),C(e.__webglObjectsImmediate,"",t,h,c,!1,u)}else{var u=null;this.setBlending(THREE.NoBlending),S(e.__webglObjects,!0,"opaque",t,h,c,!1,u),C(e.__webglObjectsImmediate,"opaque",t,h,c,!1,u),S(e.__webglObjects,!1,"transparent",t,h,c,!0,u),C(e.__webglObjectsImmediate,"transparent",t,h,c,!0,u)}M(this.renderPluginsPost,e,t),i&&i.generateMipmaps&&i.minFilter!==THREE.NearestFilter&&i.minFilter!==THREE.LinearFilter&&_t(i),this.setDepthTest(!0),this.setDepthWrite(!0)},this.renderImmediateObject=function(e,t,i,r,n){var o=j(e,t,i,r,n);Qt=-1,Wt.setMaterialFaces(r),n.immediateRenderCallback?n.immediateRenderCallback(o,It,yi):n.render(function(e){Wt.renderBufferImmediate(e,o,r)})},this.initWebGLObjects=function(e){for(e.__webglObjects||(e.__webglObjects=[],e.__webglObjectsImmediate=[],e.__webglSprites=[],e.__webglFlares=[]);e.__objectsAdded.length;)L(e.__objectsAdded[0],e),e.__objectsAdded.splice(0,1);for(;e.__objectsRemoved.length;)O(e.__objectsRemoved[0],e),e.__objectsRemoved.splice(0,1);for(var t=0,i=e.__webglObjects.length;i>t;t++){var r=e.__webglObjects[t].object;void 0===r.__webglInit&&(void 0!==r.__webglActive&&O(r,e),L(r,e)),z(r)}},this.initMaterial=function(e,t,i,r){e.addEventListener("dispose",Vi);var n,o,a,s,l,h,c;e instanceof THREE.MeshDepthMaterial?c="depth":e instanceof THREE.MeshNormalMaterial?c="normal":e instanceof THREE.MeshBasicMaterial?c="basic":e instanceof THREE.MeshLambertMaterial?c="lambert":e instanceof THREE.MeshPhongMaterial?c="phong":e instanceof THREE.LineBasicMaterial?c="basic":e instanceof THREE.LineDashedMaterial?c="dashed":e instanceof THREE.ParticleBasicMaterial&&(c="particle_basic"),c&&B(e,THREE.ShaderLib[c]),s=wt(t),h=Ht(t),l=Rt(r),a={map:!!e.map,envMap:!!e.envMap,lightMap:!!e.lightMap,bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,specularMap:!!e.specularMap,vertexColors:e.vertexColors,fog:i,useFog:e.fog,fogExp:i instanceof THREE.FogExp2,sizeAttenuation:e.sizeAttenuation,skinning:e.skinning,maxBones:l,useVertexTexture:Di&&r&&r.useVertexTexture,boneTextureWidth:r&&r.boneTextureWidth,boneTextureHeight:r&&r.boneTextureHeight,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:s.directional,maxPointLights:s.point,maxSpotLights:s.spot,maxHemiLights:s.hemi,maxShadows:h,shadowMapEnabled:this.shadowMapEnabled&&r.receiveShadow,shadowMapType:this.shadowMapType,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,alphaTest:e.alphaTest,metal:e.metal,perPixel:e.perPixel,wrapAround:e.wrapAround,doubleSided:e.side===THREE.DoubleSide,flipSided:e.side===THREE.BackSide},e.program=ht(c,e.fragmentShader,e.vertexShader,e.uniforms,e.attributes,e.defines,a);var u=e.program.attributes;if(e.morphTargets){e.numSupportedMorphTargets=0;var d,p="morphTarget";for(o=0;o<this.maxMorphTargets;o++)d=p+o,u[d]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;var d,p="morphNormal";for(o=0;o<this.maxMorphNormals;o++)d=p+o,u[d]>=0&&e.numSupportedMorphNormals++}e.uniformsList=[];for(n in e.uniforms)e.uniformsList.push([e.uniforms[n],n])},this.setFaceCulling=function(e,t){e===THREE.CullFaceNone?It.disable(It.CULL_FACE):(t===THREE.FrontFaceDirectionCW?It.frontFace(It.CW):It.frontFace(It.CCW),e===THREE.CullFaceBack?It.cullFace(It.BACK):e===THREE.CullFaceFront?It.cullFace(It.FRONT):It.cullFace(It.FRONT_AND_BACK),It.enable(It.CULL_FACE))},this.setMaterialFaces=function(e){var t=e.side===THREE.DoubleSide,i=e.side===THREE.BackSide;ei!==t&&(t?It.disable(It.CULL_FACE):It.enable(It.CULL_FACE),ei=t),ti!==i&&(i?It.frontFace(It.CW):It.frontFace(It.CCW),ti=i)},this.setDepthTest=function(e){ai!==e&&(e?It.enable(It.DEPTH_TEST):It.disable(It.DEPTH_TEST),ai=e)},this.setDepthWrite=function(e){si!==e&&(It.depthMask(e),si=e)},this.setBlending=function(e,t,i,r){e!==ii&&(e===THREE.NoBlending?It.disable(It.BLEND):e===THREE.AdditiveBlending?(It.enable(It.BLEND),It.blendEquation(It.FUNC_ADD),It.blendFunc(It.SRC_ALPHA,It.ONE)):e===THREE.SubtractiveBlending?(It.enable(It.BLEND),It.blendEquation(It.FUNC_ADD),It.blendFunc(It.ZERO,It.ONE_MINUS_SRC_COLOR)):e===THREE.MultiplyBlending?(It.enable(It.BLEND),It.blendEquation(It.FUNC_ADD),It.blendFunc(It.ZERO,It.SRC_COLOR)):e===THREE.CustomBlending?It.enable(It.BLEND):(It.enable(It.BLEND),It.blendEquationSeparate(It.FUNC_ADD,It.FUNC_ADD),It.blendFuncSeparate(It.SRC_ALPHA,It.ONE_MINUS_SRC_ALPHA,It.ONE,It.ONE_MINUS_SRC_ALPHA)),ii=e),e===THREE.CustomBlending?(t!==ri&&(It.blendEquation(xt(t)),ri=t),(i!==ni||r!==oi)&&(It.blendFunc(xt(i),xt(r)),ni=i,oi=r)):(ri=null,ni=null,oi=null)},this.setTexture=function(e,t){if(e.needsUpdate){e.__webglInit||(e.__webglInit=!0,e.addEventListener("dispose",Oi),e.__webglTexture=It.createTexture(),Wt.info.memory.textures++),It.activeTexture(It.TEXTURE0+t),It.bindTexture(It.TEXTURE_2D,e.__webglTexture),It.pixelStorei(It.UNPACK_FLIP_Y_WEBGL,e.flipY),It.pixelStorei(It.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),It.pixelStorei(It.UNPACK_ALIGNMENT,e.unpackAlignment);var i=e.image,r=ft(i.width)&&ft(i.height),n=xt(e.format),o=xt(e.type);mt(It.TEXTURE_2D,e,r);var a,s=e.mipmaps;if(e instanceof THREE.DataTexture)if(s.length>0&&r){for(var l=0,h=s.length;h>l;l++)a=s[l],It.texImage2D(It.TEXTURE_2D,l,n,a.width,a.height,0,n,o,a.data);e.generateMipmaps=!1}else It.texImage2D(It.TEXTURE_2D,0,n,i.width,i.height,0,n,o,i.data);else if(e instanceof THREE.CompressedTexture)for(var l=0,h=s.length;h>l;l++)a=s[l],It.compressedTexImage2D(It.TEXTURE_2D,l,n,a.width,a.height,0,a.data);else if(s.length>0&&r){for(var l=0,h=s.length;h>l;l++)a=s[l],It.texImage2D(It.TEXTURE_2D,l,n,n,o,a);e.generateMipmaps=!1}else It.texImage2D(It.TEXTURE_2D,0,n,n,o,e.image);e.generateMipmaps&&r&&It.generateMipmap(It.TEXTURE_2D),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()}else It.activeTexture(It.TEXTURE0+t),It.bindTexture(It.TEXTURE_2D,e.__webglTexture)},this.setRenderTarget=function(e){var t=e instanceof THREE.WebGLRenderTargetCube;if(e&&!e.__webglFramebuffer){void 0===e.depthBuffer&&(e.depthBuffer=!0),void 0===e.stencilBuffer&&(e.stencilBuffer=!0),e.addEventListener("dispose",Ui),e.__webglTexture=It.createTexture(),Wt.info.memory.textures++;var i=ft(e.width)&&ft(e.height),r=xt(e.format),n=xt(e.type);if(t){e.__webglFramebuffer=[],e.__webglRenderbuffer=[],It.bindTexture(It.TEXTURE_CUBE_MAP,e.__webglTexture),mt(It.TEXTURE_CUBE_MAP,e,i);for(var o=0;6>o;o++)e.__webglFramebuffer[o]=It.createFramebuffer(),e.__webglRenderbuffer[o]=It.createRenderbuffer(),It.texImage2D(It.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,r,e.width,e.height,0,r,n,null),yt(e.__webglFramebuffer[o],e,It.TEXTURE_CUBE_MAP_POSITIVE_X+o),Tt(e.__webglRenderbuffer[o],e);i&&It.generateMipmap(It.TEXTURE_CUBE_MAP)}else e.__webglFramebuffer=It.createFramebuffer(),e.__webglRenderbuffer=e.shareDepthFrom?e.shareDepthFrom.__webglRenderbuffer:It.createRenderbuffer(),It.bindTexture(It.TEXTURE_2D,e.__webglTexture),mt(It.TEXTURE_2D,e,i),It.texImage2D(It.TEXTURE_2D,0,r,e.width,e.height,0,r,n,null),yt(e.__webglFramebuffer,e,It.TEXTURE_2D),e.shareDepthFrom?e.depthBuffer&&!e.stencilBuffer?It.framebufferRenderbuffer(It.FRAMEBUFFER,It.DEPTH_ATTACHMENT,It.RENDERBUFFER,e.__webglRenderbuffer):e.depthBuffer&&e.stencilBuffer&&It.framebufferRenderbuffer(It.FRAMEBUFFER,It.DEPTH_STENCIL_ATTACHMENT,It.RENDERBUFFER,e.__webglRenderbuffer):Tt(e.__webglRenderbuffer,e),i&&It.generateMipmap(It.TEXTURE_2D);t?It.bindTexture(It.TEXTURE_CUBE_MAP,null):It.bindTexture(It.TEXTURE_2D,null),It.bindRenderbuffer(It.RENDERBUFFER,null),It.bindFramebuffer(It.FRAMEBUFFER,null)}var a,s,l,h,c;e?(a=t?e.__webglFramebuffer[e.activeCubeFace]:e.__webglFramebuffer,s=e.width,l=e.height,h=0,c=0):(a=null,s=fi,l=mi,h=di,c=pi),a!==qt&&(It.bindFramebuffer(It.FRAMEBUFFER,a),It.viewport(h,c,s,l),qt=a),gi=s,vi=l},this.shadowMapPlugin=new THREE.ShadowMapPlugin,this.addPrePlugin(this.shadowMapPlugin),this.addPostPlugin(new THREE.SpritePlugin),this.addPostPlugin(new THREE.LensFlarePlugin)},THREE.WebGLRenderTarget=function(e,t,i){this.width=e,this.height=t,i=i||{},this.wrapS=void 0!==i.wrapS?i.wrapS:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==i.wrapT?i.wrapT:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==i.magFilter?i.magFilter:THREE.LinearFilter,this.minFilter=void 0!==i.minFilter?i.minFilter:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.format=void 0!==i.format?i.format:THREE.RGBAFormat,this.type=void 0!==i.type?i.type:THREE.UnsignedByteType,this.depthBuffer=void 0!==i.depthBuffer?i.depthBuffer:!0,this.stencilBuffer=void 0!==i.stencilBuffer?i.stencilBuffer:!0,this.generateMipmaps=!0,this.shareDepthFrom=null},THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,clone:function(){var e=new THREE.WebGLRenderTarget(this.width,this.height);return e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.format=this.format,e.type=this.type,e.depthBuffer=this.depthBuffer,e.stencilBuffer=this.stencilBuffer,e.generateMipmaps=this.generateMipmaps,e.shareDepthFrom=this.shareDepthFrom,e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype),THREE.WebGLRenderTargetCube=function(e,t,i){THREE.WebGLRenderTarget.call(this,e,t,i),this.activeCubeFace=0},THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype),THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)},THREE.RenderableFace3=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.centroidModel=new THREE.Vector3,this.normalModel=new THREE.Vector3,this.normalModelView=new THREE.Vector3,this.vertexNormalsLength=0,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.color=null,this.material=null,this.uvs=[[]],this.z=0},THREE.RenderableFace4=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.v4=new THREE.RenderableVertex,this.centroidModel=new THREE.Vector3,this.normalModel=new THREE.Vector3,this.normalModelView=new THREE.Vector3,this.vertexNormalsLength=0,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.color=null,this.material=null,this.uvs=[[]],this.z=0},THREE.RenderableObject=function(){this.id=0,this.object=null,this.z=0},THREE.RenderableParticle=function(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=null,this.scale=new THREE.Vector2,this.material=null},THREE.RenderableLine=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.vertexColors=[new THREE.Color,new THREE.Color],this.material=null,this.z=0},THREE.GeometryUtils={merge:function(e,t,i){var r,n,o=e.vertices.length,a=(e.faceVertexUvs[0].length,t instanceof THREE.Mesh?t.geometry:t),s=e.vertices,l=a.vertices,h=e.faces,c=a.faces,u=e.faceVertexUvs[0],d=a.faceVertexUvs[0];void 0===i&&(i=0),t instanceof THREE.Mesh&&(t.matrixAutoUpdate&&t.updateMatrix(),r=t.matrix,n=(new THREE.Matrix3).getNormalMatrix(r));for(var p=0,f=l.length;f>p;p++){var m=l[p],g=m.clone();r&&g.applyMatrix4(r),s.push(g)}for(p=0,f=c.length;f>p;p++){var v,E,y,T=c[p],_=T.vertexNormals,b=T.vertexColors;T instanceof THREE.Face3?v=new THREE.Face3(T.a+o,T.b+o,T.c+o):T instanceof THREE.Face4&&(v=new THREE.Face4(T.a+o,T.b+o,T.c+o,T.d+o)),v.normal.copy(T.normal),n&&v.normal.applyMatrix3(n).normalize();for(var x=0,R=_.length;R>x;x++)E=_[x].clone(),n&&E.applyMatrix3(n).normalize(),v.vertexNormals.push(E);v.color.copy(T.color);for(var x=0,R=b.length;R>x;x++)y=b[x],v.vertexColors.push(y.clone());v.materialIndex=T.materialIndex+i,v.centroid.copy(T.centroid),r&&v.centroid.applyMatrix4(r),h.push(v)}for(p=0,f=d.length;f>p;p++){for(var w=d[p],H=[],x=0,R=w.length;R>x;x++)H.push(new THREE.Vector2(w[x].x,w[x].y));u.push(H)}},removeMaterials:function(e,t){for(var i={},r=0,n=t.length;n>r;r++)i[t[r]]=!0;for(var o,a=[],r=0,n=e.faces.length;n>r;r++)o=e.faces[r],o.materialIndex in i||a.push(o);e.faces=a},randomPointInTriangle:function(){var e=new THREE.Vector3;return function(t,i,r){var n=new THREE.Vector3,o=THREE.Math.random16(),a=THREE.Math.random16();o+a>1&&(o=1-o,a=1-a);var s=1-o-a;return n.copy(t),n.multiplyScalar(o),e.copy(i),e.multiplyScalar(a),n.add(e),e.copy(r),e.multiplyScalar(s),n.add(e),n}}(),randomPointInFace:function(e,t,i){var r,n,o,a;if(e instanceof THREE.Face3)return r=t.vertices[e.a],n=t.vertices[e.b],o=t.vertices[e.c],THREE.GeometryUtils.randomPointInTriangle(r,n,o);if(e instanceof THREE.Face4){r=t.vertices[e.a],n=t.vertices[e.b],o=t.vertices[e.c],a=t.vertices[e.d];var s,l;i?e._area1&&e._area2?(s=e._area1,l=e._area2):(s=THREE.GeometryUtils.triangleArea(r,n,a),l=THREE.GeometryUtils.triangleArea(n,o,a),e._area1=s,e._area2=l):(s=THREE.GeometryUtils.triangleArea(r,n,a),l=THREE.GeometryUtils.triangleArea(n,o,a));var h=THREE.Math.random16()*(s+l);return s>h?THREE.GeometryUtils.randomPointInTriangle(r,n,a):THREE.GeometryUtils.randomPointInTriangle(n,o,a)}},randomPointsInGeometry:function(e,t){function i(e){function t(i,r){if(i>r)return i;var n=i+Math.floor((r-i)/2);return p[n]>e?t(i,n-1):p[n]<e?t(n+1,r):n}var i=t(0,p.length-1);return i}var r,n,o,a,s,l,h=e.faces,c=e.vertices,u=h.length,d=0,p=[];for(n=0;u>n;n++)r=h[n],r instanceof THREE.Face3?(o=c[r.a],a=c[r.b],s=c[r.c],r._area=THREE.GeometryUtils.triangleArea(o,a,s)):r instanceof THREE.Face4&&(o=c[r.a],a=c[r.b],s=c[r.c],l=c[r.d],r._area1=THREE.GeometryUtils.triangleArea(o,a,l),r._area2=THREE.GeometryUtils.triangleArea(a,s,l),r._area=r._area1+r._area2),d+=r._area,p[n]=d;var f,m,g=[],v={};for(n=0;t>n;n++)f=THREE.Math.random16()*d,m=i(f),g[n]=THREE.GeometryUtils.randomPointInFace(h[m],e,!0),v[m]?v[m]+=1:v[m]=1;return g},triangleArea:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(i,r,n){return e.subVectors(r,i),t.subVectors(n,i),e.cross(t),.5*e.length()}}(),center:function(e){e.computeBoundingBox();var t=e.boundingBox,i=new THREE.Vector3;return i.addVectors(t.min,t.max),i.multiplyScalar(-.5),e.applyMatrix((new THREE.Matrix4).makeTranslation(i.x,i.y,i.z)),e.computeBoundingBox(),i},triangulateQuads:function(e){var t,i,r,n,o=[],a=[],s=[];for(t=0,i=e.faceUvs.length;i>t;t++)a[t]=[];for(t=0,i=e.faceVertexUvs.length;i>t;t++)s[t]=[];for(t=0,i=e.faces.length;i>t;t++){var l=e.faces[t];if(l instanceof THREE.Face4){var h=l.a,c=l.b,u=l.c,d=l.d,p=new THREE.Face3,f=new THREE.Face3;for(p.color.copy(l.color),f.color.copy(l.color),p.materialIndex=l.materialIndex,f.materialIndex=l.materialIndex,p.a=h,p.b=c,p.c=d,f.a=c,f.b=u,f.c=d,4===l.vertexColors.length&&(p.vertexColors[0]=l.vertexColors[0].clone(),p.vertexColors[1]=l.vertexColors[1].clone(),p.vertexColors[2]=l.vertexColors[3].clone(),f.vertexColors[0]=l.vertexColors[1].clone(),f.vertexColors[1]=l.vertexColors[2].clone(),f.vertexColors[2]=l.vertexColors[3].clone()),o.push(p,f),r=0,n=e.faceVertexUvs.length;n>r;r++)if(e.faceVertexUvs[r].length){var m=e.faceVertexUvs[r][t],g=m[0],v=m[1],E=m[2],y=m[3],T=[g.clone(),v.clone(),y.clone()],_=[v.clone(),E.clone(),y.clone()];s[r].push(T,_)}for(r=0,n=e.faceUvs.length;n>r;r++)if(e.faceUvs[r].length){var b=e.faceUvs[r][t];a[r].push(b,b)}}else{for(o.push(l),r=0,n=e.faceUvs.length;n>r;r++)a[r].push(e.faceUvs[r][t]);for(r=0,n=e.faceVertexUvs.length;n>r;r++)s[r].push(e.faceVertexUvs[r][t])}}e.faces=o,e.faceUvs=a,e.faceVertexUvs=s,e.computeCentroids(),e.computeFaceNormals(),e.computeVertexNormals(),e.hasTangents&&e.computeTangents()},setMaterialIndex:function(e,t,i,r){for(var n=e.faces,o=i||0,a=r||n.length-1,s=o;a>=s;s++)n[s].materialIndex=t}},THREE.ImageUtils={crossOrigin:"anonymous",loadTexture:function(e,t,i){var r=new Image,n=new THREE.Texture(r,t),o=new THREE.ImageLoader;return o.crossOrigin=this.crossOrigin,o.load(e,function(e){n.image=e,n.needsUpdate=!0,i&&i(n)}),n.sourceFile=e,n},loadCompressedTexture:function(e,t,i,r){var n=new THREE.CompressedTexture;n.mapping=t;var o=new XMLHttpRequest;return o.onload=function(){var e=o.response,t=THREE.ImageUtils.parseDDS(e,!0);n.format=t.format,n.mipmaps=t.mipmaps,n.image.width=t.width,n.image.height=t.height,n.generateMipmaps=!1,n.needsUpdate=!0,i&&i(n)},o.onerror=r,o.open("GET",e,!0),o.responseType="arraybuffer",o.send(null),n},loadTextureCube:function(e,t,i,r){var n=[];n.loadCount=0;var o=new THREE.Texture;o.image=n,void 0!==t&&(o.mapping=t),o.flipY=!1;for(var a=0,s=e.length;s>a;++a){var l=new Image;n[a]=l,l.onload=function(){n.loadCount+=1,6===n.loadCount&&(o.needsUpdate=!0,i&&i(o))},l.onerror=r,l.crossOrigin=this.crossOrigin,l.src=e[a]}return o},loadCompressedTextureCube:function(e,t,i,r){var n=[];n.loadCount=0;var o=new THREE.CompressedTexture;o.image=n,void 0!==t&&(o.mapping=t),o.flipY=!1,o.generateMipmaps=!1;var a=function(e,t){return function(){var r=e.response,a=THREE.ImageUtils.parseDDS(r,!0);t.format=a.format,t.mipmaps=a.mipmaps,t.width=a.width,t.height=a.height,n.loadCount+=1,6===n.loadCount&&(o.format=a.format,o.needsUpdate=!0,i&&i(o))}};if(e instanceof Array)for(var s=0,l=e.length;l>s;++s){var h={};n[s]=h;var c=new XMLHttpRequest;c.onload=a(c,h),c.onerror=r;var u=e[s];c.open("GET",u,!0),c.responseType="arraybuffer",c.send(null)}else{var u=e,c=new XMLHttpRequest;c.onload=function(){var e=c.response,t=THREE.ImageUtils.parseDDS(e,!0);if(t.isCubemap){for(var r=t.mipmaps.length/t.mipmapCount,a=0;r>a;a++){n[a]={mipmaps:[]};for(var s=0;s<t.mipmapCount;s++)n[a].mipmaps.push(t.mipmaps[a*t.mipmapCount+s]),n[a].format=t.format,n[a].width=t.width,n[a].height=t.height}o.format=t.format,o.needsUpdate=!0,i&&i(o)}},c.onerror=r,c.open("GET",u,!0),c.responseType="arraybuffer",c.send(null)}return o},parseDDS:function(e,t){function i(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function r(e){return String.fromCharCode(255&e,255&e>>8,255&e>>16,255&e>>24)}var n={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},o=542327876,a=131072,s=512,l=4,h=i("DXT1"),c=i("DXT3"),u=i("DXT5"),d=31,p=0,f=1,m=2,g=3,v=4,E=7,y=20,T=21,_=28,b=new Int32Array(e,0,d);if(b[p]!==o)return console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header"),n;if(!b[y]&l)return console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"),n;var x,R=b[T];switch(R){case h:x=8,n.format=THREE.RGB_S3TC_DXT1_Format;break;case c:x=16,n.format=THREE.RGBA_S3TC_DXT3_Format;break;case u:x=16,n.format=THREE.RGBA_S3TC_DXT5_Format;break;default:return console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",r(R)),n}n.mipmapCount=1,b[m]&a&&t!==!1&&(n.mipmapCount=Math.max(1,b[E])),n.isCubemap=b[_]&s?!0:!1,n.width=b[v],n.height=b[g];for(var w=b[f]+4,H=n.width,M=n.height,S=n.isCubemap?6:1,C=0;S>C;C++){for(var A=0;A<n.mipmapCount;A++){var D=Math.max(4,H)/4*Math.max(4,M)/4*x,P=new Uint8Array(e,w,D),L={data:P,width:H,height:M};n.mipmaps.push(L),w+=D,H=Math.max(.5*H,1),M=Math.max(.5*M,1)}H=n.width,M=n.height}return n},getNormalMap:function(e,t){var i=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},r=function(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]},n=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]};t=1|t;var o=e.width,a=e.height,s=document.createElement("canvas");s.width=o,s.height=a;var l=s.getContext("2d");l.drawImage(e,0,0);for(var h=l.getImageData(0,0,o,a).data,c=l.createImageData(o,a),u=c.data,d=0;o>d;d++)for(var p=0;a>p;p++){var f=0>p-1?0:p-1,m=p+1>a-1?a-1:p+1,g=0>d-1?0:d-1,v=d+1>o-1?o-1:d+1,E=[],y=[0,0,h[4*(p*o+d)]/255*t];E.push([-1,0,h[4*(p*o+g)]/255*t]),E.push([-1,-1,h[4*(f*o+g)]/255*t]),E.push([0,-1,h[4*(f*o+d)]/255*t]),E.push([1,-1,h[4*(f*o+v)]/255*t]),E.push([1,0,h[4*(p*o+v)]/255*t]),E.push([1,1,h[4*(m*o+v)]/255*t]),E.push([0,1,h[4*(m*o+d)]/255*t]),E.push([-1,1,h[4*(m*o+g)]/255*t]);for(var T=[],_=E.length,b=0;_>b;b++){var x=E[b],R=E[(b+1)%_];x=r(x,y),R=r(R,y),T.push(n(i(x,R)))}for(var w=[0,0,0],b=0;b<T.length;b++)w[0]+=T[b][0],w[1]+=T[b][1],w[2]+=T[b][2];w[0]/=T.length,w[1]/=T.length,w[2]/=T.length;var H=4*(p*o+d);u[H]=0|255*((w[0]+1)/2),u[H+1]=0|255*((w[1]+1)/2),u[H+2]=0|255*w[2],u[H+3]=255}return l.putImageData(c,0,0),s},generateDataTexture:function(e,t,i){for(var r=e*t,n=new Uint8Array(3*r),o=Math.floor(255*i.r),a=Math.floor(255*i.g),s=Math.floor(255*i.b),l=0;r>l;l++)n[3*l]=o,n[3*l+1]=a,n[3*l+2]=s;var h=new THREE.DataTexture(n,e,t,THREE.RGBFormat);return h.needsUpdate=!0,h}},THREE.SceneUtils={createMultiMaterialObject:function(e,t){for(var i=new THREE.Object3D,r=0,n=t.length;n>r;r++)i.add(new THREE.Mesh(e,t[r]));return i},detach:function(e,t,i){e.applyMatrix(t.matrixWorld),t.remove(e),i.add(e)},attach:function(e,t,i){var r=new THREE.Matrix4;r.getInverse(i.matrixWorld),e.applyMatrix(r),t.remove(e),i.add(e)}},THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(e){var t=e.familyName.toLowerCase(),i=this;return i.faces[t]=i.faces[t]||{},i.faces[t][e.cssFontWeight]=i.faces[t][e.cssFontWeight]||{},i.faces[t][e.cssFontWeight][e.cssFontStyle]=e,i.faces[t][e.cssFontWeight][e.cssFontStyle]=e,e},drawText:function(e){var t,i=this.getFace(),r=this.size/i.resolution,n=0,o=String(e).split(""),a=o.length,s=[];for(t=0;a>t;t++){var l=new THREE.Path,h=this.extractGlyphPoints(o[t],i,r,n,l);n+=h.offset,s.push(h.path)}var c=n/2;return{paths:s,offset:c}},extractGlyphPoints:function(e,t,i,r,n){var o,a,s,l,h,c,u,d,p,f,m,g,v,E,y,T,_,b,x,R=[],w=t.glyphs[e]||t.glyphs["?"];if(w){if(w.o)for(l=w._cachedOutline||(w._cachedOutline=w.o.split(" ")),c=l.length,u=i,d=i,o=0;c>o;)switch(h=l[o++]){case"m":p=l[o++]*u+r,f=l[o++]*d,n.moveTo(p,f);break;case"l":p=l[o++]*u+r,f=l[o++]*d,n.lineTo(p,f);break;case"q":if(m=l[o++]*u+r,g=l[o++]*d,y=l[o++]*u+r,T=l[o++]*d,n.quadraticCurveTo(y,T,m,g),x=R[R.length-1])for(v=x.x,E=x.y,a=1,s=this.divisions;s>=a;a++){var H=a/s;THREE.Shape.Utils.b2(H,v,y,m),THREE.Shape.Utils.b2(H,E,T,g)}break;case"b":if(m=l[o++]*u+r,g=l[o++]*d,y=l[o++]*u+r,T=l[o++]*-d,_=l[o++]*u+r,b=l[o++]*-d,n.bezierCurveTo(m,g,y,T,_,b),x=R[R.length-1])for(v=x.x,E=x.y,a=1,s=this.divisions;s>=a;a++){var H=a/s;THREE.Shape.Utils.b3(H,v,y,_,m),THREE.Shape.Utils.b3(H,E,T,b,g)}}return{offset:w.ha*i,path:n}}}},THREE.FontUtils.generateShapes=function(e,t){t=t||{};var i=void 0!==t.size?t.size:100,r=void 0!==t.curveSegments?t.curveSegments:4,n=void 0!==t.font?t.font:"helvetiker",o=void 0!==t.weight?t.weight:"normal",a=void 0!==t.style?t.style:"normal";THREE.FontUtils.size=i,THREE.FontUtils.divisions=r,THREE.FontUtils.face=n,THREE.FontUtils.weight=o,THREE.FontUtils.style=a;for(var s=THREE.FontUtils.drawText(e),l=s.paths,h=[],c=0,u=l.length;u>c;c++)Array.prototype.push.apply(h,l[c].toShapes());return h},function(e){var t=1e-10,i=function(e,t){var i=e.length;if(3>i)return null;var o,a,s,l=[],h=[],c=[];if(r(e)>0)for(a=0;i>a;a++)h[a]=a;else for(a=0;i>a;a++)h[a]=i-1-a;var u=i,d=2*u;for(a=u-1;u>2;){if(d--<=0)return console.log("Warning, unable to triangulate polygon!"),t?c:l;if(o=a,o>=u&&(o=0),a=o+1,a>=u&&(a=0),s=a+1,s>=u&&(s=0),n(e,o,a,s,u,h)){var p,f,m,g,v;for(p=h[o],f=h[a],m=h[s],l.push([e[p],e[f],e[m]]),c.push([h[o],h[a],h[s]]),g=a,v=a+1;u>v;g++,v++)h[g]=h[v];u--,d=2*u}}return t?c:l},r=function(e){for(var t=e.length,i=0,r=t-1,n=0;t>n;r=n++)i+=e[r].x*e[n].y-e[n].x*e[r].y;return.5*i},n=function(e,i,r,n,o,a){var s,l,h,c,u,d,p,f,m;if(l=e[a[i]].x,h=e[a[i]].y,c=e[a[r]].x,u=e[a[r]].y,d=e[a[n]].x,p=e[a[n]].y,t>(c-l)*(p-h)-(u-h)*(d-l))return!1;var g,v,E,y,T,_,b,x,R,w,H,M,S,C,A;for(g=d-c,v=p-u,E=l-d,y=h-p,T=c-l,_=u-h,s=0;o>s;s++)if(s!==i&&s!==r&&s!==n&&(f=e[a[s]].x,m=e[a[s]].y,b=f-l,x=m-h,R=f-c,w=m-u,H=f-d,M=m-p,A=g*w-v*R,S=T*x-_*b,C=E*M-y*H,A>=0&&C>=0&&S>=0))return!1;return!0};return e.Triangulate=i,e.Triangulate.area=r,e}(THREE.FontUtils),self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace},THREE.typeface_js=self._typeface_js,THREE.Curve=function(){},THREE.Curve.prototype.getPoint=function(){return console.log("Warning, getPoint() not implemented!"),null},THREE.Curve.prototype.getPointAt=function(e){var t=this.getUtoTmapping(e);return this.getPoint(t)},THREE.Curve.prototype.getPoints=function(e){e||(e=5);var t,i=[];for(t=0;e>=t;t++)i.push(this.getPoint(t/e));return i},THREE.Curve.prototype.getSpacedPoints=function(e){e||(e=5);var t,i=[];for(t=0;e>=t;t++)i.push(this.getPointAt(t/e));return i},THREE.Curve.prototype.getLength=function(){var e=this.getLengths();return e[e.length-1]},THREE.Curve.prototype.getLengths=function(e){if(e||(e=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,i,r=[],n=this.getPoint(0),o=0;for(r.push(0),i=1;e>=i;i++)t=this.getPoint(i/e),o+=t.distanceTo(n),r.push(o),n=t;return this.cacheArcLengths=r,r},THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},THREE.Curve.prototype.getUtoTmapping=function(e,t){var i,r=this.getLengths(),n=0,o=r.length;i=t?t:e*r[o-1];for(var a,s=0,l=o-1;l>=s;)if(n=Math.floor(s+(l-s)/2),a=r[n]-i,0>a)s=n+1;else{if(!(a>0)){l=n;break}l=n-1}if(n=l,r[n]==i){var h=n/(o-1);return h}var c=r[n],u=r[n+1],d=u-c,p=(i-c)/d,h=(n+p)/(o-1);return h},THREE.Curve.prototype.getTangent=function(e){var t=1e-4,i=e-t,r=e+t;0>i&&(i=0),r>1&&(r=1);var n=this.getPoint(i),o=this.getPoint(r),a=o.clone().sub(n);return a.normalize()},THREE.Curve.prototype.getTangentAt=function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},THREE.Curve.Utils={tangentQuadraticBezier:function(e,t,i,r){return 2*(1-e)*(i-t)+2*e*(r-i)},tangentCubicBezier:function(e,t,i,r,n){return-3*t*(1-e)*(1-e)+3*i*(1-e)*(1-e)-6*e*i*(1-e)+6*e*r*(1-e)-3*e*e*r+3*e*e*n},tangentSpline:function(e){var t=6*e*e-6*e,i=3*e*e-4*e+1,r=-6*e*e+6*e,n=3*e*e-2*e;return t+i+r+n},interpolate:function(e,t,i,r,n){var o=.5*(i-e),a=.5*(r-t),s=n*n,l=n*s;return(2*t-2*i+o+a)*l+(-3*t+3*i-2*o-a)*s+o*n+t}},THREE.Curve.create=function(e,t){return e.prototype=Object.create(THREE.Curve.prototype),e.prototype.getPoint=t,e},THREE.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype),THREE.CurvePath.prototype.add=function(e){this.curves.push(e)},THREE.CurvePath.prototype.checkConnection=function(){},THREE.CurvePath.prototype.closePath=function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new THREE.LineCurve(t,e))},THREE.CurvePath.prototype.getPoint=function(e){for(var t,i,r=e*this.getLength(),n=this.getCurveLengths(),o=0;o<n.length;){if(n[o]>=r){t=n[o]-r,i=this.curves[o];var a=1-t/i.getLength();return i.getPointAt(a)}o++}return null},THREE.CurvePath.prototype.getLength=function(){var e=this.getCurveLengths();return e[e.length-1]},THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var e,t=[],i=0,r=this.curves.length;for(e=0;r>e;e++)i+=this.curves[e].getLength(),t.push(i);return this.cacheLengths=t,t},THREE.CurvePath.prototype.getBoundingBox=function(){var e,t,i,r,n,o,a=this.getPoints();e=t=Number.NEGATIVE_INFINITY,r=n=Number.POSITIVE_INFINITY;var s,l,h,c,u=a[0]instanceof THREE.Vector3;for(c=u?new THREE.Vector3:new THREE.Vector2,l=0,h=a.length;h>l;l++)s=a[l],s.x>e?e=s.x:s.x<r&&(r=s.x),s.y>t?t=s.y:s.y<n&&(n=s.y),u&&(s.z>i?i=s.z:s.z<o&&(o=s.z)),c.add(s);var d={minX:r,minY:n,maxX:e,maxY:t,centroid:c.divideScalar(h)};return u&&(d.maxZ=i,d.minZ=o),d},THREE.CurvePath.prototype.createPointsGeometry=function(e){var t=this.getPoints(e,!0);return this.createGeometry(t)},THREE.CurvePath.prototype.createSpacedPointsGeometry=function(e){var t=this.getSpacedPoints(e,!0);return this.createGeometry(t)},THREE.CurvePath.prototype.createGeometry=function(e){for(var t=new THREE.Geometry,i=0;i<e.length;i++)t.vertices.push(new THREE.Vector3(e[i].x,e[i].y,e[i].z||0));return t},THREE.CurvePath.prototype.addWrapPath=function(e){this.bends.push(e)},THREE.CurvePath.prototype.getTransformedPoints=function(e,t){var i,r,n=this.getPoints(e);for(t||(t=this.bends),i=0,r=t.length;r>i;i++)n=this.getWrapPoints(n,t[i]);return n},THREE.CurvePath.prototype.getTransformedSpacedPoints=function(e,t){var i,r,n=this.getSpacedPoints(e);for(t||(t=this.bends),i=0,r=t.length;r>i;i++)n=this.getWrapPoints(n,t[i]);return n},THREE.CurvePath.prototype.getWrapPoints=function(e,t){var i,r,n,o,a,s,l=this.getBoundingBox();for(i=0,r=e.length;r>i;i++){n=e[i],o=n.x,a=n.y,s=o/l.maxX,s=t.getUtoTmapping(s,o);var h=t.getPoint(s),c=t.getNormalVector(s).multiplyScalar(a);n.x=h.x+c.x,n.y=h.y+c.y}return e},THREE.Gyroscope=function(){THREE.Object3D.call(this)},THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype),THREE.Gyroscope.prototype.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.quaternionWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.quaternionObject,this.scaleObject),this.matrixWorld.compose(this.translationWorld,this.quaternionObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=0,i=this.children.length;i>t;t++)this.children[t].updateMatrixWorld(e)},THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3,THREE.Gyroscope.prototype.translationObject=new THREE.Vector3,THREE.Gyroscope.prototype.quaternionWorld=new THREE.Quaternion,THREE.Gyroscope.prototype.quaternionObject=new THREE.Quaternion,THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3,THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3,THREE.Path=function(e){THREE.CurvePath.call(this),this.actions=[],e&&this.fromPoints(e)},THREE.Path.prototype=Object.create(THREE.CurvePath.prototype),THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},THREE.Path.prototype.fromPoints=function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,i=e.length;i>t;t++)this.lineTo(e[t].x,e[t].y)},THREE.Path.prototype.moveTo=function(){var e=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:e})},THREE.Path.prototype.lineTo=function(e,t){var i=Array.prototype.slice.call(arguments),r=this.actions[this.actions.length-1].args,n=r[r.length-2],o=r[r.length-1],a=new THREE.LineCurve(new THREE.Vector2(n,o),new THREE.Vector2(e,t));this.curves.push(a),this.actions.push({action:THREE.PathActions.LINE_TO,args:i})},THREE.Path.prototype.quadraticCurveTo=function(e,t,i,r){var n=Array.prototype.slice.call(arguments),o=this.actions[this.actions.length-1].args,a=o[o.length-2],s=o[o.length-1],l=new THREE.QuadraticBezierCurve(new THREE.Vector2(a,s),new THREE.Vector2(e,t),new THREE.Vector2(i,r));this.curves.push(l),this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:n})
},THREE.Path.prototype.bezierCurveTo=function(e,t,i,r,n,o){var a=Array.prototype.slice.call(arguments),s=this.actions[this.actions.length-1].args,l=s[s.length-2],h=s[s.length-1],c=new THREE.CubicBezierCurve(new THREE.Vector2(l,h),new THREE.Vector2(e,t),new THREE.Vector2(i,r),new THREE.Vector2(n,o));this.curves.push(c),this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:a})},THREE.Path.prototype.splineThru=function(e){var t=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,r=i[i.length-2],n=i[i.length-1],o=[new THREE.Vector2(r,n)];Array.prototype.push.apply(o,e);var a=new THREE.SplineCurve(o);this.curves.push(a),this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:t})},THREE.Path.prototype.arc=function(e,t,i,r,n,o){var a=this.actions[this.actions.length-1].args,s=a[a.length-2],l=a[a.length-1];this.absarc(e+s,t+l,i,r,n,o)},THREE.Path.prototype.absarc=function(e,t,i,r,n,o){this.absellipse(e,t,i,i,r,n,o)},THREE.Path.prototype.ellipse=function(e,t,i,r,n,o,a){var s=this.actions[this.actions.length-1].args,l=s[s.length-2],h=s[s.length-1];this.absellipse(e+l,t+h,i,r,n,o,a)},THREE.Path.prototype.absellipse=function(e,t,i,r,n,o,a){var s=Array.prototype.slice.call(arguments),l=new THREE.EllipseCurve(e,t,i,r,n,o,a);this.curves.push(l);var h=l.getPoint(a?1:0);s.push(h.x),s.push(h.y),this.actions.push({action:THREE.PathActions.ELLIPSE,args:s})},THREE.Path.prototype.getSpacedPoints=function(e){e||(e=40);for(var t=[],i=0;e>i;i++)t.push(this.getPoint(i/e));return t},THREE.Path.prototype.getPoints=function(e,t){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(e,t);e=e||12;var i,r,n,o,a,s,l,h,c,u,d,p,f,m,g,v,E,y,T=[];for(i=0,r=this.actions.length;r>i;i++)switch(n=this.actions[i],o=n.action,a=n.args,o){case THREE.PathActions.MOVE_TO:T.push(new THREE.Vector2(a[0],a[1]));break;case THREE.PathActions.LINE_TO:T.push(new THREE.Vector2(a[0],a[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:for(s=a[2],l=a[3],u=a[0],d=a[1],T.length>0?(m=T[T.length-1],p=m.x,f=m.y):(m=this.actions[i-1].args,p=m[m.length-2],f=m[m.length-1]),g=1;e>=g;g++)v=g/e,E=THREE.Shape.Utils.b2(v,p,u,s),y=THREE.Shape.Utils.b2(v,f,d,l),T.push(new THREE.Vector2(E,y));break;case THREE.PathActions.BEZIER_CURVE_TO:for(s=a[4],l=a[5],u=a[0],d=a[1],h=a[2],c=a[3],T.length>0?(m=T[T.length-1],p=m.x,f=m.y):(m=this.actions[i-1].args,p=m[m.length-2],f=m[m.length-1]),g=1;e>=g;g++)v=g/e,E=THREE.Shape.Utils.b3(v,p,u,h,s),y=THREE.Shape.Utils.b3(v,f,d,c,l),T.push(new THREE.Vector2(E,y));break;case THREE.PathActions.CSPLINE_THRU:m=this.actions[i-1].args;var _=new THREE.Vector2(m[m.length-2],m[m.length-1]),b=[_],x=e*a[0].length;b=b.concat(a[0]);var R=new THREE.SplineCurve(b);for(g=1;x>=g;g++)T.push(R.getPointAt(g/x));break;case THREE.PathActions.ARC:var w,H=a[0],M=a[1],S=a[2],C=a[3],A=a[4],D=!!a[5],P=A-C,L=2*e;for(g=1;L>=g;g++)v=g/L,D||(v=1-v),w=C+v*P,E=H+S*Math.cos(w),y=M+S*Math.sin(w),T.push(new THREE.Vector2(E,y));break;case THREE.PathActions.ELLIPSE:var w,H=a[0],M=a[1],k=a[2],F=a[3],C=a[4],A=a[5],D=!!a[6],P=A-C,L=2*e;for(g=1;L>=g;g++)v=g/L,D||(v=1-v),w=C+v*P,E=H+k*Math.cos(w),y=M+F*Math.sin(w),T.push(new THREE.Vector2(E,y))}var z=T[T.length-1],N=1e-10;return Math.abs(z.x-T[0].x)<N&&Math.abs(z.y-T[0].y)<N&&T.splice(T.length-1,1),t&&T.push(T[0]),T},THREE.Path.prototype.toShapes=function(e){var t,i,r,n,o,a=[],s=new THREE.Path;for(t=0,i=this.actions.length;i>t;t++)r=this.actions[t],o=r.args,n=r.action,n==THREE.PathActions.MOVE_TO&&0!=s.actions.length&&(a.push(s),s=new THREE.Path),s[n].apply(s,o);if(0!=s.actions.length&&a.push(s),0==a.length)return[];var l,h,c,u=[];if(1==a.length)return h=a[0],c=new THREE.Shape,c.actions=h.actions,c.curves=h.curves,u.push(c),u;var d=!THREE.Shape.Utils.isClockWise(a[0].getPoints());if(d=e?!d:d)for(c=new THREE.Shape,t=0,i=a.length;i>t;t++)h=a[t],l=THREE.Shape.Utils.isClockWise(h.getPoints()),l=e?!l:l,l?(c.actions=h.actions,c.curves=h.curves,u.push(c),c=new THREE.Shape):c.holes.push(h);else{for(c=void 0,t=0,i=a.length;i>t;t++)h=a[t],l=THREE.Shape.Utils.isClockWise(h.getPoints()),l=e?!l:l,l?(c&&u.push(c),c=new THREE.Shape,c.actions=h.actions,c.curves=h.curves):c.holes.push(h);u.push(c)}return u},THREE.Shape=function(){THREE.Path.apply(this,arguments),this.holes=[]},THREE.Shape.prototype=Object.create(THREE.Path.prototype),THREE.Shape.prototype.extrude=function(e){var t=new THREE.ExtrudeGeometry(this,e);return t},THREE.Shape.prototype.makeGeometry=function(e){var t=new THREE.ShapeGeometry(this,e);return t},THREE.Shape.prototype.getPointsHoles=function(e){var t,i=this.holes.length,r=[];for(t=0;i>t;t++)r[t]=this.holes[t].getTransformedPoints(e,this.bends);return r},THREE.Shape.prototype.getSpacedPointsHoles=function(e){var t,i=this.holes.length,r=[];for(t=0;i>t;t++)r[t]=this.holes[t].getTransformedSpacedPoints(e,this.bends);return r},THREE.Shape.prototype.extractAllPoints=function(e){return{shape:this.getTransformedPoints(e),holes:this.getPointsHoles(e)}},THREE.Shape.prototype.extractPoints=function(e){return this.useSpacedPoints?this.extractAllSpacedPoints(e):this.extractAllPoints(e)},THREE.Shape.prototype.extractAllSpacedPoints=function(e){return{shape:this.getTransformedSpacedPoints(e),holes:this.getSpacedPointsHoles(e)}},THREE.Shape.Utils={removeHoles:function(e,t){var i,r,n,o,a,s,l,h,c,u,d,p,f,m,g,v,E=e.concat(),y=E.concat(),T=[];for(a=0;a<t.length;a++){for(l=t[a],Array.prototype.push.apply(y,l),h=Number.POSITIVE_INFINITY,s=0;s<l.length;s++){d=l[s];var _=[];for(u=0;u<E.length;u++)p=E[u],c=d.distanceToSquared(p),_.push(c),h>c&&(h=c,n=s,o=u)}i=o-1>=0?o-1:E.length-1,r=n-1>=0?n-1:l.length-1;var b=[l[n],E[o],E[i]],x=THREE.FontUtils.Triangulate.area(b),R=[l[n],l[r],E[o]],w=THREE.FontUtils.Triangulate.area(R),H=1,M=-1,S=o,C=n;o+=H,n+=M,0>o&&(o+=E.length),o%=E.length,0>n&&(n+=l.length),n%=l.length,i=o-1>=0?o-1:E.length-1,r=n-1>=0?n-1:l.length-1,b=[l[n],E[o],E[i]];var A=THREE.FontUtils.Triangulate.area(b);R=[l[n],l[r],E[o]];var D=THREE.FontUtils.Triangulate.area(R);x+w>A+D&&(o=S,n=C,0>o&&(o+=E.length),o%=E.length,0>n&&(n+=l.length),n%=l.length,i=o-1>=0?o-1:E.length-1,r=n-1>=0?n-1:l.length-1),f=E.slice(0,o),m=E.slice(o),g=l.slice(n),v=l.slice(0,n);var P=[l[n],E[o],E[i]],L=[l[n],l[r],E[o]];T.push(P),T.push(L),E=f.concat(g).concat(v).concat(m)}return{shape:E,isolatedPts:T,allpoints:y}},triangulateShape:function(e,t){var i,r,n,o,a,s,l=THREE.Shape.Utils.removeHoles(e,t),h=l.shape,c=l.allpoints,u=l.isolatedPts,d=THREE.FontUtils.Triangulate(h,!1),p={};for(i=0,r=c.length;r>i;i++)a=c[i].x+":"+c[i].y,void 0!==p[a]&&console.log("Duplicate point",a),p[a]=i;for(i=0,r=d.length;r>i;i++)for(o=d[i],n=0;3>n;n++)a=o[n].x+":"+o[n].y,s=p[a],void 0!==s&&(o[n]=s);for(i=0,r=u.length;r>i;i++)for(o=u[i],n=0;3>n;n++)a=o[n].x+":"+o[n].y,s=p[a],void 0!==s&&(o[n]=s);return d.concat(u)},isClockWise:function(e){return THREE.FontUtils.Triangulate.area(e)<0},b2p0:function(e,t){var i=1-e;return i*i*t},b2p1:function(e,t){return 2*(1-e)*e*t},b2p2:function(e,t){return e*e*t},b2:function(e,t,i,r){return this.b2p0(e,t)+this.b2p1(e,i)+this.b2p2(e,r)},b3p0:function(e,t){var i=1-e;return i*i*i*t},b3p1:function(e,t){var i=1-e;return 3*i*i*e*t},b3p2:function(e,t){var i=1-e;return 3*i*e*e*t},b3p3:function(e,t){return e*e*e*t},b3:function(e,t,i,r,n){return this.b3p0(e,t)+this.b3p1(e,i)+this.b3p2(e,r)+this.b3p3(e,n)}},THREE.LineCurve=function(e,t){this.v1=e,this.v2=t},THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.LineCurve.prototype.getPoint=function(e){var t=this.v2.clone().sub(this.v1);return t.multiplyScalar(e).add(this.v1),t},THREE.LineCurve.prototype.getPointAt=function(e){return this.getPoint(e)},THREE.LineCurve.prototype.getTangent=function(){var e=this.v2.clone().sub(this.v1);return e.normalize()},THREE.QuadraticBezierCurve=function(e,t,i){this.v0=e,this.v1=t,this.v2=i},THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.QuadraticBezierCurve.prototype.getPoint=function(e){var t,i;return t=THREE.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),i=THREE.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),new THREE.Vector2(t,i)},THREE.QuadraticBezierCurve.prototype.getTangent=function(e){var t,i;t=THREE.Curve.Utils.tangentQuadraticBezier(e,this.v0.x,this.v1.x,this.v2.x),i=THREE.Curve.Utils.tangentQuadraticBezier(e,this.v0.y,this.v1.y,this.v2.y);var r=new THREE.Vector2(t,i);return r.normalize(),r},THREE.CubicBezierCurve=function(e,t,i,r){this.v0=e,this.v1=t,this.v2=i,this.v3=r},THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.CubicBezierCurve.prototype.getPoint=function(e){var t,i;return t=THREE.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i=THREE.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new THREE.Vector2(t,i)},THREE.CubicBezierCurve.prototype.getTangent=function(e){var t,i;t=THREE.Curve.Utils.tangentCubicBezier(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i=THREE.Curve.Utils.tangentCubicBezier(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var r=new THREE.Vector2(t,i);return r.normalize(),r},THREE.SplineCurve=function(e){this.points=void 0==e?[]:e},THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.SplineCurve.prototype.getPoint=function(e){var t,i,r,n=new THREE.Vector2,o=[],a=this.points;return t=(a.length-1)*e,i=Math.floor(t),r=t-i,o[0]=0==i?i:i-1,o[1]=i,o[2]=i>a.length-2?a.length-1:i+1,o[3]=i>a.length-3?a.length-1:i+2,n.x=THREE.Curve.Utils.interpolate(a[o[0]].x,a[o[1]].x,a[o[2]].x,a[o[3]].x,r),n.y=THREE.Curve.Utils.interpolate(a[o[0]].y,a[o[1]].y,a[o[2]].y,a[o[3]].y,r),n},THREE.EllipseCurve=function(e,t,i,r,n,o,a){this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=n,this.aEndAngle=o,this.aClockwise=a},THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype),THREE.EllipseCurve.prototype.getPoint=function(e){var t=this.aEndAngle-this.aStartAngle;this.aClockwise||(e=1-e);var i=this.aStartAngle+e*t,r=this.aX+this.xRadius*Math.cos(i),n=this.aY+this.yRadius*Math.sin(i);return new THREE.Vector2(r,n)},THREE.ArcCurve=function(e,t,i,r,n,o){THREE.EllipseCurve.call(this,e,t,i,i,r,n,o)},THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype),THREE.LineCurve3=THREE.Curve.create(function(e,t){this.v1=e,this.v2=t},function(e){var t=new THREE.Vector3;return t.subVectors(this.v2,this.v1),t.multiplyScalar(e),t.add(this.v1),t}),THREE.QuadraticBezierCurve3=THREE.Curve.create(function(e,t,i){this.v0=e,this.v1=t,this.v2=i},function(e){var t,i,r;return t=THREE.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),i=THREE.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),r=THREE.Shape.Utils.b2(e,this.v0.z,this.v1.z,this.v2.z),new THREE.Vector3(t,i,r)}),THREE.CubicBezierCurve3=THREE.Curve.create(function(e,t,i,r){this.v0=e,this.v1=t,this.v2=i,this.v3=r},function(e){var t,i,r;return t=THREE.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i=THREE.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),r=THREE.Shape.Utils.b3(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new THREE.Vector3(t,i,r)}),THREE.SplineCurve3=THREE.Curve.create(function(e){this.points=void 0==e?[]:e},function(e){var t,i,r,n=new THREE.Vector3,o=[],a=this.points;t=(a.length-1)*e,i=Math.floor(t),r=t-i,o[0]=0==i?i:i-1,o[1]=i,o[2]=i>a.length-2?a.length-1:i+1,o[3]=i>a.length-3?a.length-1:i+2;var s=a[o[0]],l=a[o[1]],h=a[o[2]],c=a[o[3]];return n.x=THREE.Curve.Utils.interpolate(s.x,l.x,h.x,c.x,r),n.y=THREE.Curve.Utils.interpolate(s.y,l.y,h.y,c.y,r),n.z=THREE.Curve.Utils.interpolate(s.z,l.z,h.z,c.z,r),n}),THREE.ClosedSplineCurve3=THREE.Curve.create(function(e){this.points=void 0==e?[]:e},function(e){var t,i,r,n=new THREE.Vector3,o=[],a=this.points;return t=(a.length-0)*e,i=Math.floor(t),r=t-i,i+=i>0?0:(Math.floor(Math.abs(i)/a.length)+1)*a.length,o[0]=(i-1)%a.length,o[1]=i%a.length,o[2]=(i+1)%a.length,o[3]=(i+2)%a.length,n.x=THREE.Curve.Utils.interpolate(a[o[0]].x,a[o[1]].x,a[o[2]].x,a[o[3]].x,r),n.y=THREE.Curve.Utils.interpolate(a[o[0]].y,a[o[1]].y,a[o[2]].y,a[o[3]].y,r),n.z=THREE.Curve.Utils.interpolate(a[o[0]].z,a[o[1]].z,a[o[2]].z,a[o[3]].z,r),n}),THREE.AnimationHandler=function(){var e=[],t={},i={};i.update=function(t){for(var i=0;i<e.length;i++)e[i].update(t)},i.addToUpdate=function(t){-1===e.indexOf(t)&&e.push(t)},i.removeFromUpdate=function(t){var i=e.indexOf(t);-1!==i&&e.splice(i,1)},i.add=function(e){void 0!==t[e.name]&&console.log("THREE.AnimationHandler.add: Warning! "+e.name+" already exists in library. Overwriting."),t[e.name]=e,n(e)},i.get=function(e){return"string"==typeof e?t[e]?t[e]:(console.log("THREE.AnimationHandler.get: Couldn't find animation "+e),null):void 0},i.parse=function(e){var t=[];if(e instanceof THREE.SkinnedMesh)for(var i=0;i<e.bones.length;i++)t.push(e.bones[i]);else r(e,t);return t};var r=function(e,t){t.push(e);for(var i=0;i<e.children.length;i++)r(e.children[i],t)},n=function(e){if(e.initialized!==!0){for(var t=0;t<e.hierarchy.length;t++){for(var i=0;i<e.hierarchy[t].keys.length;i++)if(e.hierarchy[t].keys[i].time<0&&(e.hierarchy[t].keys[i].time=0),void 0!==e.hierarchy[t].keys[i].rot&&!(e.hierarchy[t].keys[i].rot instanceof THREE.Quaternion)){var r=e.hierarchy[t].keys[i].rot;e.hierarchy[t].keys[i].rot=new THREE.Quaternion(r[0],r[1],r[2],r[3])}if(e.hierarchy[t].keys.length&&void 0!==e.hierarchy[t].keys[0].morphTargets){for(var n={},i=0;i<e.hierarchy[t].keys.length;i++)for(var o=0;o<e.hierarchy[t].keys[i].morphTargets.length;o++){var a=e.hierarchy[t].keys[i].morphTargets[o];n[a]=-1}e.hierarchy[t].usedMorphTargets=n;for(var i=0;i<e.hierarchy[t].keys.length;i++){var s={};for(var a in n){for(var o=0;o<e.hierarchy[t].keys[i].morphTargets.length;o++)if(e.hierarchy[t].keys[i].morphTargets[o]===a){s[a]=e.hierarchy[t].keys[i].morphTargetsInfluences[o];break}o===e.hierarchy[t].keys[i].morphTargets.length&&(s[a]=0)}e.hierarchy[t].keys[i].morphTargetsInfluences=s}}for(var i=1;i<e.hierarchy[t].keys.length;i++)e.hierarchy[t].keys[i].time===e.hierarchy[t].keys[i-1].time&&(e.hierarchy[t].keys.splice(i,1),i--);for(var i=0;i<e.hierarchy[t].keys.length;i++)e.hierarchy[t].keys[i].index=i}var l=parseInt(e.length*e.fps,10);e.JIT={},e.JIT.hierarchy=[];for(var t=0;t<e.hierarchy.length;t++)e.JIT.hierarchy.push(new Array(l));e.initialized=!0}};return i.LINEAR=0,i.CATMULLROM=1,i.CATMULLROM_FORWARD=2,i}(),THREE.Animation=function(e,t,i){this.root=e,this.data=THREE.AnimationHandler.get(t),this.hierarchy=THREE.AnimationHandler.parse(e),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.isPaused=!0,this.loop=!0,this.interpolationType=void 0!==i?i:THREE.AnimationHandler.LINEAR,this.points=[],this.target=new THREE.Vector3},THREE.Animation.prototype.play=function(e,t){if(this.isPlaying===!1){this.isPlaying=!0,this.loop=void 0!==e?e:!0,this.currentTime=void 0!==t?t:0;var i,r,n=this.hierarchy.length;for(i=0;n>i;i++){r=this.hierarchy[i],r.matrixAutoUpdate=!0,void 0===r.animationCache&&(r.animationCache={},r.animationCache.prevKey={pos:0,rot:0,scl:0},r.animationCache.nextKey={pos:0,rot:0,scl:0},r.animationCache.originalMatrix=r instanceof THREE.Bone?r.skinMatrix:r.matrix);var o=r.animationCache.prevKey,a=r.animationCache.nextKey;o.pos=this.data.hierarchy[i].keys[0],o.rot=this.data.hierarchy[i].keys[0],o.scl=this.data.hierarchy[i].keys[0],a.pos=this.getNextKeyWith("pos",i,1),a.rot=this.getNextKeyWith("rot",i,1),a.scl=this.getNextKeyWith("scl",i,1)}this.update(0)}this.isPaused=!1,THREE.AnimationHandler.addToUpdate(this)},THREE.Animation.prototype.pause=function(){this.isPaused===!0?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this),this.isPaused=!this.isPaused},THREE.Animation.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,THREE.AnimationHandler.removeFromUpdate(this)},THREE.Animation.prototype.update=function(e){if(this.isPlaying!==!1){var t,i,r,n,o,a,s,l,h,c,u=["pos","rot","scl"];this.data.JIT.hierarchy;var d,p,f,m,g;this.currentTime+=e*this.timeScale,p=this.currentTime,d=this.currentTime=this.currentTime%this.data.length,c=parseInt(Math.min(d*this.data.fps,this.data.length*this.data.fps),10);for(var v=0,E=this.hierarchy.length;E>v;v++){l=this.hierarchy[v],h=l.animationCache;for(var y=0;3>y;y++){if(t=u[y],a=h.prevKey[t],s=h.nextKey[t],s.time<=p){if(p>d){if(!this.loop)return this.stop(),void 0;for(a=this.data.hierarchy[v].keys[0],s=this.getNextKeyWith(t,v,1);s.time<d;)a=s,s=this.getNextKeyWith(t,v,s.index+1)}else do a=s,s=this.getNextKeyWith(t,v,s.index+1);while(s.time<d);h.prevKey[t]=a,h.nextKey[t]=s}l.matrixAutoUpdate=!0,l.matrixWorldNeedsUpdate=!0,i=(d-a.time)/(s.time-a.time),n=a[t],o=s[t],(0>i||i>1)&&(console.log("THREE.Animation.update: Warning! Scale out of bounds:"+i+" on bone "+v),i=0>i?0:1),"pos"===t?(r=l.position,this.interpolationType===THREE.AnimationHandler.LINEAR?(r.x=n[0]+(o[0]-n[0])*i,r.y=n[1]+(o[1]-n[1])*i,r.z=n[2]+(o[2]-n[2])*i):(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)&&(this.points[0]=this.getPrevKeyWith("pos",v,a.index-1).pos,this.points[1]=n,this.points[2]=o,this.points[3]=this.getNextKeyWith("pos",v,s.index+1).pos,i=.33*i+.33,f=this.interpolateCatmullRom(this.points,i),r.x=f[0],r.y=f[1],r.z=f[2],this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(m=this.interpolateCatmullRom(this.points,1.01*i),this.target.set(m[0],m[1],m[2]),this.target.sub(r),this.target.y=0,this.target.normalize(),g=Math.atan2(this.target.x,this.target.z),l.rotation.set(0,g,0)))):"rot"===t?THREE.Quaternion.slerp(n,o,l.quaternion,i):"scl"===t&&(r=l.scale,r.x=n[0]+(o[0]-n[0])*i,r.y=n[1]+(o[1]-n[1])*i,r.z=n[2]+(o[2]-n[2])*i)}}}},THREE.Animation.prototype.interpolateCatmullRom=function(e,t){var i,r,n,o,a,s,l,h,c,u=[],d=[];return i=(e.length-1)*t,r=Math.floor(i),n=i-r,u[0]=0===r?r:r-1,u[1]=r,u[2]=r>e.length-2?r:r+1,u[3]=r>e.length-3?r:r+2,s=e[u[0]],l=e[u[1]],h=e[u[2]],c=e[u[3]],o=n*n,a=n*o,d[0]=this.interpolate(s[0],l[0],h[0],c[0],n,o,a),d[1]=this.interpolate(s[1],l[1],h[1],c[1],n,o,a),d[2]=this.interpolate(s[2],l[2],h[2],c[2],n,o,a),d},THREE.Animation.prototype.interpolate=function(e,t,i,r,n,o,a){var s=.5*(i-e),l=.5*(r-t);return(2*(t-i)+s+l)*a+(-3*(t-i)-2*s-l)*o+s*n+t},THREE.Animation.prototype.getNextKeyWith=function(e,t,i){var r=this.data.hierarchy[t].keys;for(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?i=i<r.length-1?i:r.length-1:i%=r.length;i<r.length;i++)if(void 0!==r[i][e])return r[i];return this.data.hierarchy[t].keys[0]},THREE.Animation.prototype.getPrevKeyWith=function(e,t,i){var r=this.data.hierarchy[t].keys;for(i=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?i>0?i:0:i>=0?i:i+r.length;i>=0;i--)if(void 0!==r[i][e])return r[i];return this.data.hierarchy[t].keys[r.length-1]},THREE.KeyFrameAnimation=function(e,t,i){this.root=e,this.data=THREE.AnimationHandler.get(t),this.hierarchy=THREE.AnimationHandler.parse(e),this.currentTime=0,this.timeScale=.001,this.isPlaying=!1,this.isPaused=!0,this.loop=!0,this.JITCompile=void 0!==i?i:!0;for(var r=0,n=this.hierarchy.length;n>r;r++){var o=this.data.hierarchy[r].keys,a=this.data.hierarchy[r].sids,s=this.hierarchy[r];if(o.length&&a){for(var l=0;l<a.length;l++){var h=a[l],c=this.getNextKeyWith(h,r,0);c&&c.apply(h)}s.matrixAutoUpdate=!1,this.data.hierarchy[r].node.updateMatrix(),s.matrixWorldNeedsUpdate=!0}}},THREE.KeyFrameAnimation.prototype.play=function(e,t){if(!this.isPlaying){this.isPlaying=!0,this.loop=void 0!==e?e:!0,this.currentTime=void 0!==t?t:0,this.startTimeMs=t,this.startTime=1e7,this.endTime=-this.startTime;var i,r,n,o=this.hierarchy.length;for(i=0;o>i;i++){r=this.hierarchy[i],n=this.data.hierarchy[i],void 0===n.animationCache&&(n.animationCache={},n.animationCache.prevKey=null,n.animationCache.nextKey=null,n.animationCache.originalMatrix=r instanceof THREE.Bone?r.skinMatrix:r.matrix);var a=this.data.hierarchy[i].keys;a.length&&(n.animationCache.prevKey=a[0],n.animationCache.nextKey=a[1],this.startTime=Math.min(a[0].time,this.startTime),this.endTime=Math.max(a[a.length-1].time,this.endTime))}this.update(0)}this.isPaused=!1,THREE.AnimationHandler.addToUpdate(this)},THREE.KeyFrameAnimation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this),this.isPaused=!this.isPaused},THREE.KeyFrameAnimation.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,THREE.AnimationHandler.removeFromUpdate(this);for(var e=0;e<this.data.hierarchy.length;e++){var t=this.hierarchy[e],i=this.data.hierarchy[e];if(void 0!==i.animationCache){var r=i.animationCache.originalMatrix;t instanceof THREE.Bone?(r.copy(t.skinMatrix),t.skinMatrix=r):(r.copy(t.matrix),t.matrix=r),delete i.animationCache}}},THREE.KeyFrameAnimation.prototype.update=function(e){if(this.isPlaying){var t,i,r,n,o,a,s,l,h=this.data.JIT.hierarchy;if(this.currentTime+=e*this.timeScale,s=this.currentTime,a=this.currentTime=this.currentTime%this.data.length,a<this.startTimeMs&&(a=this.currentTime=this.startTimeMs+a),o=parseInt(Math.min(a*this.data.fps,this.data.length*this.data.fps),10),l=s>a,l&&!this.loop){for(var c=0,u=this.hierarchy.length;u>c;c++){var d=this.data.hierarchy[c].keys,p=this.data.hierarchy[c].sids,f=d.length-1,m=this.hierarchy[c];if(d.length){for(var g=0;g<p.length;g++){var v=p[g],E=this.getPrevKeyWith(v,c,f);E&&E.apply(v)}this.data.hierarchy[c].node.updateMatrix(),m.matrixWorldNeedsUpdate=!0}}return this.stop(),void 0}if(!(a<this.startTime)){for(var c=0,u=this.hierarchy.length;u>c;c++){r=this.hierarchy[c],n=this.data.hierarchy[c];var d=n.keys,y=n.animationCache;if(this.JITCompile&&void 0!==h[c][o])r instanceof THREE.Bone?(r.skinMatrix=h[c][o],r.matrixWorldNeedsUpdate=!1):(r.matrix=h[c][o],r.matrixWorldNeedsUpdate=!0);else if(d.length){if(this.JITCompile&&y&&(r instanceof THREE.Bone?r.skinMatrix=y.originalMatrix:r.matrix=y.originalMatrix),t=y.prevKey,i=y.nextKey,t&&i){if(i.time<=s){if(l&&this.loop)for(t=d[0],i=d[1];i.time<a;)t=i,i=d[t.index+1];else if(!l)for(var T=d.length-1;i.time<a&&i.index!==T;)t=i,i=d[t.index+1];y.prevKey=t,y.nextKey=i}i.time>=a?t.interpolate(i,a):t.interpolate(i,i.time)}this.data.hierarchy[c].node.updateMatrix(),r.matrixWorldNeedsUpdate=!0}}if(this.JITCompile&&void 0===h[0][o]){this.hierarchy[0].updateMatrixWorld(!0);for(var c=0;c<this.hierarchy.length;c++)h[c][o]=this.hierarchy[c]instanceof THREE.Bone?this.hierarchy[c].skinMatrix.clone():this.hierarchy[c].matrix.clone()}}}},THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(e,t,i){var r=this.data.hierarchy[t].keys;for(i%=r.length;i<r.length;i++)if(r[i].hasTarget(e))return r[i];return r[0]},THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(e,t,i){var r=this.data.hierarchy[t].keys;for(i=i>=0?i:i+r.length;i>=0;i--)if(r[i].hasTarget(e))return r[i];return r[r.length-1]},THREE.CubeCamera=function(e,t,i){THREE.Object3D.call(this);var r=90,n=1,o=new THREE.PerspectiveCamera(r,n,e,t);o.up.set(0,-1,0),o.lookAt(new THREE.Vector3(1,0,0)),this.add(o);var a=new THREE.PerspectiveCamera(r,n,e,t);a.up.set(0,-1,0),a.lookAt(new THREE.Vector3(-1,0,0)),this.add(a);var s=new THREE.PerspectiveCamera(r,n,e,t);s.up.set(0,0,1),s.lookAt(new THREE.Vector3(0,1,0)),this.add(s);var l=new THREE.PerspectiveCamera(r,n,e,t);l.up.set(0,0,-1),l.lookAt(new THREE.Vector3(0,-1,0)),this.add(l);var h=new THREE.PerspectiveCamera(r,n,e,t);h.up.set(0,-1,0),h.lookAt(new THREE.Vector3(0,0,1)),this.add(h);var c=new THREE.PerspectiveCamera(r,n,e,t);c.up.set(0,-1,0),c.lookAt(new THREE.Vector3(0,0,-1)),this.add(c),this.renderTarget=new THREE.WebGLRenderTargetCube(i,i,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter}),this.updateCubeMap=function(e,t){var i=this.renderTarget,r=i.generateMipmaps;i.generateMipmaps=!1,i.activeCubeFace=0,e.render(t,o,i),i.activeCubeFace=1,e.render(t,a,i),i.activeCubeFace=2,e.render(t,s,i),i.activeCubeFace=3,e.render(t,l,i),i.activeCubeFace=4,e.render(t,h,i),i.generateMipmaps=r,i.activeCubeFace=5,e.render(t,c,i)}},THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype),THREE.CombinedCamera=function(e,t,i,r,n,o,a){THREE.Camera.call(this),this.fov=i,this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2,this.cameraO=new THREE.OrthographicCamera(e/-2,e/2,t/2,t/-2,o,a),this.cameraP=new THREE.PerspectiveCamera(i,e/t,r,n),this.zoom=1,this.toPerspective()},THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype),THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near,this.far=this.cameraP.far,this.cameraP.fov=this.fov/this.zoom,this.cameraP.updateProjectionMatrix(),this.projectionMatrix=this.cameraP.projectionMatrix,this.inPerspectiveMode=!0,this.inOrthographicMode=!1},THREE.CombinedCamera.prototype.toOrthographic=function(){var e=this.fov,t=this.cameraP.aspect,i=this.cameraP.near,r=this.cameraP.far,n=(i+r)/2,o=Math.tan(e/2)*n,a=2*o,s=a*t,l=s/2;o/=this.zoom,l/=this.zoom,this.cameraO.left=-l,this.cameraO.right=l,this.cameraO.top=o,this.cameraO.bottom=-o,this.cameraO.updateProjectionMatrix(),this.near=this.cameraO.near,this.far=this.cameraO.far,this.projectionMatrix=this.cameraO.projectionMatrix,this.inPerspectiveMode=!1,this.inOrthographicMode=!0},THREE.CombinedCamera.prototype.setSize=function(e,t){this.cameraP.aspect=e/t,this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2},THREE.CombinedCamera.prototype.setFov=function(e){this.fov=e,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){this.inPerspectiveMode?this.toPerspective():(this.toPerspective(),this.toOrthographic())},THREE.CombinedCamera.prototype.setLens=function(e,t){void 0===t&&(t=24);var i=2*THREE.Math.radToDeg(Math.atan(t/(2*e)));return this.setFov(i),i},THREE.CombinedCamera.prototype.setZoom=function(e){this.zoom=e,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0,this.rotation.y=Math.PI,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0,this.rotation.y=-Math.PI/2,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0,this.rotation.y=Math.PI/2,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CircleGeometry=function(e,t,i,r){THREE.Geometry.call(this),e=e||50,i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI,t=void 0!==t?Math.max(3,t):8;var n,o=[],a=new THREE.Vector3,s=new THREE.Vector2(.5,.5);for(this.vertices.push(a),o.push(s),n=0;t>=n;n++){var l=new THREE.Vector3,h=i+n/t*r;l.x=e*Math.cos(h),l.y=e*Math.sin(h),this.vertices.push(l),o.push(new THREE.Vector2((l.x/e+1)/2,(l.y/e+1)/2))}var c=new THREE.Vector3(0,0,1);for(n=1;t>=n;n++){var u=n,d=n+1,p=0;this.faces.push(new THREE.Face3(u,d,p,[c,c,c])),this.faceVertexUvs[0].push([o[n],o[n+1],s])}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,e)},THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CubeGeometry=function(e,t,i,r,n,o){function a(e,t,i,r,n,o,a,l){var h,c,u,d=s.widthSegments,p=s.heightSegments,f=n/2,m=o/2,g=s.vertices.length;"x"===e&&"y"===t||"y"===e&&"x"===t?h="z":"x"===e&&"z"===t||"z"===e&&"x"===t?(h="y",p=s.depthSegments):("z"===e&&"y"===t||"y"===e&&"z"===t)&&(h="x",d=s.depthSegments);var v=d+1,E=p+1,y=n/d,T=o/p,_=new THREE.Vector3;for(_[h]=a>0?1:-1,u=0;E>u;u++)for(c=0;v>c;c++){var b=new THREE.Vector3;b[e]=(c*y-f)*i,b[t]=(u*T-m)*r,b[h]=a,s.vertices.push(b)}for(u=0;p>u;u++)for(c=0;d>c;c++){var x=c+v*u,R=c+v*(u+1),w=c+1+v*(u+1),H=c+1+v*u,M=new THREE.Face4(x+g,R+g,w+g,H+g);M.normal.copy(_),M.vertexNormals.push(_.clone(),_.clone(),_.clone(),_.clone()),M.materialIndex=l,s.faces.push(M),s.faceVertexUvs[0].push([new THREE.Vector2(c/d,1-u/p),new THREE.Vector2(c/d,1-(u+1)/p),new THREE.Vector2((c+1)/d,1-(u+1)/p),new THREE.Vector2((c+1)/d,1-u/p)])}}THREE.Geometry.call(this);var s=this;this.width=e,this.height=t,this.depth=i,this.widthSegments=r||1,this.heightSegments=n||1,this.depthSegments=o||1;var l=this.width/2,h=this.height/2,c=this.depth/2;a("z","y",-1,-1,this.depth,this.height,l,0),a("z","y",1,-1,this.depth,this.height,-l,1),a("x","z",1,1,this.width,this.depth,h,2),a("x","z",1,-1,this.width,this.depth,-h,3),a("x","y",1,-1,this.width,this.height,c,4),a("x","y",-1,-1,this.width,this.height,-c,5),this.computeCentroids(),this.mergeVertices()},THREE.CubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CylinderGeometry=function(e,t,i,r,n,o){THREE.Geometry.call(this),this.radiusTop=e=void 0!==e?e:20,this.radiusBottom=t=void 0!==t?t:20,this.height=i=void 0!==i?i:100,this.radialSegments=r=r||8,this.heightSegments=n=n||1,this.openEnded=o=void 0!==o?o:!1;var a,s,l=i/2,h=[],c=[];for(s=0;n>=s;s++){var u=[],d=[],p=s/n,f=p*(t-e)+e;for(a=0;r>=a;a++){var m=a/r,g=new THREE.Vector3;g.x=f*Math.sin(2*m*Math.PI),g.y=-p*i+l,g.z=f*Math.cos(2*m*Math.PI),this.vertices.push(g),u.push(this.vertices.length-1),d.push(new THREE.Vector2(m,1-p))}h.push(u),c.push(d)}var v,E,y=(t-e)/i;for(a=0;r>a;a++)for(0!==e?(v=this.vertices[h[0][a]].clone(),E=this.vertices[h[0][a+1]].clone()):(v=this.vertices[h[1][a]].clone(),E=this.vertices[h[1][a+1]].clone()),v.setY(Math.sqrt(v.x*v.x+v.z*v.z)*y).normalize(),E.setY(Math.sqrt(E.x*E.x+E.z*E.z)*y).normalize(),s=0;n>s;s++){var T=h[s][a],_=h[s+1][a],b=h[s+1][a+1],x=h[s][a+1],R=v.clone(),w=v.clone(),H=E.clone(),M=E.clone(),S=c[s][a].clone(),C=c[s+1][a].clone(),A=c[s+1][a+1].clone(),D=c[s][a+1].clone();this.faces.push(new THREE.Face4(T,_,b,x,[R,w,H,M])),this.faceVertexUvs[0].push([S,C,A,D])}if(o===!1&&e>0)for(this.vertices.push(new THREE.Vector3(0,l,0)),a=0;r>a;a++){var T=h[0][a],_=h[0][a+1],b=this.vertices.length-1,R=new THREE.Vector3(0,1,0),w=new THREE.Vector3(0,1,0),H=new THREE.Vector3(0,1,0),S=c[0][a].clone(),C=c[0][a+1].clone(),A=new THREE.Vector2(C.u,0);this.faces.push(new THREE.Face3(T,_,b,[R,w,H])),this.faceVertexUvs[0].push([S,C,A])}if(o===!1&&t>0)for(this.vertices.push(new THREE.Vector3(0,-l,0)),a=0;r>a;a++){var T=h[s][a+1],_=h[s][a],b=this.vertices.length-1,R=new THREE.Vector3(0,-1,0),w=new THREE.Vector3(0,-1,0),H=new THREE.Vector3(0,-1,0),S=c[s][a+1].clone(),C=c[s][a].clone(),A=new THREE.Vector2(C.u,1);this.faces.push(new THREE.Face3(T,_,b,[R,w,H])),this.faceVertexUvs[0].push([S,C,A])}this.computeCentroids(),this.computeFaceNormals()},THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry=function(e,t){return"undefined"==typeof e?(e=[],void 0):(THREE.Geometry.call(this),e=e instanceof Array?e:[e],this.shapebb=e[e.length-1].getBoundingBox(),this.addShapeList(e,t),this.computeCentroids(),this.computeFaceNormals(),void 0)},THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry.prototype.addShapeList=function(e,t){for(var i=e.length,r=0;i>r;r++){var n=e[r];this.addShape(n,t)}},THREE.ExtrudeGeometry.prototype.addShape=function(e,t){function i(e,t,i){return t||console.log("die"),t.clone().multiplyScalar(i).add(e)}function r(e,t,i){return o(e,t,i)}function n(e,t,i){var r=Math.atan2(t.y-e.y,t.x-e.x),n=Math.atan2(i.y-e.y,i.x-e.x);r>n&&(n+=2*Math.PI);var o=(r+n)/2,a=-Math.cos(o),s=-Math.sin(o),l=new THREE.Vector2(a,s);return l}function o(e,t,i){var r,o,a,s,l,h,c=THREE.ExtrudeGeometry.__v1,u=THREE.ExtrudeGeometry.__v2,d=THREE.ExtrudeGeometry.__v3,p=THREE.ExtrudeGeometry.__v4,f=THREE.ExtrudeGeometry.__v5,m=THREE.ExtrudeGeometry.__v6;return c.set(e.x-t.x,e.y-t.y),u.set(e.x-i.x,e.y-i.y),r=c.normalize(),o=u.normalize(),d.set(-r.y,r.x),p.set(o.y,-o.x),f.copy(e).add(d),m.copy(e).add(p),f.equals(m)?p.clone():(f.copy(t).add(d),m.copy(i).add(p),a=r.dot(p),s=m.sub(f).dot(p),0===a&&(console.log("Either infinite or no solutions!"),0===s?console.log("Its finite solutions."):console.log("Too bad, no solutions.")),l=s/a,0>l?n(e,t,i):(h=r.multiplyScalar(l).add(f),h.sub(e).clone()))
}function a(){if(v){var e=0,t=X*e;for(K=0;Y>K;K++)G=I[K],c(G[2]+t,G[1]+t,G[0]+t,!0);for(e=y+2*g,t=X*e,K=0;Y>K;K++)G=I[K],c(G[0]+t,G[1]+t,G[2]+t,!1)}else{for(K=0;Y>K;K++)G=I[K],c(G[2],G[1],G[0],!0);for(K=0;Y>K;K++)G=I[K],c(G[0]+X*y,G[1]+X*y,G[2]+X*y,!1)}}function s(){var e=0;for(l(O,e),e+=O.length,A=0,D=z.length;D>A;A++)C=z[A],l(C,e),e+=C.length}function l(e,t){var i,r;for(K=e.length;--K>=0;){i=K,r=K-1,0>r&&(r=e.length-1);var n=0,o=y+2*g;for(n=0;o>n;n++){var a=X*n,s=X*(n+1),l=t+i+a,h=t+r+a,c=t+r+s,d=t+i+s;u(l,h,c,d,e,n,o,i,r)}}}function h(e,t,i){P.vertices.push(new THREE.Vector3(e,t,i))}function c(i,r,n,o){i+=L,r+=L,n+=L,P.faces.push(new THREE.Face3(i,r,n,null,null,b));var a=o?R.generateBottomUV(P,e,t,i,r,n):R.generateTopUV(P,e,t,i,r,n);P.faceVertexUvs[0].push(a)}function u(i,r,n,o,a,s,l,h,c){i+=L,r+=L,n+=L,o+=L,P.faces.push(new THREE.Face4(i,r,n,o,null,null,x));var u=R.generateSideWallUV(P,e,a,t,i,r,n,o,s,l,h,c);P.faceVertexUvs[0].push(u)}var d,p=void 0!==t.amount?t.amount:100,f=void 0!==t.bevelThickness?t.bevelThickness:6,m=void 0!==t.bevelSize?t.bevelSize:f-2,g=void 0!==t.bevelSegments?t.bevelSegments:3,v=void 0!==t.bevelEnabled?t.bevelEnabled:!0,E=void 0!==t.curveSegments?t.curveSegments:12,y=void 0!==t.steps?t.steps:1,T=t.extrudePath,_=!1,b=t.material,x=t.extrudeMaterial,R=void 0!==t.UVGenerator?t.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator;this.shapebb;var w,H,M,S;T&&(d=T.getSpacedPoints(y),_=!0,v=!1,w=void 0!==t.frames?t.frames:new THREE.TubeGeometry.FrenetFrames(T,y,!1),H=new THREE.Vector3,M=new THREE.Vector3,S=new THREE.Vector3),v||(g=0,f=0,m=0);var C,A,D,P=this,L=this.vertices.length,k=e.extractPoints(E),F=k.shape,z=k.holes,N=!THREE.Shape.Utils.isClockWise(F);if(N){for(F=F.reverse(),A=0,D=z.length;D>A;A++)C=z[A],THREE.Shape.Utils.isClockWise(C)&&(z[A]=C.reverse());N=!1}var I=THREE.Shape.Utils.triangulateShape(F,z),O=F;for(A=0,D=z.length;D>A;A++)C=z[A],F=F.concat(C);var U,V,B,j,W,G,X=F.length,Y=I.length;O.length,180/Math.PI;for(var q=[],K=0,Q=O.length,$=Q-1,Z=K+1;Q>K;K++,$++,Z++)$===Q&&($=0),Z===Q&&(Z=0),O[K],O[$],O[Z],q[K]=r(O[K],O[$],O[Z]);var J,et=[],tt=q.concat();for(A=0,D=z.length;D>A;A++){for(C=z[A],J=[],K=0,Q=C.length,$=Q-1,Z=K+1;Q>K;K++,$++,Z++)$===Q&&($=0),Z===Q&&(Z=0),J[K]=r(C[K],C[$],C[Z]);et.push(J),tt=tt.concat(J)}for(U=0;g>U;U++){for(B=U/g,j=f*(1-B),V=m*Math.sin(B*Math.PI/2),K=0,Q=O.length;Q>K;K++)W=i(O[K],q[K],V),h(W.x,W.y,-j);for(A=0,D=z.length;D>A;A++)for(C=z[A],J=et[A],K=0,Q=C.length;Q>K;K++)W=i(C[K],J[K],V),h(W.x,W.y,-j)}for(V=m,K=0;X>K;K++)W=v?i(F[K],tt[K],V):F[K],_?(M.copy(w.normals[0]).multiplyScalar(W.x),H.copy(w.binormals[0]).multiplyScalar(W.y),S.copy(d[0]).add(M).add(H),h(S.x,S.y,S.z)):h(W.x,W.y,0);var it;for(it=1;y>=it;it++)for(K=0;X>K;K++)W=v?i(F[K],tt[K],V):F[K],_?(M.copy(w.normals[it]).multiplyScalar(W.x),H.copy(w.binormals[it]).multiplyScalar(W.y),S.copy(d[it]).add(M).add(H),h(S.x,S.y,S.z)):h(W.x,W.y,p/y*it);for(U=g-1;U>=0;U--){for(B=U/g,j=f*(1-B),V=m*Math.sin(B*Math.PI/2),K=0,Q=O.length;Q>K;K++)W=i(O[K],q[K],V),h(W.x,W.y,p+j);for(A=0,D=z.length;D>A;A++)for(C=z[A],J=et[A],K=0,Q=C.length;Q>K;K++)W=i(C[K],J[K],V),_?h(W.x,W.y+d[y-1].y,d[y-1].x+j):h(W.x,W.y,p+j)}a(),s()},THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(e,t,i,r,n,o){var a=e.vertices[r].x,s=e.vertices[r].y,l=e.vertices[n].x,h=e.vertices[n].y,c=e.vertices[o].x,u=e.vertices[o].y;return[new THREE.Vector2(a,s),new THREE.Vector2(l,h),new THREE.Vector2(c,u)]},generateBottomUV:function(e,t,i,r,n,o){return this.generateTopUV(e,t,i,r,n,o)},generateSideWallUV:function(e,t,i,r,n,o,a,s){var l=e.vertices[n].x,h=e.vertices[n].y,c=e.vertices[n].z,u=e.vertices[o].x,d=e.vertices[o].y,p=e.vertices[o].z,f=e.vertices[a].x,m=e.vertices[a].y,g=e.vertices[a].z,v=e.vertices[s].x,E=e.vertices[s].y,y=e.vertices[s].z;return Math.abs(h-d)<.01?[new THREE.Vector2(l,1-c),new THREE.Vector2(u,1-p),new THREE.Vector2(f,1-g),new THREE.Vector2(v,1-y)]:[new THREE.Vector2(h,1-c),new THREE.Vector2(d,1-p),new THREE.Vector2(m,1-g),new THREE.Vector2(E,1-y)]}},THREE.ExtrudeGeometry.__v1=new THREE.Vector2,THREE.ExtrudeGeometry.__v2=new THREE.Vector2,THREE.ExtrudeGeometry.__v3=new THREE.Vector2,THREE.ExtrudeGeometry.__v4=new THREE.Vector2,THREE.ExtrudeGeometry.__v5=new THREE.Vector2,THREE.ExtrudeGeometry.__v6=new THREE.Vector2,THREE.ShapeGeometry=function(e,t){THREE.Geometry.call(this),e instanceof Array==!1&&(e=[e]),this.shapebb=e[e.length-1].getBoundingBox(),this.addShapeList(e,t),this.computeCentroids(),this.computeFaceNormals()},THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ShapeGeometry.prototype.addShapeList=function(e,t){for(var i=0,r=e.length;r>i;i++)this.addShape(e[i],t);return this},THREE.ShapeGeometry.prototype.addShape=function(e,t){void 0===t&&(t={});var i=void 0!==t.curveSegments?t.curveSegments:12,r=t.material,n=void 0===t.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:t.UVGenerator;this.shapebb;var o,a,s,l=this.vertices.length,h=e.extractPoints(i),c=h.shape,u=h.holes,d=!THREE.Shape.Utils.isClockWise(c);if(d){for(c=c.reverse(),o=0,a=u.length;a>o;o++)s=u[o],THREE.Shape.Utils.isClockWise(s)&&(u[o]=s.reverse());d=!1}var p=THREE.Shape.Utils.triangulateShape(c,u),f=c;for(o=0,a=u.length;a>o;o++)s=u[o],c=c.concat(s);var m,g,v=c.length,E=p.length;for(f.length,o=0;v>o;o++)m=c[o],this.vertices.push(new THREE.Vector3(m.x,m.y,0));for(o=0;E>o;o++){g=p[o];var y=g[0]+l,T=g[1]+l,_=g[2]+l;this.faces.push(new THREE.Face3(y,T,_,null,null,r)),this.faceVertexUvs[0].push(n.generateBottomUV(this,e,t,y,T,_))}},THREE.LatheGeometry=function(e,t,i,r){THREE.Geometry.call(this),t=t||12,i=i||0,r=r||2*Math.PI;for(var n=1/(e.length-1),o=1/t,a=0,s=t;s>=a;a++)for(var l=i+a*o*r,h=Math.cos(l),c=Math.sin(l),u=0,d=e.length;d>u;u++){var p=e[u],f=new THREE.Vector3;f.x=h*p.x-c*p.y,f.y=c*p.x+h*p.y,f.z=p.z,this.vertices.push(f)}for(var m=e.length,a=0,s=t;s>a;a++)for(var u=0,d=e.length-1;d>u;u++){var g=u+m*a,v=g,E=g+m,h=g+1+m,y=g+1;this.faces.push(new THREE.Face4(v,E,h,y));var T=a*o,_=u*n,b=T+o,x=_+n;this.faceVertexUvs[0].push([new THREE.Vector2(T,_),new THREE.Vector2(b,_),new THREE.Vector2(b,x),new THREE.Vector2(T,x)])}this.mergeVertices(),this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PlaneGeometry=function(e,t,i,r){THREE.Geometry.call(this),this.width=e,this.height=t,this.widthSegments=i||1,this.heightSegments=r||1;var n,o,a=e/2,s=t/2,l=this.widthSegments,h=this.heightSegments,c=l+1,u=h+1,d=this.width/l,p=this.height/h,f=new THREE.Vector3(0,0,1);for(o=0;u>o;o++)for(n=0;c>n;n++){var m=n*d-a,g=o*p-s;this.vertices.push(new THREE.Vector3(m,-g,0))}for(o=0;h>o;o++)for(n=0;l>n;n++){var v=n+c*o,E=n+c*(o+1),y=n+1+c*(o+1),T=n+1+c*o,_=new THREE.Face4(v,E,y,T);_.normal.copy(f),_.vertexNormals.push(f.clone(),f.clone(),f.clone(),f.clone()),this.faces.push(_),this.faceVertexUvs[0].push([new THREE.Vector2(n/l,1-o/h),new THREE.Vector2(n/l,1-(o+1)/h),new THREE.Vector2((n+1)/l,1-(o+1)/h),new THREE.Vector2((n+1)/l,1-o/h)])}this.computeCentroids()},THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.RingGeometry=function(e,t,i,r,n,o){THREE.Geometry.call(this),e=e||0,t=t||50,n=void 0!==n?n:0,o=void 0!==o?o:2*Math.PI,i=void 0!==i?Math.max(3,i):8,r=void 0!==r?Math.max(3,r):8;var a,s,l=[],h=e,c=(t-e)/r;for(a=0;r>=a;a++){for(s=0;i>=s;s++){var u=new THREE.Vector3,d=n+s/i*o;u.x=h*Math.cos(d),u.y=h*Math.sin(d),this.vertices.push(u),l.push(new THREE.Vector2((u.x/h+1)/2,-(u.y/h+1)/2+1))}h+=c}var p=new THREE.Vector3(0,0,1);for(a=0;r>a;a++){var f=a*i;for(s=0;i>=s;s++){var d=s+f,m=d+a,g=d+i+a,v=d+i+1+a;this.faces.push(new THREE.Face3(m,g,v,[p,p,p])),this.faceVertexUvs[0].push([l[m],l[g],l[v]]),m=d+a,g=d+i+1+a,v=d+1+a,this.faces.push(new THREE.Face3(m,g,v,[p,p,p])),this.faceVertexUvs[0].push([l[m],l[g],l[v]])}}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,h)},THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.SphereGeometry=function(e,t,i,r,n,o,a){THREE.Geometry.call(this),this.radius=e=e||50,this.widthSegments=t=Math.max(3,Math.floor(t)||8),this.heightSegments=i=Math.max(2,Math.floor(i)||6),this.phiStart=r=void 0!==r?r:0,this.phiLength=n=void 0!==n?n:2*Math.PI,this.thetaStart=o=void 0!==o?o:0,this.thetaLength=a=void 0!==a?a:Math.PI;var s,l,h=[],c=[];for(l=0;i>=l;l++){var u=[],d=[];for(s=0;t>=s;s++){var p=s/t,f=l/i,m=new THREE.Vector3;m.x=-e*Math.cos(r+p*n)*Math.sin(o+f*a),m.y=e*Math.cos(o+f*a),m.z=e*Math.sin(r+p*n)*Math.sin(o+f*a),this.vertices.push(m),u.push(this.vertices.length-1),d.push(new THREE.Vector2(p,1-f))}h.push(u),c.push(d)}for(l=0;l<this.heightSegments;l++)for(s=0;s<this.widthSegments;s++){var g=h[l][s+1],v=h[l][s],E=h[l+1][s],y=h[l+1][s+1],T=this.vertices[g].clone().normalize(),_=this.vertices[v].clone().normalize(),b=this.vertices[E].clone().normalize(),x=this.vertices[y].clone().normalize(),R=c[l][s+1].clone(),w=c[l][s].clone(),H=c[l+1][s].clone(),M=c[l+1][s+1].clone();Math.abs(this.vertices[g].y)===this.radius?(this.faces.push(new THREE.Face3(g,E,y,[T,b,x])),this.faceVertexUvs[0].push([R,H,M])):Math.abs(this.vertices[E].y)===this.radius?(this.faces.push(new THREE.Face3(g,v,E,[T,_,b])),this.faceVertexUvs[0].push([R,w,H])):(this.faces.push(new THREE.Face4(g,v,E,y,[T,_,b,x])),this.faceVertexUvs[0].push([R,w,H,M]))}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,e)},THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TextGeometry=function(e,t){t=t||{};var i=THREE.FontUtils.generateShapes(e,t);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),THREE.ExtrudeGeometry.call(this,i,t)},THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype),THREE.TorusGeometry=function(e,t,i,r,n){THREE.Geometry.call(this),this.radius=e||100,this.tube=t||40,this.radialSegments=i||8,this.tubularSegments=r||6,this.arc=n||2*Math.PI;for(var o=new THREE.Vector3,a=[],s=[],l=0;l<=this.radialSegments;l++)for(var h=0;h<=this.tubularSegments;h++){var c=h/this.tubularSegments*this.arc,u=2*l/this.radialSegments*Math.PI;o.x=this.radius*Math.cos(c),o.y=this.radius*Math.sin(c);var d=new THREE.Vector3;d.x=(this.radius+this.tube*Math.cos(u))*Math.cos(c),d.y=(this.radius+this.tube*Math.cos(u))*Math.sin(c),d.z=this.tube*Math.sin(u),this.vertices.push(d),a.push(new THREE.Vector2(h/this.tubularSegments,l/this.radialSegments)),s.push(d.clone().sub(o).normalize())}for(var l=1;l<=this.radialSegments;l++)for(var h=1;h<=this.tubularSegments;h++){var p=(this.tubularSegments+1)*l+h-1,f=(this.tubularSegments+1)*(l-1)+h-1,m=(this.tubularSegments+1)*(l-1)+h,g=(this.tubularSegments+1)*l+h,v=new THREE.Face4(p,f,m,g,[s[p],s[f],s[m],s[g]]);v.normal.add(s[p]),v.normal.add(s[f]),v.normal.add(s[m]),v.normal.add(s[g]),v.normal.normalize(),this.faces.push(v),this.faceVertexUvs[0].push([a[p].clone(),a[f].clone(),a[m].clone(),a[g].clone()])}this.computeCentroids()},THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusKnotGeometry=function(e,t,i,r,n,o,a){function s(e,t,i,r,n){var o=Math.cos(e),a=Math.sin(e),s=t/i*e,l=Math.cos(s),h=.5*r*(2+l)*o,c=.5*r*(2+l)*a,u=.5*n*r*Math.sin(s);return new THREE.Vector3(h,c,u)}THREE.Geometry.call(this);var l=this;this.radius=e||100,this.tube=t||40,this.radialSegments=i||64,this.tubularSegments=r||8,this.p=n||2,this.q=o||3,this.heightScale=a||1,this.grid=new Array(this.radialSegments);for(var h=new THREE.Vector3,c=new THREE.Vector3,u=new THREE.Vector3,d=0;d<this.radialSegments;++d){this.grid[d]=new Array(this.tubularSegments);var p=2*(d/this.radialSegments)*this.p*Math.PI,f=s(p,this.q,this.p,this.radius,this.heightScale),m=s(p+.01,this.q,this.p,this.radius,this.heightScale);h.subVectors(m,f),c.addVectors(m,f),u.crossVectors(h,c),c.crossVectors(u,h),u.normalize(),c.normalize();for(var g=0;g<this.tubularSegments;++g){var v=2*(g/this.tubularSegments)*Math.PI,E=-this.tube*Math.cos(v),y=this.tube*Math.sin(v),T=new THREE.Vector3;T.x=f.x+E*c.x+y*u.x,T.y=f.y+E*c.y+y*u.y,T.z=f.z+E*c.z+y*u.z,this.grid[d][g]=l.vertices.push(T)-1}}for(var d=0;d<this.radialSegments;++d)for(var g=0;g<this.tubularSegments;++g){var _=(d+1)%this.radialSegments,b=(g+1)%this.tubularSegments,x=this.grid[d][g],R=this.grid[_][g],w=this.grid[_][b],H=this.grid[d][b],M=new THREE.Vector2(d/this.radialSegments,g/this.tubularSegments),S=new THREE.Vector2((d+1)/this.radialSegments,g/this.tubularSegments),C=new THREE.Vector2((d+1)/this.radialSegments,(g+1)/this.tubularSegments),A=new THREE.Vector2(d/this.radialSegments,(g+1)/this.tubularSegments);this.faces.push(new THREE.Face4(x,R,w,H)),this.faceVertexUvs[0].push([M,S,C,A])}this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry=function(e,t,i,r,n){function o(e,t,i){return H.vertices.push(new THREE.Vector3(e,t,i))-1}THREE.Geometry.call(this),this.path=e,this.segments=t||64,this.radius=i||1,this.radialSegments=r||8,this.closed=n||!1,this.grid=[];var a,s,l,h,c,u,d,p,f,m,g,v,E,y,T,_,b,x,R,w,H=this,M=this.segments+1,S=new THREE.Vector3,C=new THREE.TubeGeometry.FrenetFrames(this.path,this.segments,this.closed),A=C.tangents,D=C.normals,P=C.binormals;for(this.tangents=A,this.normals=D,this.binormals=P,f=0;M>f;f++)for(this.grid[f]=[],h=f/(M-1),p=e.getPointAt(h),a=A[f],s=D[f],l=P[f],m=0;m<this.radialSegments;m++)c=2*(m/this.radialSegments)*Math.PI,u=-this.radius*Math.cos(c),d=this.radius*Math.sin(c),S.copy(p),S.x+=u*s.x+d*l.x,S.y+=u*s.y+d*l.y,S.z+=u*s.z+d*l.z,this.grid[f][m]=o(S.x,S.y,S.z);for(f=0;f<this.segments;f++)for(m=0;m<this.radialSegments;m++)g=this.closed?(f+1)%this.segments:f+1,v=(m+1)%this.radialSegments,E=this.grid[f][m],y=this.grid[g][m],T=this.grid[g][v],_=this.grid[f][v],b=new THREE.Vector2(f/this.segments,m/this.radialSegments),x=new THREE.Vector2((f+1)/this.segments,m/this.radialSegments),R=new THREE.Vector2((f+1)/this.segments,(m+1)/this.radialSegments),w=new THREE.Vector2(f/this.segments,(m+1)/this.radialSegments),this.faces.push(new THREE.Face4(E,y,T,_)),this.faceVertexUvs[0].push([b,x,R,w]);this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry.FrenetFrames=function(e,t,i){function r(){p[0]=new THREE.Vector3,f[0]=new THREE.Vector3,o=Number.MAX_VALUE,a=Math.abs(d[0].x),s=Math.abs(d[0].y),l=Math.abs(d[0].z),o>=a&&(o=a,u.set(1,0,0)),o>=s&&(o=s,u.set(0,1,0)),o>=l&&u.set(0,0,1),m.crossVectors(d[0],u).normalize(),p[0].crossVectors(d[0],m),f[0].crossVectors(d[0],p[0])}var n,o,a,s,l,h,c,u=(new THREE.Vector3,new THREE.Vector3),d=(new THREE.Vector3,[]),p=[],f=[],m=new THREE.Vector3,g=new THREE.Matrix4,v=t+1,E=1e-4;for(this.tangents=d,this.normals=p,this.binormals=f,h=0;v>h;h++)c=h/(v-1),d[h]=e.getTangentAt(c),d[h].normalize();for(r(),h=1;v>h;h++)p[h]=p[h-1].clone(),f[h]=f[h-1].clone(),m.crossVectors(d[h-1],d[h]),m.length()>E&&(m.normalize(),n=Math.acos(THREE.Math.clamp(d[h-1].dot(d[h]),-1,1)),p[h].applyMatrix4(g.makeRotationAxis(m,n))),f[h].crossVectors(d[h],p[h]);if(i)for(n=Math.acos(THREE.Math.clamp(p[0].dot(p[v-1]),-1,1)),n/=v-1,d[0].dot(m.crossVectors(p[0],p[v-1]))>0&&(n=-n),h=1;v>h;h++)p[h].applyMatrix4(g.makeRotationAxis(d[h],n*h)),f[h].crossVectors(d[h],p[h])},THREE.PolyhedronGeometry=function(e,t,i,r){function n(e){var t=e.normalize().clone();t.index=c.vertices.push(t)-1;var i=s(e)/2/Math.PI+.5,r=l(e)/Math.PI+.5;return t.uv=new THREE.Vector2(i,1-r),t}function o(e,t,i){var r=new THREE.Face3(e.index,t.index,i.index,[e.clone(),t.clone(),i.clone()]);r.centroid.add(e).add(t).add(i).divideScalar(3),c.faces.push(r);var n=s(r.centroid);c.faceVertexUvs[0].push([h(e.uv,e,n),h(t.uv,t,n),h(i.uv,i,n)])}function a(e,t){var i=Math.pow(2,t);Math.pow(4,t);for(var r=n(c.vertices[e.a]),a=n(c.vertices[e.b]),s=n(c.vertices[e.c]),l=[],h=0;i>=h;h++){l[h]=[];for(var u=n(r.clone().lerp(s,h/i)),d=n(a.clone().lerp(s,h/i)),p=i-h,f=0;p>=f;f++)l[h][f]=0==f&&h==i?u:n(u.clone().lerp(d,f/p))}for(var h=0;i>h;h++)for(var f=0;2*(i-h)-1>f;f++){var m=Math.floor(f/2);0==f%2?o(l[h][m+1],l[h+1][m],l[h][m]):o(l[h][m+1],l[h+1][m+1],l[h+1][m])}}function s(e){return Math.atan2(e.z,-e.x)}function l(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}function h(e,t,i){return 0>i&&1===e.x&&(e=new THREE.Vector2(e.x-1,e.y)),0===t.x&&0===t.z&&(e=new THREE.Vector2(i/2/Math.PI+.5,e.y)),e.clone()}THREE.Geometry.call(this),i=i||1,r=r||0;for(var c=this,u=0,d=e.length;d>u;u++)n(new THREE.Vector3(e[u][0],e[u][1],e[u][2]));for(var p=this.vertices,f=[],u=0,d=t.length;d>u;u++){var m=p[t[u][0]],g=p[t[u][1]],v=p[t[u][2]];f[u]=new THREE.Face3(m.index,g.index,v.index,[m.clone(),g.clone(),v.clone()])}for(var u=0,d=f.length;d>u;u++)a(f[u],r);for(var u=0,d=this.faceVertexUvs[0].length;d>u;u++){var E=this.faceVertexUvs[0][u],y=E[0].x,T=E[1].x,_=E[2].x,b=Math.max(y,Math.max(T,_)),x=Math.min(y,Math.min(T,_));b>.9&&.1>x&&(.2>y&&(E[0].x+=1),.2>T&&(E[1].x+=1),.2>_&&(E[2].x+=1))}for(var u=0,d=this.vertices.length;d>u;u++)this.vertices[u].multiplyScalar(i);this.mergeVertices(),this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,i)},THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.IcosahedronGeometry=function(e,t){this.radius=e,this.detail=t;var i=(1+Math.sqrt(5))/2,r=[[-1,i,0],[1,i,0],[-1,-i,0],[1,-i,0],[0,-1,i],[0,1,i],[0,-1,-i],[0,1,-i],[i,0,-1],[i,0,1],[-i,0,-1],[-i,0,1]],n=[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]];THREE.PolyhedronGeometry.call(this,r,n,e,t)},THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.OctahedronGeometry=function(e,t){var i=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],r=[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]];THREE.PolyhedronGeometry.call(this,i,r,e,t)},THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TetrahedronGeometry=function(e,t){var i=[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],r=[[2,1,0],[0,3,2],[1,3,0],[2,3,1]];THREE.PolyhedronGeometry.call(this,i,r,e,t)},THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ParametricGeometry=function(e,t,i,r){THREE.Geometry.call(this);var n=this.vertices,o=this.faces,a=this.faceVertexUvs[0];r=void 0===r?!1:r;var s,l,h,c,u,d=t+1;for(s=0;i>=s;s++)for(u=s/i,l=0;t>=l;l++)c=l/t,h=e(c,u),n.push(h);var p,f,m,g,v,E,y,T;for(s=0;i>s;s++)for(l=0;t>l;l++)p=s*d+l,f=s*d+l+1,m=(s+1)*d+l,g=(s+1)*d+l+1,v=new THREE.Vector2(l/t,s/i),E=new THREE.Vector2((l+1)/t,s/i),y=new THREE.Vector2(l/t,(s+1)/i),T=new THREE.Vector2((l+1)/t,(s+1)/i),r?(o.push(new THREE.Face3(p,f,m)),o.push(new THREE.Face3(f,g,m)),a.push([v,E,y]),a.push([E,T,y])):(o.push(new THREE.Face4(p,f,g,m)),a.push([v,E,T,y]));this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.AxisHelper=function(e){e=e||1;var t=new THREE.Geometry;t.vertices.push(new THREE.Vector3,new THREE.Vector3(e,0,0),new THREE.Vector3,new THREE.Vector3(0,e,0),new THREE.Vector3,new THREE.Vector3(0,0,e)),t.colors.push(new THREE.Color(16711680),new THREE.Color(16755200),new THREE.Color(65280),new THREE.Color(11206400),new THREE.Color(255),new THREE.Color(43775));var i=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,t,i,THREE.LinePieces)},THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype),THREE.ArrowHelper=function(e,t,i,r){THREE.Object3D.call(this),void 0===r&&(r=16776960),void 0===i&&(i=1),this.position=t;var n=new THREE.Geometry;n.vertices.push(new THREE.Vector3(0,0,0)),n.vertices.push(new THREE.Vector3(0,1,0)),this.line=new THREE.Line(n,new THREE.LineBasicMaterial({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line);var o=new THREE.CylinderGeometry(0,.05,.25,5,1);o.applyMatrix((new THREE.Matrix4).makeTranslation(0,.875,0)),this.cone=new THREE.Mesh(o,new THREE.MeshBasicMaterial({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i)},THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.ArrowHelper.prototype.setDirection=function(){var e,t=new THREE.Vector3;return function(i){i.y>.99999?this.quaternion.set(0,0,0,1):i.y<-.99999?this.quaternion.set(1,0,0,0):(t.set(i.z,0,-i.x).normalize(),e=Math.acos(i.y),this.quaternion.setFromAxisAngle(t,e))}}(),THREE.ArrowHelper.prototype.setLength=function(e){this.scale.set(e,e,e)},THREE.ArrowHelper.prototype.setColor=function(e){this.line.material.color.setHex(e),this.cone.material.color.setHex(e)},THREE.BoxHelper=function(e){var t=[new THREE.Vector3(1,1,1),new THREE.Vector3(-1,1,1),new THREE.Vector3(-1,-1,1),new THREE.Vector3(1,-1,1),new THREE.Vector3(1,1,-1),new THREE.Vector3(-1,1,-1),new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,-1,-1)];this.vertices=t;var i=new THREE.Geometry;i.vertices.push(t[0],t[1],t[1],t[2],t[2],t[3],t[3],t[0],t[4],t[5],t[5],t[6],t[6],t[7],t[7],t[4],t[0],t[4],t[1],t[5],t[2],t[6],t[3],t[7]),THREE.Line.call(this,i,new THREE.LineBasicMaterial({color:16776960}),THREE.LinePieces),void 0!==e&&this.update(e)},THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype),THREE.BoxHelper.prototype.update=function(e){var t=e.geometry;null===t.boundingBox&&t.computeBoundingBox();var i=t.boundingBox.min,r=t.boundingBox.max,n=this.vertices;n[0].set(r.x,r.y,r.z),n[1].set(i.x,r.y,r.z),n[2].set(i.x,i.y,r.z),n[3].set(r.x,i.y,r.z),n[4].set(r.x,r.y,i.z),n[5].set(i.x,r.y,i.z),n[6].set(i.x,i.y,i.z),n[7].set(r.x,i.y,i.z),this.geometry.computeBoundingSphere(),this.geometry.verticesNeedUpdate=!0,this.matrixAutoUpdate=!1,this.matrixWorld=e.matrixWorld},THREE.BoundingBoxHelper=function(e,t){var i=t||8947848;this.object=e,this.box=new THREE.Box3,THREE.Mesh.call(this,new THREE.CubeGeometry(1,1,1),new THREE.MeshBasicMaterial({color:i,wireframe:!0}))},THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},THREE.CameraHelper=function(e){function t(e,t,r){i(e,r),i(t,r)}function i(e,t){r.vertices.push(new THREE.Vector3),r.colors.push(new THREE.Color(t)),void 0===o[e]&&(o[e]=[]),o[e].push(r.vertices.length-1)}var r=new THREE.Geometry,n=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),o={},a=16755200,s=16711680,l=43775,h=16777215,c=3355443;t("n1","n2",a),t("n2","n4",a),t("n4","n3",a),t("n3","n1",a),t("f1","f2",a),t("f2","f4",a),t("f4","f3",a),t("f3","f1",a),t("n1","f1",a),t("n2","f2",a),t("n3","f3",a),t("n4","f4",a),t("p","n1",s),t("p","n2",s),t("p","n3",s),t("p","n4",s),t("u1","u2",l),t("u2","u3",l),t("u3","u1",l),t("c","t",h),t("p","c",c),t("cn1","cn2",c),t("cn3","cn4",c),t("cf1","cf2",c),t("cf3","cf4",c),THREE.Line.call(this,r,n,THREE.LinePieces),this.camera=e,this.matrixWorld=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()},THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype),THREE.CameraHelper.prototype.update=function(){var e=new THREE.Vector3,t=new THREE.Camera,i=new THREE.Projector;return function(){function r(r,o,a,s){e.set(o,a,s),i.unprojectVector(e,t);var l=n.pointMap[r];if(void 0!==l)for(var h=0,c=l.length;c>h;h++)n.geometry.vertices[l[h]].copy(e)}var n=this,o=1,a=1;t.projectionMatrix.copy(this.camera.projectionMatrix),r("c",0,0,-1),r("t",0,0,1),r("n1",-o,-a,-1),r("n2",o,-a,-1),r("n3",-o,a,-1),r("n4",o,a,-1),r("f1",-o,-a,1),r("f2",o,-a,1),r("f3",-o,a,1),r("f4",o,a,1),r("u1",.7*o,1.1*a,-1),r("u2",.7*-o,1.1*a,-1),r("u3",0,2*a,-1),r("cf1",-o,0,1),r("cf2",o,0,1),r("cf3",0,-a,1),r("cf4",0,a,1),r("cn1",-o,0,-1),r("cn2",o,0,-1),r("cn3",0,-a,-1),r("cn4",0,a,-1),this.geometry.verticesNeedUpdate=!0}}(),THREE.DirectionalLightHelper=function(e,t){THREE.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrixWorld=e.matrixWorld,this.matrixAutoUpdate=!1;var i=new THREE.PlaneGeometry(t,t),r=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});r.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new THREE.Mesh(i,r),this.add(this.lightPlane),i=new THREE.Geometry,i.vertices.push(new THREE.Vector3),i.vertices.push(new THREE.Vector3),i.computeLineDistances(),r=new THREE.LineBasicMaterial({fog:!1}),r.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new THREE.Line(i,r),this.add(this.targetLine),this.update()},THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.DirectionalLightHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){e.getPositionFromMatrix(this.light.matrixWorld).negate(),this.lightPlane.lookAt(e),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(e),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),THREE.FaceNormalsHelper=function(e,t,i,r){this.object=e,this.size=t||1;for(var n=i||16776960,o=r||1,a=new THREE.Geometry,s=this.object.geometry.faces,l=0,h=s.length;h>l;l++)a.vertices.push(new THREE.Vector3),a.vertices.push(new THREE.Vector3);THREE.Line.call(this,a,new THREE.LineBasicMaterial({color:n,linewidth:o}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new THREE.Matrix3,this.update()},THREE.FaceNormalsHelper.prototype=Object.create(THREE.Line.prototype),THREE.FaceNormalsHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){this.object.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var t=this.geometry.vertices,i=this.object.geometry.faces,r=this.object.matrixWorld,n=0,o=i.length;o>n;n++){var a=i[n];e.copy(a.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);var s=2*n;t[s].copy(a.centroid).applyMatrix4(r),t[s+1].addVectors(t[s],e)}return this.geometry.verticesNeedUpdate=!0,this}}(),THREE.GridHelper=function(e,t){var i=new THREE.Geometry,r=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924),this.color2=new THREE.Color(8947848);for(var n=-e;e>=n;n+=t){i.vertices.push(new THREE.Vector3(-e,0,n),new THREE.Vector3(e,0,n),new THREE.Vector3(n,0,-e),new THREE.Vector3(n,0,e));var o=0===n?this.color1:this.color2;i.colors.push(o,o,o,o)}THREE.Line.call(this,i,r,THREE.LinePieces)},THREE.GridHelper.prototype=Object.create(THREE.Line.prototype),THREE.GridHelper.prototype.setColors=function(e,t){this.color1.set(e),this.color2.set(t),this.geometry.colorsNeedUpdate=!0},THREE.HemisphereLightHelper=function(e,t){THREE.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrixWorld=e.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new THREE.Color,new THREE.Color];var i=new THREE.SphereGeometry(t,4,2);i.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(var r=0,n=8;n>r;r++)i.faces[r].color=this.colors[4>r?0:1];var o=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0});this.lightSphere=new THREE.Mesh(i,o),this.add(this.lightSphere),this.update()},THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.HemisphereLightHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(e.getPositionFromMatrix(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),THREE.PointLightHelper=function(e,t){this.light=e,this.light.updateMatrixWorld();var i=new THREE.SphereGeometry(t,4,2),r=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});r.color.copy(this.light.color).multiplyScalar(this.light.intensity),THREE.Mesh.call(this,i,r),this.matrixWorld=this.light.matrixWorld,this.matrixAutoUpdate=!1},THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},THREE.SpotLightHelper=function(e){THREE.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrixWorld=e.matrixWorld,this.matrixAutoUpdate=!1;var t=new THREE.CylinderGeometry(0,1,1,8,1,!0);t.applyMatrix((new THREE.Matrix4).makeTranslation(0,-.5,0)),t.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));var i=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(t,i),this.add(this.cone),this.update()},THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.SpotLightHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){var t=this.light.distance?this.light.distance:1e4,i=t*Math.tan(this.light.angle);this.cone.scale.set(i,i,t),this.cone.lookAt(e.getPositionFromMatrix(this.light.matrixWorld).negate()),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),THREE.VertexNormalsHelper=function(e,t,i,r){this.object=e,this.size=t||1;var n=i||16711680,o=r||1,a=new THREE.Geometry;e.geometry.vertices;for(var s=e.geometry.faces,l=0,h=s.length;h>l;l++)for(var c=s[l],u=0,d=c.vertexNormals.length;d>u;u++)a.vertices.push(new THREE.Vector3),a.vertices.push(new THREE.Vector3);THREE.Line.call(this,a,new THREE.LineBasicMaterial({color:n,linewidth:o}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new THREE.Matrix3,this.update()},THREE.VertexNormalsHelper.prototype=Object.create(THREE.Line.prototype),THREE.VertexNormalsHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){var t=["a","b","c","d"];this.object.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var i=this.geometry.vertices,r=this.object.geometry.vertices,n=this.object.geometry.faces,o=this.object.matrixWorld,a=0,s=0,l=n.length;l>s;s++)for(var h=n[s],c=0,u=h.vertexNormals.length;u>c;c++){var d=h[t[c]],p=r[d],f=h.vertexNormals[c];i[a].copy(p).applyMatrix4(o),e.copy(f).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size),e.add(i[a]),a+=1,i[a].copy(e),a+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),THREE.VertexTangentsHelper=function(e,t,i,r){this.object=e,this.size=t||1;var n=i||255,o=r||1,a=new THREE.Geometry;e.geometry.vertices;for(var s=e.geometry.faces,l=0,h=s.length;h>l;l++)for(var c=s[l],u=0,d=c.vertexTangents.length;d>u;u++)a.vertices.push(new THREE.Vector3),a.vertices.push(new THREE.Vector3);THREE.Line.call(this,a,new THREE.LineBasicMaterial({color:n,linewidth:o}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.update()},THREE.VertexTangentsHelper.prototype=Object.create(THREE.Line.prototype),THREE.VertexTangentsHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){var t=["a","b","c","d"];this.object.updateMatrixWorld(!0);for(var i=this.geometry.vertices,r=this.object.geometry.vertices,n=this.object.geometry.faces,o=this.object.matrixWorld,a=0,s=0,l=n.length;l>s;s++)for(var h=n[s],c=0,u=h.vertexTangents.length;u>c;c++){var d=h[t[c]],p=r[d],f=h.vertexTangents[c];i[a].copy(p).applyMatrix4(o),e.copy(f).transformDirection(o).multiplyScalar(this.size),e.add(i[a]),a+=1,i[a].copy(e),a+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),THREE.WireframeHelper=function(e){for(var t=[0,0],i={},r=function(e,t){return e-t},n=["a","b","c","d"],o=new THREE.Geometry,a=e.geometry.vertices,s=e.geometry.faces,l=0,h=s.length;h>l;l++)for(var c=s[l],u=c instanceof THREE.Face4?4:3,d=0;u>d;d++){t[0]=c[n[d]],t[1]=c[n[(d+1)%u]],t.sort(r);var p=t.toString();void 0===i[p]&&(o.vertices.push(a[t[0]]),o.vertices.push(a[t[1]]),i[p]=!0)
}THREE.Line.call(this,o,new THREE.LineBasicMaterial({color:16777215}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.matrixWorld=e.matrixWorld},THREE.WireframeHelper.prototype=Object.create(THREE.Line.prototype),THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this),this.render=function(){}},THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare=function(e,t,i,r,n){THREE.Object3D.call(this),this.lensFlares=[],this.positionScreen=new THREE.Vector3,this.customUpdateCallback=void 0,void 0!==e&&this.add(e,t,i,r,n)},THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare.prototype.add=function(e,t,i,r,n,o){void 0===t&&(t=-1),void 0===i&&(i=0),void 0===o&&(o=1),void 0===n&&(n=new THREE.Color(16777215)),void 0===r&&(r=THREE.NormalBlending),i=Math.min(i,Math.max(0,i)),this.lensFlares.push({texture:e,size:t,distance:i,x:0,y:0,z:0,scale:1,rotation:1,opacity:o,color:n,blending:r})},THREE.LensFlare.prototype.updateLensFlares=function(){var e,t,i=this.lensFlares.length,r=2*-this.positionScreen.x,n=2*-this.positionScreen.y;for(e=0;i>e;e++)t=this.lensFlares[e],t.x=this.positionScreen.x+r*t.distance,t.y=this.positionScreen.y+n*t.distance,t.wantedRotation=.25*t.x*Math.PI,t.rotation+=.25*(t.wantedRotation-t.rotation)},THREE.MorphBlendMesh=function(e,t){THREE.Mesh.call(this,e,t),this.animationsMap={},this.animationsList=[];var i=this.geometry.morphTargets.length,r="__default",n=0,o=i-1,a=i/1;this.createAnimation(r,n,o,a),this.setAnimationWeight(r,1)},THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphBlendMesh.prototype.createAnimation=function(e,t,i,r){var n={startFrame:t,endFrame:i,length:i-t+1,fps:r,duration:(i-t)/r,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=n,this.animationsList.push(n)},THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(e){for(var t,i=/([a-z]+)(\d+)/,r={},n=this.geometry,o=0,a=n.morphTargets.length;a>o;o++){var s=n.morphTargets[o],l=s.name.match(i);if(l&&l.length>1){var h=l[1];l[2],r[h]||(r[h]={start:1/0,end:-1/0});var c=r[h];o<c.start&&(c.start=o),o>c.end&&(c.end=o),t||(t=h)}}for(var h in r){var c=r[h];this.createAnimation(h,c.start,c.end,e)}this.firstAnimation=t},THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(e){var t=this.animationsMap[e];t&&(t.direction=1,t.directionBackwards=!1)},THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(e){var t=this.animationsMap[e];t&&(t.direction=-1,t.directionBackwards=!0)},THREE.MorphBlendMesh.prototype.setAnimationFPS=function(e,t){var i=this.animationsMap[e];i&&(i.fps=t,i.duration=(i.end-i.start)/i.fps)},THREE.MorphBlendMesh.prototype.setAnimationDuration=function(e,t){var i=this.animationsMap[e];i&&(i.duration=t,i.fps=(i.end-i.start)/i.duration)},THREE.MorphBlendMesh.prototype.setAnimationWeight=function(e,t){var i=this.animationsMap[e];i&&(i.weight=t)},THREE.MorphBlendMesh.prototype.setAnimationTime=function(e,t){var i=this.animationsMap[e];i&&(i.time=t)},THREE.MorphBlendMesh.prototype.getAnimationTime=function(e){var t=0,i=this.animationsMap[e];return i&&(t=i.time),t},THREE.MorphBlendMesh.prototype.getAnimationDuration=function(e){var t=-1,i=this.animationsMap[e];return i&&(t=i.duration),t},THREE.MorphBlendMesh.prototype.playAnimation=function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):console.warn("animation["+e+"] undefined")},THREE.MorphBlendMesh.prototype.stopAnimation=function(e){var t=this.animationsMap[e];t&&(t.active=!1)},THREE.MorphBlendMesh.prototype.update=function(e){for(var t=0,i=this.animationsList.length;i>t;t++){var r=this.animationsList[t];if(r.active){var n=r.duration/r.length;r.time+=r.direction*e,r.mirroredLoop?(r.time>r.duration||r.time<0)&&(r.direction*=-1,r.time>r.duration&&(r.time=r.duration,r.directionBackwards=!0),r.time<0&&(r.time=0,r.directionBackwards=!1)):(r.time=r.time%r.duration,r.time<0&&(r.time+=r.duration));var o=r.startFrame+THREE.Math.clamp(Math.floor(r.time/n),0,r.length-1),a=r.weight;o!==r.currentFrame&&(this.morphTargetInfluences[r.lastFrame]=0,this.morphTargetInfluences[r.currentFrame]=1*a,this.morphTargetInfluences[o]=0,r.lastFrame=r.currentFrame,r.currentFrame=o);var s=r.time%n/n;r.directionBackwards&&(s=1-s),this.morphTargetInfluences[r.currentFrame]=s*a,this.morphTargetInfluences[r.lastFrame]=(1-s)*a}}},THREE.LensFlarePlugin=function(){function e(e,i){var r=t.createProgram(),n=t.createShader(t.FRAGMENT_SHADER),o=t.createShader(t.VERTEX_SHADER),a="precision "+i+" float;\n";return t.shaderSource(n,a+e.fragmentShader),t.shaderSource(o,a+e.vertexShader),t.compileShader(n),t.compileShader(o),t.attachShader(r,n),t.attachShader(r,o),t.linkProgram(r),r}var t,i,r,n={};this.init=function(o){t=o.context,i=o,r=o.getPrecision(),n.vertices=new Float32Array(16),n.faces=new Uint16Array(6);var a=0;n.vertices[a++]=-1,n.vertices[a++]=-1,n.vertices[a++]=0,n.vertices[a++]=0,n.vertices[a++]=1,n.vertices[a++]=-1,n.vertices[a++]=1,n.vertices[a++]=0,n.vertices[a++]=1,n.vertices[a++]=1,n.vertices[a++]=1,n.vertices[a++]=1,n.vertices[a++]=-1,n.vertices[a++]=1,n.vertices[a++]=0,n.vertices[a++]=1,a=0,n.faces[a++]=0,n.faces[a++]=1,n.faces[a++]=2,n.faces[a++]=0,n.faces[a++]=2,n.faces[a++]=3,n.vertexBuffer=t.createBuffer(),n.elementBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,n.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,n.vertices,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.elementBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,n.faces,t.STATIC_DRAW),n.tempTexture=t.createTexture(),n.occlusionTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,n.tempTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGB,16,16,0,t.RGB,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.bindTexture(t.TEXTURE_2D,n.occlusionTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,16,16,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS)<=0?(n.hasVertexTexture=!1,n.program=e(THREE.ShaderFlares.lensFlare,r)):(n.hasVertexTexture=!0,n.program=e(THREE.ShaderFlares.lensFlareVertexTexture,r)),n.attributes={},n.uniforms={},n.attributes.vertex=t.getAttribLocation(n.program,"position"),n.attributes.uv=t.getAttribLocation(n.program,"uv"),n.uniforms.renderType=t.getUniformLocation(n.program,"renderType"),n.uniforms.map=t.getUniformLocation(n.program,"map"),n.uniforms.occlusionMap=t.getUniformLocation(n.program,"occlusionMap"),n.uniforms.opacity=t.getUniformLocation(n.program,"opacity"),n.uniforms.color=t.getUniformLocation(n.program,"color"),n.uniforms.scale=t.getUniformLocation(n.program,"scale"),n.uniforms.rotation=t.getUniformLocation(n.program,"rotation"),n.uniforms.screenPosition=t.getUniformLocation(n.program,"screenPosition")},this.render=function(e,r,o,a){var s=e.__webglFlares,l=s.length;if(l){var h=new THREE.Vector3,c=a/o,u=.5*o,d=.5*a,p=16/a,f=new THREE.Vector2(p*c,p),m=new THREE.Vector3(1,1,0),g=new THREE.Vector2(1,1),v=n.uniforms,E=n.attributes;t.useProgram(n.program),t.enableVertexAttribArray(n.attributes.vertex),t.enableVertexAttribArray(n.attributes.uv),t.uniform1i(v.occlusionMap,0),t.uniform1i(v.map,1),t.bindBuffer(t.ARRAY_BUFFER,n.vertexBuffer),t.vertexAttribPointer(E.vertex,2,t.FLOAT,!1,16,0),t.vertexAttribPointer(E.uv,2,t.FLOAT,!1,16,8),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.elementBuffer),t.disable(t.CULL_FACE),t.depthMask(!1);var y,T,_,b,x;for(y=0;l>y;y++)if(p=16/a,f.set(p*c,p),b=s[y],h.set(b.matrixWorld.elements[12],b.matrixWorld.elements[13],b.matrixWorld.elements[14]),h.applyMatrix4(r.matrixWorldInverse),h.applyProjection(r.projectionMatrix),m.copy(h),g.x=m.x*u+u,g.y=m.y*d+d,n.hasVertexTexture||g.x>0&&g.x<o&&g.y>0&&g.y<a)for(t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,n.tempTexture),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGB,g.x-8,g.y-8,16,16,0),t.uniform1i(v.renderType,0),t.uniform2f(v.scale,f.x,f.y),t.uniform3f(v.screenPosition,m.x,m.y,m.z),t.disable(t.BLEND),t.enable(t.DEPTH_TEST),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,n.occlusionTexture),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,g.x-8,g.y-8,16,16,0),t.uniform1i(v.renderType,1),t.disable(t.DEPTH_TEST),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,n.tempTexture),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),b.positionScreen.copy(m),b.customUpdateCallback?b.customUpdateCallback(b):b.updateLensFlares(),t.uniform1i(v.renderType,2),t.enable(t.BLEND),T=0,_=b.lensFlares.length;_>T;T++)x=b.lensFlares[T],x.opacity>.001&&x.scale>.001&&(m.x=x.x,m.y=x.y,m.z=x.z,p=x.size*x.scale/a,f.x=p*c,f.y=p,t.uniform3f(v.screenPosition,m.x,m.y,m.z),t.uniform2f(v.scale,f.x,f.y),t.uniform1f(v.rotation,x.rotation),t.uniform1f(v.opacity,x.opacity),t.uniform3f(v.color,x.color.r,x.color.g,x.color.b),i.setBlending(x.blending,x.blendEquation,x.blendSrc,x.blendDst),i.setTexture(x.texture,1),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0));t.enable(t.CULL_FACE),t.enable(t.DEPTH_TEST),t.depthMask(!0)}}},THREE.ShadowMapPlugin=function(){function e(e,t){var i=new THREE.DirectionalLight;i.isVirtual=!0,i.onlyShadow=!0,i.castShadow=!0,i.shadowCameraNear=e.shadowCameraNear,i.shadowCameraFar=e.shadowCameraFar,i.shadowCameraLeft=e.shadowCameraLeft,i.shadowCameraRight=e.shadowCameraRight,i.shadowCameraBottom=e.shadowCameraBottom,i.shadowCameraTop=e.shadowCameraTop,i.shadowCameraVisible=e.shadowCameraVisible,i.shadowDarkness=e.shadowDarkness,i.shadowBias=e.shadowCascadeBias[t],i.shadowMapWidth=e.shadowCascadeWidth[t],i.shadowMapHeight=e.shadowCascadeHeight[t],i.pointsWorld=[],i.pointsFrustum=[];for(var r=i.pointsWorld,n=i.pointsFrustum,o=0;8>o;o++)r[o]=new THREE.Vector3,n[o]=new THREE.Vector3;var a=e.shadowCascadeNearZ[t],s=e.shadowCascadeFarZ[t];return n[0].set(-1,-1,a),n[1].set(1,-1,a),n[2].set(-1,1,a),n[3].set(1,1,a),n[4].set(-1,-1,s),n[5].set(1,-1,s),n[6].set(-1,1,s),n[7].set(1,1,s),i}function t(e,t){var i=e.shadowCascadeArray[t];i.position.copy(e.position),i.target.position.copy(e.target.position),i.lookAt(i.target),i.shadowCameraVisible=e.shadowCameraVisible,i.shadowDarkness=e.shadowDarkness,i.shadowBias=e.shadowCascadeBias[t];var r=e.shadowCascadeNearZ[t],n=e.shadowCascadeFarZ[t],o=i.pointsFrustum;o[0].z=r,o[1].z=r,o[2].z=r,o[3].z=r,o[4].z=n,o[5].z=n,o[6].z=n,o[7].z=n}function i(e,t){var i=t.shadowCamera,r=t.pointsFrustum,n=t.pointsWorld;d.set(1/0,1/0,1/0),p.set(-1/0,-1/0,-1/0);for(var o=0;8>o;o++){var a=n[o];a.copy(r[o]),THREE.ShadowMapPlugin.__projector.unprojectVector(a,e),a.applyMatrix4(i.matrixWorldInverse),a.x<d.x&&(d.x=a.x),a.x>p.x&&(p.x=a.x),a.y<d.y&&(d.y=a.y),a.y>p.y&&(p.y=a.y),a.z<d.z&&(d.z=a.z),a.z>p.z&&(p.z=a.z)}i.left=d.x,i.right=p.x,i.top=p.y,i.bottom=d.y,i.updateProjectionMatrix()}function r(e){return e.material instanceof THREE.MeshFaceMaterial?e.material.materials[0]:e.material}var n,o,a,s,l,h,c=new THREE.Frustum,u=new THREE.Matrix4,d=new THREE.Vector3,p=new THREE.Vector3,f=new THREE.Vector3;this.init=function(e){n=e.context,o=e;var t=THREE.ShaderLib.depthRGBA,i=THREE.UniformsUtils.clone(t.uniforms);a=new THREE.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:i}),s=new THREE.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:i,morphTargets:!0}),l=new THREE.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:i,skinning:!0}),h=new THREE.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:i,morphTargets:!0,skinning:!0}),a._shadowPass=!0,s._shadowPass=!0,l._shadowPass=!0,h._shadowPass=!0},this.render=function(e,t){o.shadowMapEnabled&&o.shadowMapAutoUpdate&&this.update(e,t)},this.update=function(d,p){var m,g,v,E,y,T,_,b,x,R,w,H,M,S,C=[],A=0,D=null;for(n.clearColor(1,1,1,1),n.disable(n.BLEND),n.enable(n.CULL_FACE),n.frontFace(n.CCW),o.shadowMapCullFace===THREE.CullFaceFront?n.cullFace(n.FRONT):n.cullFace(n.BACK),o.setDepthTest(!0),m=0,g=d.__lights.length;g>m;m++)if(M=d.__lights[m],M.castShadow)if(M instanceof THREE.DirectionalLight&&M.shadowCascade)for(y=0;y<M.shadowCascadeCount;y++){var P;if(M.shadowCascadeArray[y])P=M.shadowCascadeArray[y];else{P=e(M,y),P.originalCamera=p;var L=new THREE.Gyroscope;L.position=M.shadowCascadeOffset,L.add(P),L.add(P.target),p.add(L),M.shadowCascadeArray[y]=P,console.log("Created virtualLight",P)}t(M,y),C[A]=P,A++}else C[A]=M,A++;for(m=0,g=C.length;g>m;m++){if(M=C[m],!M.shadowMap){var k=THREE.LinearFilter;o.shadowMapType===THREE.PCFSoftShadowMap&&(k=THREE.NearestFilter);var F={minFilter:k,magFilter:k,format:THREE.RGBAFormat};M.shadowMap=new THREE.WebGLRenderTarget(M.shadowMapWidth,M.shadowMapHeight,F),M.shadowMapSize=new THREE.Vector2(M.shadowMapWidth,M.shadowMapHeight),M.shadowMatrix=new THREE.Matrix4}if(!M.shadowCamera){if(M instanceof THREE.SpotLight)M.shadowCamera=new THREE.PerspectiveCamera(M.shadowCameraFov,M.shadowMapWidth/M.shadowMapHeight,M.shadowCameraNear,M.shadowCameraFar);else{if(!(M instanceof THREE.DirectionalLight)){console.error("Unsupported light type for shadow");continue}M.shadowCamera=new THREE.OrthographicCamera(M.shadowCameraLeft,M.shadowCameraRight,M.shadowCameraTop,M.shadowCameraBottom,M.shadowCameraNear,M.shadowCameraFar)}d.add(M.shadowCamera),d.autoUpdate===!0&&d.updateMatrixWorld()}for(M.shadowCameraVisible&&!M.cameraHelper&&(M.cameraHelper=new THREE.CameraHelper(M.shadowCamera),M.shadowCamera.add(M.cameraHelper)),M.isVirtual&&P.originalCamera==p&&i(p,M),T=M.shadowMap,_=M.shadowMatrix,b=M.shadowCamera,b.position.getPositionFromMatrix(M.matrixWorld),f.getPositionFromMatrix(M.target.matrixWorld),b.lookAt(f),b.updateMatrixWorld(),b.matrixWorldInverse.getInverse(b.matrixWorld),M.cameraHelper&&(M.cameraHelper.visible=M.shadowCameraVisible),M.shadowCameraVisible&&M.cameraHelper.update(),_.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),_.multiply(b.projectionMatrix),_.multiply(b.matrixWorldInverse),u.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse),c.setFromMatrix(u),o.setRenderTarget(T),o.clear(),S=d.__webglObjects,v=0,E=S.length;E>v;v++)w=S[v],H=w.object,w.render=!1,H.visible&&H.castShadow&&((H instanceof THREE.Mesh||H instanceof THREE.ParticleSystem)&&H.frustumCulled&&!c.intersectsObject(H)||(H._modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,H.matrixWorld),w.render=!0));var z,N,I;for(v=0,E=S.length;E>v;v++)w=S[v],w.render&&(H=w.object,x=w.buffer,z=r(H),N=H.geometry.morphTargets.length>0&&z.morphTargets,I=H instanceof THREE.SkinnedMesh&&z.skinning,R=H.customDepthMaterial?H.customDepthMaterial:I?N?h:l:N?s:a,x instanceof THREE.BufferGeometry?o.renderBufferDirect(b,d.__lights,D,R,x,H):o.renderBuffer(b,d.__lights,D,R,x,H));for(S=d.__webglObjectsImmediate,v=0,E=S.length;E>v;v++)w=S[v],H=w.object,H.visible&&H.castShadow&&(H._modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,H.matrixWorld),o.renderImmediateObject(b,d.__lights,D,a,H))}var O=o.getClearColor(),U=o.getClearAlpha();n.clearColor(O.r,O.g,O.b,U),n.enable(n.BLEND),o.shadowMapCullFace===THREE.CullFaceFront&&n.cullFace(n.BACK)}},THREE.ShadowMapPlugin.__projector=new THREE.Projector,THREE.SpritePlugin=function(){function e(e,t){var r=i.createProgram(),n=i.createShader(i.FRAGMENT_SHADER),o=i.createShader(i.VERTEX_SHADER),a="precision "+t+" float;\n";return i.shaderSource(n,a+e.fragmentShader),i.shaderSource(o,a+e.vertexShader),i.compileShader(n),i.compileShader(o),i.attachShader(r,n),i.attachShader(r,o),i.linkProgram(r),r}function t(e,t){return e.z!==t.z?t.z-e.z:t.id-e.id}var i,r,n,o={};this.init=function(t){i=t.context,r=t,n=t.getPrecision(),o.vertices=new Float32Array(16),o.faces=new Uint16Array(6);var a=0;o.vertices[a++]=-1,o.vertices[a++]=-1,o.vertices[a++]=0,o.vertices[a++]=0,o.vertices[a++]=1,o.vertices[a++]=-1,o.vertices[a++]=1,o.vertices[a++]=0,o.vertices[a++]=1,o.vertices[a++]=1,o.vertices[a++]=1,o.vertices[a++]=1,o.vertices[a++]=-1,o.vertices[a++]=1,o.vertices[a++]=0,o.vertices[a++]=1,a=0,o.faces[a++]=0,o.faces[a++]=1,o.faces[a++]=2,o.faces[a++]=0,o.faces[a++]=2,o.faces[a++]=3,o.vertexBuffer=i.createBuffer(),o.elementBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,o.vertexBuffer),i.bufferData(i.ARRAY_BUFFER,o.vertices,i.STATIC_DRAW),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,o.elementBuffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,o.faces,i.STATIC_DRAW),o.program=e(THREE.ShaderSprite.sprite,n),o.attributes={},o.uniforms={},o.attributes.position=i.getAttribLocation(o.program,"position"),o.attributes.uv=i.getAttribLocation(o.program,"uv"),o.uniforms.uvOffset=i.getUniformLocation(o.program,"uvOffset"),o.uniforms.uvScale=i.getUniformLocation(o.program,"uvScale"),o.uniforms.rotation=i.getUniformLocation(o.program,"rotation"),o.uniforms.scale=i.getUniformLocation(o.program,"scale"),o.uniforms.alignment=i.getUniformLocation(o.program,"alignment"),o.uniforms.color=i.getUniformLocation(o.program,"color"),o.uniforms.map=i.getUniformLocation(o.program,"map"),o.uniforms.opacity=i.getUniformLocation(o.program,"opacity"),o.uniforms.useScreenCoordinates=i.getUniformLocation(o.program,"useScreenCoordinates"),o.uniforms.sizeAttenuation=i.getUniformLocation(o.program,"sizeAttenuation"),o.uniforms.screenPosition=i.getUniformLocation(o.program,"screenPosition"),o.uniforms.modelViewMatrix=i.getUniformLocation(o.program,"modelViewMatrix"),o.uniforms.projectionMatrix=i.getUniformLocation(o.program,"projectionMatrix"),o.uniforms.fogType=i.getUniformLocation(o.program,"fogType"),o.uniforms.fogDensity=i.getUniformLocation(o.program,"fogDensity"),o.uniforms.fogNear=i.getUniformLocation(o.program,"fogNear"),o.uniforms.fogFar=i.getUniformLocation(o.program,"fogFar"),o.uniforms.fogColor=i.getUniformLocation(o.program,"fogColor"),o.uniforms.alphaTest=i.getUniformLocation(o.program,"alphaTest")},this.render=function(e,n,a,s){var l=e.__webglSprites,h=l.length;if(h){var c=o.attributes,u=o.uniforms,d=s/a,p=.5*a,f=.5*s;i.useProgram(o.program),i.enableVertexAttribArray(c.position),i.enableVertexAttribArray(c.uv),i.disable(i.CULL_FACE),i.enable(i.BLEND),i.bindBuffer(i.ARRAY_BUFFER,o.vertexBuffer),i.vertexAttribPointer(c.position,2,i.FLOAT,!1,16,0),i.vertexAttribPointer(c.uv,2,i.FLOAT,!1,16,8),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,o.elementBuffer),i.uniformMatrix4fv(u.projectionMatrix,!1,n.projectionMatrix.elements),i.activeTexture(i.TEXTURE0),i.uniform1i(u.map,0);var m=0,g=0,v=e.fog;v?(i.uniform3f(u.fogColor,v.color.r,v.color.g,v.color.b),v instanceof THREE.Fog?(i.uniform1f(u.fogNear,v.near),i.uniform1f(u.fogFar,v.far),i.uniform1i(u.fogType,1),m=1,g=1):v instanceof THREE.FogExp2&&(i.uniform1f(u.fogDensity,v.density),i.uniform1i(u.fogType,2),m=2,g=2)):(i.uniform1i(u.fogType,0),m=0,g=0);var E,y,T,_,b,x=[];for(E=0;h>E;E++)y=l[E],T=y.material,y.visible&&0!==T.opacity&&(T.useScreenCoordinates?y.z=-y.position.z:(y._modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,y.matrixWorld),y.z=-y._modelViewMatrix.elements[14]));for(l.sort(t),E=0;h>E;E++)y=l[E],T=y.material,y.visible&&0!==T.opacity&&T.map&&T.map.image&&T.map.image.width&&(i.uniform1f(u.alphaTest,T.alphaTest),T.useScreenCoordinates===!0?(i.uniform1i(u.useScreenCoordinates,1),i.uniform3f(u.screenPosition,(y.position.x*r.devicePixelRatio-p)/p,(f-y.position.y*r.devicePixelRatio)/f,Math.max(0,Math.min(1,y.position.z))),x[0]=r.devicePixelRatio,x[1]=r.devicePixelRatio):(i.uniform1i(u.useScreenCoordinates,0),i.uniform1i(u.sizeAttenuation,T.sizeAttenuation?1:0),i.uniformMatrix4fv(u.modelViewMatrix,!1,y._modelViewMatrix.elements),x[0]=1,x[1]=1),b=e.fog&&T.fog?g:0,m!==b&&(i.uniform1i(u.fogType,b),m=b),_=1/(T.scaleByViewport?s:1),x[0]*=_*d*y.scale.x,x[1]*=_*y.scale.y,i.uniform2f(u.uvScale,T.uvScale.x,T.uvScale.y),i.uniform2f(u.uvOffset,T.uvOffset.x,T.uvOffset.y),i.uniform2f(u.alignment,T.alignment.x,T.alignment.y),i.uniform1f(u.opacity,T.opacity),i.uniform3f(u.color,T.color.r,T.color.g,T.color.b),i.uniform1f(u.rotation,y.rotation),i.uniform2fv(u.scale,x),r.setBlending(T.blending,T.blendEquation,T.blendSrc,T.blendDst),r.setDepthTest(T.depthTest),r.setDepthWrite(T.depthWrite),r.setTexture(T.map,0),i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0));i.enable(i.CULL_FACE)}}},THREE.DepthPassPlugin=function(){function e(e){return e.material instanceof THREE.MeshFaceMaterial?e.material.materials[0]:e.material}this.enabled=!1,this.renderTarget=null;var t,i,r,n,o,a,s=new THREE.Frustum,l=new THREE.Matrix4;this.init=function(e){t=e.context,i=e;var s=THREE.ShaderLib.depthRGBA,l=THREE.UniformsUtils.clone(s.uniforms);r=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l}),n=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l,morphTargets:!0}),o=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l,skinning:!0}),a=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l,morphTargets:!0,skinning:!0}),r._shadowPass=!0,n._shadowPass=!0,o._shadowPass=!0,a._shadowPass=!0},this.render=function(e,t){this.enabled&&this.update(e,t)},this.update=function(h,c){var u,d,p,f,m,g,v,E=null;for(t.clearColor(1,1,1,1),t.disable(t.BLEND),i.setDepthTest(!0),h.autoUpdate===!0&&h.updateMatrixWorld(),c.matrixWorldInverse.getInverse(c.matrixWorld),l.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),s.setFromMatrix(l),i.setRenderTarget(this.renderTarget),i.clear(),v=h.__webglObjects,u=0,d=v.length;d>u;u++)m=v[u],g=m.object,m.render=!1,g.visible&&((g instanceof THREE.Mesh||g instanceof THREE.ParticleSystem)&&g.frustumCulled&&!s.intersectsObject(g)||(g._modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,g.matrixWorld),m.render=!0));var y,T,_;for(u=0,d=v.length;d>u;u++)if(m=v[u],m.render){if(g=m.object,p=m.buffer,g instanceof THREE.ParticleSystem&&!g.customDepthMaterial)continue;y=e(g),y&&i.setMaterialFaces(g.material),T=g.geometry.morphTargets.length>0&&y.morphTargets,_=g instanceof THREE.SkinnedMesh&&y.skinning,f=g.customDepthMaterial?g.customDepthMaterial:_?T?a:o:T?n:r,p instanceof THREE.BufferGeometry?i.renderBufferDirect(c,h.__lights,E,f,p,g):i.renderBuffer(c,h.__lights,E,f,p,g)}for(v=h.__webglObjectsImmediate,u=0,d=v.length;d>u;u++)m=v[u],g=m.object,g.visible&&(g._modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,g.matrixWorld),i.renderImmediateObject(c,h.__lights,E,r,g));var b=i.getClearColor(),x=i.getClearAlpha();t.clearColor(b.r,b.g,b.b,x),t.enable(t.BLEND)}},THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},lensFlare:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}},THREE.ShaderSprite={sprite:{vertexShader:["uniform int useScreenCoordinates;","uniform int sizeAttenuation;","uniform vec3 screenPosition;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 alignment;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position + alignment;","vec2 rotatedPosition;","rotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;","rotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;","vec4 finalPosition;","if( useScreenCoordinates != 0 ) {","finalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );","} else {","finalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition * ( sizeAttenuation == 1 ? 1.0 : finalPosition.z );","}","gl_Position = finalPosition;","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")}},define("libs/threejs/build/three",function(){}),define("geometry/cubeframe",["libs/threejs/build/three"],function(){function e(e,t){return 0!=(e&1<<t)}var t=function(e,t,i,r,n,o,a,s,l){function h(e,t,i,r,n,o,a,s,l,h){var u,d,p,f=c.widthSegments,m=c.heightSegments,g=n/2,v=o/2,E=c.vertices.length;"x"===e&&"y"===t||"y"===e&&"x"===t?u="z":"x"===e&&"z"===t||"z"===e&&"x"===t?(u="y",m=c.depthSegments):("z"===e&&"y"===t||"y"===e&&"z"===t)&&(u="x",f=c.depthSegments);var y=f+1,T=m+1,_=n/f,b=o/m,x=new THREE.Vector3;for(x[u]=a>0?1:-1,p=0;T>p;p++)for(d=0;y>d;d++){var R=new THREE.Vector3;R[e]=(d*_-g)*i,R[t]=(p*b-v)*r,R[u]=a,c.vertices.push(R)}for(p=0;m>p;p++)for(d=0;f>d;d++){var w=d+y*p,H=d+y*(p+1),M=d+1+y*(p+1),S=d+1+y*p,C=new THREE.Face4(w+E,H+E,M+E,S+E);C.normal.copy(x),C.vertexNormals.push(x.clone(),x.clone(),x.clone(),x.clone()),C.materialIndex=s,c.faces.push(C),c.faceVertexUvs[0].push([new THREE.Vector2(d/f*l,1-p/m*h),new THREE.Vector2(d/f*l,1-(p+1)/m*h),new THREE.Vector2((d+1)/f*l,1-(p+1)/m*h),new THREE.Vector2((d+1)/f*l,1-p/m*h)])}}THREE.Geometry.call(this);var c=this;this.width=e,this.height=t,this.depth=i,this.widthSegments=a||1,this.heightSegments=s||1,this.depthSegments=l||1,r=r||1,n=n||1,o=o||1;var u=this.width/2,d=this.height/2,p=this.depth/2;h("z","y",-1,-1,this.depth,this.height,u,0,o,n),h("z","y",1,-1,this.depth,this.height,-u,1,o,n),h("x","z",1,1,this.width,this.depth,d,2,r,o),h("x","z",1,-1,this.width,this.depth,-d,3,r,o),h("x","y",1,-1,this.width,this.height,p,4,r,n),h("x","y",-1,-1,this.width,this.height,-p,5,r,n),this.computeCentroids(),this.mergeVertices()};return t.prototype=Object.create(THREE.Geometry.prototype),function(i,r,n,o,a,s,l,h,c){var u=a/o,d={w:new THREE.Mesh(new t(i-o,o,o,1,1,1)),h:new THREE.Mesh(new t(a,r-o,a,u,1,u)),d:new THREE.Mesh(new t(o,o,n-o,1,1,1))},p=new THREE.Mesh(new THREE.CubeGeometry(o,o,o));hw=.5*i,hh=.5*r,hd=.5*n,cube=new THREE.Mesh(THREE.Geometry()),d.d.geometry.faces=d.d.geometry.faces.slice(0,4),d.w.geometry.faces=d.w.geometry.faces.slice(2),d.h.geometry.faces.splice(2,2),d.w.position.set(0,-hh,-hd),e(s,0)&&THREE.GeometryUtils.merge(cube.geometry,d.w),d.w.position.set(0,-hh,hd),!e(c,0)&&e(s,1)&&THREE.GeometryUtils.merge(cube.geometry,d.w),d.w.position.set(0,hh,hd),e(h,1)||e(c,3)||!e(s,2)||THREE.GeometryUtils.merge(cube.geometry,d.w),d.w.position.set(0,hh,-hd),!e(h,0)&&e(s,3)&&THREE.GeometryUtils.merge(cube.geometry,d.w),d.h.position.set(-hw,0,-hd),e(s,4)&&THREE.GeometryUtils.merge(cube.geometry,d.h),d.h.position.set(hw,0,-hd),!e(l,4)&&e(s,5)&&THREE.GeometryUtils.merge(cube.geometry,d.h),d.h.position.set(hw,0,hd),e(c,5)||e(l,7)||!e(s,6)||THREE.GeometryUtils.merge(cube.geometry,d.h),d.h.position.set(-hw,0,hd),!e(c,4)&&e(s,7)&&THREE.GeometryUtils.merge(cube.geometry,d.h),d.d.position.set(-hw,-hh,0),e(s,8)&&THREE.GeometryUtils.merge(cube.geometry,d.d),d.d.position.set(hw,-hh,0),!e(l,8)&&e(s,9)&&THREE.GeometryUtils.merge(cube.geometry,d.d),d.d.position.set(hw,hh,0),e(h,9)||e(l,11)||!e(s,10)||THREE.GeometryUtils.merge(cube.geometry,d.d),d.d.position.set(-hw,hh,0),!e(h,8)&&e(s,11)&&THREE.GeometryUtils.merge(cube.geometry,d.d);var f=.5*Math.PI;return p.position.set(-hw,-hh,-hd),(e(s,0)||e(s,8)||e(s,4))&&THREE.GeometryUtils.merge(cube.geometry,p),p.position.set(hw,-hh,-hd),p.rotation.y-=f,(e(s,0)||e(s,9)||e(s,5)&&!(e(l,0)||e(l,8)||e(l,4)))&&THREE.GeometryUtils.merge(cube.geometry,p),p.position.set(hw,-hh,hd),p.rotation.y-=f,!e(s,1)&&!e(s,9)&&(!e(s,6)||e(l,8)||e(l,7)||e(l,9)||e(c,0)||e(c,5)||e(c,9))||THREE.GeometryUtils.merge(cube.geometry,p),p.position.set(-hw,-hh,hd),p.rotation.y-=f,(e(s,1)||e(s,8)||e(s,7)&&!(e(c,0)||e(c,4)||e(c,8)))&&THREE.GeometryUtils.merge(cube.geometry,p),p.position.set(-hw,hh,-hd),(e(s,3)||e(s,11)||e(s,4)&&!(e(h,0)||e(h,4)||e(h,8)))&&THREE.GeometryUtils.merge(cube.geometry,p),p.position.set(hw,hh,-hd),p.rotation.y+=f,!e(s,3)&&!e(s,10)&&(!e(s,5)||e(l,4)||e(l,3)||e(l,11)||e(h,0)||e(h,5)||e(h,3))||THREE.GeometryUtils.merge(cube.geometry,p),p.position.set(hw,hh,hd),p.rotation.y+=f,!e(s,2)&&!e(s,10)&&(!e(s,6)||e(l,2)||e(l,7)||e(l,11)||e(h,1)||e(h,6)||e(h,9)||e(c,10)||e(c,3)||e(c,5))||THREE.GeometryUtils.merge(cube.geometry,p),p.position.set(-hw,hh,hd),p.rotation.y+=f,!e(s,2)&&!e(s,11)&&(!e(s,7)||e(h,8)||e(h,1)||e(h,7)||e(c,4)||e(c,3)||e(c,11))||THREE.GeometryUtils.merge(cube.geometry,p),cube.geometry
}}),define("structure",["utils/noise","geometry/cubeframe","utils/math"],function(e,t,i){var r={DIMENSION:30,SCALE:100},n=function(n,o,a,s,l,h){for(var c,u,d,p,f,m,g,v,E=e.noise3D(r.DIMENSION,r.DIMENSION,r.DIMENSION,n,o,a),y=.5*r.DIMENSION,T=r.DIMENSION,_=new THREE.Geometry,b=[],x=[],d=new THREE.Mesh,R=Math.pow(2,12)-1,w=[];T-->0;)for(w[T]=[],u=r.DIMENSION;u-->0;)for(w[T][u]=[],c=r.DIMENSION;c-->0;)w[T][u][c]=0,p=E(c,u,T),p>s?(f=0|i.random(1,R),w[T][u][c]=f,m=w[T][u][c+1]||0,g=w[T][u+1]?w[T][u+1][c]||0:0,v=w[T+1]&&w[T+1][u]?w[T+1][u][c]||0:0,b.push([c,u,T]),d.geometry=t(r.SCALE,r.SCALE,r.SCALE,l,h,f,m,g,v),d.position.set(-y+c,-y+u,-y+T),d.position.multiplyScalar(r.SCALE),THREE.GeometryUtils.merge(_,d)):x.push([c,u,T]);return{geometry:_,volume:b,empty:x}};return n.grid=r,n}),define("utils/timer",[],function(){var e={now:function(){return window.performance&&window.performance.now?performance.now()+performance.timing.navigationStart:Date.now()},isHighPrecision:function(){return e.now()<1e12}};return e}),THREE.TransformControls=function(e,t,i){function r(e){if(0===e.button&&u.active===!1){var t=l(e,X[u.mode].children);t?ut!==t.object&&(u.hovered=!0,null!==ut&&(ut.material.color.copy(dt),ut.material.opacity=pt),ut=t.object,dt.copy(ut.material.color),pt=ut.material.opacity,ut.material.color.setRGB(1,1,0),ut.material.opacity=1,u.dispatchEvent(d)):null!==ut&&(ut.material.color.copy(dt),ut.material.opacity=pt,ut=null,u.hovered=!1,u.dispatchEvent(d))}u.document.addEventListener("mousemove",o,!1),u.document.addEventListener("mouseup",a,!1)}function n(e){if(0===e.button){var t=l(e,X[u.mode].children);if(t){u.active=t.object.name,u.update(),u.setIntersectionPlane();var i=l(e,[Y[K]]);i&&(F.copy(u.object.position),z.copy(u.object.scale),N.extractRotation(u.object.matrix),B.extractRotation(u.object.matrixWorld),I.extractRotation(u.object.parent.matrixWorld),O.getScaleFromMatrix(R.getInverse(u.object.parent.matrixWorld)),E.copy(i.point))}}u.document.addEventListener("mousemove",o,!1),u.document.addEventListener("mouseup",a,!1)}function o(e){if(u.active){var t=l(e,[Y[K]]);t&&(v.copy(t.point),"translate"==u.mode&&h("T")?(v.sub(E),v.multiply(O),"local"==u.space&&(v.applyMatrix4(R.getInverse(B)),h("X")&&1==u.modifierAxis.x||(v.x=0),h("Y")&&1==u.modifierAxis.y||(v.y=0),h("Z")&&1==u.modifierAxis.z||(v.z=0),h("XYZ")&&v.set(0,0,0),v.applyMatrix4(N),u.object.position.copy(F),u.object.position.add(v)),("world"==u.space||h("XYZ"))&&(h("X")&&1==u.modifierAxis.x||(v.x=0),h("Y")&&1==u.modifierAxis.y||(v.y=0),h("Z")&&1==u.modifierAxis.z||(v.z=0),v.applyMatrix4(R.getInverse(I)),u.object.position.copy(F),u.object.position.add(v),u.snapDist&&(h("X")&&(u.object.position.x=Math.round(u.object.position.x/u.snapDist)*u.snapDist),h("Y")&&(u.object.position.y=Math.round(u.object.position.y/u.snapDist)*u.snapDist),h("Z")&&(u.object.position.z=Math.round(u.object.position.z/u.snapDist)*u.snapDist)))):"scale"==u.mode&&h("S")?(v.sub(E),v.multiply(O),"local"==u.space&&(h("XYZ")?(_=1+v.y/50,u.object.scale.x=z.x*_,u.object.scale.y=z.y*_,u.object.scale.z=z.z*_):(v.applyMatrix4(R.getInverse(B)),h("X")&&1==u.modifierAxis.x||(v.x=0),h("Y")&&1==u.modifierAxis.y||(v.y=0),h("Z")&&1==u.modifierAxis.z||(v.z=0),h("X")&&(u.object.scale.x=z.x*(1+v.x/50)),h("Y")&&(u.object.scale.y=z.y*(1+v.y/50)),h("Z")&&(u.object.scale.z=z.z*(1+v.z/50))))):"rotate"==u.mode&&h("R")&&(v.sub(U),v.multiply(O),w.copy(E).sub(U),w.multiply(O),"RE"==u.active?(v.applyMatrix4(R.getInverse(b)),w.applyMatrix4(R.getInverse(b)),y.set(Math.atan2(v.z,v.y),Math.atan2(v.x,v.z),Math.atan2(v.y,v.x)),T.set(Math.atan2(w.z,w.y),Math.atan2(w.x,w.z),Math.atan2(w.y,w.x)),H.setFromRotationMatrix(R.getInverse(I)),k.setFromAxisAngle(x,y.z-T.z),A.setFromRotationMatrix(B),H.multiplyQuaternions(H,k),H.multiplyQuaternions(H,A),u.object.quaternion.copy(H)):"RXYZE"==u.active?(k.setFromEuler(v.clone().cross(w).normalize()),H.setFromRotationMatrix(R.getInverse(I)),D.setFromAxisAngle(k,-v.clone().angleTo(w)),A.setFromRotationMatrix(B),H.multiplyQuaternions(H,D),H.multiplyQuaternions(H,A),u.object.quaternion.copy(H)):"local"==u.space?(v.applyMatrix4(R.getInverse(B)),w.applyMatrix4(R.getInverse(B)),y.set(Math.atan2(v.z,v.y),Math.atan2(v.x,v.z),Math.atan2(v.y,v.x)),T.set(Math.atan2(w.z,w.y),Math.atan2(w.x,w.z),Math.atan2(w.y,w.x)),A.setFromRotationMatrix(N),D.setFromAxisAngle(M,y.x-T.x),P.setFromAxisAngle(S,y.y-T.y),L.setFromAxisAngle(C,y.z-T.z),"RX"==u.active&&A.multiplyQuaternions(A,D),"RY"==u.active&&A.multiplyQuaternions(A,P),"RZ"==u.active&&A.multiplyQuaternions(A,L),u.object.quaternion.copy(A)):"world"==u.space&&(y.set(Math.atan2(v.z,v.y),Math.atan2(v.x,v.z),Math.atan2(v.y,v.x)),T.set(Math.atan2(w.z,w.y),Math.atan2(w.x,w.z),Math.atan2(w.y,w.x)),H.setFromRotationMatrix(R.getInverse(I)),D.setFromAxisAngle(M,y.x-T.x),P.setFromAxisAngle(S,y.y-T.y),L.setFromAxisAngle(C,y.z-T.z),A.setFromRotationMatrix(B),"RX"==u.active&&H.multiplyQuaternions(H,D),"RY"==u.active&&H.multiplyQuaternions(H,P),"RZ"==u.active&&H.multiplyQuaternions(H,L),H.multiplyQuaternions(H,A),u.object.quaternion.copy(H)))),u.update(),u.dispatchEvent(d)}}function a(){u.active=!1,u.document.removeEventListener("mousemove",o,!1),u.document.removeEventListener("mouseup",a,!1)}function s(e){var t=u.mode,i=u.space,r=u.scale;87==e.keyCode&&("translate"==u.mode&&(u.space="world"==u.space?"local":"world"),u.mode="translate"),69==e.keyCode&&("rotate"==u.mode&&(u.space="world"==u.space?"local":"world"),u.mode="rotate"),82==e.keyCode&&(u.mode="scale",u.space="local"),(187==e.keyCode||107==e.keyCode)&&(u.scale+=.1),(189==e.keyCode||109==e.keyCode)&&(u.scale-=.1,u.scale=Math.max(u.scale,.1)),(u.mode!==t||u.space!==i||u.scale!==r)&&(u.setMode(u.mode),u.dispatchEvent(d))}function l(e,t){g.set(2*(e.layerX/u.domElement.offsetWidth)-1,2*-(e.layerY/u.domElement.offsetHeight)+1,.5),m.unprojectVector(g,u.camera),f.set(j,g.sub(j).normalize());var i=f.intersectObjects(t,!0);return i[0]?i[0]:!1}function h(e){return-1!=u.active.search(e)?!0:!1}function c(e){var t=new THREE.Geometry;THREE.GeometryUtils.merge(t,e),e.geometry=t,e.position.set(0,0,0),e.rotation.set(0,0,0),e.scale.set(1,1,1)}this.camera=e,this.domElement=void 0!==t?t:document,this.document=void 0!==i?i:document,this.object=void 0,this.active=!1,this.hovered=!1,this.keysEnabled=!1,this.mode="translate",this.space="world",this.scale=1,this.snapDist=null,this.modifierAxis=new THREE.Vector3(1,1,1),this.gizmo=new THREE.Object3D;var u=this,d={type:"change"},p=!1,f=new THREE.Raycaster,m=new THREE.Projector,g=new THREE.Vector3,v=new THREE.Vector3,E=new THREE.Vector3,y=new THREE.Vector3,T=new THREE.Vector3,_=1,b=new THREE.Matrix4,x=new THREE.Vector3,R=new THREE.Matrix4,w=new THREE.Vector3,H=new THREE.Quaternion,M=new THREE.Vector3(1,0,0),S=new THREE.Vector3(0,1,0),C=new THREE.Vector3(0,0,1),A=new THREE.Quaternion,D=new THREE.Quaternion,P=new THREE.Quaternion,L=new THREE.Quaternion,k=new THREE.Quaternion,F=new THREE.Vector3,z=new THREE.Vector3,N=new THREE.Matrix4,I=new THREE.Matrix4,O=new THREE.Vector3,U=new THREE.Vector3,V=new THREE.Euler,B=new THREE.Matrix4,j=new THREE.Vector3,W=new THREE.Euler,G={},X={},Y={},q=["XY","YZ","XZ","XYZE"],K="XY",Q=new THREE.Object3D;this.gizmo.add(Q);for(var $ in q)Y[q[$]]=new THREE.Mesh(new THREE.PlaneGeometry(500,500)),Y[q[$]].material.side=THREE.DoubleSide,Y[q[$]].visible=!1,Q.add(Y[q[$]]);Y.YZ.rotation.set(0,Math.PI/2,0),Y.XZ.rotation.set(-Math.PI/2,0,0),c(Y.YZ),c(Y.XZ),G.translate=new THREE.Object3D,G.rotate=new THREE.Object3D,G.scale=new THREE.Object3D,this.gizmo.add(G.translate),this.gizmo.add(G.rotate),this.gizmo.add(G.scale),X.translate=new THREE.Object3D,X.rotate=new THREE.Object3D,X.scale=new THREE.Object3D,this.gizmo.add(X.translate),this.gizmo.add(X.rotate),this.gizmo.add(X.scale);var Z,J,et=function(e,t){var i=new THREE.MeshBasicMaterial;return i.color=e,i.side=THREE.DoubleSide,i.depthTest=!1,i.depthWrite=!1,i.opacity=void 0!==t?t:1,i.transparent=!0,i},tt=function(e,t){var i=new THREE.LineBasicMaterial;return i.color=e,i.depthTest=!1,i.depthWrite=!1,i.opacity=void 0!==t?t:1,i.transparent=!0,i},it=new THREE.Color(16777215),rt=new THREE.Color(8421504),nt=new THREE.Color(16711680),ot=new THREE.Color(65280),at=new THREE.Color(255),st=new THREE.Color(65535),lt=new THREE.Color(16711935),ht=new THREE.Color(16776960);Z=new THREE.Geometry,Z.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(1,0,0),new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,1)),Z.colors.push(nt,nt,ot,ot,at,at),material=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0}),J=new THREE.Line(Z,material,THREE.LinePieces),G.translate.add(J),G.scale.add(J.clone()),J=new THREE.Mesh(new THREE.OctahedronGeometry(.1,0),et(it,.25)),J.name="TXYZ",G.translate.add(J),X.translate.add(J.clone()),Z=new THREE.PlaneGeometry(.3,.3),J=new THREE.Mesh(Z,et(ht,.25)),J.position.set(.15,.15,0),c(J),J.name="TXY",G.translate.add(J),X.translate.add(J.clone()),J=new THREE.Mesh(Z,et(st,.25)),J.position.set(0,.15,.15),J.rotation.y=Math.PI/2,c(J),J.name="TYZ",G.translate.add(J),X.translate.add(J.clone()),J=new THREE.Mesh(Z,et(lt,.25)),J.position.set(.15,0,.15),J.rotation.x=Math.PI/2,c(J),J.name="TXZ",G.translate.add(J),X.translate.add(J.clone()),Z=new THREE.CylinderGeometry(0,.05,.2,4,1,!0),J=new THREE.Mesh(Z,et(nt)),J.position.x=1.1,J.rotation.z=-Math.PI/2,c(J),J.name="TX",G.translate.add(J),J=new THREE.Mesh(Z,et(ot)),J.position.y=1.1,c(J),J.name="TY",G.translate.add(J),J=new THREE.Mesh(Z,et(at)),J.position.z=1.1,J.rotation.x=Math.PI/2,c(J),J.name="TZ",G.translate.add(J),Z=new THREE.CylinderGeometry(.2,.1,.8,4,1,!1),J=new THREE.Mesh(Z,et(nt)),J.position.x=.7,J.rotation.z=-Math.PI/2,c(J),J.name="TX",X.translate.add(J),J=new THREE.Mesh(Z,et(ot)),J.position.y=.7,c(J),J.name="TY",X.translate.add(J),J=new THREE.Mesh(Z,et(at)),J.position.z=.7,J.rotation.x=Math.PI/2,c(J),J.name="TZ",X.translate.add(J),Z=new THREE.CubeGeometry(.125,.125,.125),J=new THREE.Mesh(Z,et(it,.25)),J.name="SXYZ",G.scale.add(J),X.scale.add(J.clone()),J=new THREE.Mesh(Z,et(nt)),J.position.set(1.05,0,0),c(J),J.name="SX",G.scale.add(J),X.scale.add(J.clone()),J=new THREE.Mesh(Z,et(ot)),J.position.set(0,1.05,0),c(J),J.name="SY",G.scale.add(J),X.scale.add(J.clone()),J=new THREE.Mesh(Z,et(at)),J.position.set(0,0,1.05),c(J),J.name="SZ",G.scale.add(J),X.scale.add(J.clone());var ct=function(e,t,i){Z=new THREE.Geometry,i=i?i:1;for(var r=0;64*i>=r;++r)"x"==t&&Z.vertices.push(new THREE.Vector3(0,Math.cos(r/32*Math.PI),Math.sin(r/32*Math.PI)).multiplyScalar(e)),"y"==t&&Z.vertices.push(new THREE.Vector3(Math.cos(r/32*Math.PI),0,Math.sin(r/32*Math.PI)).multiplyScalar(e)),"z"==t&&Z.vertices.push(new THREE.Vector3(Math.sin(r/32*Math.PI),Math.cos(r/32*Math.PI),0).multiplyScalar(e));return Z};J=new THREE.Line(ct(1,"x",.5),tt(nt)),J.name="RX",G.rotate.add(J),J=new THREE.Line(ct(1,"y",.5),tt(ot)),J.name="RY",G.rotate.add(J),J=new THREE.Line(ct(1,"z",.5),tt(at)),J.name="RZ",G.rotate.add(J),J=new THREE.Line(ct(1,"z"),tt(rt)),J.name="RXYZE",G.rotate.add(J),J=new THREE.Line(ct(1.25,"z"),tt(ht,.25)),J.name="RE",G.rotate.add(J),Z=new THREE.TorusGeometry(1,.15,4,6,Math.PI),J=new THREE.Mesh(Z,et(nt)),J.rotation.z=-Math.PI/2,J.rotation.y=-Math.PI/2,c(J),J.name="RX",X.rotate.add(J),J=new THREE.Mesh(Z,et(ot)),J.rotation.z=Math.PI,J.rotation.x=-Math.PI/2,c(J),J.name="RY",X.rotate.add(J),J=new THREE.Mesh(Z,et(at)),J.rotation.z=-Math.PI/2,c(J),J.name="RZ",X.rotate.add(J),J=new THREE.Mesh(new THREE.SphereGeometry(.95,12,12),et(it,.25)),J.name="RXYZE",X.rotate.add(J),Y.SPHERE=new THREE.Mesh(new THREE.SphereGeometry(.95,12,12)),Y.SPHERE.visible=!1,Q.add(Y.SPHERE),J=new THREE.Mesh(new THREE.TorusGeometry(1.3,.15,4,12),et(ht,.25)),J.name="RE",X.rotate.add(J),J=null,this.attach=function(e){this.object=e,this.setMode(u.mode),this.domElement.addEventListener("mousedown",n,!1),this.domElement.addEventListener("mousemove",r,!1),this.keysEnabled&&this.document.addEventListener("keydown",s,!1)},this.detach=function(){this.object=void 0,this.hide(),this.domElement.removeEventListener("mousedown",n,!1),this.domElement.removeEventListener("mousemove",r,!1),this.keysEnabled&&this.document.removeEventListener("keydown",s,!1)},this.update=function(e){if(void 0!==this.object){e&&(this.camera=e),this.object.updateMatrixWorld(),U.getPositionFromMatrix(this.object.matrixWorld),V.setFromRotationMatrix(R.extractRotation(this.object.matrixWorld)),this.camera.updateMatrixWorld(),j.getPositionFromMatrix(this.camera.matrixWorld),W.setFromRotationMatrix(R.extractRotation(this.camera.matrixWorld)),_=U.distanceTo(j)/6*this.scale,this.gizmo.position.copy(U),this.gizmo.scale.set(_,_,_);for(var t in this.gizmo.children)for(var i in this.gizmo.children[t].children){var r=this.gizmo.children[t].children[i],n=r.name;-1!=n.search("E")?(b.lookAt(j,U,w.set(0,1,0)),r.rotation.setFromRotationMatrix(b)):(x.copy(j).sub(U).normalize(),"local"==this.space?(H.setFromEuler(V),-1!=n.search("R")&&(R.makeRotationFromQuaternion(H).getInverse(R),x.applyProjection(R),"RX"==n&&(D.setFromAxisAngle(M,Math.atan2(-x.y,x.z)),H.multiplyQuaternions(H,D)),"RY"==n&&(P.setFromAxisAngle(S,Math.atan2(x.x,x.z)),H.multiplyQuaternions(H,P)),"RZ"==n&&(L.setFromAxisAngle(C,Math.atan2(x.y,x.x)),H.multiplyQuaternions(H,L))),r.quaternion.copy(H)):"world"==this.space&&(r.rotation.set(0,0,0),"RX"==n&&(r.rotation.x=Math.atan2(-x.y,x.z)),"RY"==n&&(r.rotation.y=Math.atan2(x.x,x.z)),"RZ"==n&&(r.rotation.z=Math.atan2(x.y,x.x))))}}},this.hide=function(){for(var e in G)for(var t in G[e].children)G[e].children[t].visible=!1;for(var e in X)for(var t in X[e].children)X[e].children[t].visible=!1},this.setMode=function(e){u.mode=e,this.hide(),"scale"==u.mode&&(u.space="local");for(var t in G[this.mode].children)G[this.mode].children[t].visible=!0;for(var t in X[this.mode].children)X[this.mode].children[t].visible=p;u.update()},this.setIntersectionPlane=function(){x.copy(j).sub(U).normalize(),"local"==this.space&&x.applyMatrix4(R.getInverse(u.object.matrixWorld)),h("X")&&(K=x.y>x.z?"XZ":"XY"),h("Y")&&(K=x.x>x.z?"YZ":"XY"),h("Z")&&(K=x.x>x.y?"YZ":"XZ"),h("XY")&&(K="XY"),h("YZ")&&(K="YZ"),h("XZ")&&(K="XZ"),(h("XYZ")||h("E"))&&(K="XYZE"),h("RX")&&(K="YZ"),h("RY")&&(K="XZ"),h("RZ")&&(K="XY"),h("RXYZ")&&(K="SPHERE")};var ut=null,dt=new THREE.Color,pt=1},THREE.TransformControls.prototype=Object.create(THREE.EventDispatcher.prototype),define("libs/threejs/examples/js/controls/TransformControls",function(){}),define("lighting",["utils/math","libs/threejs/examples/js/controls/TransformControls"],function(){return function(e,t,i,r){function n(e){f=e.target.hovered}function o(o){return o.controls=new THREE.TransformControls(t,i),o.controls.scale=.65,o.controls.attach(o),d.push(o),e.add(o),r&&(o.controls.addEventListener("change",n),e.add(o.controls.gizmo)),onLightAddedCallback&&onLightAddedCallback(),o}function a(e,t){e.__folders[t].close(),e.__ul.removeChild(e.__folders[t].domElement.parentNode),e.__folders[t]=void 0,e.onResize()}var s,l=0,h=0,c=0,u=0,d=[],p=!1,f=!1,m=new THREE.AmbientLight(2236962);e.add(m);var g={updateColors:function(){},remove:function(){}},v={onLightAdded:function(e){onLightAddedCallback=e},onLightRemoved:function(e){onLightRemovedCallback=e},update:function(){for(p=!1,s=d.length;s-->0;)d[s].helper.update(),d[s].controls.update(),p=p||Boolean(d[s].controls.active);return p||f},addPointLight:function(t,i,n,s){var h=new THREE.PointLight(t,i,n||2e3);if(s?h.position.copy(s):h.position.set(12*Math.random()-6,12*Math.random()-6,12*Math.random()-6).multiplyScalar(100),h.helper=new THREE.PointLightHelper(h,100),r&&e.add(h.helper),h.api={color:"#"+h.color.getHexString()},l++,o(h),r){var c="Point Light "+l,u=r.addFolder(c);u.addColor(h.api,"color").onChange(function(){h.color.set(h.api.color)}),u.add(h,"intensity"),u.add(h,"distance"),u.add(g,"remove").onChange(function(){e.remove(h),e.remove(h.helper),e.remove(h.controls.gizmo),d.splice(d.indexOf(h)),a(r,c),onLightRemovedCallback&&onLightRemovedCallback()})}},addDirectionalLight:function(t){var i=new THREE.DirectionalLight(t);if(i.helper=new THREE.DirectionalLightHelper(i,100),r&&e.add(i.helper),i.api={color:"#"+i.color.getHexString()},h++,o(i),r){var n="Directional Light "+h,s=r.addFolder(n);s.addColor(i.api,"color").onChange(function(){i.color.set(i.api.color)}),s.add(i,"intensity"),s.add(g,"remove").onChange(function(){e.remove(i),e.remove(i.helper),e.remove(i.controls.gizmo),d.splice(d.indexOf(i)),a(r,n),onLightRemovedCallback&&onLightRemovedCallback()})}},addHemispshereLight:function(t){var i=new THREE.HemisphereLight(t);if(i.helper=new THREE.HemisphereLightHelper(i,100),r&&e.add(i.helper),i.api={color:"#"+i.color.getHexString(),groundColor:"#"+i.groundColor.getHexString()},c++,o(i),r){var n="Hemisphere Light "+c,s=r.addFolder(n);s.addColor(i.api,"color").onChange(function(){i.color.set(i.api.color)}),s.addColor(i.api,"groundColor").onChange(function(){i.groundColor.set(i.api.groundColor)}),s.add(i,"intensity"),s.add(g,"remove").onChange(function(){e.remove(i),e.remove(i.helper),e.remove(i.controls.gizmo),d.splice(d.indexOf(i)),a(r,n),onLightRemovedCallback&&onLightRemovedCallback()})}},addSpotLight:function(t){var i=new THREE.SpotLight(t);if(i.helper=new THREE.SpotLightHelper(i,100),r&&e.add(i.helper),i.api={color:"#"+i.color.getHexString()},u++,o(i),r){var n="Spotlight "+u,s=r.addFolder(n);s.addColor(i.api,"color").onChange(function(){i.color.set(i.api.color)}),s.add(i,"intensity"),s.add(i,"angle",0,.5*Math.PI).step(.01),s.add(i,"exponent",0,10).step(.1),s.add(g,"remove").onChange(function(){e.remove(i),e.remove(i.helper),e.remove(i.controls.gizmo),d.splice(d.indexOf(i)),a(r,n),onLightRemovedCallback&&onLightRemovedCallback()})}}};if(r){r=r.addFolder("lights"),r.add(v,"addPointLight"),r.add(v,"addDirectionalLight"),r.add(v,"addHemispshereLight"),r.add(v,"addSpotLight");var E=r.addFolder("Ambient Lighting"),y={color:"#"+m.color.getHexString()};E.addColor(y,"color").onChange(function(){m.color.set(y.color)})}return v}});var dat=dat||{};dat.gui=dat.gui||{},dat.utils=dat.utils||{},dat.controllers=dat.controllers||{},dat.dom=dat.dom||{},dat.color=dat.color||{},dat.utils.css=function(){return{load:function(e,t){var t=t||document,i=t.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,t.getElementsByTagName("head")[0].appendChild(i)},inject:function(e,t){var t=t||document,i=document.createElement("style");i.type="text/css",i.innerHTML=e,t.getElementsByTagName("head")[0].appendChild(i)}}}(),dat.utils.common=function(){var e=Array.prototype.forEach,t=Array.prototype.slice;return{BREAK:{},extend:function(e){return this.each(t.call(arguments,1),function(t){for(var i in t)this.isUndefined(t[i])||(e[i]=t[i])},this),e},defaults:function(e){return this.each(t.call(arguments,1),function(t){for(var i in t)this.isUndefined(e[i])&&(e[i]=t[i])},this),e},compose:function(){var e=t.call(arguments);return function(){for(var i=t.call(arguments),r=e.length-1;r>=0;r--)i=[e[r].apply(this,i)];return i[0]}},each:function(t,i,r){if(e&&t.forEach===e)t.forEach(i,r);else if(t.length===t.length+0)for(var n=0,o=t.length;o>n&&!(n in t&&i.call(r,t[n],n)===this.BREAK);n++);else for(n in t)if(i.call(r,t[n],n)===this.BREAK)break},defer:function(e){setTimeout(e,0)},toArray:function(e){return e.toArray?e.toArray():t.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){return e!==e},isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}}}(),dat.controllers.Controller=function(e){var t=function(e,t){this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onFinishChange=this.__onChange=void 0};return e.extend(t.prototype,{onChange:function(e){return this.__onChange=e,this},onFinishChange:function(e){return this.__onFinishChange=e,this},setValue:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),t}(dat.utils.common),dat.dom.dom=function(e){function t(t){return"0"===t||e.isUndefined(t)?0:(t=t.match(r),e.isNull(t)?0:parseFloat(t[1]))}var i={};e.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(t,r){e.each(t,function(e){i[e]=r})});var r=/(\d+(\.\d+)?)px/,n={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(t,i,r){e.isUndefined(i)&&(i=!0),e.isUndefined(r)&&(r=!0),t.style.position="absolute",i&&(t.style.left=0,t.style.right=0),r&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,r,n,o){var n=n||{},a=i[r];if(!a)throw Error("Event type "+r+" not supported.");var s=document.createEvent(a);switch(a){case"MouseEvents":s.initMouseEvent(r,n.bubbles||!1,n.cancelable||!0,window,n.clickCount||1,0,0,n.x||n.clientX||0,n.y||n.clientY||0,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":a=s.initKeyboardEvent||s.initKeyEvent,e.defaults(n,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),a(r,n.bubbles||!1,n.cancelable,window,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.keyCode,n.charCode);break;default:s.initEvent(r,n.bubbles||!1,n.cancelable||!0)}e.defaults(s,o),t.dispatchEvent(s)},bind:function(e,t,i,r){return e.addEventListener?e.addEventListener(t,i,r||!1):e.attachEvent&&e.attachEvent("on"+t,i),n},unbind:function(e,t,i,r){return e.removeEventListener?e.removeEventListener(t,i,r||!1):e.detachEvent&&e.detachEvent("on"+t,i),n},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var i=e.className.split(/ +/);-1==i.indexOf(t)&&(i.push(t),e.className=i.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return n},removeClass:function(e,t){if(t){if(void 0!==e.className)if(e.className===t)e.removeAttribute("class");else{var i=e.className.split(/ +/),r=i.indexOf(t);-1!=r&&(i.splice(r,1),e.className=i.join(" "))}}else e.className=void 0;return n},hasClass:function(e,t){return RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){return e=getComputedStyle(e),t(e["border-left-width"])+t(e["border-right-width"])+t(e["padding-left"])+t(e["padding-right"])+t(e.width)},getHeight:function(e){return e=getComputedStyle(e),t(e["border-top-width"])+t(e["border-bottom-width"])+t(e["padding-top"])+t(e["padding-bottom"])+t(e.height)},getOffset:function(e){var t={left:0,top:0};if(e.offsetParent)do t.left+=e.offsetLeft,t.top+=e.offsetTop;while(e=e.offsetParent);return t},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}};return n}(dat.utils.common),dat.controllers.OptionController=function(e,t,i){var r=function(e,n,o){r.superclass.call(this,e,n);var a=this;if(this.__select=document.createElement("select"),i.isArray(o)){var s={};i.each(o,function(e){s[e]=e}),o=s}i.each(o,function(e,t){var i=document.createElement("option");i.innerHTML=t,i.setAttribute("value",e),a.__select.appendChild(i)}),this.updateDisplay(),t.bind(this.__select,"change",function(){a.setValue(this.options[this.selectedIndex].value)}),this.domElement.appendChild(this.__select)};return r.superclass=e,i.extend(r.prototype,e.prototype,{setValue:function(e){return e=r.superclass.prototype.setValue.call(this,e),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),e},updateDisplay:function(){return this.__select.value=this.getValue(),r.superclass.prototype.updateDisplay.call(this)}}),r}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.NumberController=function(e,t){var i=function(e,r,n){i.superclass.call(this,e,r),n=n||{},this.__min=n.min,this.__max=n.max,this.__step=n.step,e=this.__impliedStep=t.isUndefined(this.__step)?0==this.initialValue?1:Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__step,e=e.toString(),this.__precision=e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0};return i.superclass=e,t.extend(i.prototype,e.prototype,{setValue:function(e){return void 0!==this.__min&&e<this.__min?e=this.__min:void 0!==this.__max&&e>this.__max&&(e=this.__max),void 0!==this.__step&&0!=e%this.__step&&(e=Math.round(e/this.__step)*this.__step),i.superclass.prototype.setValue.call(this,e)},min:function(e){return this.__min=e,this},max:function(e){return this.__max=e,this},step:function(e){return this.__step=e,this}}),i}(dat.controllers.Controller,dat.utils.common),dat.controllers.NumberControllerBox=function(e,t,i){var r=function(e,n,o){function a(){var e=parseFloat(c.__input.value);i.isNaN(e)||c.setValue(e)}function s(e){var t=h-e.clientY;c.setValue(c.getValue()+t*c.__impliedStep),h=e.clientY}function l(){t.unbind(window,"mousemove",s),t.unbind(window,"mouseup",l)}this.__truncationSuspended=!1,r.superclass.call(this,e,n,o);var h,c=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),t.bind(this.__input,"change",a),t.bind(this.__input,"blur",function(){a(),c.__onFinishChange&&c.__onFinishChange.call(c,c.getValue())}),t.bind(this.__input,"mousedown",function(e){t.bind(window,"mousemove",s),t.bind(window,"mouseup",l),h=e.clientY}),t.bind(this.__input,"keydown",function(e){13===e.keyCode&&(c.__truncationSuspended=!0,this.blur(),c.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return r.superclass=e,i.extend(r.prototype,e.prototype,{updateDisplay:function(){var e,t=this.__input;if(this.__truncationSuspended)e=this.getValue();else{e=this.getValue();var i=Math.pow(10,this.__precision);e=Math.round(e*i)/i}return t.value=e,r.superclass.prototype.updateDisplay.call(this)}}),r}(dat.controllers.NumberController,dat.dom.dom,dat.utils.common),dat.controllers.NumberControllerSlider=function(e,t,i,r,n){var o=function(e,i,r,n,a){function s(e){e.preventDefault();var i=t.getOffset(h.__background),r=t.getWidth(h.__background);return h.setValue(h.__min+(h.__max-h.__min)*((e.clientX-i.left)/(i.left+r-i.left))),!1}function l(){t.unbind(window,"mousemove",s),t.unbind(window,"mouseup",l),h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}o.superclass.call(this,e,i,{min:r,max:n,step:a});var h=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),t.bind(this.__background,"mousedown",function(e){t.bind(window,"mousemove",s),t.bind(window,"mouseup",l),s(e)}),t.addClass(this.__background,"slider"),t.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)};return o.superclass=e,o.useDefaultStyles=function(){i.inject(n)},r.extend(o.prototype,e.prototype,{updateDisplay:function(){return this.__foreground.style.width=100*((this.getValue()-this.__min)/(this.__max-this.__min))+"%",o.superclass.prototype.updateDisplay.call(this)}}),o}(dat.controllers.NumberController,dat.dom.dom,dat.utils.css,dat.utils.common,".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}"),dat.controllers.FunctionController=function(e,t,i){var r=function(e,i,n){r.superclass.call(this,e,i);var o=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===n?"Fire":n,t.bind(this.__button,"click",function(e){return e.preventDefault(),o.fire(),!1}),t.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)};return r.superclass=e,i.extend(r.prototype,e.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.getValue().call(this.object)}}),r}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.BooleanController=function(e,t,i){var r=function(e,i){r.superclass.call(this,e,i);var n=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),t.bind(this.__checkbox,"change",function(){n.setValue(!n.__prev)},!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()};return r.superclass=e,i.extend(r.prototype,e.prototype,{setValue:function(e){return e=r.superclass.prototype.setValue.call(this,e),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),e},updateDisplay:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,r.superclass.prototype.updateDisplay.call(this)}}),r}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.color.toString=function(e){return function(t){if(1==t.a||e.isUndefined(t.a)){for(t=t.hex.toString(16);t.length<6;)t="0"+t;return"#"+t}return"rgba("+Math.round(t.r)+","+Math.round(t.g)+","+Math.round(t.b)+","+t.a+")"}}(dat.utils.common),dat.color.interpret=function(e,t){var i,r,n=[{litmus:t.isString,conversions:{THREE_CHAR_HEX:{read:function(e){return e=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i),null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:e},SIX_CHAR_HEX:{read:function(e){return e=e.match(/^#([A-F0-9]{6})$/i),null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:e},CSS_RGB:{read:function(e){return e=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/),null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:e},CSS_RGBA:{read:function(e){return e=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/),null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:e}}},{litmus:t.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:t.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3!=e.length?!1:{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4!=e.length?!1:{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:t.isObject,conversions:{RGBA_OBJ:{read:function(e){return t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)&&t.isNumber(e.a)?{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)?{space:"RGB",r:e.r,g:e.g,b:e.b}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)&&t.isNumber(e.a)?{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)?{space:"HSV",h:e.h,s:e.s,v:e.v}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}];return function(){r=!1;var e=arguments.length>1?t.toArray(arguments):arguments[0];return t.each(n,function(n){return n.litmus(e)?(t.each(n.conversions,function(n,o){return i=n.read(e),r===!1&&i!==!1?(r=i,i.conversionName=o,i.conversion=n,t.BREAK):void 0
}),t.BREAK):void 0}),r}}(dat.color.toString,dat.utils.common),dat.GUI=dat.gui.GUI=function(e,t,i,r,n,o,a,s,l,h,c,u,d,p,f){function m(e,t,i,o){if(void 0===t[i])throw Error("Object "+t+' has no property "'+i+'"');o.color?t=new c(t,i):(t=[t,i].concat(o.factoryArgs),t=r.apply(e,t)),o.before instanceof n&&(o.before=o.before.__li),E(e,t),p.addClass(t.domElement,"c"),i=document.createElement("span"),p.addClass(i,"property-name"),i.innerHTML=t.property;var a=document.createElement("div");return a.appendChild(i),a.appendChild(t.domElement),o=g(e,a,o.before),p.addClass(o,k.CLASS_CONTROLLER_ROW),p.addClass(o,typeof t.getValue()),v(e,o,t),e.__controllers.push(t),t}function g(e,t,i){var r=document.createElement("li");return t&&r.appendChild(t),i?e.__ul.insertBefore(r,params.before):e.__ul.appendChild(r),e.onResize(),r}function v(e,t,i){if(i.__li=t,i.__gui=e,f.extend(i,{options:function(t){return arguments.length>1?(i.remove(),m(e,i.object,i.property,{before:i.__li.nextElementSibling,factoryArgs:[f.toArray(arguments)]})):f.isArray(t)||f.isObject(t)?(i.remove(),m(e,i.object,i.property,{before:i.__li.nextElementSibling,factoryArgs:[t]})):void 0},name:function(e){return i.__li.firstElementChild.firstElementChild.innerHTML=e,i},listen:function(){return i.__gui.listen(i),i},remove:function(){return i.__gui.remove(i),i}}),i instanceof l){var r=new s(i.object,i.property,{min:i.__min,max:i.__max,step:i.__step});f.each(["updateDisplay","onChange","onFinishChange"],function(e){var t=i[e],n=r[e];i[e]=r[e]=function(){var e=Array.prototype.slice.call(arguments);return t.apply(i,e),n.apply(r,e)}}),p.addClass(t,"has-slider"),i.domElement.insertBefore(r.domElement,i.domElement.firstElementChild)}else if(i instanceof s){var n=function(t){return f.isNumber(i.__min)&&f.isNumber(i.__max)?(i.remove(),m(e,i.object,i.property,{before:i.__li.nextElementSibling,factoryArgs:[i.__min,i.__max,i.__step]})):t};i.min=f.compose(n,i.min),i.max=f.compose(n,i.max)}else i instanceof o?(p.bind(t,"click",function(){p.fakeEvent(i.__checkbox,"click")}),p.bind(i.__checkbox,"click",function(e){e.stopPropagation()})):i instanceof a?(p.bind(t,"click",function(){p.fakeEvent(i.__button,"click")}),p.bind(t,"mouseover",function(){p.addClass(i.__button,"hover")}),p.bind(t,"mouseout",function(){p.removeClass(i.__button,"hover")})):i instanceof c&&(p.addClass(t,"color"),i.updateDisplay=f.compose(function(e){return t.style.borderLeftColor=i.__color.toString(),e},i.updateDisplay),i.updateDisplay());i.setValue=f.compose(function(t){return e.getRoot().__preset_select&&i.isModified()&&R(e.getRoot(),!0),t},i.setValue)}function E(e,t){var i=e.getRoot(),r=i.__rememberedObjects.indexOf(t.object);if(-1!=r){var n=i.__rememberedObjectIndecesToControllers[r];if(void 0===n&&(n={},i.__rememberedObjectIndecesToControllers[r]=n),n[t.property]=t,i.load&&i.load.remembered){if(i=i.load.remembered,i[e.preset])i=i[e.preset];else{if(!i[M])return;i=i[M]}i[r]&&void 0!==i[r][t.property]&&(r=i[r][t.property],t.initialValue=r,t.setValue(r))}}}function y(e){var t=e.__save_row=document.createElement("li");p.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),p.addClass(t,"save-row");var i=document.createElement("span");i.innerHTML="&nbsp;",p.addClass(i,"button gears");var r=document.createElement("span");r.innerHTML="Save",p.addClass(r,"button"),p.addClass(r,"save");var n=document.createElement("span");n.innerHTML="New",p.addClass(n,"button"),p.addClass(n,"save-as");var o=document.createElement("span");o.innerHTML="Revert",p.addClass(o,"button"),p.addClass(o,"revert");var a=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered?f.each(e.load.remembered,function(t,i){x(e,i,i==e.preset)}):x(e,M,!1),p.bind(a,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value}),t.appendChild(a),t.appendChild(i),t.appendChild(r),t.appendChild(n),t.appendChild(o),H){var t=document.getElementById("dg-save-locally"),s=document.getElementById("dg-local-explain");t.style.display="block",t=document.getElementById("dg-local-storage"),"true"===localStorage.getItem(document.location.href+".isLocal")&&t.setAttribute("checked","checked");var l=function(){s.style.display=e.useLocalStorage?"block":"none"};l(),p.bind(t,"change",function(){e.useLocalStorage=!e.useLocalStorage,l()})}var h=document.getElementById("dg-new-constructor");p.bind(h,"keydown",function(e){e.metaKey&&(67===e.which||67==e.keyCode)&&C.hide()}),p.bind(i,"click",function(){h.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),C.show(),h.focus(),h.select()}),p.bind(r,"click",function(){e.save()}),p.bind(n,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)}),p.bind(o,"click",function(){e.revert()})}function T(e){function t(t){return t.preventDefault(),n=t.clientX,p.addClass(e.__closeButton,k.CLASS_DRAG),p.bind(window,"mousemove",i),p.bind(window,"mouseup",r),!1}function i(t){return t.preventDefault(),e.width+=n-t.clientX,e.onResize(),n=t.clientX,!1}function r(){p.removeClass(e.__closeButton,k.CLASS_DRAG),p.unbind(window,"mousemove",i),p.unbind(window,"mouseup",r)}e.__resize_handle=document.createElement("div"),f.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var n;p.bind(e.__resize_handle,"mousedown",t),p.bind(e.__closeButton,"mousedown",t),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function _(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function b(e,t){var i={};return f.each(e.__rememberedObjects,function(r,n){var o={};f.each(e.__rememberedObjectIndecesToControllers[n],function(e,i){o[i]=t?e.initialValue:e.getValue()}),i[n]=o}),i}function x(e,t,i){var r=document.createElement("option");r.innerHTML=t,r.value=t,e.__preset_select.appendChild(r),i&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function R(e,t){var i=e.__preset_select[e.__preset_select.selectedIndex];i.innerHTML=t?i.value+"*":i.value}function w(e){0!=e.length&&u(function(){w(e)}),f.each(e,function(e){e.updateDisplay()})}e.inject(i);var H,M="Default";try{H="localStorage"in window&&null!==window.localStorage}catch(S){H=!1}var C,A,D=!0,P=!1,L=[],k=function(e){function t(){localStorage.setItem(document.location.href+".gui",JSON.stringify(r.getSaveObject()))}function i(){var e=r.getRoot();e.width+=1,f.defer(function(){e.width-=1})}var r=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),p.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],e=e||{},e=f.defaults(e,{autoPlace:!0,width:k.DEFAULT_WIDTH}),e=f.defaults(e,{resizable:e.autoPlace,hideable:e.autoPlace}),f.isUndefined(e.load)?e.load={preset:M}:e.preset&&(e.load.preset=e.preset),f.isUndefined(e.parent)&&e.hideable&&L.push(this),e.resizable=f.isUndefined(e.parent)&&e.resizable,e.autoPlace&&f.isUndefined(e.scrollable)&&(e.scrollable=!0);var n=H&&"true"===localStorage.getItem(document.location.href+".isLocal");if(Object.defineProperties(this,{parent:{get:function(){return e.parent}},scrollable:{get:function(){return e.scrollable}},autoPlace:{get:function(){return e.autoPlace}},preset:{get:function(){return r.parent?r.getRoot().preset:e.load.preset},set:function(t){for(r.parent?r.getRoot().preset=t:e.load.preset=t,t=0;t<this.__preset_select.length;t++)this.__preset_select[t].value==this.preset&&(this.__preset_select.selectedIndex=t);r.revert()}},width:{get:function(){return e.width},set:function(t){e.width=t,_(r,t)}},name:{get:function(){return e.name},set:function(t){e.name=t,a&&(a.innerHTML=e.name)}},closed:{get:function(){return e.closed},set:function(t){e.closed=t,e.closed?p.addClass(r.__ul,k.CLASS_CLOSED):p.removeClass(r.__ul,k.CLASS_CLOSED),this.onResize(),r.__closeButton&&(r.__closeButton.innerHTML=t?k.TEXT_OPEN:k.TEXT_CLOSED)}},load:{get:function(){return e.load}},useLocalStorage:{get:function(){return n},set:function(e){H&&((n=e)?p.bind(window,"unload",t):p.unbind(window,"unload",t),localStorage.setItem(document.location.href+".isLocal",e))}}}),f.isUndefined(e.parent)){if(e.closed=!1,p.addClass(this.domElement,k.CLASS_MAIN),p.makeSelectable(this.domElement,!1),H&&n){r.useLocalStorage=!0;var o=localStorage.getItem(document.location.href+".gui");o&&(e.load=JSON.parse(o))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=k.TEXT_CLOSED,p.addClass(this.__closeButton,k.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),p.bind(this.__closeButton,"click",function(){r.closed=!r.closed})}else{void 0===e.closed&&(e.closed=!0);var a=document.createTextNode(e.name);p.addClass(a,"controller-name"),o=g(r,a),p.addClass(this.__ul,k.CLASS_CLOSED),p.addClass(o,"title"),p.bind(o,"click",function(e){return e.preventDefault(),r.closed=!r.closed,!1}),e.closed||(this.closed=!1)}e.autoPlace&&(f.isUndefined(e.parent)&&(D&&(A=document.createElement("div"),p.addClass(A,"dg"),p.addClass(A,k.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(A),D=!1),A.appendChild(this.domElement),p.addClass(this.domElement,k.CLASS_AUTO_PLACE)),this.parent||_(r,e.width)),p.bind(window,"resize",function(){r.onResize()}),p.bind(this.__ul,"webkitTransitionEnd",function(){r.onResize()}),p.bind(this.__ul,"transitionend",function(){r.onResize()}),p.bind(this.__ul,"oTransitionEnd",function(){r.onResize()}),this.onResize(),e.resizable&&T(this),r.getRoot(),e.parent||i()};return k.toggleHide=function(){P=!P,f.each(L,function(e){e.domElement.style.zIndex=P?-999:999,e.domElement.style.opacity=P?0:1})},k.CLASS_AUTO_PLACE="a",k.CLASS_AUTO_PLACE_CONTAINER="ac",k.CLASS_MAIN="main",k.CLASS_CONTROLLER_ROW="cr",k.CLASS_TOO_TALL="taller-than-window",k.CLASS_CLOSED="closed",k.CLASS_CLOSE_BUTTON="close-button",k.CLASS_DRAG="drag",k.DEFAULT_WIDTH=245,k.TEXT_CLOSED="Close Controls",k.TEXT_OPEN="Open Controls",p.bind(window,"keydown",function(e){"text"!==document.activeElement.type&&(72===e.which||72==e.keyCode)&&k.toggleHide()},!1),f.extend(k.prototype,{add:function(e,t){return m(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return m(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.slice(this.__controllers.indexOf(e),1);var t=this;f.defer(function(){t.onResize()})},destroy:function(){this.autoPlace&&A.removeChild(this.domElement)},addFolder:function(e){if(void 0!==this.__folders[e])throw Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};return t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]),t=new k(t),this.__folders[e]=t,e=g(this,t.domElement),p.addClass(e,"folder"),t},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=p.getOffset(e.__ul).top,i=0;f.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(i+=p.getHeight(t))}),window.innerHeight-t-20<i?(p.addClass(e.domElement,k.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(p.removeClass(e.domElement,k.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&f.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},remember:function(){if(f.isUndefined(C)&&(C=new d,C.domElement.innerHTML=t),this.parent)throw Error("You can only call remember on a top level GUI.");var e=this;f.each(Array.prototype.slice.call(arguments),function(t){0==e.__rememberedObjects.length&&y(e),-1==e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)}),this.autoPlace&&_(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=b(this)),e.folders={},f.each(this.__folders,function(t,i){e.folders[i]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=b(this),R(this,!1)},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[M]=b(this,!0)),this.load.remembered[e]=b(this),this.preset=e,x(this,e,!0)},revert:function(e){f.each(this.__controllers,function(t){this.getRoot().load.remembered?E(e||this.getRoot(),t):t.setValue(t.initialValue)},this),f.each(this.__folders,function(e){e.revert(e)}),e||R(this.getRoot(),!1)},listen:function(e){var t=0==this.__listening.length;this.__listening.push(e),t&&w(this.__listening)}}),k}(dat.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n",dat.controllers.factory=function(e,t,i,r,n,o,a){return function(s,l,h,c){var u=s[l];return a.isArray(h)||a.isObject(h)?new e(s,l,h):a.isNumber(u)?a.isNumber(h)&&a.isNumber(c)?new i(s,l,h,c):new t(s,l,{min:h,max:c}):a.isString(u)?new r(s,l):a.isFunction(u)?new n(s,l,""):a.isBoolean(u)?new o(s,l):void 0}}(dat.controllers.OptionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.StringController=function(e,t,i){var r=function(e,i){function n(){o.setValue(o.__input.value)}r.superclass.call(this,e,i);var o=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),t.bind(this.__input,"keyup",n),t.bind(this.__input,"change",n),t.bind(this.__input,"blur",function(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}),t.bind(this.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return r.superclass=e,i.extend(r.prototype,e.prototype,{updateDisplay:function(){return t.isActive(this.__input)||(this.__input.value=this.getValue()),r.superclass.prototype.updateDisplay.call(this)}}),r}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.FunctionController,dat.controllers.BooleanController,dat.utils.common),dat.controllers.Controller,dat.controllers.BooleanController,dat.controllers.FunctionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.OptionController,dat.controllers.ColorController=function(e,t,i,r,n){function o(e,t,i,r){e.style.background="",n.each(l,function(n){e.style.cssText+="background: "+n+"linear-gradient("+t+", "+i+" 0%, "+r+" 100%); "})}function a(e){e.style.background="",e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var s=function(e,l){function h(e){p(e),t.bind(window,"mousemove",p),t.bind(window,"mouseup",c)}function c(){t.unbind(window,"mousemove",p),t.unbind(window,"mouseup",c)}function u(){var e=r(this.value);e!==!1?(m.__color.__state=e,m.setValue(m.__color.toOriginal())):this.value=m.__color.toString()}function d(){t.unbind(window,"mousemove",f),t.unbind(window,"mouseup",d)}function p(e){e.preventDefault();var i=t.getWidth(m.__saturation_field),r=t.getOffset(m.__saturation_field),n=(e.clientX-r.left+document.body.scrollLeft)/i,e=1-(e.clientY-r.top+document.body.scrollTop)/i;return e>1?e=1:0>e&&(e=0),n>1?n=1:0>n&&(n=0),m.__color.v=e,m.__color.s=n,m.setValue(m.__color.toOriginal()),!1}function f(e){e.preventDefault();var i=t.getHeight(m.__hue_field),r=t.getOffset(m.__hue_field),e=1-(e.clientY-r.top+document.body.scrollTop)/i;return e>1?e=1:0>e&&(e=0),m.__color.h=360*e,m.setValue(m.__color.toOriginal()),!1}s.superclass.call(this,e,l),this.__color=new i(this.getValue()),this.__temp=new i(0);var m=this;this.domElement=document.createElement("div"),t.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",t.bind(this.__input,"keydown",function(e){13===e.keyCode&&u.call(this)}),t.bind(this.__input,"blur",u),t.bind(this.__selector,"mousedown",function(){t.addClass(this,"drag").bind(window,"mouseup",function(){t.removeClass(m.__selector,"drag")})});var g=document.createElement("div");n.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),n.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),n.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),n.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),n.extend(g.style,{width:"100%",height:"100%",background:"none"}),o(g,"top","rgba(0,0,0,0)","#000"),n.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),a(this.__hue_field),n.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),t.bind(this.__saturation_field,"mousedown",h),t.bind(this.__field_knob,"mousedown",h),t.bind(this.__hue_field,"mousedown",function(e){f(e),t.bind(window,"mousemove",f),t.bind(window,"mouseup",d)}),this.__saturation_field.appendChild(g),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()};s.superclass=e,n.extend(s.prototype,e.prototype,{updateDisplay:function(){var e=r(this.getValue());if(e!==!1){var t=!1;n.each(i.COMPONENTS,function(i){return n.isUndefined(e[i])||n.isUndefined(this.__color.__state[i])||e[i]===this.__color.__state[i]?void 0:(t=!0,{})},this),t&&n.extend(this.__color.__state,e)}n.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var a=this.__color.v<.5||this.__color.s>.5?255:0,s=255-a;n.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+a+","+a+","+a+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,o(this.__saturation_field,"left","#fff",this.__temp.toString()),n.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+a+","+a+","+a+")",textShadow:this.__input_textShadow+"rgba("+s+","+s+","+s+",.7)"})}});var l=["-moz-","-o-","-webkit-","-ms-",""];return s}(dat.controllers.Controller,dat.dom.dom,dat.color.Color=function(e,t,i,r){function n(e,t,i){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(a(this,t,i),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(a(this,t,i),this.__state.space="RGB"),this.__state[t]=e}})}function o(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(s(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(s(this),this.__state.space="HSV"),this.__state[t]=e}})}function a(e,i,n){if("HEX"===e.__state.space)e.__state[i]=t.component_from_hex(e.__state.hex,n);else{if("HSV"!==e.__state.space)throw"Corrupted color state";r.extend(e.__state,t.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}}function s(e){var i=t.rgb_to_hsv(e.r,e.g,e.b);r.extend(e.__state,{s:i.s,v:i.v}),r.isNaN(i.h)?r.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=i.h}var l=function(){if(this.__state=e.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return l.COMPONENTS="r,g,b,h,s,v,hex,a".split(","),r.extend(l.prototype,{toString:function(){return i(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),n(l.prototype,"r",2),n(l.prototype,"g",1),n(l.prototype,"b",0),o(l.prototype,"h"),o(l.prototype,"s"),o(l.prototype,"v"),Object.defineProperty(l.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(l.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=t.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}}),l}(dat.color.interpret,dat.color.math=function(){var e;return{hsv_to_rgb:function(e,t,i){var r=e/60-Math.floor(e/60),n=i*(1-t),o=i*(1-r*t),t=i*(1-(1-r)*t),e=[[i,t,n],[o,i,n],[n,i,t],[n,o,i],[t,n,i],[i,n,o]][Math.floor(e/60)%6];return{r:255*e[0],g:255*e[1],b:255*e[2]}},rgb_to_hsv:function(e,t,i){var r=Math.min(e,t,i),n=Math.max(e,t,i),r=n-r;return 0==n?{h:0/0,s:0,v:0}:(e=e==n?(t-i)/r:t==n?2+(i-e)/r:4+(e-t)/r,e/=6,0>e&&(e+=1),{h:360*e,s:r/n,v:n/255})},rgb_to_hex:function(e,t,i){return e=this.hex_with_component(0,2,e),e=this.hex_with_component(e,1,t),e=this.hex_with_component(e,0,i)},component_from_hex:function(e,t){return 255&e>>8*t},hex_with_component:function(t,i,r){return r<<(e=8*i)|t&~(255<<e)}}}(),dat.color.toString,dat.utils.common),dat.color.interpret,dat.utils.common),dat.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),dat.dom.CenteredDiv=function(e,t){var i=function(){this.backgroundElement=document.createElement("div"),t.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"}),e.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),t.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var i=this;e.bind(this.backgroundElement,"click",function(){i.hide()})};return i.prototype.show=function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),t.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})},i.prototype.hide=function(){var t=this,i=function(){t.domElement.style.display="none",t.backgroundElement.style.display="none",e.unbind(t.domElement,"webkitTransitionEnd",i),e.unbind(t.domElement,"transitionend",i),e.unbind(t.domElement,"oTransitionEnd",i)};e.bind(this.domElement,"webkitTransitionEnd",i),e.bind(this.domElement,"transitionend",i),e.bind(this.domElement,"oTransitionEnd",i),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},i.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-e.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-e.getHeight(this.domElement)/2+"px"},i}(dat.dom.dom,dat.utils.common),dat.dom.dom,dat.utils.common),define("libs/datgui",function(){}),function(e){"function"==typeof define&&define.amd?define("purl",e):window.purl=e()}(function(){function e(e,t){for(var i=decodeURI(e),r=m[t?"strict":"loose"].exec(i),n={attr:{},param:{},seg:{}},a=14;a--;)n.attr[p[a]]=r[a]||"";return n.param.query=o(n.attr.query),n.param.fragment=o(n.attr.fragment),n.seg.path=n.attr.path.replace(/^\/+|\/+$/g,"").split("/"),n.seg.fragment=n.attr.fragment.replace(/^\/+|\/+$/g,"").split("/"),n.attr.base=n.attr.host?(n.attr.protocol?n.attr.protocol+"://"+n.attr.host:n.attr.host)+(n.attr.port?":"+n.attr.port:""):"",n}function t(e){var t=e.tagName;return"undefined"!=typeof t?d[t.toLowerCase()]:t}function i(e,t){if(0===e[t].length)return e[t]={};var i={};for(var r in e[t])i[r]=e[t][r];return e[t]=i,i}function r(e,t,n,o){var a=e.shift();if(a){var s=t[n]=t[n]||[];"]"==a?h(s)?""!==o&&s.push(o):"object"==typeof s?s[c(s).length]=o:s=t[n]=[t[n],o]:~a.indexOf("]")?(a=a.substr(0,a.length-1),!g.test(a)&&h(s)&&(s=i(t,n)),r(e,s,a,o)):(!g.test(a)&&h(s)&&(s=i(t,n)),r(e,s,a,o))}else h(t[n])?t[n].push(o):t[n]="object"==typeof t[n]?o:"undefined"==typeof t[n]?o:[t[n],o]}function n(e,t,i){if(~t.indexOf("]")){var n=t.split("[");r(n,e,"base",i)}else{if(!g.test(t)&&h(e.base)){var o={};for(var s in e.base)o[s]=e.base[s];e.base=o}""!==t&&a(e.base,t,i)}return e}function o(e){return l(String(e).split(/&|;/),function(e,t){try{t=decodeURIComponent(t.replace(/\+/g," "))
}catch(i){}var r=t.indexOf("="),o=s(t),a=t.substr(0,o||r),l=t.substr(o||r,t.length);return l=l.substr(l.indexOf("=")+1,l.length),""===a&&(a=t,l=""),n(e,a,l)},{base:{}}).base}function a(e,t,i){var r=e[t];"undefined"==typeof r?e[t]=i:h(r)?r.push(i):e[t]=[r,i]}function s(e){for(var t,i,r=e.length,n=0;r>n;++n)if(i=e[n],"]"==i&&(t=!1),"["==i&&(t=!0),"="==i&&!t)return n}function l(e,t){for(var i=0,r=e.length>>0,n=arguments[2];r>i;)i in e&&(n=t.call(void 0,n,e[i],i,e)),++i;return n}function h(e){return"[object Array]"===Object.prototype.toString.call(e)}function c(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t}function u(t,i){return 1===arguments.length&&t===!0&&(i=!0,t=void 0),i=i||!1,t=t||window.location.toString(),{data:e(t,i),attr:function(e){return e=f[e]||e,"undefined"!=typeof e?this.data.attr[e]:this.data.attr},param:function(e){return"undefined"!=typeof e?this.data.param.query[e]:this.data.param.query},fparam:function(e){return"undefined"!=typeof e?this.data.param.fragment[e]:this.data.param.fragment},segment:function(e){return"undefined"==typeof e?this.data.seg.path:(e=0>e?this.data.seg.path.length+e:e-1,this.data.seg.path[e])},fsegment:function(e){return"undefined"==typeof e?this.data.seg.fragment:(e=0>e?this.data.seg.fragment.length+e:e-1,this.data.seg.fragment[e])}}}var d={a:"href",img:"src",form:"action",base:"href",script:"src",iframe:"src",link:"href",embed:"src",object:"data"},p=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","fragment"],f={anchor:"fragment"},m={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},g=/^[0-9]+$/;return u.jQuery=function(e){null!=e&&(e.fn.url=function(i){var r="";return this.length&&(r=e(this).attr(t(this[0]))||""),u(r,i)},e.url=u)},u.jQuery(window.jQuery),u}),define("utils/gui",["libs/datgui","purl"],function(){return null}),define("data",["module"],function(e){var t=function(t,i){require([e.config().instagram.feed+"&callback=define",e.config().twitter.feed+"&callback=define"],function(e,r){r.loaded="OK"===r.status,e.loaded="OK"===e.status;var n=e.loaded&&r.loaded;n?t(r,e):i(e,r)})};return t.search=function(t,i){require([e.config().instagram.search+t+"&callback=define&bust="+Date.now(),e.config().twitter.search+t+"&callback=define&bust="+Date.now()],function(e,t){t.loaded="OK"===t.status,e.loaded="OK"===e.status;var r=e.loaded&&t.loaded;r?i(t.results,e.results):errCallback(e,t)})},t}),define("textplane",["libs/threejs/build/three"],function(){function e(e,t,i,r,n,o){for(var a=t.split(" "),s="",l=0;l<a.length;l++){var h=s+a[l]+" ",c=e.measureText(h),u=c.width;u>n&&l>0||a[l].split("\n").length>1?(e.fillText(s,i,r),s=a[l]+" ",r+=o*(a[l].split("\n").length>1?2:1)):s=h}e.fillText(s,i,r)}var t=1500;return function(i,r,n,o,a,s){var l=document.createElement("canvas"),h=l.getContext("2d");l.width=t,l.height=t,s=s||0,r=r||11,n=n||0,o=o||16777215,a=a||.5,h.font=r+"pt Helvertica Neue, Arial, sans",h.scale(-1,-1),h.measureText(i).width,h=l.getContext("2d"),h.textAlign="center",h.font=r+"pt Helvertica Neue, Arial, sans",h.fillStyle=("000000"+o.toString(16)).slice(-6),h.fillRect(0,0,-l.width,-l.height),h.textBaseline="middle",h.fillStyle=("000000"+n.toString(16)).slice(-6),e(h,i,l.width*-.5,l.height*-.5,.3*l.width,31);var c=new THREE.Texture(l);return c.needsUpdate=!0,l}}),define("transition",[],function(){function e(e){for(i=o.length;i-->0;)o[i](e)}function t(e,t,i,n){n.spring=n.spring||r,n.delay=n.delay||0;var o,a,l,h,c,u=!1,d=0,p=0,f=Math.sqrt(n.spring);return update=function(i,r,m,g){return p+=m,p>=n.delay&&(c=r-i,h=m*s.globalSpeed,o=c*n.spring,a=2*-d*f,l=o+a,d+=l*h,d=g?0:d,e[t]+=d*h,!u)?u=!0:!1}}var i,r=1.5,n=20,o=[],a=function(){},s=function(e,i,r,s){var s=s||{},l=t(e,i,r,s),h=!1,c=!1,u={callback:a,startCallback:function(){},target:r||null,arrived:!1,paused:!1,speed:s.speed||1,dispose:function(){o.splice(o.indexOf(d),1)},reset:function(){h=!0}};s.threshold=s.threshold||n;var d=function(t){c=!1,u.paused||null===u.target||(c=l(e[i],u.target,t*u.speed,h),c&&u.startCallback(),!u.arrived&&Math.abs(u.target-e[i])<=s.threshold&&(u.arrived=!0,u.callback())),h=!1};return o.push(d),u};return s.update=function(t){e(t||1)},s.globalSpeed=1,s.vec3=function(e,i,r){var s,l,h,r=r||{},c=t(e,["x"],i.x,r),u=t(e,["y"],i.y,r),d=t(e,["z"],i.z,r),p=!1,f=!1;controls={callback:a,startCallback:function(){},target:i||null,arrived:!1,paused:!0,speed:r.speed||1,dispose:function(){o.splice(o.indexOf(m),1)},reset:function(){f=!0}},r.threshold=r.threshold||n;var m=function(t){if(!controls.paused&&null!==controls.target){p=c(e.x,controls.target.x,t*controls.speed,f),p=u(e.y,controls.target.y,t*controls.speed,f)&&p,p=d(e.z,controls.target.z,t*controls.speed,f)&&p,p&&controls.startCallback(),s=controls.target.x-e.x,l=controls.target.y-e.y,h=controls.target.z-e.z;var i=Math.sqrt(s*s+l*l+h*h);!controls.arrived&&i<=r.threshold&&(controls.arrived=!0,controls.callback())}f=!1};return o.push(m),controls},s}),define("utils/easing",{linear:function(e){return e},inQuad:function(e){return e*e},outQuad:function(e){return e*(2-e)},inOutQuad:function(e){return.5>e?2*e*e:-1+(4-2*e)*e},inCubic:function(e){return e*e*e},outCubic:function(e){return--e*e*e+1},inOutCubic:function(e){return.5>e?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},inQuart:function(e){return e*e*e*e},outQuart:function(e){return 1- --e*e*e*e},inOutQuart:function(e){return.5>e?8*e*e*e*e:1-8*--e*e*e*e},inQuint:function(e){return e*e*e*e*e},outQuint:function(e){return 1+--e*e*e*e*e},inOutQuint:function(e){return.5>e?16*e*e*e*e*e:1+16*--e*e*e*e*e}}),define("sounds",{mouseOver:[new Howl({urls:["audio/over1.mp3","audio/over1.ogg"],loop:!1,volume:1}),new Howl({urls:["audio/over2.mp3","audio/over2.ogg"],loop:!1,volume:1})],mouseDrag:new Howl({urls:["audio/turn.mp3","audio/turn.ogg"],loop:!1,volume:1}),ambient:new Howl({urls:["audio/raum.mp3","audio/raum.ogg"],loop:!0,volume:1}),search:new Howl({urls:["audio/search.mp3","audio/search.ogg"],loop:!1,volume:1}),click:[new Howl({urls:["audio/fly-in1.mp3","audio/fly-in1.ogg"],volume:1,loop:!1}),new Howl({urls:["audio/fly-in2.mp3","audio/fly-in2.ogg"],volume:1,loop:!1}),new Howl({urls:["audio/fly-in3.mp3","audio/fly-in3.ogg"],volume:1,loop:!1})],closer:[new Howl({urls:["audio/closer1.mp3","audio/closer1.ogg"],volume:1,loop:!1}),new Howl({urls:["audio/closer2.mp3","audio/closer2.ogg"],volume:1,loop:!1}),new Howl({urls:["audio/closer3.mp3","audio/closer3.ogg"],volume:1,loop:!1})],out:new Howl({urls:["audio/flyout.mp3","audio/flyout.ogg"],volume:1,loop:!1}),entering:[new Howl({urls:["audio/entering1.mp3","audio/entering1.ogg"],volume:1,loop:!1}),new Howl({urls:["audio/entering2.mp3","audio/entering2.ogg"],volume:1,loop:!1})]});var TWEEN=TWEEN||function(){var e=[];return{REVISION:"10",getAll:function(){return e},removeAll:function(){e=[]},add:function(t){e.push(t)},remove:function(t){var i=e.indexOf(t);-1!==i&&e.splice(i,1)},update:function(t){if(0===e.length)return!1;var i=0,r=e.length;for(t=void 0!==t?t:void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();r>i;)e[i].update(t)?i++:(e.splice(i,1),r--);return!0}}}();TWEEN.Tween=function(e){var t=e,i={},r={},n={},o=1e3,a=0,s=0,l=null,h=TWEEN.Easing.Linear.None,c=TWEEN.Interpolation.Linear,u=[],d=null,p=!1,f=null,m=null;for(var g in e)i[g]=parseFloat(e[g],10);this.to=function(e,t){return void 0!==t&&(o=t),r=e,this},this.start=function(e){TWEEN.add(this),p=!1,l=void 0!==e?e:void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),l+=s;for(var o in r){if(r[o]instanceof Array){if(0===r[o].length)continue;r[o]=[t[o]].concat(r[o])}i[o]=t[o],i[o]instanceof Array==!1&&(i[o]*=1),n[o]=i[o]||0}return this},this.stop=function(){return TWEEN.remove(this),this},this.delay=function(e){return s=e,this},this.repeat=function(e){return a=e,this},this.easing=function(e){return h=e,this},this.interpolation=function(e){return c=e,this},this.chain=function(){return u=arguments,this},this.onStart=function(e){return d=e,this},this.onUpdate=function(e){return f=e,this},this.onComplete=function(e){return m=e,this},this.update=function(e){if(l>e)return!0;p===!1&&(null!==d&&d.call(t),p=!0);var g=(e-l)/o;g=g>1?1:g;var v=h(g);for(var E in r){var y=i[E]||0,T=r[E];T instanceof Array?t[E]=c(T,v):("string"==typeof T&&(T=y+parseFloat(T,10)),t[E]=y+(T-y)*v)}if(null!==f&&f.call(t,v),1==g){if(a>0){isFinite(a)&&a--;for(var E in n)"string"==typeof r[E]&&(n[E]=n[E]+parseFloat(r[E],10)),i[E]=n[E];return l=e+s,!0}null!==m&&m.call(t);for(var _=0,b=u.length;b>_;_++)u[_].start(e);return!1}return!0}},TWEEN.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,i=.1,r=.4;return 0===e?0:1===e?1:(!i||1>i?(i=1,t=r/4):t=r*Math.asin(1/i)/(2*Math.PI),-(i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*2*Math.PI/r)))},Out:function(e){var t,i=.1,r=.4;return 0===e?0:1===e?1:(!i||1>i?(i=1,t=r/4):t=r*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*e)*Math.sin((e-t)*2*Math.PI/r)+1)},InOut:function(e){var t,i=.1,r=.4;return 0===e?0:1===e?1:(!i||1>i?(i=1,t=r/4):t=r*Math.asin(1/i)/(2*Math.PI),(e*=2)<1?-.5*i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*2*Math.PI/r):.5*i*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*2*Math.PI/r)+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?.5*e*e*((t+1)*e-t):.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-TWEEN.Easing.Bounce.Out(1-e)},Out:function(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return.5>e?.5*TWEEN.Easing.Bounce.In(2*e):.5*TWEEN.Easing.Bounce.Out(2*e-1)+.5}}},TWEEN.Interpolation={Linear:function(e,t){var i=e.length-1,r=i*t,n=Math.floor(r),o=TWEEN.Interpolation.Utils.Linear;return 0>t?o(e[0],e[1],r):t>1?o(e[i],e[i-1],i-r):o(e[n],e[n+1>i?i:n+1],r-n)},Bezier:function(e,t){var i,r=0,n=e.length-1,o=Math.pow,a=TWEEN.Interpolation.Utils.Bernstein;for(i=0;n>=i;i++)r+=o(1-t,n-i)*o(t,i)*e[i]*a(n,i);return r},CatmullRom:function(e,t){var i=e.length-1,r=i*t,n=Math.floor(r),o=TWEEN.Interpolation.Utils.CatmullRom;return e[0]===e[i]?(0>t&&(n=Math.floor(r=i*(1+t))),o(e[(n-1+i)%i],e[n],e[(n+1)%i],e[(n+2)%i],r-n)):0>t?e[0]-(o(e[0],e[0],e[1],e[1],-r)-e[0]):t>1?e[i]-(o(e[i],e[i],e[i-1],e[i-1],r-i)-e[i]):o(e[n?n-1:0],e[n],e[n+1>i?i:n+1],e[n+2>i?i:n+2],r-n)},Utils:{Linear:function(e,t,i){return(t-e)*i+e},Bernstein:function(e,t){var i=TWEEN.Interpolation.Utils.Factorial;return i(e)/i(t)/i(e-t)},Factorial:function(){var e=[1];return function(t){var i,r=1;if(e[t])return e[t];for(i=t;i>1;i--)r*=i;return e[t]=r}}(),CatmullRom:function(e,t,i,r,n){var o=.5*(i-e),a=.5*(r-t),s=n*n,l=n*s;return(2*t-2*i+o+a)*l+(-3*t+3*i-2*o-a)*s+o*n+t}}},define("libs/Tween",function(){}),THREE.OrbitControls=function(e,t){function i(){return 2*Math.PI/60/60*h.autoRotateSpeed}function r(){return Math.pow(.95,h.userZoomSpeed)}function n(e){h.enabled!==!1&&h.userRotate!==!1&&(0===e.button?(x=b.ROTATE,d.set(e.clientX,e.clientY)):1===e.button?(x=b.ZOOM,m.set(e.clientX,e.clientY)):2===e.button&&(x=b.PAN),h.domElement.addEventListener("mousemove",o,!1),h.domElement.addEventListener("mouseup",a,!1))}function o(e){if(e.preventDefault(),e.stopImmediatePropagation(),h.enabled!==!1)if(e.preventDefault(),x===b.ROTATE)w&&(w=!1,h.dispatchEvent(startDragEvent)),p.set(e.clientX,e.clientY),f.subVectors(p,d),h.rotateLeft(2*Math.PI*f.x/u*h.userRotateSpeed),h.rotateUp(2*Math.PI*f.y/u*h.userRotateSpeed),d.copy(p);else if(x===b.ZOOM)g.set(e.clientX,e.clientY),v.subVectors(g,m),v.y>0?h.zoomIn():h.zoomOut(),m.copy(g);else if(x===b.PAN){var t=e.movementX||e.mozMovementX||e.webkitMovementX||0,i=e.movementY||e.mozMovementY||e.webkitMovementY||0;h.pan(new THREE.Vector3(-t,i,0))}}function a(e){e.preventDefault(),e.stopImmediatePropagation(),w=!0,h.enabled!==!1&&h.userRotate!==!1&&(h.domElement.removeEventListener("mousemove",o,!1),h.domElement.removeEventListener("mouseup",a,!1),x=b.NONE)}function s(e){if(h.enabled!==!1&&h.userZoom!==!1){var t=0;e.wheelDelta?t=e.wheelDelta:e.detail&&(t=-e.detail),t>0?h.zoomOut():h.zoomIn()}}function l(e){if(h.enabled!==!1&&h.userPan!==!1)switch(e.keyCode){case h.keys.UP:h.pan(new THREE.Vector3(0,1,0));break;case h.keys.BOTTOM:h.pan(new THREE.Vector3(0,-1,0));break;case h.keys.LEFT:h.pan(new THREE.Vector3(-1,0,0));break;case h.keys.RIGHT:h.pan(new THREE.Vector3(1,0,0))}}this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.center=new THREE.Vector3,this.userZoom=!0,this.userZoomSpeed=1,this.userRotate=!0,this.userRotateSpeed=1,this.userPan=!0,this.userPanSpeed=2,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minDistance=0,this.maxDistance=1/0,this.distance=4e3,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var h=this,c=1e-6,u=1800,d=new THREE.Vector2,p=new THREE.Vector2,f=new THREE.Vector2,m=new THREE.Vector2,g=new THREE.Vector2,v=new THREE.Vector2,E=0,y=0,T=1,_=new THREE.Vector3,b={NONE:-1,ROTATE:0,ZOOM:1,PAN:2},x=b.NONE,R={type:"change"};this.rotateLeft=function(e){void 0===e&&(e=i()),y-=e},this.rotateRight=function(e){void 0===e&&(e=i()),y+=e},this.rotateUp=function(e){void 0===e&&(e=i()),E-=e},this.rotateDown=function(e){void 0===e&&(e=i()),E+=e},this.zoomIn=function(e){void 0===e&&(e=r()),T/=e},this.zoomOut=function(e){void 0===e&&(e=r()),T*=e},this.pan=function(e){e.transformDirection(this.object.matrix),e.multiplyScalar(h.userPanSpeed),this.object.position.add(e),this.center.add(e)},this.update=function(e){e&&(this.object=e);var t=this.object.position,r=t.clone().sub(this.center),n=Math.atan2(r.x,r.z),o=Math.atan2(Math.sqrt(r.x*r.x+r.z*r.z),r.y);this.autoRotate&&this.rotateLeft(i()),n+=y,o+=E,o=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,o)),o=Math.max(c,Math.min(Math.PI-c,o)),r.length()*T,r.x=this.distance*Math.sin(o)*Math.sin(n),r.y=this.distance*Math.cos(o),r.z=this.distance*Math.sin(o)*Math.cos(n),t.copy(this.center).add(r),this.object.lookAt(this.center),y=0,E=0,T=1,_.distanceTo(this.object.position)>0&&(this.dispatchEvent(R),_.copy(this.object.position))};var w=!0;startDragEvent={type:"drag"},this.setPauseState=function(e){this.enabled===e&&(e?(this.domElement.removeEventListener("mousemove",o,!1),this.domElement.removeEventListener("mouseup",a,!1),this.domElement.addEventListener("mousewheel",a,!1)):(this.domElement.addEventListener("mousedown",n,!1),this.domElement.addEventListener("mousewheel",a,!1)),this.enabled=!e)},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",n,!1),this.domElement.addEventListener("mousewheel",s,!1),this.domElement.addEventListener("DOMMouseScroll",s,!1),this.domElement.addEventListener("keydown",l,!1)},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),define("libs/threejs/examples/js/controls/OrbitControls",function(){}),define("main",["module","jquery","libs/jquery-ui","glsl!shaders/structure.glsl","utils/math","structure","glsl!shaders/skydome.glsl","utils/timer","lighting","utils/gui","data","textplane","transition","utils/easing","glsl!shaders/clouds.glsl","glsl!shaders/post.glsl","sounds","libs/Tween","purl","./libs/threejs/examples/js/controls/OrbitControls"],function(e,t,i,r,o,a,s,l,h,c,u,d,p,f,m,g,v){function E(){B=window.innerWidth,j=window.innerHeight,nt.aspect=B/j,nt.updateProjectionMatrix(),Z.setSize(B,j)}function y(e,t,i){e.stop().fadeOut({duration:t||400,complete:i})}function T(){for(var e=ut.children.length;e-->0;)Jt.splice(Jt.indexOf(ut.children[e]),1),ut.remove(ut.children[e])}function _(){v.ambient.fadeIn(1,1e3),v.search.fadeOut(0,1e3),Et=!1,it.value="",T(),tt.fadeOut(0),y(et,400),et.expanded&&(et.expanded=!1,et.children("#body").toggle({direction:"right",progress:w,duration:400},400)),A(.9),M()}function b(t,i,r){var n=[];n.loadCount=0,Rt.image=n;var o="https://levismakeourmark.thismoment.com/v4/api/media/image_proxy.json?url=";Rt.flipY=!1;for(var a=0,s=t.length;s>a;++a){var l=new Image;n[a]=l,l.onload=function(){n.loadCount+=1,6===n.loadCount&&(Rt.needsUpdate=!0,i&&i(Rt))},l.onerror=r,l.crossOrigin="",l.src=(e.config().proxy||o)+t[a]}return Rt}function x(e,t){b([t,t,t,t,t,t],function(t){q&&q.material===e&&(q.material.opacity=.28,q.material.envMap=t)})}function R(e,t){wt.image=[t,t,t,t,t,t],wt.needsUpdate=!0,e.opacity=.28,e.envMap=wt}function w(e,t){et.xOffset=500*f.inOutQuad(et.expanded?t:1-t)}function H(e,t,i){i=i||1,yt=t||250,Ht.target=yt,Mt.target.copy(e),dt=!0,Mt.arrived=!1,Ht.arrived=!1,Mt.paused=!1,Mt.speed=Ht.speed=i}function M(){K&&K.light&&(K.isSelected=!1,K.light.transition.target=0,K.light.transitionDist.target=Et?4:1,K.light.transition.paused=!1,Qt.push(K.light)),K&&(K.material.envMap=xt,K.material.opacity=.9),P(),q=null,v.out.play(),y(et,400),H(ht.set(0,0,0),2e3,.4)}function S(e){q=e,q.isSelected=!0,q.light.transitionDist.target=Et?5.5:3,Qt.splice(Qt.indexOf(q.light),1),v.click[Math.floor(Math.random()*v.click.length)].play(),ot.autoRotate=!0;var t=et.children("#body").children("#image");et.expanded&&et.video&&et.video.pause&&et.video.pause(),y(et,400,function(e,i){if(t.attr("src",e),q.isInstagram)x(q.material,i);else{var r=d(q.infoDataObject.title.toUpperCase(),20);R(q.material,r)}}.bind(this,q.infoDataObject.attribution_avatar,q.infoDataObject.media.length>0?q.infoDataObject.media[0].large:void 0,q.infoDataObject.media.length>0?q.infoDataObject.media[0].video_url:void 0)),et.expanded&&(et.expanded=!1,et.children("#body").toggle({direction:"right",progress:w,duration:400})),H(q.position)}function C(){for(var e=ct.children.length;e-->0;)ct.children[e].material&&(ct.children[e].material.needsUpdate=!0);for(e=ut.children.length;e-->0;)ut.children[e].material&&(ut.children[e].material.needsUpdate=!0);jt.needsUpdate=!0}function A(e){Gt.opacity=e,Wt.opacity=e,Gt.color.setHex(.5>e?4473924:Gt.prevColor),Gt.ambient.setHex(.5>e?4473924:Gt.prevAmbientColor),Wt.color.setHex(.5>e?4473924:Gt.prevColor),Wt.ambient.setHex(.5>e?4473924:Gt.prevAmbientColor)}function D(e,t,i,r){var n=new THREE.Mesh(vi,t?Wt:Gt),o=0|Math.random()*r.length,a=r.splice(o,1)[0];return i?n.position.copy(i):n.position.set(a[0],a[1],a[2]),n.position.x-=15,n.position.y-=15,n.position.z-=15,n.position.multiplyScalar(100),n.matrixWorld.setPosition(n.position),n.infoDataObject=e,n}function P(){q&&(q.isSelected=!1,q.material.opacity=.9,q.light.transition.target=0,q.light.transition.reset(),q.light.transition.paused=!1,q.light.transitionDist.target=Et?5:1,Qt.push(q.light),q.material.envMap=xt,q.material.needsUpdate=!0)}function L(e){y(et,400),P(),q=null;var t,i=new THREE.Vector3;Et=!0,$(".featured-submissions").hide(0),$("#search-field").blur(),""!==e&&u.search(e,function(e,r){for(var n=e.concat(r),o=n.length;o-->0;)n[o].isInstagram=o>=e.length;tt.children("#results").html("YOUR SEARCH RETURNED <br/><b>"+(0===n.length?"NO":Math.min(n.length,X))+" SUBMISSIONS</b>"),tt.fadeIn(0,function(){Et=!1}),n.sort(function(){return Math.random()-.5}),Et=!0,T(),qt.centeredVolume=qt.volume.slice();var a=new THREE.Vector3,s=new THREE.Vector3;if(qt.centeredVolume.sort(function(e,t){return a.set(e[0]-15,e[1]-15,e[2]-15).length()-s.set(t[0]-15,t[1]-15,t[2]-15).length()}),qt.centeredVolume=qt.centeredVolume.splice(0,Math.max(40,0|qt.centeredVolume.length*Y)),n.length>0){v.ambient.fadeOut(0,1e3),v.search.volume(1),v.search.play(),A(.08);var l,h=qt.centeredVolume.slice();for(o=Math.min(n.length,X);o-->0&&h.length>0;)l=h[0|Math.random()*h.length],i.set(l[0],l[1],l[2]),t=D(n[o],n[o].isInstagram,i,qt.centeredVolume),Jt.push(t),t.isInstagram=n[o].isInstagram,t.material=Xt,ut.add(t);N(ut.children[0]),S(ut.children[0]),H(ut.children[0].position)}})}function k(){Ut&&(rt.remove(Ut),Ut.geometry.dispose()),qt=a(ti.frequency,ti.complexity,ti.seed,ti.threshold,ti.horizontal_thickness,ti.vertical_thickness),Ut=new THREE.Mesh(qt.geometry,jt),console.log(Ut.geometry.faces.length),Ut.matrixAutoUpdate=!1,rt.add(Ut)}function F(){function e(t){_i=t-Ei,Ti=_i-yi,Ti=Ti>W?W:Ti,yi=_i,TWEEN.update(yi),mt=Yt.update(nt),ot.setPauseState(mt),mt||ot.update(nt),I(),p.update(Ti/1e3*ti.speed),pt&&K&&(z(K.position,nt,$("#main")),bi=Number(Ri.top-200),bi-=Math.max(0,bi+et.height()-window.innerHeight+10),bi=Math.max(0,bi),et.css("transform","translate( "+Number(Ri.left+250-et.xOffset)+"px, "+bi+"px )")),requestAnimationFrame(e),O(Ti,yi)}xi||(xi=!0,v.ambient.play(),yi=0,Ti=0,_i=0,Ei=l.now()-(performance&&performance.timing?performance.timing.navigationStart:U),requestAnimationFrame(e))}function z(e,t,i){return wi.copy(e),Hi.copy(t.projectionMatrix).multiply(t.matrixWorldInverse),wi.applyProjection(Hi),Ri.left=(wi.x+1)*i.width()/2,Ri.top=(-wi.y+1)*i.height()/2,Ri}function N(e){var t=null===e.light,i=e.light||Qt[Qt.length-Qt.unshift(Qt.pop())];i.object=null,e.light=i,t&&(i.opacity=0,i.transition.reset()),i.transition.target=1,i.color.set(Et?i.blueColor:e.isInstagram?i.originalColor:i.twitterLightColor),i.object=e,i.position.copy(e.position),i.transition.paused=!1}function I(){Mi.set(lt.x,lt.y,1),at.unprojectVector(Mi,nt),st.set(nt.position,Mi.sub(nt.position).normalize());var e=st.intersectObjects(Jt,!0);if(e.length>0&&!e[0].object.unclickable){if(Q!=e[0].object){if(Q&&Q!==q&&Q.light&&(Q.light.transition.paused=!1,Q.light.transition.target=0),Et&&-1===ut.children.indexOf(e[0].object))return;v.mouseOver[Math.floor(Math.random()*v.mouseOver.length)].play(),Q=e[0].object,N(Q)}}else Q&&Q!==q&&Q.light&&(Q.light.transition.paused=!1,Q.light.transition.target=0),Q=null}function O(e,t){for(var i=allLights.length;i-->0;)allLights[i].distance=Math.sin(5e-4*t)*range+range+150,allLights[i].intensity=allLights[i].distance/175*(.6*Math.cos(10*t)+8),allLights[i].intensity*=allLights[i].opacity,allLights[i].distance*=allLights[i].distanceCoeff;for(var r=Dt.children.length;r-->0;)Dt.children[r].up.set(0,1,0).applyQuaternion(nt.quaternion),Dt.children[r].lookAt(nt.position),Dt.children[r].currentRot+=Dt.children[r].rotDirection,Si.setFromAxisAngle(normal,Dt.children[r].currentRot),Dt.children[r].quaternion.multiply(Si);St.uniforms.uTime.value+=.001*e,Ct.position.copy(nt.position),forward.set(0,0,-1).applyQuaternion(nt.quaternion),Ct.position.add(forward),Z.render(rt,nt)}console.log("=============================="),console.log("NAME:         "+NAME),console.log("VERSION:      e648f38"),console.log("DEBUG MODE:   "+!1),console.log("==============================");var U=Date.now();if(c){var V=document.getElementById("gui");V.appendChild(c.domElement)}var B=window.innerWidth,j=window.innerHeight,W=1e3/60,G=30,X=10,Y=.1;new THREE.Vector3(1500,1500,1500);var q,K,Q,Z=new THREE.WebGLRenderer({antialias:!0}),J=$("#main")[0],et=$("#info-overlay"),tt=$("#search-overlay"),it=$("#search-field")[0],rt=new THREE.Scene,nt=new THREE.PerspectiveCamera(65,B/j,1,1e5),ot=new THREE.OrbitControls(nt,J),at=new THREE.Projector,st=new THREE.Raycaster,lt=new THREE.Vector2,ht=new THREE.Vector3,ct=new THREE.Object3D,ut=new THREE.Object3D,dt=!1,pt=!1,ft=8e-4,mt=!1,gt=!0,vt=!1,Et=!1;$("#search-field").focus(function(e){e.preventDefault(),$("#search-field").val(""),vt=!0,_(),$("#search-container").toggleClass("search-focus",!0),$(".featured-submissions").slideDown(50)}).blur(function(){gt&&!Et&&(vt=!1,$("#search-container").toggleClass("search-focus",!1),$(".featured-submissions").hide(0))}),$(".vip, .search-button").mousedown(function(){gt=!1}),$(".vip").mouseup(function(){gt=!0;var e=$(this).data().username;$("#search-field").val(e),L(e),$("#search-field").blur()}),$(".search-button").mouseup(function(){gt=!0,L($("#search-field").val()),$("#search-field").blur()}),et.expanded=!1,et.xOffset=0,$("#search").fadeOut(0),et.vidElement=$(".videoWrapper"),et.vidElement.append($('<video  id="infoVid" ></video>')),videojs("infoVid",{techOrder:["html5","flash"],width:"100%",height:"auto"}).ready(function(){et.video=this}),rt.fog=new THREE.Fog(0,1,5e3),Z.setClearColor(1777698),ot.velocity=new THREE.Vector3,ot.maxPolarAngle=Math.PI/1.42,ot.userRotateSpeed=.4,ot.userPan=!1,ot.userZoom=!1,ot.autoRotate=!0,ot.autoRotateSpeed=300*ft;var yt=ot.distance=2e3;ot.distanceVel=0,ot.addEventListener("drag",function(){v.mouseDrag.play()}),nt.position.z=2e3,rt.add(nt),rt.add(ut),J.appendChild(Z.domElement),window.addEventListener("resize",E),document.addEventListener("mousemove",function(e){e.preventDefault(),lt.x=2*(e.clientX/window.innerWidth)-1,lt.y=2*-(e.clientY/window.innerHeight)+1});var Tt,_t;"undefined"!=typeof document.hidden?(Tt="hidden",_t="visibilitychange"):"undefined"!=typeof document.mozHidden?(Tt="mozHidden",_t="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(Tt="msHidden",_t="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(Tt="webkitHidden",_t="webkitvisibilitychange"),document.addEventListener(_t,function(){Howler.volume(document[Tt]?0:1),document[Tt]||(yi=0,Ti=0,_i=0,Ei=l.now()-(performance&&performance.timing?performance.timing.navigationStart:U))}),$("#search-field").click(function(e){e.stopImmediatePropagation(),$(this).select(),$(this).keypress(function(){vt||M(),vt=!0,q&&(q.material.envMap=xt,q.material.needsUpdate=!0)})});var bt=["img/skybox/px.jpg","img/skybox/nx.jpg","img/skybox/py.jpg","img/skybox/ny.jpg","img/skybox/pz.jpg","img/skybox/nz.jpg"],xt=THREE.ImageUtils.loadTextureCube(bt,new THREE.CubeRefractionMapping),Rt=new THREE.Texture(null,new THREE.CubeRefractionMapping),wt=new THREE.Texture(null,new THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.LinearMipMapLinearFilter,THREE.LinearMipMapLinearFilter);this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(.05,.05),wt.magFilter=THREE.LinearMipMapLinearFilter,wt.minFilter=THREE.LinearMipMapLinearFilter,$("#show-more").click(function(e){e.preventDefault(),e.stopImmediatePropagation(),et.expanded=!et.expanded,et.vidElement.toggle(q.isInstagram,0),et.children("#body").toggle({direction:"right",easing:"easeInOutQuad",duration:400,progress:w,complete:function(){et.expanded&&q.isInstagram&&(et.vidElement.append($('<video  id="infoVid" ></video>')),videojs("infoVid",{techOrder:["html5","flash"],width:"100%",height:"470px"}).ready(function(){et.video=this;var e=[];e[0]={},e[0].src=q.infoDataObject.media[0].video_url,e[0].type="video/mp4",setTimeout(function(){et.video.src(e),et.video.play()},100)}))}}),!et.expanded&&q.isInstagram&&et.video.dispose()}),et.children(".buttons").children(".close-button-icon").click(function(e){e.preventDefault(),e.stopImmediatePropagation(),y(et,400),et.expanded&&(et.expanded=!1,K.isInstagram&&et.video&&et.video.pause(),et.children("#body").toggle({direction:"right",progress:w,duration:400})),K.material.envMap=xt,K.material.needsUpdate=!0,M()});var Ht=p(ot,["distance"],null,{spring:1.5}),Mt=p.vec3(ot.center,new THREE.Vector3,null,{spring:2});Mt.paused=!0,Mt.callback=function(){if(dt=!1,pt=!0,q){K=q;var e=et.children("#body");v.closer[Math.floor(Math.random()*v.closer.length)].play(),e.children("#content").html(q.infoDataObject.title),$("#show-more").toggleClass("camera-button-icon",q.isInstagram),e.children("#user-info").children("#user-name").html("<a href='"+(q.isInstagram?"http://instagram.com/"+q.infoDataObject.user_info.screen_name:q.infoDataObject.user_info.user_url)+"' target='_blank'>"+q.infoDataObject.user_name+"</a>"),e.children("#user-info").children("#user-id").html((q.isInstagram?"":"@")+q.infoDataObject.user_info.screen_name),e.children("#date").html("Posted via "+(q.isInstagram?"Instagram":"Twitter")+" on "+new Date(q.infoDataObject.add_date.slice(0,10)).toDateString().slice(4)),et.stop().fadeIn(400),et.expanded=!1,et.children("#body").hide({direction:"right",progress:w,duration:1,complete:function(){et.expanded=!1,w(1,1)}})}},document.addEventListener("click",function(e){if(Q&&Q!==q){if(e.preventDefault(),e.stopImmediatePropagation(),Et&&-1===ut.children.indexOf(Q))return;q&&(q.isSelected=!1,q.material.opacity=.9,q.light.transition.target=0,q.light.transition.reset(),q.light.transition.paused=!1,q.light.transitionDist.target=Et?5:1,Qt.push(q.light),q.material.envMap=xt),S(Q)}}),Z.setSize(B,j);var St=new THREE.ShaderMaterial({uniforms:{uTime:{type:"f",value:0},opacity:{type:"f",value:.26},visible:{type:"f",value:0},fNintensity:{type:"f",value:.8},fSintensity:{type:"f",value:.7},fScount:{type:"f",value:2500},vignetteAmount:{type:"f",value:1},vignetteStart:{type:"f",value:.2},vignetteEnd:{type:"f",value:.87},noiseColor:{type:"c",value:new THREE.Color(2631720)},vignColor:{type:"c",value:new THREE.Color(788488)}},vertexShader:g.vertexShader,fragmentShader:g.fragmentShader,depthWrite:!1,depthTest:!1,transparent:!0,blend:THREE.MultiplyBlending}),Ct=new THREE.Mesh(new THREE.PlaneGeometry(2,2,1,1),St);rt.add(Ct);var At={},Dt=new THREE.Object3D;new THREE.Geometry;var Pt=THREE.ImageUtils.loadTexture("img/darkCloud.png");At.material=new THREE.ShaderMaterial({uniforms:{map:{type:"t",value:Pt},fogColor:{type:"c",value:rt.fog.color},fogNear:{type:"f",value:rt.fog.near},fogFar:{type:"f",value:rt.fog.far},opacity:{type:"f",value:.18},offset:{type:"f",value:.4},useClouds:{type:"f",value:1},exponent:{type:"f",value:1}},vertexShader:m.vertexShader,fragmentShader:m.fragmentShader,depthWrite:!1,transparent:!0,blend:THREE.AdditiveBlending});for(var Lt,kt=new THREE.PlaneGeometry(64,64),Ft=0;15>Ft;Ft++)Lt=new THREE.Mesh(kt,At.material),Lt.position.x=o.random(-1500,1500),Lt.position.y=o.random(-1500,1500),Lt.position.z=o.random(-1500,1500),Lt.oldScale=Lt.scale.x=Lt.scale.y=15*Math.random()*Math.random()+25,Lt.currentRot=Math.random()*Math.PI,Lt.rotDirection=4e-4*o.random(-1,1),Dt.add(Lt);rt.add(Dt);var zt={topColor:{type:"c",value:new THREE.Color(7829367)},bottomColor:{type:"c",value:new THREE.Color(2236962)},offset:{type:"f",value:10},exponent:{type:"f",value:.5}},Nt=new THREE.SphereGeometry(4e3,32,15),It=new THREE.ShaderMaterial({vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,uniforms:zt,side:THREE.BackSide});It.visible=!1;var Ot=new THREE.Mesh(Nt,It);rt.add(Ot);var ct,Ut,Vt=[2394,1231,1136,5136,6136,6555,6572,4472,8765,6773,6594],Bt=Vt[Math.floor(Math.random()*Vt.length)],jt=new THREE.MeshPhongMaterial({reflectivity:.5,perPixel:!1,color:2236962,ambient:4353412,specular:16777215,shininess:30,metal:!1}),Wt=new THREE.MeshPhongMaterial({color:new THREE.Color(6710886),specular:16777215,ambient:new THREE.Color(16777215),transparent:!0,envMap:xt,refractionRatio:1.25,side:THREE.DoubleSide,combine:THREE.MixOperation,blending:THREE.AdditiveBlending,opacity:.9});Wt.defines={FLIP:!0},Wt.originColor=new THREE.Color(6688e3),Wt.prevColor=new THREE.Color(6710886),Wt.prevAmbientColor=16777215;
var Gt=new THREE.MeshPhongMaterial({color:new THREE.Color(6710886),specular:16777215,ambient:new THREE.Color(16777215),transparent:!0,envMap:xt,refractionRatio:1.25,combine:THREE.MixOperation,blending:THREE.AdditiveBlending,opacity:.9});Gt.originColor=new THREE.Color(2622720),Gt.prevColor=new THREE.Color(6710886),Gt.prevAmbientColor=16777215,Gt.defines={FLIP:!0};var Xt=new THREE.MeshPhongMaterial({color:new THREE.Color(6710886),specular:16777215,ambient:new THREE.Color(16777215),transparent:!0,envMap:xt,refractionRatio:1.25,combine:THREE.MixOperation,blending:THREE.AdditiveBlending,opacity:.9});Xt.defines={FLIP:!0},jt.seed=Bt.toString();var Yt=new h(rt,nt,J,c);Yt.onLightAdded(C),Yt.onLightRemoved(C),Yt.addPointLight(16777215),Yt.addPointLight(16777215),Yt.addPointLight(16777215);for(var qt,Kt,Qt=[],$t=new THREE.Mesh(new THREE.Geometry,Wt),Zt=new THREE.Mesh(new THREE.Geometry,Gt),Jt=[],ei=3;ei-->0;)Kt=new THREE.PointLight(16721432,0,250),Kt.color.multiplyScalar(22),Kt.originalColor=new THREE.Color(Kt.color.clone()),Kt.blueColor=new THREE.Color(591124).multiplyScalar(30),Kt.twitterLightColor=new THREE.Color(989280).multiplyScalar(30),Kt.opacity=0,Kt.distanceCoeff=1,Kt.transition=p(Kt,"opacity",0,{threshold:.01,speed:5}),Kt.transitionDist=p(Kt,"distanceCoeff",1,{threshold:.01,speed:.1}),Kt.transition.target=0,Kt.transition.callback=function(e){e.transition.arrived=!1,e.transition.paused=!0,e.opacity=e.transition.target,e.transition.target<.5&&e.object&&!e.object.isSelected&&(e.object.light=null)}.bind(this,Kt),Qt.push(Kt),rt.add(Kt);allLights=Qt.slice();var ti={frequency:.95,speed:1.4,threshold:.68,noiseAmount:.7,complexity:.82,horizontal_thickness:11,vertical_thickness:3,generate:k,seed:String(Bt),camera:!1,rollLight:{color:"#"+Qt[0].color.getHexString(),scale:22,update:function(){for(var e=Qt.length;e-->0;)Qt[e].originalColor.setStyle(ti.rollLight.color).multiplyScalar(ti.rollLight.scale);q&&q.light&&q.light.color.setStyle(ti.rollLight.color).multiplyScalar(ti.rollLight.scale)}},clouds:{debug:!1,opacity:At.material.uniforms.opacity.value,offset:At.material.uniforms.offset.value,exponent:At.material.uniforms.exponent.value,update:function(){At.material.uniforms.exponent.value=ti.clouds.exponent,At.material.uniforms.opacity.value=ti.clouds.opacity,At.material.uniforms.offset.value=ti.clouds.offset,At.material.uniforms.useClouds.value=ti.clouds.debug?0:1;for(var e,t=Dt.children.length;t-->0;)e=ti.clouds.debug?5:Dt.children[t].oldScale,Dt.children[t].scale.set(e,e,1)}},post:{grain:{speed:1,opacity:St.uniforms.opacity.value,amount:St.uniforms.fNintensity.value,scanlines:St.uniforms.fSintensity.value,numScanlines:St.uniforms.fScount.value,color:"#"+St.uniforms.noiseColor.value.getHexString()},vignette:{opacity:St.uniforms.vignetteAmount.value,start:St.uniforms.vignetteStart.value,end:St.uniforms.vignetteEnd.value,color:"#"+St.uniforms.vignColor.value.getHexString()},update:function(){St.uniforms.fNintensity.value=ti.post.grain.amount,St.uniforms.fSintensity.value=ti.post.grain.scanlines,St.uniforms.fScount.value=ti.post.grain.numScanlines,St.uniforms.opacity.value=ti.post.grain.opacity,St.uniforms.vignetteAmount.value=ti.post.vignette.opacity,St.uniforms.vignetteStart.value=ti.post.vignette.start,St.uniforms.vignetteEnd.value=ti.post.vignette.end,St.uniforms.noiseColor.value.set(ti.post.grain.color),St.uniforms.vignColor.value.set(ti.post.vignette.color)}},background_color:"#"+Z.getClearColor().getHexString(),fog:{color:"#"+rt.fog.color.getHexString()},random:function(){Bt=0|9999*Math.random(),ti.seed=String(Bt);for(var e in c.__controllers)c.__controllers[e].updateDisplay();k()},updateCamera:function(){nt.updateProjectionMatrix()},structure:{shininess:jt.shininess,color:"#"+jt.color.getHexString(),specular:"#"+jt.specular.getHexString(),ambient:"#"+jt.ambient.getHexString(),updateMaterial:function(){jt.color.set(ti.structure.color),jt.specular.set(ti.structure.specular),jt.ambient.set(ti.structure.ambient),jt.shininess=ti.structure.shininess}},dataObjects:{refractionRatio:1.25,reflectivity:1,metal:!1,twitter:{color:"#"+Gt.color.getHexString(),opacity:Gt.opacity,specular:"#"+Gt.specular.getHexString(),ambient:"#"+Gt.ambient.getHexString(),shininess:Gt.shininess,combine:Gt.combine},instagram:{color:"#"+Wt.color.getHexString(),opacity:Gt.opacity,specular:"#"+Wt.specular.getHexString(),ambient:"#"+Wt.ambient.getHexString(),shininess:Wt.shininess,combine:Wt.combine},updateMaterial:function(){for(Wt.refractionRatio=Gt.refractionRatio=ti.dataObjects.refractionRatio,Wt.reflectivity=Gt.reflectivity=ti.dataObjects.reflectivity,Wt.metal=Gt.metal=ti.dataObjects.metal,Wt.opacity=ti.dataObjects.instagram.opacity,Gt.opacity=ti.dataObjects.twitter.opacity,Wt.color.set(ti.dataObjects.instagram.color),Gt.color.set(ti.dataObjects.twitter.color),Wt.specular.set(ti.dataObjects.instagram.specular),Gt.specular.set(ti.dataObjects.twitter.specular),Wt.ambient.set(ti.dataObjects.instagram.ambient),Gt.ambient.set(ti.dataObjects.twitter.ambient),Wt.shininess=ti.dataObjects.instagram.shininess,Gt.shininess=ti.dataObjects.twitter.shininess,Wt.combine=ti.dataObjects.instagram.combine,Gt.combine=ti.dataObjects.twitter.combine,n=ut.children.length;n-->0;)ut.children[n].material&&(ut.children[n].material.refractionRatio=ti.dataObjects.refractionRatio,ut.children[n].material.reflectivity=ti.dataObjects.reflectivity,ut.children[n].material.opacity=ti.dataObjects.opacity,ct.children[n].material.metal=ti.dataObjects.metal,ct.children[n].material.needsUpdate=!0)}},updateBackgoundColor:function(){Z.setClearColor(ti.background_color)},updateFogColor:function(){rt.fog.color.set(ti.fog.color)}};if(c){var ii=c.addFolder("structure");ii.add(ti,"frequency",0,2).onFinishChange(ti.generate),ii.add(ti,"threshold",.01,.99).onFinishChange(ti.generate),ii.add(ti,"complexity",0,1).onFinishChange(ti.generate),ii.add(ti,"horizontal_thickness",0,50).onFinishChange(ti.generate),ii.add(ti,"vertical_thickness",0,50).onFinishChange(ti.generate);var ri=c.addFolder("Structure Material");ri.addColor(ti.structure,"color").onChange(ti.structure.updateMaterial),ri.addColor(ti.structure,"ambient").onChange(ti.structure.updateMaterial),ri.addColor(ti.structure,"specular").onChange(ti.structure.updateMaterial),ri.add(ti.structure,"shininess").onChange(ti.structure.updateMaterial),ri.add(jt,"metal");var ni=c.addFolder("Data Object Material");ni.add(ti.dataObjects,"refractionRatio").onChange(ti.dataObjects.updateMaterial),ni.add(ti.dataObjects,"reflectivity",0,1).onChange(ti.dataObjects.updateMaterial),ni.add(ti.dataObjects,"metal").onChange(ti.dataObjects.updateMaterial);var oi=ni.addFolder("instagram material");oi.add(ti.dataObjects.instagram,"opacity").onChange(ti.dataObjects.updateMaterial),oi.addColor(ti.dataObjects.instagram,"color").onChange(ti.dataObjects.updateMaterial),oi.addColor(ti.dataObjects.instagram,"specular").onChange(ti.dataObjects.updateMaterial),oi.addColor(ti.dataObjects.instagram,"ambient").onChange(ti.dataObjects.updateMaterial),oi.add(ti.dataObjects.instagram,"shininess"),oi.add(ti.dataObjects.instagram,"combine",{Multiply:THREE.MultiplyOperation,Mix:THREE.MixOperation,Add:THREE.AddOperation}).onChange(ti.dataObjects.updateMaterial);var ai=ni.addFolder("twitter material");ai.add(ti.dataObjects.twitter,"opacity").onChange(ti.dataObjects.updateMaterial),ai.addColor(ti.dataObjects.twitter,"color").onChange(ti.dataObjects.updateMaterial),ai.addColor(ti.dataObjects.twitter,"specular").onChange(ti.dataObjects.updateMaterial),ai.addColor(ti.dataObjects.twitter,"ambient").onChange(ti.dataObjects.updateMaterial),ai.add(ti.dataObjects.twitter,"shininess"),ai.add(ti.dataObjects.twitter,"combine",{Multiply:THREE.MultiplyOperation,Mix:THREE.MixOperation,Add:THREE.AddOperation}).onChange(ti.dataObjects.updateMaterial);var si=c.addFolder("clouds");si.add(ti.clouds,"debug").onChange(ti.clouds.update),si.add(ti.clouds,"opacity",0,1).onChange(ti.clouds.update),si.add(ti.clouds,"offset",0,1).onChange(ti.clouds.update),si.add(ti.clouds,"exponent",0).onChange(ti.clouds.update);var li=c.addFolder("Fog");li.addColor(ti.fog,"color").onChange(ti.updateFogColor),li.add(rt.fog,"near"),li.add(rt.fog,"far");var hi=c.addFolder("Post"),ci=hi.addFolder("grain");ci.add(ti.post.grain,"amount").onChange(ti.post.update),ci.add(ti.post.grain,"scanlines").onChange(ti.post.update),ci.add(ti.post.grain,"numScanlines").onChange(ti.post.update),ci.add(ti.post.grain,"opacity").onChange(ti.post.update),ci.addColor(ti.post.grain,"color").onChange(ti.post.update);var ui=hi.addFolder("Vignette");ui.add(ti.post.vignette,"opacity").onChange(ti.post.update),ui.add(ti.post.vignette,"start").onChange(ti.post.update),ui.add(ti.post.vignette,"end").onChange(ti.post.update),ui.addColor(ti.post.vignette,"color").onChange(ti.post.update),c.add(ti,"seed").onChange(function(){Bt=parseInt(ti.seed)}),c.add(ti,"random"),c.add(ti,"generate"),c.add(It,"visible"),c.add(ti,"speed"),c.addColor(ti.rollLight,"color").onChange(ti.rollLight.update),c.add(ti.rollLight,"scale").onChange(ti.rollLight.update),c.add(nt,"fov",0,100).onChange(ti.updateCamera),c.addColor(ti,"background_color").onChange(ti.updateBackgoundColor)}rt.add($t),rt.add(Zt);var di=Qt[0].clone();di.opacity=1,di.distanceCoeff=.01,allLights.push(di),rt.add(di),u(function(e,t){k();for(var i,r,n,o=e.results.concat(t.results),a=o.length,s=3e4;a-->0;)o[a].isInstagram=a>=e.results.length;for(o.sort(function(){return Math.random()-.5}),a=o.length;a-->0;)if(i=o[a],r=D(i,i.isInstagram,null,qt.volume),r.isInstagram=i.isInstagram,G>a){var l=Math.random(),h=1/3>l?"x":2/3>l?"y":"z";r.targetProp=h,n=r.position[h],r.position[h]+=5e3*(2*Math.round(Math.random())-1),r.unclickable=!0,r.position[h]+5e3*(2*Math.round(Math.random())-1);var c={};c[h]=n,r.tween=new TWEEN.Tween(r.position).to(c,s).easing(TWEEN.Easing.Quadratic.InOut).delay((3e3+s)*a).onComplete(function(e){di.fadeTween=new TWEEN.Tween(di).to({distanceCoeff:.001},2e3).onComplete(function(){e.tween.stop(),di.fadeTween.stop(),di.distanceCoeff=.001}).start(yi),e.unclickable=!1,Jt.push(e)}.bind(this,r)).onStart(function(e){rt.add(e),di.position=e.position,di.color.set(e.isInstagram?Kt.originalColor:Kt.twitterLightColor),di.distanceCoeff=3,v.entering[Math.floor(Math.random()*v.entering.length)].play()}.bind(this,r)).start(yi)}else Jt.push(r),THREE.GeometryUtils.merge(r.isInstagram?$t.geometry:Zt.geometry,r);F(),new TWEEN.Tween(St.uniforms.visible).to({value:1},5e3).delay(1e3).start(yi),$(".loading-icon").fadeOut(3e3),$("#search").delay(8e3).fadeIn(3e3)},function(e,t){t.loaded||console.log("Instagram failed to load."),e.loaded||console.log("Twitter failed to load.")});var pi=5,fi=new THREE.Mesh(new THREE.CubeGeometry(85,85,pi,10,10,1)),mi=new THREE.Mesh(new THREE.CubeGeometry(pi,85,85,1,10,10)),gi=new THREE.Mesh(new THREE.CubeGeometry(85,pi,85,10,1,10)),vi=new THREE.Geometry;fi.position.z=-50,THREE.GeometryUtils.merge(vi,fi),fi.position.z=50,THREE.GeometryUtils.merge(vi,fi),mi.position.x=-50,THREE.GeometryUtils.merge(vi,mi),mi.position.x=50,THREE.GeometryUtils.merge(vi,mi),gi.position.y=-50,THREE.GeometryUtils.merge(vi,gi),gi.position.y=50,THREE.GeometryUtils.merge(vi,gi),$("#clear-search").click(function(){_(),$("#search-field").blur()}),$(".search-button").click(function(e){return e.preventDefault(),e.stopImmediatePropagation(),!1}),$("#search-field").keypress(function(e){13===e.which&&(e.preventDefault(),e.stopImmediatePropagation(),L(it.value))}),$("#search-form").submit(function(e){e.preventDefault()});var qt,Ei,yi,Ti,_i,bi,xi=!1,Ri={},wi=new THREE.Vector3,Hi=new THREE.Matrix4,Mi=new THREE.Vector3;forward=new THREE.Vector3(0,0,-1),normal=new THREE.Vector3(0,0,1),camUp=new THREE.Vector3(0,1,0),range=25;var Si=new THREE.Quaternion});