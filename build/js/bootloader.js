/**
 * @license RequireJS domReady 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/*! jQuery v2.0.3 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license
*/

/*! jQuery UI - v1.10.3 - 2013-05-03
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.draggable.js, jquery.ui.droppable.js, jquery.ui.resizable.js, jquery.ui.selectable.js, jquery.ui.sortable.js, jquery.ui.effect.js, jquery.ui.accordion.js, jquery.ui.autocomplete.js, jquery.ui.button.js, jquery.ui.datepicker.js, jquery.ui.dialog.js, jquery.ui.effect-blind.js, jquery.ui.effect-bounce.js, jquery.ui.effect-clip.js, jquery.ui.effect-drop.js, jquery.ui.effect-explode.js, jquery.ui.effect-fade.js, jquery.ui.effect-fold.js, jquery.ui.effect-highlight.js, jquery.ui.effect-pulsate.js, jquery.ui.effect-scale.js, jquery.ui.effect-shake.js, jquery.ui.effect-slide.js, jquery.ui.effect-transfer.js, jquery.ui.menu.js, jquery.ui.position.js, jquery.ui.progressbar.js, jquery.ui.slider.js, jquery.ui.spinner.js, jquery.ui.tabs.js, jquery.ui.tooltip.js
* Copyright 2013 jQuery Foundation and other contributors; Licensed MIT */

/*!
 * jQuery Color Animations v2.1.2
 * https://github.com/jquery/jquery-color
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Date: Wed Jan 16 08:47:09 2013 -0600
 */

/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.

/**
 * dat-gui JavaScript Controller Library
 * http://code.google.com/p/dat-gui
 *
 * Copyright 2011 Data Arts Team, Google Creative Lab
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */

/*
 * Purl (A JavaScript URL parser) v2.3.1
 * Developed and maintanined by Mark Perkins, mark@allmarkedup.com
 * Source repository: https://github.com/allmarkedup/jQuery-URL-Parser
 * Licensed under an MIT-style license. See https://github.com/allmarkedup/jQuery-URL-Parser/blob/master/LICENSE for details.
 */

define("utils/domReady",[],function(){function e(e){var t;for(t=0;t<e.length;t+=1)e[t](h)}function t(){var t=c;if(l)if(t.length){c=[];e(t)}}function i(){if(!l){l=!0;if(a)clearInterval(a);t()}}function r(e){if(l)e(h);else c.push(e);return r}var n,o,a,s="undefined"!=typeof window&&window.document,l=!s,h=s?document:null,c=[];if(s){if(document.addEventListener){document.addEventListener("DOMContentLoaded",i,!1);window.addEventListener("load",i,!1)}else if(window.attachEvent){window.attachEvent("onload",i);o=document.createElement("div");try{n=null===window.frameElement}catch(u){}if(o.doScroll&&n&&window.external)a=setInterval(function(){try{o.doScroll();i()}catch(e){}},30)}if("complete"===document.readyState)i()}r.version="2.0.1";r.load=function(e,t,i,n){if(n.isBuild)i(null);else r(i)};return r});requirejs.config({name:"main",baseUrl:"./js",waitSeconds:0,config:{main:{proxy:"https://levismakeourmark.thismoment.com/v4/api/media/image_proxy.json?url="},data:{instagram:{feed:"https://levismakeourmark.thismoment.com/v4/api/gallery/get.jsonp?environment=1&sort=1&gallery_id=4&category_id=28",search:"https://levismakeourmark.thismoment.com/v4/api/search/content.jsonp?environment=1&gallery_id=4&category_id=28&query="},twitter:{feed:"https://levismakeourmark.thismoment.com/v4/api/gallery/get.jsonp?environment=1&sort=1&gallery_id=4&category_id=29",search:"https://levismakeourmark.thismoment.com/v4/api/search/content.jsonp?environment=1&gallery_id=4&category_id=29&query="}}},paths:{glsl:"loaders/glsl",text:"loaders/text",json:"loaders/json",template:"loaders/template"},shim:{"libs/threejs/build/three":{exports:"THREE"},purl:{deps:["jquery"]},"libs/jquery-ui":["jquery"],"libs/threejs/examples/js/renderers/WebGLDeferredRenderer":["libs/threejs/build/three"],"libs/threejs/examples/js/controls/OrbitControls":["libs/threejs/build/three"],"libs/threejs/examples/js/controls/TransformControls":["libs/threejs/build/three"]}});if("undefined"==typeof NAME)NAME="Levis";if(!1)!1=!0;if(!1)"681c996"="Unknown Version";if("undefined"==typeof APP)APP="main";require(["utils/domReady!","require"],function(e,t){t([APP])});define("bootloader",function(){});!function(e,t){function i(e){var t=e.length,i=ot.type(e);return ot.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===i||"function"!==i&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function r(e){var t=pt[e]={};return ot.each(e.match(st)||[],function(e,i){t[i]=!0}),t}function n(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=ot.expando+Math.random()}function o(e,i,r){var n;if(r===t&&1===e.nodeType)if(n="data-"+i.replace(Et,"-$1").toLowerCase(),r=e.getAttribute(n),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:vt.test(r)?JSON.parse(r):r}catch(o){}mt.set(e,i,r)}else r=t;return r}function a(){return!0}function s(){return!1}function l(){try{return G.activeElement}catch(e){}}function h(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function c(e,t,i){if(ot.isFunction(t))return ot.grep(e,function(e,r){return!!t.call(e,r,e)!==i});if(t.nodeType)return ot.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(St.test(t))return ot.filter(t,e,i);t=ot.filter(t,e)}return ot.grep(e,function(e){return tt.call(t,e)>=0!==i})}function u(e,t){return ot.nodeName(e,"table")&&ot.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function f(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function d(e){var t=Ot.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function p(e,t){var i=e.length,r=0;for(;i>r;r++)gt.set(e[r],"globalEval",!t||gt.get(t[r],"globalEval"))}function m(e,t){var i,r,n,o,a,s,l,h;if(1===t.nodeType){if(gt.hasData(e)&&(o=gt.access(e),a=gt.set(t,o),h=o.events)){delete a.handle,a.events={};for(n in h)for(i=0,r=h[n].length;r>i;i++)ot.event.add(t,n,h[n][i])}mt.hasData(e)&&(s=mt.access(e),l=ot.extend({},s),mt.set(t,l))}}function g(e,i){var r=e.getElementsByTagName?e.getElementsByTagName(i||"*"):e.querySelectorAll?e.querySelectorAll(i||"*"):[];return i===t||i&&ot.nodeName(e,i)?ot.merge([e],r):r}function v(e,t){var i=t.nodeName.toLowerCase();"input"===i&&zt.test(e.type)?t.checked=e.checked:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}function E(e,t){if(t in e)return t;var i=t.charAt(0).toUpperCase()+t.slice(1),r=t,n=Jt.length;for(;n--;)if(t=Jt[n]+i,t in e)return t;return r}function y(e,t){return e=t||e,"none"===ot.css(e,"display")||!ot.contains(e.ownerDocument,e)}function T(t){return e.getComputedStyle(t,null)}function _(e,t){var i,r,n,o=[],a=0,s=e.length;for(;s>a;a++)r=e[a],r.style&&(o[a]=gt.get(r,"olddisplay"),i=r.style.display,t?(o[a]||"none"!==i||(r.style.display=""),""===r.style.display&&y(r)&&(o[a]=gt.access(r,"olddisplay",w(r.nodeName)))):o[a]||(n=y(r),(i&&"none"!==i||!n)&&gt.set(r,"olddisplay",n?i:ot.css(r,"display"))));for(a=0;s>a;a++)r=e[a],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[a]||"":"none"));return e}function b(e,t,i){var r=Xt.exec(t);return r?Math.max(0,r[1]-(i||0))+(r[2]||"px"):t}function x(e,t,i,r,n){var o=i===(r?"border":"content")?4:"width"===t?1:0,a=0;for(;4>o;o+=2)"margin"===i&&(a+=ot.css(e,i+$t[o],!0,n)),r?("content"===i&&(a-=ot.css(e,"padding"+$t[o],!0,n)),"margin"!==i&&(a-=ot.css(e,"border"+$t[o]+"Width",!0,n))):(a+=ot.css(e,"padding"+$t[o],!0,n),"padding"!==i&&(a+=ot.css(e,"border"+$t[o]+"Width",!0,n)));return a}function R(e,t,i){var r=!0,n="width"===t?e.offsetWidth:e.offsetHeight,o=T(e),a=ot.support.boxSizing&&"border-box"===ot.css(e,"boxSizing",!1,o);if(0>=n||null==n){if(n=Bt(e,t,o),(0>n||null==n)&&(n=e.style[t]),Yt.test(n))return n;r=a&&(ot.support.boxSizingReliable||n===e.style[t]),n=parseFloat(n)||0}return n+x(e,t,i||(a?"border":"content"),r,o)+"px"}function w(e){var t=G,i=Kt[e];return i||(i=H(e,t),"none"!==i&&i||(jt=(jt||ot("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(jt[0].contentWindow||jt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),i=H(e,t),jt.detach()),Kt[e]=i),i}function H(e,t){var i=ot(t.createElement(e)).appendTo(t.body),r=ot.css(i[0],"display");return i.remove(),r}function M(e,t,i,r){var n;if(ot.isArray(t))ot.each(t,function(t,n){i||ti.test(e)?r(e,n):M(e+"["+("object"==typeof n?t:"")+"]",n,i,r)});else if(i||"object"!==ot.type(t))r(e,t);else for(n in t)M(e+"["+n+"]",t[n],i,r)}function S(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var r,n=0,o=t.toLowerCase().match(st)||[];if(ot.isFunction(i))for(;r=o[n++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(i)):(e[r]=e[r]||[]).push(i)}}function C(e,i,r,n){function o(l){var h;return a[l]=!0,ot.each(e[l]||[],function(e,l){var c=l(i,r,n);return"string"!=typeof c||s||a[c]?s?!(h=c):t:(i.dataTypes.unshift(c),o(c),!1)}),h}var a={},s=e===Ei;return o(i.dataTypes[0])||!a["*"]&&o("*")}function A(e,i){var r,n,o=ot.ajaxSettings.flatOptions||{};for(r in i)i[r]!==t&&((o[r]?e:n||(n={}))[r]=i[r]);return n&&ot.extend(!0,e,n),e}function D(e,i,r){var n,o,a,s,l=e.contents,h=e.dataTypes;for(;"*"===h[0];)h.shift(),n===t&&(n=e.mimeType||i.getResponseHeader("Content-Type"));if(n)for(o in l)if(l[o]&&l[o].test(n)){h.unshift(o);break}if(h[0]in r)a=h[0];else{for(o in r){if(!h[0]||e.converters[o+" "+h[0]]){a=o;break}s||(s=o)}a=a||s}return a?(a!==h[0]&&h.unshift(a),r[a]):t}function P(e,t,i,r){var n,o,a,s,l,h={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)h[a.toLowerCase()]=e.converters[a];o=c.shift();for(;o;)if(e.responseFields[o]&&(i[e.responseFields[o]]=t),!l&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(a=h[l+" "+o]||h["* "+o],!a)for(n in h)if(s=n.split(" "),s[1]===o&&(a=h[l+" "+s[0]]||h["* "+s[0]])){a===!0?a=h[n]:h[n]!==!0&&(o=s[0],c.unshift(s[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(u){return{state:"parsererror",error:a?u:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}function k(){return setTimeout(function(){Mi=t}),Mi=ot.now()}function L(e,t,i){var r,n=(ki[t]||[]).concat(ki["*"]),o=0,a=n.length;for(;a>o;o++)if(r=n[o].call(i,t,e))return r}function F(e,t,i){var r,n,o=0,a=Pi.length,s=ot.Deferred().always(function(){delete l.elem}),l=function(){if(n)return!1;var t=Mi||k(),i=Math.max(0,h.startTime+h.duration-t),r=i/h.duration||0,o=1-r,a=0,l=h.tweens.length;for(;l>a;a++)h.tweens[a].run(o);return s.notifyWith(e,[h,o,i]),1>o&&l?i:(s.resolveWith(e,[h]),!1)},h=s.promise({elem:e,props:ot.extend({},t),opts:ot.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Mi||k(),duration:i.duration,tweens:[],createTween:function(t,i){var r=ot.Tween(e,h.opts,t,i,h.opts.specialEasing[t]||h.opts.easing);return h.tweens.push(r),r},stop:function(t){var i=0,r=t?h.tweens.length:0;if(n)return this;for(n=!0;r>i;i++)h.tweens[i].run(1);return t?s.resolveWith(e,[h,t]):s.rejectWith(e,[h,t]),this}}),c=h.props;for(z(c,h.opts.specialEasing);a>o;o++)if(r=Pi[o].call(h,e,c,h.opts))return r;return ot.map(c,L,h),ot.isFunction(h.opts.start)&&h.opts.start.call(e,h),ot.fx.timer(ot.extend(l,{elem:e,anim:h,queue:h.opts.queue})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}function z(e,t){var i,r,n,o,a;for(i in e)if(r=ot.camelCase(i),n=t[r],o=e[i],ot.isArray(o)&&(n=o[1],o=e[i]=o[0]),i!==r&&(e[r]=o,delete e[i]),a=ot.cssHooks[r],a&&"expand"in a){o=a.expand(o),delete e[r];for(i in o)i in e||(e[i]=o[i],t[i]=n)}else t[r]=n}function N(e,i,r){var n,o,a,s,l,h,c=this,u={},f=e.style,d=e.nodeType&&y(e),p=gt.get(e,"fxshow");r.queue||(l=ot._queueHooks(e,"fx"),null==l.unqueued&&(l.unqueued=0,h=l.empty.fire,l.empty.fire=function(){l.unqueued||h()}),l.unqueued++,c.always(function(){c.always(function(){l.unqueued--,ot.queue(e,"fx").length||l.empty.fire()})})),1===e.nodeType&&("height"in i||"width"in i)&&(r.overflow=[f.overflow,f.overflowX,f.overflowY],"inline"===ot.css(e,"display")&&"none"===ot.css(e,"float")&&(f.display="inline-block")),r.overflow&&(f.overflow="hidden",c.always(function(){f.overflow=r.overflow[0],f.overflowX=r.overflow[1],f.overflowY=r.overflow[2]}));for(n in i)if(o=i[n],Ci.exec(o)){if(delete i[n],a=a||"toggle"===o,o===(d?"hide":"show")){if("show"!==o||!p||p[n]===t)continue;d=!0}u[n]=p&&p[n]||ot.style(e,n)}if(!ot.isEmptyObject(u)){p?"hidden"in p&&(d=p.hidden):p=gt.access(e,"fxshow",{}),a&&(p.hidden=!d),d?ot(e).show():c.done(function(){ot(e).hide()}),c.done(function(){var t;gt.remove(e,"fxshow");for(t in u)ot.style(e,t,u[t])});for(n in u)s=L(d?p[n]:0,n,c),n in p||(p[n]=s.start,d&&(s.end=s.start,s.start="width"===n||"height"===n?1:0))}}function I(e,t,i,r,n){return new I.prototype.init(e,t,i,r,n)}function O(e,t){var i,r={height:e},n=0;for(t=t?1:0;4>n;n+=2-t)i=$t[n],r["margin"+i]=r["padding"+i]=e;return t&&(r.opacity=r.width=e),r}function U(e){return ot.isWindow(e)?e:9===e.nodeType&&e.defaultView}var V,B,j=typeof t,W=e.location,G=e.document,X=G.documentElement,Y=e.jQuery,q=e.$,K={},Q=[],Z="2.0.3",$=Q.concat,J=Q.push,et=Q.slice,tt=Q.indexOf,it=K.toString,rt=K.hasOwnProperty,nt=Z.trim,ot=function(e,t){return new ot.fn.init(e,t,V)},at=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,st=/\S+/g,lt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ht=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ct=/^-ms-/,ut=/-([\da-z])/gi,ft=function(e,t){return t.toUpperCase()},dt=function(){G.removeEventListener("DOMContentLoaded",dt,!1),e.removeEventListener("load",dt,!1),ot.ready()};ot.fn=ot.prototype={jquery:Z,constructor:ot,init:function(e,i,r){var n,o;if(!e)return this;if("string"==typeof e){if(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:lt.exec(e),!n||!n[1]&&i)return!i||i.jquery?(i||r).find(e):this.constructor(i).find(e);if(n[1]){if(i=i instanceof ot?i[0]:i,ot.merge(this,ot.parseHTML(n[1],i&&i.nodeType?i.ownerDocument||i:G,!0)),ht.test(n[1])&&ot.isPlainObject(i))for(n in i)ot.isFunction(this[n])?this[n](i[n]):this.attr(n,i[n]);return this}return o=G.getElementById(n[2]),o&&o.parentNode&&(this.length=1,this[0]=o),this.context=G,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):ot.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),ot.makeArray(e,this))},selector:"",length:0,toArray:function(){return et.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=ot.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return ot.each(this,e,t)},ready:function(e){return ot.ready.promise().done(e),this},slice:function(){return this.pushStack(et.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},map:function(e){return this.pushStack(ot.map(this,function(t,i){return e.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:J,sort:[].sort,splice:[].splice},ot.fn.init.prototype=ot.fn,ot.extend=ot.fn.extend=function(){var e,i,r,n,o,a,s=arguments[0]||{},l=1,h=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},l=2),"object"==typeof s||ot.isFunction(s)||(s={}),h===l&&(s=this,--l);h>l;l++)if(null!=(e=arguments[l]))for(i in e)r=s[i],n=e[i],s!==n&&(c&&n&&(ot.isPlainObject(n)||(o=ot.isArray(n)))?(o?(o=!1,a=r&&ot.isArray(r)?r:[]):a=r&&ot.isPlainObject(r)?r:{},s[i]=ot.extend(c,a,n)):n!==t&&(s[i]=n));return s},ot.extend({expando:"jQuery"+(Z+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===ot&&(e.$=q),t&&e.jQuery===ot&&(e.jQuery=Y),ot},isReady:!1,readyWait:1,holdReady:function(e){e?ot.readyWait++:ot.ready(!0)},ready:function(e){(e===!0?--ot.readyWait:ot.isReady)||(ot.isReady=!0,e!==!0&&--ot.readyWait>0||(B.resolveWith(G,[ot]),ot.fn.trigger&&ot(G).trigger("ready").off("ready")))},isFunction:function(e){return"function"===ot.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?K[it.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==ot.type(e)||e.nodeType||ot.isWindow(e))return!1;try{if(e.constructor&&!rt.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||G;var r=ht.exec(e),n=!i&&[];return r?[t.createElement(r[1])]:(r=ot.buildFragment([e],t,n),n&&ot(n).remove(),ot.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var i,r;if(!e||"string"!=typeof e)return null;try{r=new DOMParser,i=r.parseFromString(e,"text/xml")}catch(n){i=t}return(!i||i.getElementsByTagName("parsererror").length)&&ot.error("Invalid XML: "+e),i},noop:function(){},globalEval:function(e){var t,i=eval;e=ot.trim(e),e&&(1===e.indexOf("use strict")?(t=G.createElement("script"),t.text=e,G.head.appendChild(t).parentNode.removeChild(t)):i(e))},camelCase:function(e){return e.replace(ct,"ms-").replace(ut,ft)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,r){var n,o=0,a=e.length,s=i(e);if(r){if(s)for(;a>o&&(n=t.apply(e[o],r),n!==!1);o++);else for(o in e)if(n=t.apply(e[o],r),n===!1)break}else if(s)for(;a>o&&(n=t.call(e[o],o,e[o]),n!==!1);o++);else for(o in e)if(n=t.call(e[o],o,e[o]),n===!1)break;return e},trim:function(e){return null==e?"":nt.call(e)},makeArray:function(e,t){var r=t||[];return null!=e&&(i(Object(e))?ot.merge(r,"string"==typeof e?[e]:e):J.call(r,e)),r},inArray:function(e,t,i){return null==t?-1:tt.call(t,e,i)},merge:function(e,i){var r=i.length,n=e.length,o=0;if("number"==typeof r)for(;r>o;o++)e[n++]=i[o];else for(;i[o]!==t;)e[n++]=i[o++];return e.length=n,e},grep:function(e,t,i){var r,n=[],o=0,a=e.length;for(i=!!i;a>o;o++)r=!!t(e[o],o),i!==r&&n.push(e[o]);return n},map:function(e,t,r){var n,o=0,a=e.length,s=i(e),l=[];if(s)for(;a>o;o++)n=t(e[o],o,r),null!=n&&(l[l.length]=n);else for(o in e)n=t(e[o],o,r),null!=n&&(l[l.length]=n);return $.apply([],l)},guid:1,proxy:function(e,i){var r,n,o;return"string"==typeof i&&(r=e[i],i=e,e=r),ot.isFunction(e)?(n=et.call(arguments,2),o=function(){return e.apply(i||this,n.concat(et.call(arguments)))},o.guid=e.guid=e.guid||ot.guid++,o):t},access:function(e,i,r,n,o,a,s){var l=0,h=e.length,c=null==r;if("object"===ot.type(r)){o=!0;for(l in r)ot.access(e,i,l,r[l],!0,a,s)}else if(n!==t&&(o=!0,ot.isFunction(n)||(s=!0),c&&(s?(i.call(e,n),i=null):(c=i,i=function(e,t,i){return c.call(ot(e),i)})),i))for(;h>l;l++)i(e[l],r,s?n:n.call(e[l],l,i(e[l],r)));return o?e:c?i.call(e):h?i(e[0],r):a},now:Date.now,swap:function(e,t,i,r){var n,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];n=i.apply(e,r||[]);for(o in t)e.style[o]=a[o];return n}}),ot.ready.promise=function(t){return B||(B=ot.Deferred(),"complete"===G.readyState?setTimeout(ot.ready):(G.addEventListener("DOMContentLoaded",dt,!1),e.addEventListener("load",dt,!1))),B.promise(t)},ot.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){K["[object "+t+"]"]=t.toLowerCase()});V=ot(G),function(e,t){function i(e,t,i,r){var n,o,a,s,l,h,c,u,p,m;if((t?t.ownerDocument||t:U)!==P&&D(t),t=t||P,i=i||[],!e||"string"!=typeof e)return i;if(1!==(s=t.nodeType)&&9!==s)return[];if(L&&!r){if(n=yt.exec(e))if(a=n[1]){if(9===s){if(o=t.getElementById(a),!o||!o.parentNode)return i;if(o.id===a)return i.push(o),i}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&I(t,o)&&o.id===a)return i.push(o),i}else{if(n[2])return et.apply(i,t.getElementsByTagName(e)),i;if((a=n[3])&&x.getElementsByClassName&&t.getElementsByClassName)return et.apply(i,t.getElementsByClassName(a)),i}if(x.qsa&&(!F||!F.test(e))){if(u=c=O,p=t,m=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){h=f(e),(c=t.getAttribute("id"))?u=c.replace(bt,"\\$&"):t.setAttribute("id",u),u="[id='"+u+"'] ",l=h.length;for(;l--;)h[l]=u+d(h[l]);p=dt.test(e)&&t.parentNode||t,m=h.join(",")}if(m)try{return et.apply(i,p.querySelectorAll(m)),i}catch(g){}finally{c||t.removeAttribute("id")}}}return _(e.replace(ct,"$1"),t,i,r)}function r(){function e(i,r){return t.push(i+=" ")>w.cacheLength&&delete e[t.shift()],e[i]=r}var t=[];return e}function n(e){return e[O]=!0,e}function o(e){var t=P.createElement("div");try{return!!e(t)}catch(i){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function a(e,t){var i=e.split("|"),r=e.length;for(;r--;)w.attrHandle[i[r]]=t}function s(e,t){var i=t&&e,r=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||K)-(~e.sourceIndex||K);if(r)return r;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function l(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function h(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function c(e){return n(function(t){return t=+t,n(function(i,r){var n,o=e([],i.length,t),a=o.length;for(;a--;)i[n=o[a]]&&(i[n]=!(r[n]=i[n]))})})}function u(){}function f(e,t){var r,n,o,a,s,l,h,c=W[e+" "];if(c)return t?0:c.slice(0);s=e,l=[],h=w.preFilter;for(;s;){(!r||(n=ut.exec(s)))&&(n&&(s=s.slice(n[0].length)||s),l.push(o=[])),r=!1,(n=ft.exec(s))&&(r=n.shift(),o.push({value:r,type:n[0].replace(ct," ")}),s=s.slice(r.length));for(a in w.filter)!(n=vt[a].exec(s))||h[a]&&!(n=h[a](n))||(r=n.shift(),o.push({value:r,type:a,matches:n}),s=s.slice(r.length));if(!r)break}return t?s.length:s?i.error(e):W(e,l).slice(0)}function d(e){var t=0,i=e.length,r="";for(;i>t;t++)r+=e[t].value;return r}function p(e,t,i){var r=t.dir,n=i&&"parentNode"===r,o=B++;return t.first?function(t,i,o){for(;t=t[r];)if(1===t.nodeType||n)return e(t,i,o)}:function(t,i,a){var s,l,h,c=V+" "+o;if(a){for(;t=t[r];)if((1===t.nodeType||n)&&e(t,i,a))return!0}else for(;t=t[r];)if(1===t.nodeType||n)if(h=t[O]||(t[O]={}),(l=h[r])&&l[0]===c){if((s=l[1])===!0||s===R)return s===!0}else if(l=h[r]=[c],l[1]=e(t,i,a)||R,l[1]===!0)return!0}}function m(e){return e.length>1?function(t,i,r){var n=e.length;for(;n--;)if(!e[n](t,i,r))return!1;return!0}:e[0]}function g(e,t,i,r,n){var o,a=[],s=0,l=e.length,h=null!=t;for(;l>s;s++)(o=e[s])&&(!i||i(o,r,n))&&(a.push(o),h&&t.push(s));return a}function v(e,t,i,r,o,a){return r&&!r[O]&&(r=v(r)),o&&!o[O]&&(o=v(o,a)),n(function(n,a,s,l){var h,c,u,f=[],d=[],p=a.length,m=n||T(t||"*",s.nodeType?[s]:s,[]),v=!e||!n&&t?m:g(m,f,e,s,l),E=i?o||(n?e:p||r)?[]:a:v;if(i&&i(v,E,s,l),r){h=g(E,d),r(h,[],s,l),c=h.length;for(;c--;)(u=h[c])&&(E[d[c]]=!(v[d[c]]=u))}if(n){if(o||e){if(o){h=[],c=E.length;for(;c--;)(u=E[c])&&h.push(v[c]=u);o(null,E=[],h,l)}c=E.length;for(;c--;)(u=E[c])&&(h=o?it.call(n,u):f[c])>-1&&(n[h]=!(a[h]=u))}}else E=g(E===a?E.splice(p,E.length):E),o?o(null,a,E,l):et.apply(a,E)})}function E(e){var t,i,r,n=e.length,o=w.relative[e[0].type],a=o||w.relative[" "],s=o?1:0,l=p(function(e){return e===t},a,!0),h=p(function(e){return it.call(t,e)>-1},a,!0),c=[function(e,i,r){return!o&&(r||i!==C)||((t=i).nodeType?l(e,i,r):h(e,i,r))}];for(;n>s;s++)if(i=w.relative[e[s].type])c=[p(m(c),i)];else{if(i=w.filter[e[s].type].apply(null,e[s].matches),i[O]){for(r=++s;n>r&&!w.relative[e[r].type];r++);return v(s>1&&m(c),s>1&&d(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(ct,"$1"),i,r>s&&E(e.slice(s,r)),n>r&&E(e=e.slice(r)),n>r&&d(e))}c.push(i)}return m(c)}function y(e,t){var r=0,o=t.length>0,a=e.length>0,s=function(n,s,l,h,c){var u,f,d,p=[],m=0,v="0",E=n&&[],y=null!=c,T=C,_=n||a&&w.find.TAG("*",c&&s.parentNode||s),b=V+=null==T?1:Math.random()||.1;for(y&&(C=s!==P&&s,R=r);null!=(u=_[v]);v++){if(a&&u){f=0;for(;d=e[f++];)if(d(u,s,l)){h.push(u);break}y&&(V=b,R=++r)}o&&((u=!d&&u)&&m--,n&&E.push(u))}if(m+=v,o&&v!==m){f=0;for(;d=t[f++];)d(E,p,s,l);if(n){if(m>0)for(;v--;)E[v]||p[v]||(p[v]=$.call(h));p=g(p)}et.apply(h,p),y&&!n&&p.length>0&&m+t.length>1&&i.uniqueSort(h)}return y&&(V=b,C=T),E};return o?n(s):s}function T(e,t,r){var n=0,o=t.length;for(;o>n;n++)i(e,t[n],r);return r}function _(e,t,i,r){var n,o,a,s,l,h=f(e);if(!r&&1===h.length){if(o=h[0]=h[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&x.getById&&9===t.nodeType&&L&&w.relative[o[1].type]){if(t=(w.find.ID(a.matches[0].replace(xt,Rt),t)||[])[0],!t)return i;e=e.slice(o.shift().value.length)}n=vt.needsContext.test(e)?0:o.length;for(;n--&&(a=o[n],!w.relative[s=a.type]);)if((l=w.find[s])&&(r=l(a.matches[0].replace(xt,Rt),dt.test(o[0].type)&&t.parentNode||t))){if(o.splice(n,1),e=r.length&&d(o),!e)return et.apply(i,r),i;break}}return S(e,h)(r,t,!L,i,dt.test(e)),i}var b,x,R,w,H,M,S,C,A,D,P,k,L,F,z,N,I,O="sizzle"+-new Date,U=e.document,V=0,B=0,j=r(),W=r(),G=r(),X=!1,Y=function(e,t){return e===t?(X=!0,0):0},q=typeof t,K=1<<31,Q={}.hasOwnProperty,Z=[],$=Z.pop,J=Z.push,et=Z.push,tt=Z.slice,it=Z.indexOf||function(e){var t=0,i=this.length;for(;i>t;t++)if(this[t]===e)return t;return-1},rt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\x20\\t\\r\\n\\f]",at="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",st=at.replace("w","w#"),lt="\\["+nt+"*("+at+")"+nt+"*(?:([*^$|!~]?=)"+nt+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+st+")|)|)"+nt+"*\\]",ht=":("+at+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+lt.replace(3,8)+")*)|.*)\\)|)",ct=RegExp("^"+nt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+nt+"+$","g"),ut=RegExp("^"+nt+"*,"+nt+"*"),ft=RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),dt=RegExp(nt+"*[+~]"),pt=RegExp("="+nt+"*([^\\]'\"]*)"+nt+"*\\]","g"),mt=RegExp(ht),gt=RegExp("^"+st+"$"),vt={ID:RegExp("^#("+at+")"),CLASS:RegExp("^\\.("+at+")"),TAG:RegExp("^("+at.replace("w","w*")+")"),ATTR:RegExp("^"+lt),PSEUDO:RegExp("^"+ht),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+nt+"*(even|odd|(([+-]|)(\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\d+)|))"+nt+"*\\)|)","i"),bool:RegExp("^(?:"+rt+")$","i"),needsContext:RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+nt+"*((?:-\\d)?\\d*)"+nt+"*\\)|)(?=[^-]|$)","i")},Et=/^[^{]+\{\s*\[native \w/,yt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Tt=/^(?:input|select|textarea|button)$/i,_t=/^h\d$/i,bt=/'|\\/g,xt=RegExp("\\\\([\\da-f]{1,6}"+nt+"?|("+nt+")|.)","ig"),Rt=function(e,t,i){var r="0x"+t-65536;return r!==r||i?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{et.apply(Z=tt.call(U.childNodes),U.childNodes),Z[U.childNodes.length].nodeType}catch(wt){et={apply:Z.length?function(e,t){J.apply(e,tt.call(t))}:function(e,t){var i=e.length,r=0;for(;e[i++]=t[r++];);e.length=i-1}}}M=i.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},x=i.support={},D=i.setDocument=function(e){var i=e?e.ownerDocument||e:U,r=i.defaultView;return i!==P&&9===i.nodeType&&i.documentElement?(P=i,k=i.documentElement,L=!M(i),r&&r.attachEvent&&r!==r.top&&r.attachEvent("onbeforeunload",function(){D()}),x.attributes=o(function(e){return e.className="i",!e.getAttribute("className")}),x.getElementsByTagName=o(function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length}),x.getElementsByClassName=o(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),x.getById=o(function(e){return k.appendChild(e).id=O,!i.getElementsByName||!i.getElementsByName(O).length}),x.getById?(w.find.ID=function(e,t){if(typeof t.getElementById!==q&&L){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},w.filter.ID=function(e){var t=e.replace(xt,Rt);return function(e){return e.getAttribute("id")===t}}):(delete w.find.ID,w.filter.ID=function(e){var t=e.replace(xt,Rt);return function(e){var i=typeof e.getAttributeNode!==q&&e.getAttributeNode("id");return i&&i.value===t}}),w.find.TAG=x.getElementsByTagName?function(e,i){return typeof i.getElementsByTagName!==q?i.getElementsByTagName(e):t}:function(e,t){var i,r=[],n=0,o=t.getElementsByTagName(e);if("*"===e){for(;i=o[n++];)1===i.nodeType&&r.push(i);return r}return o},w.find.CLASS=x.getElementsByClassName&&function(e,i){return typeof i.getElementsByClassName!==q&&L?i.getElementsByClassName(e):t},z=[],F=[],(x.qsa=Et.test(i.querySelectorAll))&&(o(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||F.push("\\["+nt+"*(?:value|"+rt+")"),e.querySelectorAll(":checked").length||F.push(":checked")}),o(function(e){var t=i.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&F.push("[*^$]="+nt+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||F.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),F.push(",.*:")})),(x.matchesSelector=Et.test(N=k.webkitMatchesSelector||k.mozMatchesSelector||k.oMatchesSelector||k.msMatchesSelector))&&o(function(e){x.disconnectedMatch=N.call(e,"div"),N.call(e,"[s!='']:x"),z.push("!=",ht)}),F=F.length&&RegExp(F.join("|")),z=z.length&&RegExp(z.join("|")),I=Et.test(k.contains)||k.compareDocumentPosition?function(e,t){var i=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(i.contains?i.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},Y=k.compareDocumentPosition?function(e,t){if(e===t)return X=!0,0;var r=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return r?1&r||!x.sortDetached&&t.compareDocumentPosition(e)===r?e===i||I(U,e)?-1:t===i||I(U,t)?1:A?it.call(A,e)-it.call(A,t):0:4&r?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,n=0,o=e.parentNode,a=t.parentNode,l=[e],h=[t];if(e===t)return X=!0,0;if(!o||!a)return e===i?-1:t===i?1:o?-1:a?1:A?it.call(A,e)-it.call(A,t):0;if(o===a)return s(e,t);r=e;for(;r=r.parentNode;)l.unshift(r);r=t;for(;r=r.parentNode;)h.unshift(r);for(;l[n]===h[n];)n++;return n?s(l[n],h[n]):l[n]===U?-1:h[n]===U?1:0},i):P},i.matches=function(e,t){return i(e,null,null,t)},i.matchesSelector=function(e,t){if((e.ownerDocument||e)!==P&&D(e),t=t.replace(pt,"='$1']"),!(!x.matchesSelector||!L||z&&z.test(t)||F&&F.test(t)))try{var r=N.call(e,t);if(r||x.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(n){}return i(t,P,null,[e]).length>0},i.contains=function(e,t){return(e.ownerDocument||e)!==P&&D(e),I(e,t)},i.attr=function(e,i){(e.ownerDocument||e)!==P&&D(e);var r=w.attrHandle[i.toLowerCase()],n=r&&Q.call(w.attrHandle,i.toLowerCase())?r(e,i,!L):t;return n===t?x.attributes||!L?e.getAttribute(i):(n=e.getAttributeNode(i))&&n.specified?n.value:null:n},i.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},i.uniqueSort=function(e){var t,i=[],r=0,n=0;if(X=!x.detectDuplicates,A=!x.sortStable&&e.slice(0),e.sort(Y),X){for(;t=e[n++];)t===e[n]&&(r=i.push(n));for(;r--;)e.splice(i[r],1)}return e},H=i.getText=function(e){var t,i="",r=0,n=e.nodeType;if(n){if(1===n||9===n||11===n){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=H(e)}else if(3===n||4===n)return e.nodeValue}else for(;t=e[r];r++)i+=H(t);return i},w=i.selectors={cacheLength:50,createPseudo:n,match:vt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(xt,Rt),e[3]=(e[4]||e[5]||"").replace(xt,Rt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||i.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&i.error(e[0]),e},PSEUDO:function(e){var i,r=!e[5]&&e[2];return vt.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&mt.test(r)&&(i=f(r,!0))&&(i=r.indexOf(")",r.length-i)-r.length)&&(e[0]=e[0].slice(0,i),e[2]=r.slice(0,i)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(xt,Rt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=j[e+" "];return t||(t=RegExp("(^|"+nt+")"+e+"("+nt+"|$)"))&&j(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==q&&e.getAttribute("class")||"")})},ATTR:function(e,t,r){return function(n){var o=i.attr(n,e);return null==o?"!="===t:t?(o+="","="===t?o===r:"!="===t?o!==r:"^="===t?r&&0===o.indexOf(r):"*="===t?r&&o.indexOf(r)>-1:"$="===t?r&&o.slice(-r.length)===r:"~="===t?(" "+o+" ").indexOf(r)>-1:"|="===t?o===r||o.slice(0,r.length+1)===r+"-":!1):!0}},CHILD:function(e,t,i,r,n){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===n?function(e){return!!e.parentNode}:function(t,i,l){var h,c,u,f,d,p,m=o!==a?"nextSibling":"previousSibling",g=t.parentNode,v=s&&t.nodeName.toLowerCase(),E=!l&&!s;if(g){if(o){for(;m;){u=t;for(;u=u[m];)if(s?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;p=m="only"===e&&!p&&"nextSibling"}return!0}if(p=[a?g.firstChild:g.lastChild],a&&E){c=g[O]||(g[O]={}),h=c[e]||[],d=h[0]===V&&h[1],f=h[0]===V&&h[2],u=d&&g.childNodes[d];for(;u=++d&&u&&u[m]||(f=d=0)||p.pop();)if(1===u.nodeType&&++f&&u===t){c[e]=[V,d,f];break}}else if(E&&(h=(t[O]||(t[O]={}))[e])&&h[0]===V)f=h[1];else for(;(u=++d&&u&&u[m]||(f=d=0)||p.pop())&&((s?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++f||(E&&((u[O]||(u[O]={}))[e]=[V,f]),u!==t)););return f-=n,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var r,o=w.pseudos[e]||w.setFilters[e.toLowerCase()]||i.error("unsupported pseudo: "+e);return o[O]?o(t):o.length>1?(r=[e,e,"",t],w.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,i){var r,n=o(e,t),a=n.length;for(;a--;)r=it.call(e,n[a]),e[r]=!(i[r]=n[a])}):function(e){return o(e,0,r)}):o}},pseudos:{not:n(function(e){var t=[],i=[],r=S(e.replace(ct,"$1"));
return r[O]?n(function(e,t,i,n){var o,a=r(e,null,n,[]),s=e.length;for(;s--;)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,n,o){return t[0]=e,r(t,null,o,i),!i.pop()}}),has:n(function(e){return function(t){return i(e,t).length>0}}),contains:n(function(e){return function(t){return(t.textContent||t.innerText||H(t)).indexOf(e)>-1}}),lang:n(function(e){return gt.test(e||"")||i.error("unsupported lang: "+e),e=e.replace(xt,Rt).toLowerCase(),function(t){var i;do if(i=L?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===k},focus:function(e){return e===P.activeElement&&(!P.hasFocus||P.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!w.pseudos.empty(e)},header:function(e){return _t.test(e.nodeName)},input:function(e){return Tt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,i){return[0>i?i+t:i]}),even:c(function(e,t){var i=0;for(;t>i;i+=2)e.push(i);return e}),odd:c(function(e,t){var i=1;for(;t>i;i+=2)e.push(i);return e}),lt:c(function(e,t,i){var r=0>i?i+t:i;for(;--r>=0;)e.push(r);return e}),gt:c(function(e,t,i){var r=0>i?i+t:i;for(;t>++r;)e.push(r);return e})}},w.pseudos.nth=w.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[b]=l(b);for(b in{submit:!0,reset:!0})w.pseudos[b]=h(b);u.prototype=w.filters=w.pseudos,w.setFilters=new u;S=i.compile=function(e,t){var i,r=[],n=[],o=G[e+" "];if(!o){t||(t=f(e)),i=t.length;for(;i--;)o=E(t[i]),o[O]?r.push(o):n.push(o);o=G(e,y(n,r))}return o};x.sortStable=O.split("").sort(Y).join("")===O,x.detectDuplicates=X,D(),x.sortDetached=o(function(e){return 1&e.compareDocumentPosition(P.createElement("div"))}),o(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||a("type|href|height|width",function(e,i,r){return r?t:e.getAttribute(i,"type"===i.toLowerCase()?1:2)}),x.attributes&&o(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||a("value",function(e,i,r){return r||"input"!==e.nodeName.toLowerCase()?t:e.defaultValue}),o(function(e){return null==e.getAttribute("disabled")})||a(rt,function(e,i,r){var n;return r?t:(n=e.getAttributeNode(i))&&n.specified?n.value:e[i]===!0?i.toLowerCase():null}),ot.find=i,ot.expr=i.selectors,ot.expr[":"]=ot.expr.pseudos,ot.unique=i.uniqueSort,ot.text=i.getText,ot.isXMLDoc=i.isXML,ot.contains=i.contains}(e);var pt={};ot.Callbacks=function(e){e="string"==typeof e?pt[e]||r(e):ot.extend({},e);var i,n,o,a,s,l,h=[],c=!e.once&&[],u=function(t){for(i=e.memory&&t,n=!0,l=a||0,a=0,s=h.length,o=!0;h&&s>l;l++)if(h[l].apply(t[0],t[1])===!1&&e.stopOnFalse){i=!1;break}o=!1,h&&(c?c.length&&u(c.shift()):i?h=[]:f.disable())},f={add:function(){if(h){var t=h.length;!function r(t){ot.each(t,function(t,i){var n=ot.type(i);"function"===n?e.unique&&f.has(i)||h.push(i):i&&i.length&&"string"!==n&&r(i)})}(arguments),o?s=h.length:i&&(a=t,u(i))}return this},remove:function(){return h&&ot.each(arguments,function(e,t){var i;for(;(i=ot.inArray(t,h,i))>-1;)h.splice(i,1),o&&(s>=i&&s--,l>=i&&l--)}),this},has:function(e){return e?ot.inArray(e,h)>-1:!(!h||!h.length)},empty:function(){return h=[],s=0,this},disable:function(){return h=c=i=t,this},disabled:function(){return!h},lock:function(){return c=t,i||f.disable(),this},locked:function(){return!c},fireWith:function(e,t){return!h||n&&!c||(t=t||[],t=[e,t.slice?t.slice():t],o?c.push(t):u(t)),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!n}};return f},ot.extend({Deferred:function(e){var t=[["resolve","done",ot.Callbacks("once memory"),"resolved"],["reject","fail",ot.Callbacks("once memory"),"rejected"],["notify","progress",ot.Callbacks("memory")]],i="pending",r={state:function(){return i},always:function(){return n.done(arguments).fail(arguments),this},then:function(){var e=arguments;return ot.Deferred(function(i){ot.each(t,function(t,o){var a=o[0],s=ot.isFunction(e[t])&&e[t];n[o[1]](function(){var e=s&&s.apply(this,arguments);e&&ot.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[a+"With"](this===r?i.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?ot.extend(e,r):r}},n={};return r.pipe=r.then,ot.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){i=s},t[1^e][2].disable,t[2][2].lock),n[o[0]]=function(){return n[o[0]+"With"](this===n?r:this,arguments),this},n[o[0]+"With"]=a.fireWith}),r.promise(n),e&&e.call(n,n),n},when:function(e){var t,i,r,n=0,o=et.call(arguments),a=o.length,s=1!==a||e&&ot.isFunction(e.promise)?a:0,l=1===s?e:ot.Deferred(),h=function(e,i,r){return function(n){i[e]=this,r[e]=arguments.length>1?et.call(arguments):n,r===t?l.notifyWith(i,r):--s||l.resolveWith(i,r)}};if(a>1)for(t=Array(a),i=Array(a),r=Array(a);a>n;n++)o[n]&&ot.isFunction(o[n].promise)?o[n].promise().done(h(n,r,o)).fail(l.reject).progress(h(n,i,t)):--s;return s||l.resolveWith(r,o),l.promise()}}),ot.support=function(t){var i=G.createElement("input"),r=G.createDocumentFragment(),n=G.createElement("div"),o=G.createElement("select"),a=o.appendChild(G.createElement("option"));return i.type?(i.type="checkbox",t.checkOn=""!==i.value,t.optSelected=a.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,i.checked=!0,t.noCloneChecked=i.cloneNode(!0).checked,o.disabled=!0,t.optDisabled=!a.disabled,i=G.createElement("input"),i.value="t",i.type="radio",t.radioValue="t"===i.value,i.setAttribute("checked","t"),i.setAttribute("name","t"),r.appendChild(i),t.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin"in e,n.style.backgroundClip="content-box",n.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===n.style.backgroundClip,ot(function(){var i,r,o="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",a=G.getElementsByTagName("body")[0];a&&(i=G.createElement("div"),i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(i).appendChild(n),n.innerHTML="",n.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",ot.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===n.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(n,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(n,null)||{width:"4px"}).width,r=n.appendChild(G.createElement("div")),r.style.cssText=n.style.cssText=o,r.style.marginRight=r.style.width="0",n.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),a.removeChild(i))}),t):t}({});var mt,gt,vt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Et=/([A-Z])/g;n.uid=1,n.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},n.prototype={key:function(e){if(!n.accepts(e))return 0;var t={},i=e[this.expando];if(!i){i=n.uid++;try{t[this.expando]={value:i},Object.defineProperties(e,t)}catch(r){t[this.expando]=i,ot.extend(e,t)}}return this.cache[i]||(this.cache[i]={}),i},set:function(e,t,i){var r,n=this.key(e),o=this.cache[n];if("string"==typeof t)o[t]=i;else if(ot.isEmptyObject(o))ot.extend(this.cache[n],t);else for(r in t)o[r]=t[r];return o},get:function(e,i){var r=this.cache[this.key(e)];return i===t?r:r[i]},access:function(e,i,r){var n;return i===t||i&&"string"==typeof i&&r===t?(n=this.get(e,i),n!==t?n:this.get(e,ot.camelCase(i))):(this.set(e,i,r),r!==t?r:i)},remove:function(e,i){var r,n,o,a=this.key(e),s=this.cache[a];if(i===t)this.cache[a]={};else{ot.isArray(i)?n=i.concat(i.map(ot.camelCase)):(o=ot.camelCase(i),i in s?n=[i,o]:(n=o,n=n in s?[n]:n.match(st)||[])),r=n.length;for(;r--;)delete s[n[r]]}},hasData:function(e){return!ot.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},mt=new n,gt=new n,ot.extend({acceptData:n.accepts,hasData:function(e){return mt.hasData(e)||gt.hasData(e)},data:function(e,t,i){return mt.access(e,t,i)},removeData:function(e,t){mt.remove(e,t)},_data:function(e,t,i){return gt.access(e,t,i)},_removeData:function(e,t){gt.remove(e,t)}}),ot.fn.extend({data:function(e,i){var r,n,a=this[0],s=0,l=null;if(e===t){if(this.length&&(l=mt.get(a),1===a.nodeType&&!gt.get(a,"hasDataAttrs"))){for(r=a.attributes;r.length>s;s++)n=r[s].name,0===n.indexOf("data-")&&(n=ot.camelCase(n.slice(5)),o(a,n,l[n]));gt.set(a,"hasDataAttrs",!0)}return l}return"object"==typeof e?this.each(function(){mt.set(this,e)}):ot.access(this,function(i){var r,n=ot.camelCase(e);if(a&&i===t){if(r=mt.get(a,e),r!==t)return r;if(r=mt.get(a,n),r!==t)return r;if(r=o(a,n,t),r!==t)return r}else this.each(function(){var r=mt.get(this,n);mt.set(this,n,i),-1!==e.indexOf("-")&&r!==t&&mt.set(this,e,i)})},null,i,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){mt.remove(this,e)})}});ot.extend({queue:function(e,i,r){var n;return e?(i=(i||"fx")+"queue",n=gt.get(e,i),r&&(!n||ot.isArray(r)?n=gt.access(e,i,ot.makeArray(r)):n.push(r)),n||[]):t},dequeue:function(e,t){t=t||"fx";var i=ot.queue(e,t),r=i.length,n=i.shift(),o=ot._queueHooks(e,t),a=function(){ot.dequeue(e,t)};"inprogress"===n&&(n=i.shift(),r--),n&&("fx"===t&&i.unshift("inprogress"),delete o.stop,n.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return gt.get(e,i)||gt.access(e,i,{empty:ot.Callbacks("once memory").add(function(){gt.remove(e,[t+"queue",i])})})}}),ot.fn.extend({queue:function(e,i){var r=2;return"string"!=typeof e&&(i=e,e="fx",r--),r>arguments.length?ot.queue(this[0],e):i===t?this:this.each(function(){var t=ot.queue(this,e,i);ot._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&ot.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ot.dequeue(this,e)})},delay:function(e,t){return e=ot.fx?ot.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var r=setTimeout(t,e);i.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,i){var r,n=1,o=ot.Deferred(),a=this,s=this.length,l=function(){--n||o.resolveWith(a,[a])};"string"!=typeof e&&(i=e,e=t),e=e||"fx";for(;s--;)r=gt.get(a[s],e+"queueHooks"),r&&r.empty&&(n++,r.empty.add(l));return l(),o.promise(i)}});var yt,Tt,_t=/[\t\r\n\f]/g,bt=/\r/g,xt=/^(?:input|select|textarea|button)$/i;ot.fn.extend({attr:function(e,t){return ot.access(this,ot.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ot.removeAttr(this,e)})},prop:function(e,t){return ot.access(this,ot.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[ot.propFix[e]||e]})},addClass:function(e){var t,i,r,n,o,a=0,s=this.length,l="string"==typeof e&&e;if(ot.isFunction(e))return this.each(function(t){ot(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(st)||[];s>a;a++)if(i=this[a],r=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(_t," "):" ")){o=0;for(;n=t[o++];)0>r.indexOf(" "+n+" ")&&(r+=n+" ");i.className=ot.trim(r)}return this},removeClass:function(e){var t,i,r,n,o,a=0,s=this.length,l=0===arguments.length||"string"==typeof e&&e;if(ot.isFunction(e))return this.each(function(t){ot(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(st)||[];s>a;a++)if(i=this[a],r=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(_t," "):"")){o=0;for(;n=t[o++];)for(;r.indexOf(" "+n+" ")>=0;)r=r.replace(" "+n+" "," ");i.className=e?ot.trim(r):""}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):ot.isFunction(e)?this.each(function(i){ot(this).toggleClass(e.call(this,i,this.className,t),t)}):this.each(function(){if("string"===i){var t,r=0,n=ot(this),o=e.match(st)||[];for(;t=o[r++];)n.hasClass(t)?n.removeClass(t):n.addClass(t)}else(i===j||"boolean"===i)&&(this.className&&gt.set(this,"__className__",this.className),this.className=this.className||e===!1?"":gt.get(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",i=0,r=this.length;for(;r>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(_t," ").indexOf(t)>=0)return!0;return!1},val:function(e){var i,r,n,o=this[0];if(arguments.length)return n=ot.isFunction(e),this.each(function(r){var o;1===this.nodeType&&(o=n?e.call(this,r,ot(this).val()):e,null==o?o="":"number"==typeof o?o+="":ot.isArray(o)&&(o=ot.map(o,function(e){return null==e?"":e+""})),i=ot.valHooks[this.type]||ot.valHooks[this.nodeName.toLowerCase()],i&&"set"in i&&i.set(this,o,"value")!==t||(this.value=o))});if(o)return i=ot.valHooks[o.type]||ot.valHooks[o.nodeName.toLowerCase()],i&&"get"in i&&(r=i.get(o,"value"))!==t?r:(r=o.value,"string"==typeof r?r.replace(bt,""):null==r?"":r);else return void 0}}),ot.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,i,r=e.options,n=e.selectedIndex,o="select-one"===e.type||0>n,a=o?null:[],s=o?n+1:r.length,l=0>n?s:o?n:0;for(;s>l;l++)if(i=r[l],!(!i.selected&&l!==n||(ot.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&ot.nodeName(i.parentNode,"optgroup"))){if(t=ot(i).val(),o)return t;a.push(t)}return a},set:function(e,t){var i,r,n=e.options,o=ot.makeArray(t),a=n.length;for(;a--;)r=n[a],(r.selected=ot.inArray(ot(r).val(),o)>=0)&&(i=!0);return i||(e.selectedIndex=-1),o}}},attr:function(e,i,r){var n,o,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return typeof e.getAttribute===j?ot.prop(e,i,r):(1===a&&ot.isXMLDoc(e)||(i=i.toLowerCase(),n=ot.attrHooks[i]||(ot.expr.match.bool.test(i)?Tt:yt)),r===t?n&&"get"in n&&null!==(o=n.get(e,i))?o:(o=ot.find.attr(e,i),null==o?t:o):null!==r?n&&"set"in n&&(o=n.set(e,r,i))!==t?o:(e.setAttribute(i,r+""),r):(ot.removeAttr(e,i),t));else return void 0},removeAttr:function(e,t){var i,r,n=0,o=t&&t.match(st);if(o&&1===e.nodeType)for(;i=o[n++];)r=ot.propFix[i]||i,ot.expr.match.bool.test(i)&&(e[r]=!1),e.removeAttribute(i)},attrHooks:{type:{set:function(e,t){if(!ot.support.radioValue&&"radio"===t&&ot.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,i,r){var n,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!ot.isXMLDoc(e),a&&(i=ot.propFix[i]||i,o=ot.propHooks[i]),r!==t?o&&"set"in o&&(n=o.set(e,r,i))!==t?n:e[i]=r:o&&"get"in o&&null!==(n=o.get(e,i))?n:e[i];else return void 0},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||xt.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),Tt={set:function(e,t,i){return t===!1?ot.removeAttr(e,i):e.setAttribute(i,i),i}},ot.each(ot.expr.match.bool.source.match(/\w+/g),function(e,i){var r=ot.expr.attrHandle[i]||ot.find.attr;ot.expr.attrHandle[i]=function(e,i,n){var o=ot.expr.attrHandle[i],a=n?t:(ot.expr.attrHandle[i]=t)!=r(e,i,n)?i.toLowerCase():null;return ot.expr.attrHandle[i]=o,a}}),ot.support.optSelected||(ot.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),ot.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ot.propFix[this.toLowerCase()]=this}),ot.each(["radio","checkbox"],function(){ot.valHooks[this]={set:function(e,i){return ot.isArray(i)?e.checked=ot.inArray(ot(e).val(),i)>=0:t}},ot.support.checkOn||(ot.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Rt=/^key/,wt=/^(?:mouse|contextmenu)|click/,Ht=/^(?:focusinfocus|focusoutblur)$/,Mt=/^([^.]*)(?:\.(.+)|)$/;ot.event={global:{},add:function(e,i,r,n,o){var a,s,l,h,c,u,f,d,p,m,g,v=gt.get(e);if(v){r.handler&&(a=r,r=a.handler,o=a.selector),r.guid||(r.guid=ot.guid++),(h=v.events)||(h=v.events={}),(s=v.handle)||(s=v.handle=function(e){return typeof ot===j||e&&ot.event.triggered===e.type?t:ot.event.dispatch.apply(s.elem,arguments)},s.elem=e),i=(i||"").match(st)||[""],c=i.length;for(;c--;)l=Mt.exec(i[c])||[],p=g=l[1],m=(l[2]||"").split(".").sort(),p&&(f=ot.event.special[p]||{},p=(o?f.delegateType:f.bindType)||p,f=ot.event.special[p]||{},u=ot.extend({type:p,origType:g,data:n,handler:r,guid:r.guid,selector:o,needsContext:o&&ot.expr.match.needsContext.test(o),namespace:m.join(".")},a),(d=h[p])||(d=h[p]=[],d.delegateCount=0,f.setup&&f.setup.call(e,n,m,s)!==!1||e.addEventListener&&e.addEventListener(p,s,!1)),f.add&&(f.add.call(e,u),u.handler.guid||(u.handler.guid=r.guid)),o?d.splice(d.delegateCount++,0,u):d.push(u),ot.event.global[p]=!0);e=null}},remove:function(e,t,i,r,n){var o,a,s,l,h,c,u,f,d,p,m,g=gt.hasData(e)&&gt.get(e);if(g&&(l=g.events)){t=(t||"").match(st)||[""],h=t.length;for(;h--;)if(s=Mt.exec(t[h])||[],d=m=s[1],p=(s[2]||"").split(".").sort(),d){u=ot.event.special[d]||{},d=(r?u.delegateType:u.bindType)||d,f=l[d]||[],s=s[2]&&RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=f.length;for(;o--;)c=f[o],!n&&m!==c.origType||i&&i.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(f.splice(o,1),c.selector&&f.delegateCount--,u.remove&&u.remove.call(e,c));a&&!f.length&&(u.teardown&&u.teardown.call(e,p,g.handle)!==!1||ot.removeEvent(e,d,g.handle),delete l[d])}else for(d in l)ot.event.remove(e,d+t[h],i,r,!0);ot.isEmptyObject(l)&&(delete g.handle,gt.remove(e,"events"))}},trigger:function(i,r,n,o){var a,s,l,h,c,u,f,d=[n||G],p=rt.call(i,"type")?i.type:i,m=rt.call(i,"namespace")?i.namespace.split("."):[];if(s=l=n=n||G,3!==n.nodeType&&8!==n.nodeType&&!Ht.test(p+ot.event.triggered)&&(p.indexOf(".")>=0&&(m=p.split("."),p=m.shift(),m.sort()),c=0>p.indexOf(":")&&"on"+p,i=i[ot.expando]?i:new ot.Event(p,"object"==typeof i&&i),i.isTrigger=o?2:3,i.namespace=m.join("."),i.namespace_re=i.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=t,i.target||(i.target=n),r=null==r?[i]:ot.makeArray(r,[i]),f=ot.event.special[p]||{},o||!f.trigger||f.trigger.apply(n,r)!==!1)){if(!o&&!f.noBubble&&!ot.isWindow(n)){for(h=f.delegateType||p,Ht.test(h+p)||(s=s.parentNode);s;s=s.parentNode)d.push(s),l=s;l===(n.ownerDocument||G)&&d.push(l.defaultView||l.parentWindow||e)}a=0;for(;(s=d[a++])&&!i.isPropagationStopped();)i.type=a>1?h:f.bindType||p,u=(gt.get(s,"events")||{})[i.type]&&gt.get(s,"handle"),u&&u.apply(s,r),u=c&&s[c],u&&ot.acceptData(s)&&u.apply&&u.apply(s,r)===!1&&i.preventDefault();return i.type=p,o||i.isDefaultPrevented()||f._default&&f._default.apply(d.pop(),r)!==!1||!ot.acceptData(n)||c&&ot.isFunction(n[p])&&!ot.isWindow(n)&&(l=n[c],l&&(n[c]=null),ot.event.triggered=p,n[p](),ot.event.triggered=t,l&&(n[c]=l)),i.result}},dispatch:function(e){e=ot.event.fix(e);var i,r,n,o,a,s=[],l=et.call(arguments),h=(gt.get(this,"events")||{})[e.type]||[],c=ot.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){s=ot.event.handlers.call(this,e,h),i=0;for(;(o=s[i++])&&!e.isPropagationStopped();){e.currentTarget=o.elem,r=0;for(;(a=o.handlers[r++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(a.namespace))&&(e.handleObj=a,e.data=a.data,n=((ot.event.special[a.origType]||{}).handle||a.handler).apply(o.elem,l),n!==t&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,i){var r,n,o,a,s=[],l=i.delegateCount,h=e.target;if(l&&h.nodeType&&(!e.button||"click"!==e.type))for(;h!==this;h=h.parentNode||this)if(h.disabled!==!0||"click"!==e.type){for(n=[],r=0;l>r;r++)a=i[r],o=a.selector+" ",n[o]===t&&(n[o]=a.needsContext?ot(o,this).index(h)>=0:ot.find(o,this,null,[h]).length),n[o]&&n.push(a);n.length&&s.push({elem:h,handlers:n})}return i.length>l&&s.push({elem:this,handlers:i.slice(l)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,i){var r,n,o,a=i.button;return null==e.pageX&&null!=i.clientX&&(r=e.target.ownerDocument||G,n=r.documentElement,o=r.body,e.pageX=i.clientX+(n&&n.scrollLeft||o&&o.scrollLeft||0)-(n&&n.clientLeft||o&&o.clientLeft||0),e.pageY=i.clientY+(n&&n.scrollTop||o&&o.scrollTop||0)-(n&&n.clientTop||o&&o.clientTop||0)),e.which||a===t||(e.which=1&a?1:2&a?3:4&a?2:0),e}},fix:function(e){if(e[ot.expando])return e;var t,i,r,n=e.type,o=e,a=this.fixHooks[n];a||(this.fixHooks[n]=a=wt.test(n)?this.mouseHooks:Rt.test(n)?this.keyHooks:{}),r=a.props?this.props.concat(a.props):this.props,e=new ot.Event(o),t=r.length;for(;t--;)i=r[t],e[i]=o[i];return e.target||(e.target=G),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==l()&&this.focus?(this.focus(),!1):t},delegateType:"focusin"},blur:{trigger:function(){return this===l()&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&ot.nodeName(this,"input")?(this.click(),!1):t},_default:function(e){return ot.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,r){var n=ot.extend(new ot.Event,i,{type:e,isSimulated:!0,originalEvent:{}});r?ot.event.trigger(n,null,t):ot.event.dispatch.call(t,n),n.isDefaultPrevented()&&i.preventDefault()}},ot.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)},ot.Event=function(e,i){return this instanceof ot.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?a:s):this.type=e,i&&ot.extend(this,i),this.timeStamp=e&&e.timeStamp||ot.now(),this[ot.expando]=!0,t):new ot.Event(e,i)},ot.Event.prototype={isDefaultPrevented:s,isPropagationStopped:s,isImmediatePropagationStopped:s,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=a,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=a,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=a,this.stopPropagation()}},ot.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){ot.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,r=this,n=e.relatedTarget,o=e.handleObj;return(!n||n!==r&&!ot.contains(r,n))&&(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}}),ot.support.focusinBubbles||ot.each({focus:"focusin",blur:"focusout"},function(e,t){var i=0,r=function(e){ot.event.simulate(t,e.target,ot.event.fix(e),!0)};ot.event.special[t]={setup:function(){0===i++&&G.addEventListener(e,r,!0)},teardown:function(){0===--i&&G.removeEventListener(e,r,!0)}}}),ot.fn.extend({on:function(e,i,r,n,o){var a,l;if("object"==typeof e){"string"!=typeof i&&(r=r||i,i=t);for(l in e)this.on(l,i,r,e[l],o);return this}if(null==r&&null==n?(n=i,r=i=t):null==n&&("string"==typeof i?(n=r,r=t):(n=r,r=i,i=t)),n===!1)n=s;else if(!n)return this;return 1===o&&(a=n,n=function(e){return ot().off(e),a.apply(this,arguments)},n.guid=a.guid||(a.guid=ot.guid++)),this.each(function(){ot.event.add(this,e,n,r,i)})},one:function(e,t,i,r){return this.on(e,t,i,r,1)},off:function(e,i,r){var n,o;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,ot(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(o in e)this.off(o,i,e[o]);return this}return(i===!1||"function"==typeof i)&&(r=i,i=t),r===!1&&(r=s),this.each(function(){ot.event.remove(this,e,r,i)})},trigger:function(e,t){return this.each(function(){ot.event.trigger(e,t,this)})},triggerHandler:function(e,i){var r=this[0];return r?ot.event.trigger(e,i,r,!0):t}});var St=/^.[^:#\[\.,]*$/,Ct=/^(?:parents|prev(?:Until|All))/,At=ot.expr.match.needsContext,Dt={children:!0,contents:!0,next:!0,prev:!0};ot.fn.extend({find:function(e){var t,i=[],r=this,n=r.length;if("string"!=typeof e)return this.pushStack(ot(e).filter(function(){for(t=0;n>t;t++)if(ot.contains(r[t],this))return!0}));for(t=0;n>t;t++)ot.find(e,r[t],i);return i=this.pushStack(n>1?ot.unique(i):i),i.selector=this.selector?this.selector+" "+e:e,i},has:function(e){var t=ot(e,this),i=t.length;return this.filter(function(){var e=0;for(;i>e;e++)if(ot.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(c(this,e||[],!0))},filter:function(e){return this.pushStack(c(this,e||[],!1))},is:function(e){return!!c(this,"string"==typeof e&&At.test(e)?ot(e):e||[],!1).length},closest:function(e,t){var i,r=0,n=this.length,o=[],a=At.test(e)||"string"!=typeof e?ot(e,t||this.context):0;for(;n>r;r++)for(i=this[r];i&&i!==t;i=i.parentNode)if(11>i.nodeType&&(a?a.index(i)>-1:1===i.nodeType&&ot.find.matchesSelector(i,e))){i=o.push(i);break}return this.pushStack(o.length>1?ot.unique(o):o)},index:function(e){return e?"string"==typeof e?tt.call(ot(e),this[0]):tt.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var i="string"==typeof e?ot(e,t):ot.makeArray(e&&e.nodeType?[e]:e),r=ot.merge(this.get(),i);return this.pushStack(ot.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}});ot.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ot.dir(e,"parentNode")},parentsUntil:function(e,t,i){return ot.dir(e,"parentNode",i)},next:function(e){return h(e,"nextSibling")},prev:function(e){return h(e,"previousSibling")},nextAll:function(e){return ot.dir(e,"nextSibling")},prevAll:function(e){return ot.dir(e,"previousSibling")},nextUntil:function(e,t,i){return ot.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return ot.dir(e,"previousSibling",i)},siblings:function(e){return ot.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ot.sibling(e.firstChild)},contents:function(e){return e.contentDocument||ot.merge([],e.childNodes)}},function(e,t){ot.fn[e]=function(i,r){var n=ot.map(this,t,i);return"Until"!==e.slice(-5)&&(r=i),r&&"string"==typeof r&&(n=ot.filter(r,n)),this.length>1&&(Dt[e]||ot.unique(n),Ct.test(e)&&n.reverse()),this.pushStack(n)}}),ot.extend({filter:function(e,t,i){var r=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?ot.find.matchesSelector(r,e)?[r]:[]:ot.find.matches(e,ot.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,i,r){var n=[],o=r!==t;for(;(e=e[i])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&ot(e).is(r))break;n.push(e)}return n},sibling:function(e,t){var i=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}});var Pt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,kt=/<([\w:]+)/,Lt=/<|&#?\w+;/,Ft=/<(?:script|style|link)/i,zt=/^(?:checkbox|radio)$/i,Nt=/checked\s*(?:[^=]|=\s*.checked.)/i,It=/^$|\/(?:java|ecma)script/i,Ot=/^true\/(.*)/,Ut=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Vt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Vt.optgroup=Vt.option,Vt.tbody=Vt.tfoot=Vt.colgroup=Vt.caption=Vt.thead,Vt.th=Vt.td,ot.fn.extend({text:function(e){return ot.access(this,function(e){return e===t?ot.text(this):this.empty().append((this[0]&&this[0].ownerDocument||G).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=u(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=u(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var i,r=e?ot.filter(e,this):this,n=0;for(;null!=(i=r[n]);n++)t||1!==i.nodeType||ot.cleanData(g(i)),i.parentNode&&(t&&ot.contains(i.ownerDocument,i)&&p(g(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++)1===e.nodeType&&(ot.cleanData(g(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return ot.clone(this,e,t)})},html:function(e){return ot.access(this,function(e){var i=this[0]||{},r=0,n=this.length;if(e===t&&1===i.nodeType)return i.innerHTML;if("string"==typeof e&&!Ft.test(e)&&!Vt[(kt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Pt,"<$1></$2>");try{for(;n>r;r++)i=this[r]||{},1===i.nodeType&&(ot.cleanData(g(i,!1)),i.innerHTML=e);i=0}catch(o){}}i&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=ot.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(i){var r=e[t++],n=e[t++];n&&(r&&r.parentNode!==n&&(r=this.nextSibling),ot(this).remove(),n.insertBefore(i,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,i){e=$.apply([],e);var r,n,o,a,s,l,h=0,c=this.length,u=this,p=c-1,m=e[0],v=ot.isFunction(m);if(v||!(1>=c||"string"!=typeof m||ot.support.checkClone)&&Nt.test(m))return this.each(function(r){var n=u.eq(r);v&&(e[0]=m.call(this,r,n.html())),n.domManip(e,t,i)});if(c&&(r=ot.buildFragment(e,this[0].ownerDocument,!1,!i&&this),n=r.firstChild,1===r.childNodes.length&&(r=n),n)){for(o=ot.map(g(r,"script"),f),a=o.length;c>h;h++)s=r,h!==p&&(s=ot.clone(s,!0,!0),a&&ot.merge(o,g(s,"script"))),t.call(this[h],s,h);if(a)for(l=o[o.length-1].ownerDocument,ot.map(o,d),h=0;a>h;h++)s=o[h],It.test(s.type||"")&&!gt.access(s,"globalEval")&&ot.contains(l,s)&&(s.src?ot._evalUrl(s.src):ot.globalEval(s.textContent.replace(Ut,"")))}return this}}),ot.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ot.fn[e]=function(e){var i,r=[],n=ot(e),o=n.length-1,a=0;for(;o>=a;a++)i=a===o?this:this.clone(!0),ot(n[a])[t](i),J.apply(r,i.get());return this.pushStack(r)}}),ot.extend({clone:function(e,t,i){var r,n,o,a,s=e.cloneNode(!0),l=ot.contains(e.ownerDocument,e);if(!(ot.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ot.isXMLDoc(e)))for(a=g(s),o=g(e),r=0,n=o.length;n>r;r++)v(o[r],a[r]);if(t)if(i)for(o=o||g(e),a=a||g(s),r=0,n=o.length;n>r;r++)m(o[r],a[r]);else m(e,s);return a=g(s,"script"),a.length>0&&p(a,!l&&g(e,"script")),s},buildFragment:function(e,t,i,r){var n,o,a,s,l,h,c=0,u=e.length,f=t.createDocumentFragment(),d=[];for(;u>c;c++)if(n=e[c],n||0===n)if("object"===ot.type(n))ot.merge(d,n.nodeType?[n]:n);
else if(Lt.test(n)){o=o||f.appendChild(t.createElement("div")),a=(kt.exec(n)||["",""])[1].toLowerCase(),s=Vt[a]||Vt._default,o.innerHTML=s[1]+n.replace(Pt,"<$1></$2>")+s[2],h=s[0];for(;h--;)o=o.lastChild;ot.merge(d,o.childNodes),o=f.firstChild,o.textContent=""}else d.push(t.createTextNode(n));f.textContent="",c=0;for(;n=d[c++];)if((!r||-1===ot.inArray(n,r))&&(l=ot.contains(n.ownerDocument,n),o=g(f.appendChild(n),"script"),l&&p(o),i)){h=0;for(;n=o[h++];)It.test(n.type||"")&&i.push(n)}return f},cleanData:function(e){var i,r,o,a,s,l,h=ot.event.special,c=0;for(;(r=e[c])!==t;c++){if(n.accepts(r)&&(s=r[gt.expando],s&&(i=gt.cache[s]))){if(o=Object.keys(i.events||{}),o.length)for(l=0;(a=o[l])!==t;l++)h[a]?ot.event.remove(r,a):ot.removeEvent(r,a,i.handle);gt.cache[s]&&delete gt.cache[s]}delete mt.cache[r[mt.expando]]}},_evalUrl:function(e){return ot.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}});ot.fn.extend({wrapAll:function(e){var t;return ot.isFunction(e)?this.each(function(t){ot(this).wrapAll(e.call(this,t))}):(this[0]&&(t=ot(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;for(;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return ot.isFunction(e)?this.each(function(t){ot(this).wrapInner(e.call(this,t))}):this.each(function(){var t=ot(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=ot.isFunction(e);return this.each(function(i){ot(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){ot.nodeName(this,"body")||ot(this).replaceWith(this.childNodes)}).end()}});var Bt,jt,Wt=/^(none|table(?!-c[ea]).+)/,Gt=/^margin/,Xt=RegExp("^("+at+")(.*)$","i"),Yt=RegExp("^("+at+")(?!px)[a-z%]+$","i"),qt=RegExp("^([+-])=("+at+")","i"),Kt={BODY:"block"},Qt={position:"absolute",visibility:"hidden",display:"block"},Zt={letterSpacing:0,fontWeight:400},$t=["Top","Right","Bottom","Left"],Jt=["Webkit","O","Moz","ms"];ot.fn.extend({css:function(e,i){return ot.access(this,function(e,i,r){var n,o,a={},s=0;if(ot.isArray(i)){for(n=T(e),o=i.length;o>s;s++)a[i[s]]=ot.css(e,i[s],!1,n);return a}return r!==t?ot.style(e,i,r):ot.css(e,i)},e,i,arguments.length>1)},show:function(){return _(this,!0)},hide:function(){return _(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){y(this)?ot(this).show():ot(this).hide()})}}),ot.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=Bt(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,i,r,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,l=ot.camelCase(i),h=e.style;return i=ot.cssProps[l]||(ot.cssProps[l]=E(h,l)),s=ot.cssHooks[i]||ot.cssHooks[l],r===t?s&&"get"in s&&(o=s.get(e,!1,n))!==t?o:h[i]:(a=typeof r,"string"===a&&(o=qt.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(ot.css(e,i)),a="number"),null==r||"number"===a&&isNaN(r)||("number"!==a||ot.cssNumber[l]||(r+="px"),ot.support.clearCloneStyle||""!==r||0!==i.indexOf("background")||(h[i]="inherit"),s&&"set"in s&&(r=s.set(e,r,n))===t||(h[i]=r)),t)}},css:function(e,i,r,n){var o,a,s,l=ot.camelCase(i);return i=ot.cssProps[l]||(ot.cssProps[l]=E(e.style,l)),s=ot.cssHooks[i]||ot.cssHooks[l],s&&"get"in s&&(o=s.get(e,!0,r)),o===t&&(o=Bt(e,i,n)),"normal"===o&&i in Zt&&(o=Zt[i]),""===r||r?(a=parseFloat(o),r===!0||ot.isNumeric(a)?a||0:o):o}}),Bt=function(e,i,r){var n,o,a,s=r||T(e),l=s?s.getPropertyValue(i)||s[i]:t,h=e.style;return s&&(""!==l||ot.contains(e.ownerDocument,e)||(l=ot.style(e,i)),Yt.test(l)&&Gt.test(i)&&(n=h.width,o=h.minWidth,a=h.maxWidth,h.minWidth=h.maxWidth=h.width=l,l=s.width,h.width=n,h.minWidth=o,h.maxWidth=a)),l};ot.each(["height","width"],function(e,i){ot.cssHooks[i]={get:function(e,r,n){return r?0===e.offsetWidth&&Wt.test(ot.css(e,"display"))?ot.swap(e,Qt,function(){return R(e,i,n)}):R(e,i,n):t},set:function(e,t,r){var n=r&&T(e);return b(e,t,r?x(e,i,r,ot.support.boxSizing&&"border-box"===ot.css(e,"boxSizing",!1,n),n):0)}}}),ot(function(){ot.support.reliableMarginRight||(ot.cssHooks.marginRight={get:function(e,i){return i?ot.swap(e,{display:"inline-block"},Bt,[e,"marginRight"]):t}}),!ot.support.pixelPosition&&ot.fn.position&&ot.each(["top","left"],function(e,i){ot.cssHooks[i]={get:function(e,r){return r?(r=Bt(e,i),Yt.test(r)?ot(e).position()[i]+"px":r):t}}})}),ot.expr&&ot.expr.filters&&(ot.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight},ot.expr.filters.visible=function(e){return!ot.expr.filters.hidden(e)}),ot.each({margin:"",padding:"",border:"Width"},function(e,t){ot.cssHooks[e+t]={expand:function(i){var r=0,n={},o="string"==typeof i?i.split(" "):[i];for(;4>r;r++)n[e+$t[r]+t]=o[r]||o[r-2]||o[0];return n}},Gt.test(e)||(ot.cssHooks[e+t].set=b)});var ei=/%20/g,ti=/\[\]$/,ii=/\r?\n/g,ri=/^(?:submit|button|image|reset|file)$/i,ni=/^(?:input|select|textarea|keygen)/i;ot.fn.extend({serialize:function(){return ot.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ot.prop(this,"elements");return e?ot.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ot(this).is(":disabled")&&ni.test(this.nodeName)&&!ri.test(e)&&(this.checked||!zt.test(e))}).map(function(e,t){var i=ot(this).val();return null==i?null:ot.isArray(i)?ot.map(i,function(e){return{name:t.name,value:e.replace(ii,"\r\n")}}):{name:t.name,value:i.replace(ii,"\r\n")}}).get()}}),ot.param=function(e,i){var r,n=[],o=function(e,t){t=ot.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(i===t&&(i=ot.ajaxSettings&&ot.ajaxSettings.traditional),ot.isArray(e)||e.jquery&&!ot.isPlainObject(e))ot.each(e,function(){o(this.name,this.value)});else for(r in e)M(r,e[r],i,o);return n.join("&").replace(ei,"+")};ot.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){ot.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),ot.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,r){return this.on(t,e,i,r)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var oi,ai,si=ot.now(),li=/\?/,hi=/#.*$/,ci=/([?&])_=[^&]*/,ui=/^(.*?):[ \t]*([^\r\n]*)$/gm,fi=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,di=/^(?:GET|HEAD)$/,pi=/^\/\//,mi=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,gi=ot.fn.load,vi={},Ei={},yi="*/".concat("*");try{ai=W.href}catch(Ti){ai=G.createElement("a"),ai.href="",ai=ai.href}oi=mi.exec(ai.toLowerCase())||[];ot.fn.load=function(e,i,r){if("string"!=typeof e&&gi)return gi.apply(this,arguments);var n,o,a,s=this,l=e.indexOf(" ");return l>=0&&(n=e.slice(l),e=e.slice(0,l)),ot.isFunction(i)?(r=i,i=t):i&&"object"==typeof i&&(o="POST"),s.length>0&&ot.ajax({url:e,type:o,dataType:"html",data:i}).done(function(e){a=arguments,s.html(n?ot("<div>").append(ot.parseHTML(e)).find(n):e)}).complete(r&&function(e,t){s.each(r,a||[e.responseText,t,e])}),this},ot.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ot.fn[t]=function(e){return this.on(t,e)}}),ot.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ai,type:"GET",isLocal:fi.test(oi[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":yi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ot.parseJSON,"text xml":ot.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?A(A(e,ot.ajaxSettings),t):A(ot.ajaxSettings,e)},ajaxPrefilter:S(vi),ajaxTransport:S(Ei),ajax:function(e,i){function r(e,i,r,s){var h,u,E,y,_,x=i;2!==T&&(T=2,l&&clearTimeout(l),n=t,a=s||"",b.readyState=e>0?4:0,h=e>=200&&300>e||304===e,r&&(y=D(f,b,r)),y=P(f,y,b,h),h?(f.ifModified&&(_=b.getResponseHeader("Last-Modified"),_&&(ot.lastModified[o]=_),_=b.getResponseHeader("etag"),_&&(ot.etag[o]=_)),204===e||"HEAD"===f.type?x="nocontent":304===e?x="notmodified":(x=y.state,u=y.data,E=y.error,h=!E)):(E=x,(e||!x)&&(x="error",0>e&&(e=0))),b.status=e,b.statusText=(i||x)+"",h?m.resolveWith(d,[u,x,b]):m.rejectWith(d,[b,x,E]),b.statusCode(v),v=t,c&&p.trigger(h?"ajaxSuccess":"ajaxError",[b,f,h?u:E]),g.fireWith(d,[b,x]),c&&(p.trigger("ajaxComplete",[b,f]),--ot.active||ot.event.trigger("ajaxStop")))}"object"==typeof e&&(i=e,e=t),i=i||{};var n,o,a,s,l,h,c,u,f=ot.ajaxSetup({},i),d=f.context||f,p=f.context&&(d.nodeType||d.jquery)?ot(d):ot.event,m=ot.Deferred(),g=ot.Callbacks("once memory"),v=f.statusCode||{},E={},y={},T=0,_="canceled",b={readyState:0,getResponseHeader:function(e){var t;if(2===T){if(!s){s={};for(;t=ui.exec(a);)s[t[1].toLowerCase()]=t[2]}t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===T?a:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return T||(e=y[i]=y[i]||e,E[e]=t),this},overrideMimeType:function(e){return T||(f.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>T)for(t in e)v[t]=[v[t],e[t]];else b.always(e[b.status]);return this},abort:function(e){var t=e||_;return n&&n.abort(t),r(0,t),this}};if(m.promise(b).complete=g.add,b.success=b.done,b.error=b.fail,f.url=((e||f.url||ai)+"").replace(hi,"").replace(pi,oi[1]+"//"),f.type=i.method||i.type||f.method||f.type,f.dataTypes=ot.trim(f.dataType||"*").toLowerCase().match(st)||[""],null==f.crossDomain&&(h=mi.exec(f.url.toLowerCase()),f.crossDomain=!(!h||h[1]===oi[1]&&h[2]===oi[2]&&(h[3]||("http:"===h[1]?"80":"443"))===(oi[3]||("http:"===oi[1]?"80":"443")))),f.data&&f.processData&&"string"!=typeof f.data&&(f.data=ot.param(f.data,f.traditional)),C(vi,f,i,b),2===T)return b;c=f.global,c&&0===ot.active++&&ot.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!di.test(f.type),o=f.url,f.hasContent||(f.data&&(o=f.url+=(li.test(o)?"&":"?")+f.data,delete f.data),f.cache===!1&&(f.url=ci.test(o)?o.replace(ci,"$1_="+si++):o+(li.test(o)?"&":"?")+"_="+si++)),f.ifModified&&(ot.lastModified[o]&&b.setRequestHeader("If-Modified-Since",ot.lastModified[o]),ot.etag[o]&&b.setRequestHeader("If-None-Match",ot.etag[o])),(f.data&&f.hasContent&&f.contentType!==!1||i.contentType)&&b.setRequestHeader("Content-Type",f.contentType),b.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+yi+"; q=0.01":""):f.accepts["*"]);for(u in f.headers)b.setRequestHeader(u,f.headers[u]);if(f.beforeSend&&(f.beforeSend.call(d,b,f)===!1||2===T))return b.abort();_="abort";for(u in{success:1,error:1,complete:1})b[u](f[u]);if(n=C(Ei,f,i,b)){b.readyState=1,c&&p.trigger("ajaxSend",[b,f]),f.async&&f.timeout>0&&(l=setTimeout(function(){b.abort("timeout")},f.timeout));try{T=1,n.send(E,r)}catch(x){if(!(2>T))throw x;r(-1,x)}}else r(-1,"No Transport");return b},getJSON:function(e,t,i){return ot.get(e,t,i,"json")},getScript:function(e,i){return ot.get(e,t,i,"script")}}),ot.each(["get","post"],function(e,i){ot[i]=function(e,r,n,o){return ot.isFunction(r)&&(o=o||n,n=r,r=t),ot.ajax({url:e,type:i,dataType:o,data:r,success:n})}});ot.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return ot.globalEval(e),e}}}),ot.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),ot.ajaxTransport("script",function(e){if(e.crossDomain){var t,i;return{send:function(r,n){t=ot("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&n("error"===e.type?404:200,e.type)}),G.head.appendChild(t[0])},abort:function(){i&&i()}}}});var _i=[],bi=/(=)\?(?=&|$)|\?\?/;ot.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=_i.pop()||ot.expando+"_"+si++;return this[e]=!0,e}}),ot.ajaxPrefilter("json jsonp",function(i,r,n){var o,a,s,l=i.jsonp!==!1&&(bi.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&bi.test(i.data)&&"data");return l||"jsonp"===i.dataTypes[0]?(o=i.jsonpCallback=ot.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,l?i[l]=i[l].replace(bi,"$1"+o):i.jsonp!==!1&&(i.url+=(li.test(i.url)?"&":"?")+i.jsonp+"="+o),i.converters["script json"]=function(){return s||ot.error(o+" was not called"),s[0]},i.dataTypes[0]="json",a=e[o],e[o]=function(){s=arguments},n.always(function(){e[o]=a,i[o]&&(i.jsonpCallback=r.jsonpCallback,_i.push(o)),s&&ot.isFunction(a)&&a(s[0]),s=a=t}),"script"):t}),ot.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var xi=ot.ajaxSettings.xhr(),Ri={0:200,1223:204},wi=0,Hi={};e.ActiveXObject&&ot(e).on("unload",function(){for(var e in Hi)Hi[e]();Hi=t}),ot.support.cors=!!xi&&"withCredentials"in xi,ot.support.ajax=xi=!!xi,ot.ajaxTransport(function(e){var i;return ot.support.cors||xi&&!e.crossDomain?{send:function(r,n){var o,a,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)s[o]=e.xhrFields[o];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest");for(o in r)s.setRequestHeader(o,r[o]);i=function(e){return function(){i&&(delete Hi[a],i=s.onload=s.onerror=null,"abort"===e?s.abort():"error"===e?n(s.status||404,s.statusText):n(Ri[s.status]||s.status,s.statusText,"string"==typeof s.responseText?{text:s.responseText}:t,s.getAllResponseHeaders()))}},s.onload=i(),s.onerror=i("error"),i=Hi[a=wi++]=i("abort"),s.send(e.hasContent&&e.data||null)},abort:function(){i&&i()}}:t});var Mi,Si,Ci=/^(?:toggle|show|hide)$/,Ai=RegExp("^(?:([+-])=|)("+at+")([a-z%]*)$","i"),Di=/queueHooks$/,Pi=[N],ki={"*":[function(e,t){var i=this.createTween(e,t),r=i.cur(),n=Ai.exec(t),o=n&&n[3]||(ot.cssNumber[e]?"":"px"),a=(ot.cssNumber[e]||"px"!==o&&+r)&&Ai.exec(ot.css(i.elem,e)),s=1,l=20;if(a&&a[3]!==o){o=o||a[3],n=n||[],a=+r||1;do s=s||".5",a/=s,ot.style(i.elem,e,a+o);while(s!==(s=i.cur()/r)&&1!==s&&--l)}return n&&(a=i.start=+a||+r||0,i.unit=o,i.end=n[1]?a+(n[1]+1)*n[2]:+n[2]),i}]};ot.Animation=ot.extend(F,{tweener:function(e,t){ot.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var i,r=0,n=e.length;for(;n>r;r++)i=e[r],ki[i]=ki[i]||[],ki[i].unshift(t)},prefilter:function(e,t){t?Pi.unshift(e):Pi.push(e)}});ot.Tween=I,I.prototype={constructor:I,init:function(e,t,i,r,n,o){this.elem=e,this.prop=i,this.easing=n||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(ot.cssNumber[i]?"":"px")},cur:function(){var e=I.propHooks[this.prop];return e&&e.get?e.get(this):I.propHooks._default.get(this)},run:function(e){var t,i=I.propHooks[this.prop];return this.pos=t=this.options.duration?ot.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):I.propHooks._default.set(this),this}},I.prototype.init.prototype=I.prototype,I.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=ot.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){ot.fx.step[e.prop]?ot.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[ot.cssProps[e.prop]]||ot.cssHooks[e.prop])?ot.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},I.propHooks.scrollTop=I.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ot.each(["toggle","show","hide"],function(e,t){var i=ot.fn[t];ot.fn[t]=function(e,r,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(O(t,!0),e,r,n)}}),ot.fn.extend({fadeTo:function(e,t,i,r){return this.filter(y).css("opacity",0).show().end().animate({opacity:t},e,i,r)},animate:function(e,t,i,r){var n=ot.isEmptyObject(e),o=ot.speed(t,i,r),a=function(){var t=F(this,ot.extend({},e),o);(n||gt.get(this,"finish"))&&t.stop(!0)};return a.finish=a,n||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,i,r){var n=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=i,i=e,e=t),i&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=ot.timers,a=gt.get(this);if(i)a[i]&&a[i].stop&&n(a[i]);else for(i in a)a[i]&&a[i].stop&&Di.test(i)&&n(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(r),t=!1,o.splice(i,1));(t||!r)&&ot.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=gt.get(this),r=i[e+"queue"],n=i[e+"queueHooks"],o=ot.timers,a=r?r.length:0;for(i.finish=!0,ot.queue(this,e,[]),n&&n.stop&&n.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete i.finish})}});ot.each({slideDown:O("show"),slideUp:O("hide"),slideToggle:O("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){ot.fn[e]=function(e,i,r){return this.animate(t,e,i,r)}}),ot.speed=function(e,t,i){var r=e&&"object"==typeof e?ot.extend({},e):{complete:i||!i&&t||ot.isFunction(e)&&e,duration:e,easing:i&&t||t&&!ot.isFunction(t)&&t};return r.duration=ot.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in ot.fx.speeds?ot.fx.speeds[r.duration]:ot.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){ot.isFunction(r.old)&&r.old.call(this),r.queue&&ot.dequeue(this,r.queue)},r},ot.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ot.timers=[],ot.fx=I.prototype.init,ot.fx.tick=function(){var e,i=ot.timers,r=0;for(Mi=ot.now();i.length>r;r++)e=i[r],e()||i[r]!==e||i.splice(r--,1);i.length||ot.fx.stop(),Mi=t},ot.fx.timer=function(e){e()&&ot.timers.push(e)&&ot.fx.start()},ot.fx.interval=13,ot.fx.start=function(){Si||(Si=setInterval(ot.fx.tick,ot.fx.interval))},ot.fx.stop=function(){clearInterval(Si),Si=null},ot.fx.speeds={slow:600,fast:200,_default:400},ot.fx.step={},ot.expr&&ot.expr.filters&&(ot.expr.filters.animated=function(e){return ot.grep(ot.timers,function(t){return e===t.elem}).length}),ot.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){ot.offset.setOffset(this,e,t)});var i,r,n=this[0],o={top:0,left:0},a=n&&n.ownerDocument;if(a)return i=a.documentElement,ot.contains(i,n)?(typeof n.getBoundingClientRect!==j&&(o=n.getBoundingClientRect()),r=U(a),{top:o.top+r.pageYOffset-i.clientTop,left:o.left+r.pageXOffset-i.clientLeft}):o;else return void 0},ot.offset={setOffset:function(e,t,i){var r,n,o,a,s,l,h,c=ot.css(e,"position"),u=ot(e),f={};"static"===c&&(e.style.position="relative"),s=u.offset(),o=ot.css(e,"top"),l=ot.css(e,"left"),h=("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1,h?(r=u.position(),a=r.top,n=r.left):(a=parseFloat(o)||0,n=parseFloat(l)||0),ot.isFunction(t)&&(t=t.call(e,i,s)),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+n),"using"in t?t.using.call(e,f):u.css(f)}},ot.fn.extend({position:function(){if(this[0]){var e,t,i=this[0],r={top:0,left:0};return"fixed"===ot.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),ot.nodeName(e[0],"html")||(r=e.offset()),r.top+=ot.css(e[0],"borderTopWidth",!0),r.left+=ot.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-ot.css(i,"marginTop",!0),left:t.left-r.left-ot.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||X;for(;e&&!ot.nodeName(e,"html")&&"static"===ot.css(e,"position");)e=e.offsetParent;return e||X})}}),ot.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(i,r){var n="pageYOffset"===r;ot.fn[i]=function(o){return ot.access(this,function(i,o,a){var s=U(i);return a===t?s?s[r]:i[o]:(s?s.scrollTo(n?e.pageXOffset:a,n?a:e.pageYOffset):i[o]=a,t)},i,o,arguments.length,null)}});ot.each({Height:"height",Width:"width"},function(e,i){ot.each({padding:"inner"+e,content:i,"":"outer"+e},function(r,n){ot.fn[n]=function(n,o){var a=arguments.length&&(r||"boolean"!=typeof n),s=r||(n===!0||o===!0?"margin":"border");return ot.access(this,function(i,r,n){var o;return ot.isWindow(i)?i.document.documentElement["client"+e]:9===i.nodeType?(o=i.documentElement,Math.max(i.body["scroll"+e],o["scroll"+e],i.body["offset"+e],o["offset"+e],o["client"+e])):n===t?ot.css(i,r,s):ot.style(i,r,n,s)},i,a?n:t,a,null)}})}),ot.fn.size=function(){return this.length},ot.fn.andSelf=ot.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=ot:"function"==typeof define&&define.amd&&define("jquery",[],function(){return ot}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=ot)}(window);!function(e,t){function i(t,i){var n,o,a,s=t.nodeName.toLowerCase();if("area"===s){n=t.parentNode;o=n.name;if(!t.href||!o||"map"!==n.nodeName.toLowerCase())return!1;a=e("img[usemap=#"+o+"]")[0];return!!a&&r(a)}return(/input|select|textarea|button|object/.test(s)?!t.disabled:"a"===s?t.href||i:i)&&r(t)}function r(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var n=0,o=/^ui-id-\d+$/;e.ui=e.ui||{};e.extend(e.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});e.fn.extend({focus:function(t){return function(i,r){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus();if(r)r.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;if(e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position")))t=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0);else t=this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0);return/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(i){if(i!==t)return this.css("zIndex",i);if(this.length){var r,n,o=e(this[0]);for(;o.length&&o[0]!==document;){r=o.css("position");if("absolute"===r||"relative"===r||"fixed"===r){n=parseInt(o.css("zIndex"),10);if(!isNaN(n)&&0!==n)return n}o=o.parent()}}return 0},uniqueId:function(){return this.each(function(){if(!this.id)this.id="ui-id-"+ ++n})},removeUniqueId:function(){return this.each(function(){if(o.test(this.id))e(this).removeAttr("id")})}});e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,r){return!!e.data(t,r[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var r=e.attr(t,"tabindex"),n=isNaN(r);return(n||r>=0)&&i(t,!n)}});if(!e("<a>").outerWidth(1).jquery)e.each(["Width","Height"],function(i,r){function n(t,i,r,n){e.each(o,function(){i-=parseFloat(e.css(t,"padding"+this))||0;if(r)i-=parseFloat(e.css(t,"border"+this+"Width"))||0;if(n)i-=parseFloat(e.css(t,"margin"+this))||0});return i}var o="Width"===r?["Left","Right"]:["Top","Bottom"],a=r.toLowerCase(),s={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(i){if(i===t)return s["inner"+r].call(this);else return this.each(function(){e(this).css(a,n(this,i)+"px")})};e.fn["outer"+r]=function(t,i){if("number"!=typeof t)return s["outer"+r].call(this,t);else return this.each(function(){e(this).css(a,n(this,t,!0,i)+"px")})}});if(!e.fn.addBack)e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))};if(e("<a>").data("a-b","a").removeData("a-b").data("a-b"))e.fn.removeData=function(t){return function(i){if(arguments.length)return t.call(this,e.camelCase(i));else return t.call(this)}}(e.fn.removeData);e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());e.support.selectstart="onselectstart"in document.createElement("div");e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});e.extend(e.ui,{plugin:{add:function(t,i,r){var n,o=e.ui[t].prototype;for(n in r){o.plugins[n]=o.plugins[n]||[];o.plugins[n].push([i,r[n]])}},call:function(e,t,i){var r,n=e.plugins[t];if(n&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(r=0;r<n.length;r++)if(e.options[n[r][0]])n[r][1].apply(e.element,i)}},hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var r=i&&"left"===i?"scrollLeft":"scrollTop",n=!1;if(t[r]>0)return!0;t[r]=1;n=t[r]>0;t[r]=0;return n}})}(jQuery);!function(e,t){var i=0,r=Array.prototype.slice,n=e.cleanData;e.cleanData=function(t){for(var i,r=0;null!=(i=t[r]);r++)try{e(i).triggerHandler("remove")}catch(o){}n(t)};e.widget=function(t,i,r){var n,o,a,s,l={},h=t.split(".")[0];t=t.split(".")[1];n=h+"-"+t;if(!r){r=i;i=e.Widget}e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)};e[h]=e[h]||{};o=e[h][t];a=e[h][t]=function(e,t){if(!this._createWidget)return new a(e,t);if(arguments.length)this._createWidget(e,t)};e.extend(a,o,{version:r.version,_proto:e.extend({},r),_childConstructors:[]});s=new i;s.options=e.widget.extend({},s.options);e.each(r,function(t,r){if(e.isFunction(r))l[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,o=this._superApply;this._super=e;this._superApply=n;t=r.apply(this,arguments);this._super=i;this._superApply=o;return t}}();else l[t]=r});a.prototype=e.widget.extend(s,{widgetEventPrefix:o?s.widgetEventPrefix:t},l,{constructor:a,namespace:h,widgetName:t,widgetFullName:n});if(o){e.each(o._childConstructors,function(t,i){var r=i.prototype;e.widget(r.namespace+"."+r.widgetName,a,i._proto)});delete o._childConstructors}else i._childConstructors.push(a);e.widget.bridge(t,a)};e.widget.extend=function(i){var n,o,a=r.call(arguments,1),s=0,l=a.length;for(;l>s;s++)for(n in a[s]){o=a[s][n];if(a[s].hasOwnProperty(n)&&o!==t)if(e.isPlainObject(o))i[n]=e.isPlainObject(i[n])?e.widget.extend({},i[n],o):e.widget.extend({},o);else i[n]=o}return i};e.widget.bridge=function(i,n){var o=n.prototype.widgetFullName||i;e.fn[i]=function(a){var s="string"==typeof a,l=r.call(arguments,1),h=this;a=!s&&l.length?e.widget.extend.apply(null,[a].concat(l)):a;if(s)this.each(function(){var r,n=e.data(this,o);if(!n)return e.error("cannot call methods on "+i+" prior to initialization; "+"attempted to call method '"+a+"'");if(!e.isFunction(n[a])||"_"===a.charAt(0))return e.error("no such method '"+a+"' for "+i+" widget instance");r=n[a].apply(n,l);if(r!==n&&r!==t){h=r&&r.jquery?h.pushStack(r.get()):r;return!1}});else this.each(function(){var t=e.data(this,o);if(t)t.option(a||{})._init();else e.data(this,o,new n(a,this))});return h}};e.Widget=function(){};e.Widget._childConstructors=[];e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0];this.element=e(r);this.uuid=i++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=e.widget.extend({},this.options,this._getCreateOptions(),t);this.bindings=e();this.hoverable=e();this.focusable=e();if(r!==this){e.data(r,this.widgetFullName,this);this._on(!0,this.element,{remove:function(e){if(e.target===r)this.destroy()}});this.document=e(r.style?r.ownerDocument:r.document||r);this.window=e(this.document[0].defaultView||this.document[0].parentWindow)}this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(i,r){var n,o,a,s=i;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof i){s={};n=i.split(".");i=n.shift();if(n.length){o=s[i]=e.widget.extend({},this.options[i]);for(a=0;a<n.length-1;a++){o[n[a]]=o[n[a]]||{};o=o[n[a]]}i=n.pop();if(r===t)return o[i]===t?null:o[i];o[i]=r}else{if(r===t)return this.options[i]===t?null:this.options[i];s[i]=r}}this._setOptions(s);return this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){this.options[e]=t;if("disabled"===e){this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}return this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,i,r){var n,o=this;if("boolean"!=typeof t){r=i;i=t;t=!1}if(!r){r=i;i=this.element;n=this.widget()}else{i=n=e(i);this.bindings=this.bindings.add(i)}e.each(r,function(r,a){function s(){if(t||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled"))return("string"==typeof a?o[a]:a).apply(o,arguments);else return void 0}if("string"!=typeof a)s.guid=a.guid=a.guid||s.guid||e.guid++;var l=r.match(/^(\w+)\s*(.*)$/),h=l[1]+o.eventNamespace,c=l[2];if(c)n.delegate(c,h,s);else i.bind(h,s)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return("string"==typeof e?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t);this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t);this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,r){var n,o,a=this.options[t];r=r||{};i=e.Event(i);i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase();i.target=this.element[0];o=i.originalEvent;if(o)for(n in o)if(!(n in i))i[n]=o[n];this.element.trigger(i,r);return!(e.isFunction(a)&&a.apply(this.element[0],[i].concat(r))===!1||i.isDefaultPrevented())}};e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(r,n,o){if("string"==typeof n)n={effect:n};var a,s=!n?t:n===!0||"number"==typeof n?i:n.effect||i;n=n||{};if("number"==typeof n)n={duration:n};a=!e.isEmptyObject(n);n.complete=o;if(n.delay)r.delay(n.delay);if(a&&e.effects&&e.effects.effect[s])r[t](n);else if(s!==t&&r[s])r[s](n.duration,n.easing,o);
else r.queue(function(i){e(this)[t]();if(o)o.call(r[0]);i()})}})}(jQuery);!function(e){var t=!1;e(document).mouseup(function(){t=!1});e.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){if(!0===e.data(i.target,t.widgetName+".preventClickEvent")){e.removeData(i.target,t.widgetName+".preventClickEvent");i.stopImmediatePropagation();return!1}});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate)e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!t){this._mouseStarted&&this._mouseUp(i);this._mouseDownEvent=i;var r=this,n=1===i.which,o="string"==typeof this.options.cancel&&i.target.nodeName?e(i.target).closest(this.options.cancel).length:!1;if(!n||o||!this._mouseCapture(i))return!0;this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet)this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay);if(this._mouseDistanceMet(i)&&this._mouseDelayMet(i)){this._mouseStarted=this._mouseStart(i)!==!1;if(!this._mouseStarted){i.preventDefault();return!0}}if(!0===e.data(i.target,this.widgetName+".preventClickEvent"))e.removeData(i.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(e){return r._mouseMove(e)};this._mouseUpDelegate=function(e){return r._mouseUp(e)};e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);i.preventDefault();t=!0;return!0}},_mouseMove:function(t){if(e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(this._mouseStarted){this._mouseDrag(t);return t.preventDefault()}if(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)){this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1;this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)}return!this._mouseStarted},_mouseUp:function(t){e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=!1;if(t.target===this._mouseDownEvent.target)e.data(t.target,this.widgetName+".preventClickEvent",!0);this._mouseStop(t)}return!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery);!function(e){e.widget("ui.draggable",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){if("original"===this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position")))this.element[0].style.position="relative";if(this.options.addClasses)this.element.addClass("ui-draggable");if(this.options.disabled)this.element.addClass("ui-draggable-disabled");this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy()},_mouseCapture:function(t){var i=this.options;if(this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0)return!1;this.handle=this._getHandle(t);if(!this.handle)return!1;e(i.iframeFix===!0?"iframe":i.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")});return!0},_mouseStart:function(t){var i=this.options;this.helper=this._createHelper(t);this.helper.addClass("ui-draggable-dragging");this._cacheHelperProportions();if(e.ui.ddmanager)e.ui.ddmanager.current=this;this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offsetParent=this.helper.offsetParent();this.offsetParentCssPosition=this.offsetParent.css("position");this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.offset.scroll=!1;e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(t);this.originalPageX=t.pageX;this.originalPageY=t.pageY;i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt);this._setContainment();if(this._trigger("start",t)===!1){this._clear();return!1}this._cacheHelperProportions();if(e.ui.ddmanager&&!i.dropBehaviour)e.ui.ddmanager.prepareOffsets(this,t);this._mouseDrag(t,!0);if(e.ui.ddmanager)e.ui.ddmanager.dragStart(this,t);return!0},_mouseDrag:function(t,i){if("fixed"===this.offsetParentCssPosition)this.offset.parent=this._getParentOffset();this.position=this._generatePosition(t);this.positionAbs=this._convertPositionTo("absolute");if(!i){var r=this._uiHash();if(this._trigger("drag",t,r)===!1){this._mouseUp({});return!1}this.position=r.position}if(!this.options.axis||"y"!==this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!==this.options.axis)this.helper[0].style.top=this.position.top+"px";if(e.ui.ddmanager)e.ui.ddmanager.drag(this,t);return!1},_mouseStop:function(t){var i=this,r=!1;if(e.ui.ddmanager&&!this.options.dropBehaviour)r=e.ui.ddmanager.drop(this,t);if(this.dropped){r=this.dropped;this.dropped=!1}if("original"===this.options.helper&&!e.contains(this.element[0].ownerDocument,this.element[0]))return!1;if("invalid"===this.options.revert&&!r||"valid"===this.options.revert&&r||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,r))e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(i._trigger("stop",t)!==!1)i._clear()});else if(this._trigger("stop",t)!==!1)this._clear();return!1},_mouseUp:function(t){e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});if(e.ui.ddmanager)e.ui.ddmanager.dragStop(this,t);return e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){if(this.helper.is(".ui-draggable-dragging"))this._mouseUp({});else this._clear();return this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(t){var i=this.options,r=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;if(!r.parents("body").length)r.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo);if(r[0]!==this.element[0]&&!/(fixed|absolute)/.test(r.css("position")))r.css("position","absolute");return r},_adjustOffsetFromHelper:function(t){if("string"==typeof t)t=t.split(" ");if(e.isArray(t))t={left:+t[0],top:+t[1]||0};if("left"in t)this.offset.click.left=t.left+this.margins.left;if("right"in t)this.offset.click.left=this.helperProportions.width-t.right+this.margins.left;if("top"in t)this.offset.click.top=t.top+this.margins.top;if("bottom"in t)this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top},_getParentOffset:function(){var t=this.offsetParent.offset();if("absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])){t.left+=this.scrollParent.scrollLeft();t.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,r,n=this.options;if(n.containment)if("window"!==n.containment)if("document"!==n.containment)if(n.containment.constructor!==Array){if("parent"===n.containment)n.containment=this.helper[0].parentNode;i=e(n.containment);r=i[0];if(r){t="hidden"!==i.css("overflow");this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=i}}else this.containment=n.containment;else this.containment=[0,0,e(document).width()-this.helperProportions.width-this.margins.left,(e(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];else this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];else this.containment=null},_convertPositionTo:function(t,i){if(!i)i=this.position;var r="absolute"===t?1:-1,n="absolute"===this.cssPosition&&(this.scrollParent[0]===document||!e.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent;if(!this.offset.scroll)this.offset.scroll={top:n.scrollTop(),left:n.scrollLeft()};return{top:i.top+this.offset.relative.top*r+this.offset.parent.top*r-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*r,left:i.left+this.offset.relative.left*r+this.offset.parent.left*r-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*r}},_generatePosition:function(t){var i,r,n,o,a=this.options,s="absolute"===this.cssPosition&&(this.scrollParent[0]===document||!e.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,l=t.pageX,h=t.pageY;if(!this.offset.scroll)this.offset.scroll={top:s.scrollTop(),left:s.scrollLeft()};if(this.originalPosition){if(this.containment){if(this.relative_container){r=this.relative_container.offset();i=[this.containment[0]+r.left,this.containment[1]+r.top,this.containment[2]+r.left,this.containment[3]+r.top]}else i=this.containment;if(t.pageX-this.offset.click.left<i[0])l=i[0]+this.offset.click.left;if(t.pageY-this.offset.click.top<i[1])h=i[1]+this.offset.click.top;if(t.pageX-this.offset.click.left>i[2])l=i[2]+this.offset.click.left;if(t.pageY-this.offset.click.top>i[3])h=i[3]+this.offset.click.top}if(a.grid){n=a.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY;h=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-a.grid[1]:n+a.grid[1]:n;o=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX;l=i?o-this.offset.click.left>=i[0]||o-this.offset.click.left>i[2]?o:o-this.offset.click.left>=i[0]?o-a.grid[0]:o+a.grid[0]:o}}return{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval)this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(t,i,r){r=r||this._uiHash();e.ui.plugin.call(this,t,[i,r]);if("drag"===t)this.positionAbs=this._convertPositionTo("absolute");return e.Widget.prototype._trigger.call(this,t,i,r)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i){var r=e(this).data("ui-draggable"),n=r.options,o=e.extend({},i,{item:r.element});r.sortables=[];e(n.connectToSortable).each(function(){var i=e.data(this,"ui-sortable");if(i&&!i.options.disabled){r.sortables.push({instance:i,shouldRevert:i.options.revert});i.refreshPositions();i._trigger("activate",t,o)}})},stop:function(t,i){var r=e(this).data("ui-draggable"),n=e.extend({},i,{item:r.element});e.each(r.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;r.cancelHelperRemoval=!0;this.instance.cancelHelperRemoval=!1;if(this.shouldRevert)this.instance.options.revert=this.shouldRevert;this.instance._mouseStop(t);this.instance.options.helper=this.instance.options._helper;if("original"===r.options.helper)this.instance.currentItem.css({top:"auto",left:"auto"})}else{this.instance.cancelHelperRemoval=!1;this.instance._trigger("deactivate",t,n)}})},drag:function(t,i){var r=e(this).data("ui-draggable"),n=this;e.each(r.sortables,function(){var o=!1,a=this;this.instance.positionAbs=r.positionAbs;this.instance.helperProportions=r.helperProportions;this.instance.offset.click=r.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){o=!0;e.each(r.sortables,function(){this.instance.positionAbs=r.positionAbs;this.instance.helperProportions=r.helperProportions;this.instance.offset.click=r.offset.click;if(this!==a&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(a.instance.element[0],this.instance.element[0]))o=!1;return o})}if(o){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=e(n).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return i.helper[0]};t.target=this.instance.currentItem[0];this.instance._mouseCapture(t,!0);this.instance._mouseStart(t,!0,!0);this.instance.offset.click.top=r.offset.click.top;this.instance.offset.click.left=r.offset.click.left;this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top;r._trigger("toSortable",t);r.dropped=this.instance.element;r.currentItem=r.element;this.instance.fromOutside=r}if(this.instance.currentItem)this.instance._mouseDrag(t)}else if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=!0;this.instance.options.revert=!1;this.instance._trigger("out",t,this.instance._uiHash(this.instance));this.instance._mouseStop(t,!0);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder)this.instance.placeholder.remove();r._trigger("fromSortable",t);r.dropped=!1}})}});e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),i=e(this).data("ui-draggable").options;if(t.css("cursor"))i._cursor=t.css("cursor");t.css("cursor",i.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;if(t._cursor)e("body").css("cursor",t._cursor)}});e.ui.plugin.add("draggable","opacity",{start:function(t,i){var r=e(i.helper),n=e(this).data("ui-draggable").options;if(r.css("opacity"))n._opacity=r.css("opacity");r.css("opacity",n.opacity)},stop:function(t,i){var r=e(this).data("ui-draggable").options;if(r._opacity)e(i.helper).css("opacity",r._opacity)}});e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");if(t.scrollParent[0]!==document&&"HTML"!==t.scrollParent[0].tagName)t.overflowOffset=t.scrollParent.offset()},drag:function(t){var i=e(this).data("ui-draggable"),r=i.options,n=!1;if(i.scrollParent[0]!==document&&"HTML"!==i.scrollParent[0].tagName){if(!r.axis||"x"!==r.axis)if(i.overflowOffset.top+i.scrollParent[0].offsetHeight-t.pageY<r.scrollSensitivity)i.scrollParent[0].scrollTop=n=i.scrollParent[0].scrollTop+r.scrollSpeed;else if(t.pageY-i.overflowOffset.top<r.scrollSensitivity)i.scrollParent[0].scrollTop=n=i.scrollParent[0].scrollTop-r.scrollSpeed;if(!r.axis||"y"!==r.axis)if(i.overflowOffset.left+i.scrollParent[0].offsetWidth-t.pageX<r.scrollSensitivity)i.scrollParent[0].scrollLeft=n=i.scrollParent[0].scrollLeft+r.scrollSpeed;else if(t.pageX-i.overflowOffset.left<r.scrollSensitivity)i.scrollParent[0].scrollLeft=n=i.scrollParent[0].scrollLeft-r.scrollSpeed}else{if(!r.axis||"x"!==r.axis)if(t.pageY-e(document).scrollTop()<r.scrollSensitivity)n=e(document).scrollTop(e(document).scrollTop()-r.scrollSpeed);else if(e(window).height()-(t.pageY-e(document).scrollTop())<r.scrollSensitivity)n=e(document).scrollTop(e(document).scrollTop()+r.scrollSpeed);if(!r.axis||"y"!==r.axis)if(t.pageX-e(document).scrollLeft()<r.scrollSensitivity)n=e(document).scrollLeft(e(document).scrollLeft()-r.scrollSpeed);else if(e(window).width()-(t.pageX-e(document).scrollLeft())<r.scrollSensitivity)n=e(document).scrollLeft(e(document).scrollLeft()+r.scrollSpeed)}if(n!==!1&&e.ui.ddmanager&&!r.dropBehaviour)e.ui.ddmanager.prepareOffsets(i,t)}});e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),i=t.options;t.snapElements=[];e(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var i=e(this),r=i.offset();if(this!==t.element[0])t.snapElements.push({item:this,width:i.outerWidth(),height:i.outerHeight(),top:r.top,left:r.left})})},drag:function(t,i){var r,n,o,a,s,l,h,c,u,f,d=e(this).data("ui-draggable"),p=d.options,m=p.snapTolerance,g=i.offset.left,v=g+d.helperProportions.width,E=i.offset.top,y=E+d.helperProportions.height;for(u=d.snapElements.length-1;u>=0;u--){s=d.snapElements[u].left;l=s+d.snapElements[u].width;h=d.snapElements[u].top;c=h+d.snapElements[u].height;if(!(s-m>v||g>l+m||h-m>y||E>c+m)&&e.contains(d.snapElements[u].item.ownerDocument,d.snapElements[u].item)){if("inner"!==p.snapMode){r=Math.abs(h-y)<=m;n=Math.abs(c-E)<=m;o=Math.abs(s-v)<=m;a=Math.abs(l-g)<=m;if(r)i.position.top=d._convertPositionTo("relative",{top:h-d.helperProportions.height,left:0}).top-d.margins.top;if(n)i.position.top=d._convertPositionTo("relative",{top:c,left:0}).top-d.margins.top;if(o)i.position.left=d._convertPositionTo("relative",{top:0,left:s-d.helperProportions.width}).left-d.margins.left;if(a)i.position.left=d._convertPositionTo("relative",{top:0,left:l}).left-d.margins.left}f=r||n||o||a;if("outer"!==p.snapMode){r=Math.abs(h-E)<=m;n=Math.abs(c-y)<=m;o=Math.abs(s-g)<=m;a=Math.abs(l-v)<=m;if(r)i.position.top=d._convertPositionTo("relative",{top:h,left:0}).top-d.margins.top;if(n)i.position.top=d._convertPositionTo("relative",{top:c-d.helperProportions.height,left:0}).top-d.margins.top;if(o)i.position.left=d._convertPositionTo("relative",{top:0,left:s}).left-d.margins.left;if(a)i.position.left=d._convertPositionTo("relative",{top:0,left:l-d.helperProportions.width}).left-d.margins.left}if(!d.snapElements[u].snapping&&(r||n||o||a||f))d.options.snap.snap&&d.options.snap.snap.call(d.element,t,e.extend(d._uiHash(),{snapItem:d.snapElements[u].item}));d.snapElements[u].snapping=r||n||o||a||f}else{if(d.snapElements[u].snapping)d.options.snap.release&&d.options.snap.release.call(d.element,t,e.extend(d._uiHash(),{snapItem:d.snapElements[u].item}));d.snapElements[u].snapping=!1}}}});e.ui.plugin.add("draggable","stack",{start:function(){var t,i=this.data("ui-draggable").options,r=e.makeArray(e(i.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});if(r.length){t=parseInt(e(r[0]).css("zIndex"),10)||0;e(r).each(function(i){e(this).css("zIndex",t+i)});this.css("zIndex",t+r.length)}}});e.ui.plugin.add("draggable","zIndex",{start:function(t,i){var r=e(i.helper),n=e(this).data("ui-draggable").options;if(r.css("zIndex"))n._zIndex=r.css("zIndex");r.css("zIndex",n.zIndex)},stop:function(t,i){var r=e(this).data("ui-draggable").options;if(r._zIndex)e(i.helper).css("zIndex",r._zIndex)}})}(jQuery);!function(e){function t(e,t,i){return e>t&&t+i>e}e.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t=this.options,i=t.accept;this.isover=!1;this.isout=!0;this.accept=e.isFunction(i)?i:function(e){return e.is(i)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};e.ui.ddmanager.droppables[t.scope]=e.ui.ddmanager.droppables[t.scope]||[];e.ui.ddmanager.droppables[t.scope].push(this);t.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){var t=0,i=e.ui.ddmanager.droppables[this.options.scope];for(;t<i.length;t++)if(i[t]===this)i.splice(t,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,i){if("accept"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var i=e.ui.ddmanager.current;if(this.options.activeClass)this.element.addClass(this.options.activeClass);if(i)this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;if(this.options.activeClass)this.element.removeClass(this.options.activeClass);if(i)this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;if(i&&(i.currentItem||i.element)[0]!==this.element[0])if(this.accept.call(this.element[0],i.currentItem||i.element)){if(this.options.hoverClass)this.element.addClass(this.options.hoverClass);this._trigger("over",t,this.ui(i))}},_out:function(t){var i=e.ui.ddmanager.current;if(i&&(i.currentItem||i.element)[0]!==this.element[0])if(this.accept.call(this.element[0],i.currentItem||i.element)){if(this.options.hoverClass)this.element.removeClass(this.options.hoverClass);this._trigger("out",t,this.ui(i))}},_drop:function(t,i){var r=i||e.ui.ddmanager.current,n=!1;if(!r||(r.currentItem||r.element)[0]===this.element[0])return!1;this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=e.data(this,"ui-droppable");if(t.options.greedy&&!t.options.disabled&&t.options.scope===r.options.scope&&t.accept.call(t.element[0],r.currentItem||r.element)&&e.ui.intersect(r,e.extend(t,{offset:t.element.offset()}),t.options.tolerance)){n=!0;return!1}});if(n)return!1;if(this.accept.call(this.element[0],r.currentItem||r.element)){if(this.options.activeClass)this.element.removeClass(this.options.activeClass);if(this.options.hoverClass)this.element.removeClass(this.options.hoverClass);this._trigger("drop",t,this.ui(r));return this.element}return!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}});e.ui.intersect=function(e,i,r){if(!i.offset)return!1;var n,o,a=(e.positionAbs||e.position.absolute).left,s=a+e.helperProportions.width,l=(e.positionAbs||e.position.absolute).top,h=l+e.helperProportions.height,c=i.offset.left,u=c+i.proportions.width,f=i.offset.top,d=f+i.proportions.height;switch(r){case"fit":return a>=c&&u>=s&&l>=f&&d>=h;case"intersect":return c<a+e.helperProportions.width/2&&s-e.helperProportions.width/2<u&&f<l+e.helperProportions.height/2&&h-e.helperProportions.height/2<d;case"pointer":n=(e.positionAbs||e.position.absolute).left+(e.clickOffset||e.offset.click).left;o=(e.positionAbs||e.position.absolute).top+(e.clickOffset||e.offset.click).top;return t(o,f,i.proportions.height)&&t(n,c,i.proportions.width);case"touch":return(l>=f&&d>=l||h>=f&&d>=h||f>l&&h>d)&&(a>=c&&u>=a||s>=c&&u>=s||c>a&&s>u);default:return!1}};e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,i){var r,n,o=e.ui.ddmanager.droppables[t.options.scope]||[],a=i?i.type:null,s=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(r=0;r<o.length;r++)if(!(o[r].options.disabled||t&&!o[r].accept.call(o[r].element[0],t.currentItem||t.element))){for(n=0;n<s.length;n++)if(s[n]===o[r].element[0]){o[r].proportions.height=0;continue e}o[r].visible="none"!==o[r].element.css("display");if(o[r].visible){if("mousedown"===a)o[r]._activate.call(o[r],i);o[r].offset=o[r].element.offset();o[r].proportions={width:o[r].element[0].offsetWidth,height:o[r].element[0].offsetHeight}}else;}else;},drop:function(t,i){var r=!1;e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){if(this.options){if(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance))r=this._drop.call(this,i)||r;if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)){this.isout=!0;this.isover=!1;this._deactivate.call(this,i)}}});return r},dragStart:function(t,i){t.element.parentsUntil("body").bind("scroll.droppable",function(){if(!t.options.refreshPositions)e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){if(t.options.refreshPositions)e.ui.ddmanager.prepareOffsets(t,i);e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var r,n,o,a=e.ui.intersect(t,this,this.options.tolerance),s=!a&&this.isover?"isout":a&&!this.isover?"isover":null;if(s){if(this.options.greedy){n=this.options.scope;o=this.element.parents(":data(ui-droppable)").filter(function(){return e.data(this,"ui-droppable").options.scope===n});if(o.length){r=e.data(o[0],"ui-droppable");r.greedyChild="isover"===s}}if(r&&"isover"===s){r.isover=!1;r.isout=!0;r._out.call(r,i)}this[s]=!0;this["isout"===s?"isover":"isout"]=!1;this["isover"===s?"_over":"_out"].call(this,i);if(r&&"isout"===s){r.isout=!1;r.isover=!0;r._over.call(r,i)}}}})},dragStop:function(t,i){t.element.parentsUntil("body").unbind("scroll.droppable");if(!t.options.refreshPositions)e.ui.ddmanager.prepareOffsets(t,i)}}}(jQuery);!function(e){function t(e){return parseInt(e,10)||0}function i(e){return!isNaN(parseInt(e,10))}e.widget("ui.resizable",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var t,i,r,n,o,a=this,s=this.options;this.element.addClass("ui-resizable");e.extend(this,{_aspectRatio:!!s.aspectRatio,aspectRatio:s.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:s.helper||s.ghost||s.animate?s.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable"));this.elementIsWrapper=!0;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=s.handles||(!e(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor===String){if("all"===this.handles)this.handles="n,e,s,w,se,sw,ne,nw";t=this.handles.split(",");this.handles={};for(i=0;i<t.length;i++){r=e.trim(t[i]);o="ui-resizable-"+r;n=e("<div class='ui-resizable-handle "+o+"'></div>");n.css({zIndex:s.zIndex});if("se"===r)n.addClass("ui-icon ui-icon-gripsmall-diagonal-se");this.handles[r]=".ui-resizable-"+r;this.element.append(n)}}this._renderAxis=function(t){var i,r,n,o;t=t||this.element;for(i in this.handles){if(this.handles[i].constructor===String)this.handles[i]=e(this.handles[i],this.element).show();if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){r=e(this.handles[i],this.element);o=/sw|ne|nw|se|n|s/.test(i)?r.outerHeight():r.outerWidth();n=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join("");t.css(n,o);this._proportionallyResize()}if(e(this.handles[i]).length);else;}};this._renderAxis(this.element);this._handles=e(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!a.resizing){if(this.className)n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);a.axis=n&&n[1]?n[1]:"se"}});if(s.autoHide){this._handles.hide();e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){if(!s.disabled){e(this).removeClass("ui-resizable-autohide");a._handles.show()}}).mouseleave(function(){if(!s.disabled)if(!a.resizing){e(this).addClass("ui-resizable-autohide");a._handles.hide()}})}this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,i=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){i(this.element);t=this.element;this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t);t.remove()}this.originalElement.css("resize",this.originalResizeStyle);i(this.originalElement);return this},_mouseCapture:function(t){var i,r,n=!1;for(i in this.handles){r=e(this.handles[i])[0];if(r===t.target||e.contains(r,t.target))n=!0}return!this.options.disabled&&n},_mouseStart:function(i){var r,n,o,a=this.options,s=this.element.position(),l=this.element;this.resizing=!0;if(/absolute/.test(l.css("position")))l.css({position:"absolute",top:l.css("top"),left:l.css("left")});else if(l.is(".ui-draggable"))l.css({position:"absolute",top:s.top,left:s.left});this._renderProxy();r=t(this.helper.css("left"));n=t(this.helper.css("top"));if(a.containment){r+=e(a.containment).scrollLeft()||0;n+=e(a.containment).scrollTop()||0
}this.offset=this.helper.offset();this.position={left:r,top:n};this.size=this._helper?{width:l.outerWidth(),height:l.outerHeight()}:{width:l.width(),height:l.height()};this.originalSize=this._helper?{width:l.outerWidth(),height:l.outerHeight()}:{width:l.width(),height:l.height()};this.originalPosition={left:r,top:n};this.sizeDiff={width:l.outerWidth()-l.width(),height:l.outerHeight()-l.height()};this.originalMousePosition={left:i.pageX,top:i.pageY};this.aspectRatio="number"==typeof a.aspectRatio?a.aspectRatio:this.originalSize.width/this.originalSize.height||1;o=e(".ui-resizable-"+this.axis).css("cursor");e("body").css("cursor","auto"===o?this.axis+"-resize":o);l.addClass("ui-resizable-resizing");this._propagate("start",i);return!0},_mouseDrag:function(t){var i,r=this.helper,n={},o=this.originalMousePosition,a=this.axis,s=this.position.top,l=this.position.left,h=this.size.width,c=this.size.height,u=t.pageX-o.left||0,f=t.pageY-o.top||0,d=this._change[a];if(!d)return!1;i=d.apply(this,[t,u,f]);this._updateVirtualBoundaries(t.shiftKey);if(this._aspectRatio||t.shiftKey)i=this._updateRatio(i,t);i=this._respectSize(i,t);this._updateCache(i);this._propagate("resize",t);if(this.position.top!==s)n.top=this.position.top+"px";if(this.position.left!==l)n.left=this.position.left+"px";if(this.size.width!==h)n.width=this.size.width+"px";if(this.size.height!==c)n.height=this.size.height+"px";r.css(n);if(!this._helper&&this._proportionallyResizeElements.length)this._proportionallyResize();if(!e.isEmptyObject(n))this._trigger("resize",t,this.ui());return!1},_mouseStop:function(t){this.resizing=!1;var i,r,n,o,a,s,l,h=this.options,c=this;if(this._helper){i=this._proportionallyResizeElements;r=i.length&&/textarea/i.test(i[0].nodeName);n=r&&e.ui.hasScroll(i[0],"left")?0:c.sizeDiff.height;o=r?0:c.sizeDiff.width;a={width:c.helper.width()-o,height:c.helper.height()-n};s=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null;l=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;if(!h.animate)this.element.css(e.extend(a,{top:l,left:s}));c.helper.height(c.size.height);c.helper.width(c.size.width);if(this._helper&&!h.animate)this._proportionallyResize()}e("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",t);if(this._helper)this.helper.remove();return!1},_updateVirtualBoundaries:function(e){var t,r,n,o,a,s=this.options;a={minWidth:i(s.minWidth)?s.minWidth:0,maxWidth:i(s.maxWidth)?s.maxWidth:1/0,minHeight:i(s.minHeight)?s.minHeight:0,maxHeight:i(s.maxHeight)?s.maxHeight:1/0};if(this._aspectRatio||e){t=a.minHeight*this.aspectRatio;n=a.minWidth/this.aspectRatio;r=a.maxHeight*this.aspectRatio;o=a.maxWidth/this.aspectRatio;if(t>a.minWidth)a.minWidth=t;if(n>a.minHeight)a.minHeight=n;if(r<a.maxWidth)a.maxWidth=r;if(o<a.maxHeight)a.maxHeight=o}this._vBoundaries=a},_updateCache:function(e){this.offset=this.helper.offset();if(i(e.left))this.position.left=e.left;if(i(e.top))this.position.top=e.top;if(i(e.height))this.size.height=e.height;if(i(e.width))this.size.width=e.width},_updateRatio:function(e){var t=this.position,r=this.size,n=this.axis;if(i(e.height))e.width=e.height*this.aspectRatio;else if(i(e.width))e.height=e.width/this.aspectRatio;if("sw"===n){e.left=t.left+(r.width-e.width);e.top=null}if("nw"===n){e.top=t.top+(r.height-e.height);e.left=t.left+(r.width-e.width)}return e},_respectSize:function(e){var t=this._vBoundaries,r=this.axis,n=i(e.width)&&t.maxWidth&&t.maxWidth<e.width,o=i(e.height)&&t.maxHeight&&t.maxHeight<e.height,a=i(e.width)&&t.minWidth&&t.minWidth>e.width,s=i(e.height)&&t.minHeight&&t.minHeight>e.height,l=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,c=/sw|nw|w/.test(r),u=/nw|ne|n/.test(r);if(a)e.width=t.minWidth;if(s)e.height=t.minHeight;if(n)e.width=t.maxWidth;if(o)e.height=t.maxHeight;if(a&&c)e.left=l-t.minWidth;if(n&&c)e.left=l-t.maxWidth;if(s&&u)e.top=h-t.minHeight;if(o&&u)e.top=h-t.maxHeight;if(!e.width&&!e.height&&!e.left&&e.top)e.top=null;else if(!e.width&&!e.height&&!e.top&&e.left)e.left=null;return e},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var e,t,i,r,n,o=this.helper||this.element;for(e=0;e<this._proportionallyResizeElements.length;e++){n=this._proportionallyResizeElements[e];if(!this.borderDif){this.borderDif=[];i=[n.css("borderTopWidth"),n.css("borderRightWidth"),n.css("borderBottomWidth"),n.css("borderLeftWidth")];r=[n.css("paddingTop"),n.css("paddingRight"),n.css("paddingBottom"),n.css("paddingLeft")];for(t=0;t<i.length;t++)this.borderDif[t]=(parseInt(i[t],10)||0)+(parseInt(r[t],10)||0)}n.css({height:o.height()-this.borderDif[0]-this.borderDif[2]||0,width:o.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset();if(this._helper){this.helper=this.helper||e("<div style='overflow:hidden;'></div>");this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex});this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,r=this.originalPosition;return{left:r.left+t,width:i.width-t}},n:function(e,t,i){var r=this.originalSize,n=this.originalPosition;return{top:n.top+i,height:r.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,r){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,r]))},sw:function(t,i,r){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,r]))},ne:function(t,i,r){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,r]))},nw:function(t,i,r){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,r]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]);"resize"!==t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).data("ui-resizable"),r=i.options,n=i._proportionallyResizeElements,o=n.length&&/textarea/i.test(n[0].nodeName),a=o&&e.ui.hasScroll(n[0],"left")?0:i.sizeDiff.height,s=o?0:i.sizeDiff.width,l={width:i.size.width-s,height:i.size.height-a},h=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,c=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(l,c&&h?{top:c,left:h}:{}),{duration:r.animateDuration,easing:r.animateEasing,step:function(){var r={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};if(n&&n.length)e(n[0]).css({width:r.width,height:r.height});i._updateCache(r);i._propagate("resize",t)}})}});e.ui.plugin.add("resizable","containment",{start:function(){var i,r,n,o,a,s,l,h=e(this).data("ui-resizable"),c=h.options,u=h.element,f=c.containment,d=f instanceof e?f.get(0):/parent/.test(f)?u.parent().get(0):f;if(d){h.containerElement=e(d);if(/document/.test(f)||f===document){h.containerOffset={left:0,top:0};h.containerPosition={left:0,top:0};h.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}}else{i=e(d);r=[];e(["Top","Right","Left","Bottom"]).each(function(e,n){r[e]=t(i.css("padding"+n))});h.containerOffset=i.offset();h.containerPosition=i.position();h.containerSize={height:i.innerHeight()-r[3],width:i.innerWidth()-r[1]};n=h.containerOffset;o=h.containerSize.height;a=h.containerSize.width;s=e.ui.hasScroll(d,"left")?d.scrollWidth:a;l=e.ui.hasScroll(d)?d.scrollHeight:o;h.parentData={element:d,left:n.left,top:n.top,width:s,height:l}}}},resize:function(t){var i,r,n,o,a=e(this).data("ui-resizable"),s=a.options,l=a.containerOffset,h=a.position,c=a._aspectRatio||t.shiftKey,u={top:0,left:0},f=a.containerElement;if(f[0]!==document&&/static/.test(f.css("position")))u=l;if(h.left<(a._helper?l.left:0)){a.size.width=a.size.width+(a._helper?a.position.left-l.left:a.position.left-u.left);if(c)a.size.height=a.size.width/a.aspectRatio;a.position.left=s.helper?l.left:0}if(h.top<(a._helper?l.top:0)){a.size.height=a.size.height+(a._helper?a.position.top-l.top:a.position.top);if(c)a.size.width=a.size.height*a.aspectRatio;a.position.top=a._helper?l.top:0}a.offset.left=a.parentData.left+a.position.left;a.offset.top=a.parentData.top+a.position.top;i=Math.abs((a._helper?a.offset.left-u.left:a.offset.left-u.left)+a.sizeDiff.width);r=Math.abs((a._helper?a.offset.top-u.top:a.offset.top-l.top)+a.sizeDiff.height);n=a.containerElement.get(0)===a.element.parent().get(0);o=/relative|absolute/.test(a.containerElement.css("position"));if(n&&o)i-=a.parentData.left;if(i+a.size.width>=a.parentData.width){a.size.width=a.parentData.width-i;if(c)a.size.height=a.size.width/a.aspectRatio}if(r+a.size.height>=a.parentData.height){a.size.height=a.parentData.height-r;if(c)a.size.width=a.size.height*a.aspectRatio}},stop:function(){var t=e(this).data("ui-resizable"),i=t.options,r=t.containerOffset,n=t.containerPosition,o=t.containerElement,a=e(t.helper),s=a.offset(),l=a.outerWidth()-t.sizeDiff.width,h=a.outerHeight()-t.sizeDiff.height;if(t._helper&&!i.animate&&/relative/.test(o.css("position")))e(this).css({left:s.left-n.left-r.left,width:l,height:h});if(t._helper&&!i.animate&&/static/.test(o.css("position")))e(this).css({left:s.left-n.left-r.left,width:l,height:h})}});e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).data("ui-resizable"),i=t.options,r=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};if("object"==typeof i.alsoResize&&!i.alsoResize.parentNode)if(i.alsoResize.length){i.alsoResize=i.alsoResize[0];r(i.alsoResize)}else e.each(i.alsoResize,function(e){r(e)});else r(i.alsoResize)},resize:function(t,i){var r=e(this).data("ui-resizable"),n=r.options,o=r.originalSize,a=r.originalPosition,s={height:r.size.height-o.height||0,width:r.size.width-o.width||0,top:r.position.top-a.top||0,left:r.position.left-a.left||0},l=function(t,r){e(t).each(function(){var t=e(this),n=e(this).data("ui-resizable-alsoresize"),o={},a=r&&r.length?r:t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(a,function(e,t){var i=(n[t]||0)+(s[t]||0);if(i&&i>=0)o[t]=i||null});t.css(o)})};if("object"==typeof n.alsoResize&&!n.alsoResize.nodeType)e.each(n.alsoResize,function(e,t){l(e,t)});else l(n.alsoResize)},stop:function(){e(this).removeData("resizable-alsoresize")}});e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).data("ui-resizable"),i=t.options,r=t.size;t.ghost=t.originalElement.clone();t.ghost.css({opacity:.25,display:"block",position:"relative",height:r.height,width:r.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:"");t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).data("ui-resizable");if(t.ghost)t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).data("ui-resizable");if(t.ghost&&t.helper)t.helper.get(0).removeChild(t.ghost.get(0))}});e.ui.plugin.add("resizable","grid",{resize:function(){var t=e(this).data("ui-resizable"),i=t.options,r=t.size,n=t.originalSize,o=t.originalPosition,a=t.axis,s="number"==typeof i.grid?[i.grid,i.grid]:i.grid,l=s[0]||1,h=s[1]||1,c=Math.round((r.width-n.width)/l)*l,u=Math.round((r.height-n.height)/h)*h,f=n.width+c,d=n.height+u,p=i.maxWidth&&i.maxWidth<f,m=i.maxHeight&&i.maxHeight<d,g=i.minWidth&&i.minWidth>f,v=i.minHeight&&i.minHeight>d;i.grid=s;if(g)f+=l;if(v)d+=h;if(p)f-=l;if(m)d-=h;if(/^(se|s|e)$/.test(a)){t.size.width=f;t.size.height=d}else if(/^(ne)$/.test(a)){t.size.width=f;t.size.height=d;t.position.top=o.top-u}else if(/^(sw)$/.test(a)){t.size.width=f;t.size.height=d;t.position.left=o.left-c}else{t.size.width=f;t.size.height=d;t.position.top=o.top-u;t.position.left=o.left-c}}})}(jQuery);!function(e){e.widget("ui.selectable",e.ui.mouse,{version:"1.10.3",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,i=this;this.element.addClass("ui-selectable");this.dragged=!1;this.refresh=function(){t=e(i.options.filter,i.element[0]);t.addClass("ui-selectee");t.each(function(){var t=e(this),i=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:i.left,top:i.top,right:i.left+t.outerWidth(),bottom:i.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})};this.refresh();this.selectees=t.addClass("ui-selectee");this._mouseInit();this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled");this._mouseDestroy()},_mouseStart:function(t){var i=this,r=this.options;this.opos=[t.pageX,t.pageY];if(!this.options.disabled){this.selectees=e(r.filter,this.element[0]);this._trigger("start",t);e(r.appendTo).append(this.helper);this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0});if(r.autoRefresh)this.refresh();this.selectees.filter(".ui-selected").each(function(){var r=e.data(this,"selectable-item");r.startselected=!0;if(!t.metaKey&&!t.ctrlKey){r.$element.removeClass("ui-selected");r.selected=!1;r.$element.addClass("ui-unselecting");r.unselecting=!0;i._trigger("unselecting",t,{unselecting:r.element})}});e(t.target).parents().addBack().each(function(){var r,n=e.data(this,"selectable-item");if(n){r=!t.metaKey&&!t.ctrlKey||!n.$element.hasClass("ui-selected");n.$element.removeClass(r?"ui-unselecting":"ui-selected").addClass(r?"ui-selecting":"ui-unselecting");n.unselecting=!r;n.selecting=r;n.selected=r;if(r)i._trigger("selecting",t,{selecting:n.element});else i._trigger("unselecting",t,{unselecting:n.element});return!1}})}},_mouseDrag:function(t){this.dragged=!0;if(!this.options.disabled){var i,r=this,n=this.options,o=this.opos[0],a=this.opos[1],s=t.pageX,l=t.pageY;if(o>s){i=s;s=o;o=i}if(a>l){i=l;l=a;a=i}this.helper.css({left:o,top:a,width:s-o,height:l-a});this.selectees.each(function(){var i=e.data(this,"selectable-item"),h=!1;if(i&&i.element!==r.element[0]){if("touch"===n.tolerance)h=!(i.left>s||i.right<o||i.top>l||i.bottom<a);else if("fit"===n.tolerance)h=i.left>o&&i.right<s&&i.top>a&&i.bottom<l;if(h){if(i.selected){i.$element.removeClass("ui-selected");i.selected=!1}if(i.unselecting){i.$element.removeClass("ui-unselecting");i.unselecting=!1}if(!i.selecting){i.$element.addClass("ui-selecting");i.selecting=!0;r._trigger("selecting",t,{selecting:i.element})}}else{if(i.selecting)if((t.metaKey||t.ctrlKey)&&i.startselected){i.$element.removeClass("ui-selecting");i.selecting=!1;i.$element.addClass("ui-selected");i.selected=!0}else{i.$element.removeClass("ui-selecting");i.selecting=!1;if(i.startselected){i.$element.addClass("ui-unselecting");i.unselecting=!0}r._trigger("unselecting",t,{unselecting:i.element})}if(i.selected)if(!t.metaKey&&!t.ctrlKey&&!i.startselected){i.$element.removeClass("ui-selected");i.selected=!1;i.$element.addClass("ui-unselecting");i.unselecting=!0;r._trigger("unselecting",t,{unselecting:i.element})}}}});return!1}},_mouseStop:function(t){var i=this;this.dragged=!1;e(".ui-unselecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-unselecting");r.unselecting=!1;r.startselected=!1;i._trigger("unselected",t,{unselected:r.element})});e(".ui-selecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-selecting").addClass("ui-selected");r.selecting=!1;r.selected=!0;r.startselected=!0;i._trigger("selected",t,{selected:r.element})});this._trigger("stop",t);this.helper.remove();return!1}})}(jQuery);!function(e){function t(e,t,i){return e>t&&t+i>e}function i(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))}e.widget("ui.sortable",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var e=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?"x"===e.axis||i(this.items[0].item):!1;this.offset=this.element.offset();this._mouseInit();this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,i){if("disabled"===t){this.options[t]=i;this.widget().toggleClass("ui-sortable-disabled",!!i)}else e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,i){var r=null,n=!1,o=this;if(this.reverting)return!1;if(this.options.disabled||"static"===this.options.type)return!1;this._refreshItems(t);e(t.target).parents().each(function(){if(e.data(this,o.widgetName+"-item")===o){r=e(this);return!1}});if(e.data(t.target,o.widgetName+"-item")===o)r=e(t.target);if(!r)return!1;if(this.options.handle&&!i){e(this.options.handle,r).find("*").addBack().each(function(){if(this===t.target)n=!0});if(!n)return!1}this.currentItem=r;this._removeCurrentsFromItems();return!0},_mouseStart:function(t,i,r){var n,o,a=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(t);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(t);this.originalPageX=t.pageX;this.originalPageY=t.pageY;a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!==this.currentItem[0])this.currentItem.hide();this._createPlaceholder();if(a.containment)this._setContainment();if(a.cursor&&"auto"!==a.cursor){o=this.document.find("body");this.storedCursor=o.css("cursor");o.css("cursor",a.cursor);this.storedStylesheet=e("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(o)}if(a.opacity){if(this.helper.css("opacity"))this._storedOpacity=this.helper.css("opacity");this.helper.css("opacity",a.opacity)}if(a.zIndex){if(this.helper.css("zIndex"))this._storedZIndex=this.helper.css("zIndex");this.helper.css("zIndex",a.zIndex)}if(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName)this.overflowOffset=this.scrollParent.offset();this._trigger("start",t,this._uiHash());if(!this._preserveHelperProportions)this._cacheHelperProportions();if(!r)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",t,this._uiHash(this));if(e.ui.ddmanager)e.ui.ddmanager.current=this;if(e.ui.ddmanager&&!a.dropBehaviour)e.ui.ddmanager.prepareOffsets(this,t);this.dragging=!0;this.helper.addClass("ui-sortable-helper");this._mouseDrag(t);return!0},_mouseDrag:function(t){var i,r,n,o,a=this.options,s=!1;this.position=this._generatePosition(t);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs)this.lastPositionAbs=this.positionAbs;if(this.options.scroll){if(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName){if(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<a.scrollSensitivity)this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop+a.scrollSpeed;else if(t.pageY-this.overflowOffset.top<a.scrollSensitivity)this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop-a.scrollSpeed;if(this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<a.scrollSensitivity)this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft+a.scrollSpeed;else if(t.pageX-this.overflowOffset.left<a.scrollSensitivity)this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft-a.scrollSpeed}else{if(t.pageY-e(document).scrollTop()<a.scrollSensitivity)s=e(document).scrollTop(e(document).scrollTop()-a.scrollSpeed);else if(e(window).height()-(t.pageY-e(document).scrollTop())<a.scrollSensitivity)s=e(document).scrollTop(e(document).scrollTop()+a.scrollSpeed);if(t.pageX-e(document).scrollLeft()<a.scrollSensitivity)s=e(document).scrollLeft(e(document).scrollLeft()-a.scrollSpeed);else if(e(window).width()-(t.pageX-e(document).scrollLeft())<a.scrollSensitivity)s=e(document).scrollLeft(e(document).scrollLeft()+a.scrollSpeed)}if(s!==!1&&e.ui.ddmanager&&!a.dropBehaviour)e.ui.ddmanager.prepareOffsets(this,t)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||"y"!==this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!==this.options.axis)this.helper[0].style.top=this.position.top+"px";for(i=this.items.length-1;i>=0;i--){r=this.items[i];n=r.item[0];o=this._intersectsWithPointer(r);if(o)if(r.instance===this.currentContainer){if(n!==this.currentItem[0]&&this.placeholder[1===o?"next":"prev"]()[0]!==n&&!e.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],n):!0)){this.direction=1===o?"down":"up";if("pointer"===this.options.tolerance||this._intersectsWithSides(r))this._rearrange(t,r);else break;this._trigger("change",t,this._uiHash());break}}else;else;}this._contactContainers(t);if(e.ui.ddmanager)e.ui.ddmanager.drag(this,t);this._trigger("sort",t,this._uiHash());this.lastPositionAbs=this.positionAbs;return!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour)e.ui.ddmanager.drop(this,t);if(this.options.revert){var r=this,n=this.placeholder.offset(),o=this.options.axis,a={};if(!o||"x"===o)a.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft);if(!o||"y"===o)a.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop);this.reverting=!0;e(this.helper).animate(a,parseInt(this.options.revert,10)||500,function(){r._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});if("original"===this.options.helper)this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");else this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--){this.containers[t]._trigger("deactivate",null,this._uiHash(this));if(this.containers[t].containerCache.over){this.containers[t]._trigger("out",null,this._uiHash(this));this.containers[t].containerCache.over=0}}}if(this.placeholder){if(this.placeholder[0].parentNode)this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if("original"!==this.options.helper&&this.helper&&this.helper[0].parentNode)this.helper.remove();e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null});if(this.domPosition.prev)e(this.domPosition.prev).after(this.currentItem);else e(this.domPosition.parent).prepend(this.currentItem)}return this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),r=[];t=t||{};e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);if(i)r.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))});if(!r.length&&t.key)r.push(t.key+"=");return r.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),r=[];t=t||{};i.each(function(){r.push(e(t.item||this).attr(t.attribute||"id")||"")});return r},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,r=this.positionAbs.top,n=r+this.helperProportions.height,o=e.left,a=o+e.width,s=e.top,l=s+e.height,h=this.offset.click.top,c=this.offset.click.left,u="x"===this.options.axis||r+h>s&&l>r+h,f="y"===this.options.axis||t+c>o&&a>t+c,d=u&&f;if("pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"])return d;else return o<t+this.helperProportions.width/2&&i-this.helperProportions.width/2<a&&s<r+this.helperProportions.height/2&&n-this.helperProportions.height/2<l},_intersectsWithPointer:function(e){var i="x"===this.options.axis||t(this.positionAbs.top+this.offset.click.top,e.top,e.height),r="y"===this.options.axis||t(this.positionAbs.left+this.offset.click.left,e.left,e.width),n=i&&r,o=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();if(!n)return!1;else return this.floating?a&&"right"===a||"down"===o?2:1:o&&("down"===o?2:1)},_intersectsWithSides:function(e){var i=t(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),r=t(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),n=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();if(this.floating&&o)return"right"===o&&r||"left"===o&&!r;else return n&&("down"===n&&i||"up"===n&&!i)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){this._refreshItems(e);this.refreshPositions();return this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var i,r,n,o,a=[],s=[],l=this._connectWith();if(l&&t)for(i=l.length-1;i>=0;i--){n=e(l[i]);for(r=n.length-1;r>=0;r--){o=e.data(n[r],this.widgetFullName);if(o&&o!==this&&!o.options.disabled)s.push([e.isFunction(o.options.items)?o.options.items.call(o.element):e(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o])}}s.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(i=s.length-1;i>=0;i--)s[i][0].each(function(){a.push(this)});return e(a)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var i=0;i<t.length;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[];this.containers=[this];var i,r,n,o,a,s,l,h,c=this.items,u=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],f=this._connectWith();if(f&&this.ready)for(i=f.length-1;i>=0;i--){n=e(f[i]);for(r=n.length-1;r>=0;r--){o=e.data(n[r],this.widgetFullName);if(o&&o!==this&&!o.options.disabled){u.push([e.isFunction(o.options.items)?o.options.items.call(o.element[0],t,{item:this.currentItem}):e(o.options.items,o.element),o]);this.containers.push(o)}}}for(i=u.length-1;i>=0;i--){a=u[i][1];s=u[i][0];for(r=0,h=s.length;h>r;r++){l=e(s[r]);l.data(this.widgetName+"-item",a);c.push({item:l,instance:a,width:0,height:0,left:0,top:0})}}},refreshPositions:function(t){if(this.offsetParent&&this.helper)this.offset.parent=this._getParentOffset();var i,r,n,o;for(i=this.items.length-1;i>=0;i--){r=this.items[i];if(r.instance===this.currentContainer||!this.currentContainer||r.item[0]===this.currentItem[0]){n=this.options.toleranceElement?e(this.options.toleranceElement,r.item):r.item;if(!t){r.width=n.outerWidth();r.height=n.outerHeight()}o=n.offset();r.left=o.left;r.top=o.top}else;}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--){o=this.containers[i].element.offset();this.containers[i].containerCache.left=o.left;this.containers[i].containerCache.top=o.top;this.containers[i].containerCache.width=this.containers[i].element.outerWidth();this.containers[i].containerCache.height=this.containers[i].element.outerHeight()}return this},_createPlaceholder:function(t){t=t||this;var i,r=t.options;if(!r.placeholder||r.placeholder.constructor===String){i=r.placeholder;r.placeholder={element:function(){var r=t.currentItem[0].nodeName.toLowerCase(),n=e("<"+r+">",t.document[0]).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");if("tr"===r)t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(n)});else if("img"===r)n.attr("src",t.currentItem.attr("src"));if(!i)n.css("visibility","hidden");return n},update:function(e,n){if(!i||r.forcePlaceholderSize){if(!n.height())n.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10));if(!n.width())n.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10))}}}}t.placeholder=e(r.placeholder.element.call(t.element,t.currentItem));t.currentItem.after(t.placeholder);r.placeholder.update(t,t.placeholder)},_contactContainers:function(r){var n,o,a,s,l,h,c,u,f,d,p=null,m=null;for(n=this.containers.length-1;n>=0;n--)if(!e.contains(this.currentItem[0],this.containers[n].element[0])){if(this._intersectsWith(this.containers[n].containerCache)){if(p&&e.contains(this.containers[n].element[0],p.element[0]))continue;p=this.containers[n];m=n}else if(this.containers[n].containerCache.over){this.containers[n]._trigger("out",r,this._uiHash(this));this.containers[n].containerCache.over=0}}else;if(p)if(1===this.containers.length){if(!this.containers[m].containerCache.over){this.containers[m]._trigger("over",r,this._uiHash(this));this.containers[m].containerCache.over=1}}else{a=1e4;s=null;d=p.floating||i(this.currentItem);l=d?"left":"top";h=d?"width":"height";c=this.positionAbs[l]+this.offset.click[l];for(o=this.items.length-1;o>=0;o--)if(e.contains(this.containers[m].element[0],this.items[o].item[0]))if(this.items[o].item[0]!==this.currentItem[0])if(!d||t(this.positionAbs.top+this.offset.click.top,this.items[o].top,this.items[o].height)){u=this.items[o].item.offset()[l];f=!1;if(Math.abs(u-c)>Math.abs(u+this.items[o][h]-c)){f=!0;u+=this.items[o][h]}if(Math.abs(u-c)<a){a=Math.abs(u-c);s=this.items[o];this.direction=f?"up":"down"}}else;else;else;if(!s&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[m])return;s?this._rearrange(r,s,null,!0):this._rearrange(r,null,this.containers[m].element,!0);this._trigger("change",r,this._uiHash());this.containers[m]._trigger("change",r,this._uiHash(this));this.currentContainer=this.containers[m];this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[m]._trigger("over",r,this._uiHash(this));
this.containers[m].containerCache.over=1}},_createHelper:function(t){var i=this.options,r=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;if(!r.parents("body").length)e("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(r[0]);if(r[0]===this.currentItem[0])this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")};if(!r[0].style.width||i.forceHelperSize)r.width(this.currentItem.width());if(!r[0].style.height||i.forceHelperSize)r.height(this.currentItem.height());return r},_adjustOffsetFromHelper:function(t){if("string"==typeof t)t=t.split(" ");if(e.isArray(t))t={left:+t[0],top:+t[1]||0};if("left"in t)this.offset.click.left=t.left+this.margins.left;if("right"in t)this.offset.click.left=this.helperProportions.width-t.right+this.margins.left;if("top"in t)this.offset.click.top=t.top+this.margins.top;if("bottom"in t)this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();if("absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])){t.left+=this.scrollParent.scrollLeft();t.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,r,n=this.options;if("parent"===n.containment)n.containment=this.helper[0].parentNode;if("document"===n.containment||"window"===n.containment)this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"===n.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"===n.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(n.containment)){t=e(n.containment)[0];i=e(n.containment).offset();r="hidden"!==e(t).css("overflow");this.containment=[i.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(r?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(r?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(t,i){if(!i)i=this.position;var r="absolute"===t?1:-1,n="absolute"===this.cssPosition&&(this.scrollParent[0]===document||!e.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,o=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*r+this.offset.parent.top*r-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:n.scrollTop())*r,left:i.left+this.offset.relative.left*r+this.offset.parent.left*r-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())*r}},_generatePosition:function(t){var i,r,n=this.options,o=t.pageX,a=t.pageY,s="absolute"===this.cssPosition&&(this.scrollParent[0]===document||!e.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,l=/(html|body)/i.test(s[0].tagName);if("relative"===this.cssPosition&&(this.scrollParent[0]===document||this.scrollParent[0]===this.offsetParent[0]))this.offset.relative=this._getRelativeOffset();if(this.originalPosition){if(this.containment){if(t.pageX-this.offset.click.left<this.containment[0])o=this.containment[0]+this.offset.click.left;if(t.pageY-this.offset.click.top<this.containment[1])a=this.containment[1]+this.offset.click.top;if(t.pageX-this.offset.click.left>this.containment[2])o=this.containment[2]+this.offset.click.left;if(t.pageY-this.offset.click.top>this.containment[3])a=this.containment[3]+this.offset.click.top}if(n.grid){i=this.originalPageY+Math.round((a-this.originalPageY)/n.grid[1])*n.grid[1];a=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i;r=this.originalPageX+Math.round((o-this.originalPageX)/n.grid[0])*n.grid[0];o=this.containment?r-this.offset.click.left>=this.containment[0]&&r-this.offset.click.left<=this.containment[2]?r:r-this.offset.click.left>=this.containment[0]?r-n.grid[0]:r+n.grid[0]:r}}return{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:s.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:s.scrollLeft())}},_rearrange:function(e,t,i,r){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling);this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){if(n===this.counter)this.refreshPositions(!r)})},_clear:function(e,t){this.reverting=!1;var i,r=[];if(!this._noFinalSort&&this.currentItem.parent().length)this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)if("auto"===this._storedCSS[i]||"static"===this._storedCSS[i])this._storedCSS[i]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();if(this.fromOutside&&!t)r.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))});if((this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!t)r.push(function(e){this._trigger("update",e,this._uiHash())});if(this!==this.currentContainer)if(!t){r.push(function(e){this._trigger("remove",e,this._uiHash())});r.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer));r.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer))}for(i=this.containers.length-1;i>=0;i--){if(!t)r.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[i]));if(this.containers[i].containerCache.over){r.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[i]));this.containers[i].containerCache.over=0}}if(this.storedCursor){this.document.find("body").css("cursor",this.storedCursor);this.storedStylesheet.remove()}if(this._storedOpacity)this.helper.css("opacity",this._storedOpacity);if(this._storedZIndex)this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex);this.dragging=!1;if(this.cancelHelperRemoval){if(!t){this._trigger("beforeStop",e,this._uiHash());for(i=0;i<r.length;i++)r[i].call(this,e);this._trigger("stop",e,this._uiHash())}this.fromOutside=!1;return!1}if(!t)this._trigger("beforeStop",e,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(this.helper[0]!==this.currentItem[0])this.helper.remove();this.helper=null;if(!t){for(i=0;i<r.length;i++)r[i].call(this,e);this._trigger("stop",e,this._uiHash())}this.fromOutside=!1;return!0},_trigger:function(){if(e.Widget.prototype._trigger.apply(this,arguments)===!1)this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}})}(jQuery);!function(e,t){var i="ui-effects-";e.effects={effect:{}};!function(e,t){function i(e,t,i){var r=u[t.type]||{};if(null==e)return i||!t.def?null:t.def;e=r.floor?~~e:parseFloat(e);if(isNaN(e))return t.def;if(r.mod)return(e+r.mod)%r.mod;else return 0>e?0:r.max<e?r.max:e}function r(t){var i=h(),r=i._rgba=[];t=t.toLowerCase();p(l,function(e,n){var o,a=n.re.exec(t),s=a&&n.parse(a),l=n.space||"rgba";if(s){o=i[l](s);i[c[l].cache]=o[c[l].cache];r=i._rgba=o._rgba;return!1}});if(r.length){if("0,0,0,0"===r.join())e.extend(r,o.transparent);return i}return o[t]}function n(e,t,i){i=(i+1)%1;if(1>6*i)return e+6*(t-e)*i;if(1>2*i)return t;if(2>3*i)return e+6*(t-e)*(2/3-i);else return e}var o,a="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",s=/^([\-+])=\s*(\d+\.?\d*)/,l=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],h=e.Color=function(t,i,r,n){return new e.Color.fn.parse(t,i,r,n)},c={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},u={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},f=h.support={},d=e("<p>")[0],p=e.each;d.style.cssText="background-color:rgba(1,1,1,.5)";f.rgba=d.style.backgroundColor.indexOf("rgba")>-1;p(c,function(e,t){t.cache="_"+e;t.props.alpha={idx:3,type:"percent",def:1}});h.fn=e.extend(h.prototype,{parse:function(n,a,s,l){if(n===t){this._rgba=[null,null,null,null];return this}if(n.jquery||n.nodeType){n=e(n).css(a);a=t}var u=this,f=e.type(n),d=this._rgba=[];if(a!==t){n=[n,a,s,l];f="array"}if("string"===f)return this.parse(r(n)||o._default);if("array"===f){p(c.rgba.props,function(e,t){d[t.idx]=i(n[t.idx],t)});return this}if("object"===f){if(n instanceof h)p(c,function(e,t){if(n[t.cache])u[t.cache]=n[t.cache].slice()});else p(c,function(t,r){var o=r.cache;p(r.props,function(e,t){if(!u[o]&&r.to){if("alpha"===e||null==n[e])return;u[o]=r.to(u._rgba)}u[o][t.idx]=i(n[e],t,!0)});if(u[o]&&e.inArray(null,u[o].slice(0,3))<0){u[o][3]=1;if(r.from)u._rgba=r.from(u[o])}});return this}},is:function(e){var t=h(e),i=!0,r=this;p(c,function(e,n){var o,a=t[n.cache];if(a){o=r[n.cache]||n.to&&n.to(r._rgba)||[];p(n.props,function(e,t){if(null!=a[t.idx]){i=a[t.idx]===o[t.idx];return i}})}return i});return i},_space:function(){var e=[],t=this;p(c,function(i,r){if(t[r.cache])e.push(i)});return e.pop()},transition:function(e,t){var r=h(e),n=r._space(),o=c[n],a=0===this.alpha()?h("transparent"):this,s=a[o.cache]||o.to(a._rgba),l=s.slice();r=r[o.cache];p(o.props,function(e,n){var o=n.idx,a=s[o],h=r[o],c=u[n.type]||{};if(null!==h)if(null===a)l[o]=h;else{if(c.mod)if(h-a>c.mod/2)a+=c.mod;else if(a-h>c.mod/2)a-=c.mod;l[o]=i((h-a)*t+a,n)}});return this[n](l)},blend:function(t){if(1===this._rgba[3])return this;var i=this._rgba.slice(),r=i.pop(),n=h(t)._rgba;return h(e.map(i,function(e,t){return(1-r)*n[t]+r*e}))},toRgbaString:function(){var t="rgba(",i=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});if(1===i[3]){i.pop();t="rgb("}return t+i.join()+")"},toHslaString:function(){var t="hsla(",i=e.map(this.hsla(),function(e,t){if(null==e)e=t>2?1:0;if(t&&3>t)e=Math.round(100*e)+"%";return e});if(1===i[3]){i.pop();t="hsl("}return t+i.join()+")"},toHexString:function(t){var i=this._rgba.slice(),r=i.pop();if(t)i.push(~~(255*r));return"#"+e.map(i,function(e){e=(e||0).toString(16);return 1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}});h.fn.parse.prototype=h.fn;c.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,i,r=e[0]/255,n=e[1]/255,o=e[2]/255,a=e[3],s=Math.max(r,n,o),l=Math.min(r,n,o),h=s-l,c=s+l,u=.5*c;if(l===s)t=0;else if(r===s)t=60*(n-o)/h+360;else if(n===s)t=60*(o-r)/h+120;else t=60*(r-n)/h+240;if(0===h)i=0;else if(.5>=u)i=h/c;else i=h/(2-c);return[Math.round(t)%360,i,u,null==a?1:a]};c.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],r=e[2],o=e[3],a=.5>=r?r*(1+i):r+i-r*i,s=2*r-a;return[Math.round(255*n(s,a,t+1/3)),Math.round(255*n(s,a,t)),Math.round(255*n(s,a,t-1/3)),o]};p(c,function(r,n){var o=n.props,a=n.cache,l=n.to,c=n.from;h.fn[r]=function(r){if(l&&!this[a])this[a]=l(this._rgba);if(r===t)return this[a].slice();var n,s=e.type(r),u="array"===s||"object"===s?r:arguments,f=this[a].slice();p(o,function(e,t){var r=u["object"===s?e:t.idx];if(null==r)r=f[t.idx];f[t.idx]=i(r,t)});if(c){n=h(c(f));n[a]=f;return n}else return h(f)};p(o,function(t,i){if(!h.fn[t])h.fn[t]=function(n){var o,a=e.type(n),l="alpha"===t?this._hsla?"hsla":"rgba":r,h=this[l](),c=h[i.idx];if("undefined"===a)return c;if("function"===a){n=n.call(this,c);a=e.type(n)}if(null==n&&i.empty)return this;if("string"===a){o=s.exec(n);if(o)n=c+parseFloat(o[2])*("+"===o[1]?1:-1)}h[i.idx]=n;return this[l](h)}})});h.hook=function(t){var i=t.split(" ");p(i,function(t,i){e.cssHooks[i]={set:function(t,n){var o,a,s="";if("transparent"!==n&&("string"!==e.type(n)||(o=r(n)))){n=h(o||n);if(!f.rgba&&1!==n._rgba[3]){a="backgroundColor"===i?t.parentNode:t;for(;(""===s||"transparent"===s)&&a&&a.style;)try{s=e.css(a,"backgroundColor");a=a.parentNode}catch(l){}n=n.blend(s&&"transparent"!==s?s:"_default")}n=n.toRgbaString()}try{t.style[i]=n}catch(l){}}};e.fx.step[i]=function(t){if(!t.colorInit){t.start=h(t.elem,i);t.end=h(t.end);t.colorInit=!0}e.cssHooks[i].set(t.elem,t.start.transition(t.end,t.pos))}})};h.hook(a);e.cssHooks.borderColor={expand:function(e){var t={};p(["Top","Right","Bottom","Left"],function(i,r){t["border"+r+"Color"]=e});return t}};o=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery);!function(){function i(t){var i,r,n=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,o={};if(n&&n.length&&n[0]&&n[n[0]]){r=n.length;for(;r--;){i=n[r];if("string"==typeof n[i])o[e.camelCase(i)]=n[i]}}else for(i in n)if("string"==typeof n[i])o[i]=n[i];return o}function r(t,i){var r,n,a={};for(r in i){n=i[r];if(t[r]!==n)if(!o[r])if(e.fx.step[r]||!isNaN(parseFloat(n)))a[r]=n}return a}var n=["add","remove","toggle"],o={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,i){e.fx.step[i]=function(e){if("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr){jQuery.style(e.elem,i,e.end);e.setAttr=!0}}});if(!e.fn.addBack)e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))};e.effects.animateClass=function(t,o,a,s){var l=e.speed(o,a,s);return this.queue(function(){var o,a=e(this),s=a.attr("class")||"",h=l.children?a.find("*").addBack():a;h=h.map(function(){var t=e(this);return{el:t,start:i(this)}});o=function(){e.each(n,function(e,i){if(t[i])a[i+"Class"](t[i])})};o();h=h.map(function(){this.end=i(this.el[0]);this.diff=r(this.start,this.end);return this});a.attr("class",s);h=h.map(function(){var t=this,i=e.Deferred(),r=e.extend({},l,{queue:!1,complete:function(){i.resolve(t)}});this.el.animate(this.diff,r);return i.promise()});e.when.apply(e,h.get()).done(function(){o();e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})});l.complete.call(a[0])})})};e.fn.extend({addClass:function(t){return function(i,r,n,o){return r?e.effects.animateClass.call(this,{add:i},r,n,o):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(i,r,n,o){return arguments.length>1?e.effects.animateClass.call(this,{remove:i},r,n,o):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(i){return function(r,n,o,a,s){if("boolean"==typeof n||n===t)if(!o)return i.apply(this,arguments);else return e.effects.animateClass.call(this,n?{add:r}:{remove:r},o,a,s);else return e.effects.animateClass.call(this,{toggle:r},n,o,a)}}(e.fn.toggleClass),switchClass:function(t,i,r,n,o){return e.effects.animateClass.call(this,{add:i,remove:t},r,n,o)}})}();!function(){function r(t,i,r,n){if(e.isPlainObject(t)){i=t;t=t.effect}t={effect:t};if(null==i)i={};if(e.isFunction(i)){n=i;r=null;i={}}if("number"==typeof i||e.fx.speeds[i]){n=r;r=i;i={}}if(e.isFunction(r)){n=r;r=null}if(i)e.extend(t,i);r=r||i.duration;t.duration=e.fx.off?0:"number"==typeof r?r:r in e.fx.speeds?e.fx.speeds[r]:e.fx.speeds._default;t.complete=n||i.complete;return t}function n(t){if(!t||"number"==typeof t||e.fx.speeds[t])return!0;if("string"==typeof t&&!e.effects.effect[t])return!0;if(e.isFunction(t))return!0;if("object"==typeof t&&!t.effect)return!0;else return!1}e.extend(e.effects,{version:"1.10.3",save:function(e,t){for(var r=0;r<t.length;r++)if(null!==t[r])e.data(i+t[r],e[0].style[t[r]])},restore:function(e,r){var n,o;for(o=0;o<r.length;o++)if(null!==r[o]){n=e.data(i+r[o]);if(n===t)n="";e.css(r[o],n)}},setMode:function(e,t){if("toggle"===t)t=e.is(":hidden")?"show":"hide";return t},getBaseline:function(e,t){var i,r;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":r=0;break;case"center":r=.5;break;case"right":r=1;break;default:r=e[1]/t.width}return{x:r,y:i}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var i={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},r=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:t.width(),height:t.height()},o=document.activeElement;try{o.id}catch(a){o=document.body}t.wrap(r);if(t[0]===o||e.contains(t[0],o))e(o).focus();r=t.parent();if("static"===t.css("position")){r.css({position:"relative"});t.css({position:"relative"})}else{e.extend(i,{position:t.css("position"),zIndex:t.css("z-index")});e.each(["top","left","bottom","right"],function(e,r){i[r]=t.css(r);if(isNaN(parseInt(i[r],10)))i[r]="auto"});t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}t.css(n);return r.css(i).show()},removeWrapper:function(t){var i=document.activeElement;if(t.parent().is(".ui-effects-wrapper")){t.parent().replaceWith(t);if(t[0]===i||e.contains(t[0],i))e(i).focus()}return t},setTransition:function(t,i,r,n){n=n||{};e.each(i,function(e,i){var o=t.cssUnit(i);if(o[0]>0)n[i]=o[0]*r+o[1]});return n}});e.fn.extend({effect:function(){function t(t){function r(){if(e.isFunction(o))o.call(n[0]);if(e.isFunction(t))t()}var n=e(this),o=i.complete,s=i.mode;if(n.is(":hidden")?"hide"===s:"show"===s){n[s]();r()}else a.call(n[0],i,r)}var i=r.apply(this,arguments),n=i.mode,o=i.queue,a=e.effects.effect[i.effect];if(e.fx.off||!a)if(n)return this[n](i.duration,i.complete);else return this.each(function(){if(i.complete)i.complete.call(this)});return o===!1?this.each(t):this.queue(o||"fx",t)},show:function(e){return function(t){if(n(t))return e.apply(this,arguments);else{var i=r.apply(this,arguments);i.mode="show";return this.effect.call(this,i)}}}(e.fn.show),hide:function(e){return function(t){if(n(t))return e.apply(this,arguments);else{var i=r.apply(this,arguments);i.mode="hide";return this.effect.call(this,i)}}}(e.fn.hide),toggle:function(e){return function(t){if(n(t)||"boolean"==typeof t)return e.apply(this,arguments);else{var i=r.apply(this,arguments);i.mode="toggle";return this.effect.call(this,i)}}}(e.fn.toggle),cssUnit:function(t){var i=this.css(t),r=[];e.each(["em","px","%","pt"],function(e,t){if(i.indexOf(t)>0)r=[parseFloat(i),t]});return r}})}();!function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,i){t[i]=function(t){return Math.pow(t,e+2)}});e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){var t,i=4;for(;e<((t=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}});e.each(t,function(t,i){e.easing["easeIn"+t]=i;e.easing["easeOut"+t]=function(e){return 1-i(1-e)};e.easing["easeInOut"+t]=function(e){return.5>e?i(2*e)/2:1-i(-2*e+2)/2}})}()}(jQuery);!function(e){var t=0,i={},r={};i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="hide";r.height=r.paddingTop=r.paddingBottom=r.borderTopWidth=r.borderBottomWidth="show";e.widget("ui.accordion",{version:"1.10.3",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var t=this.options;this.prevShow=this.prevHide=e();this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist");if(!t.collapsible&&(t.active===!1||null==t.active))t.active=0;this._processPanels();if(t.active<0)t.active+=this.headers.length;this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:!this.active.length?e():this.active.next(),content:!this.active.length?e():this.active.next()}},_createIcons:function(){var t=this.options.icons;if(t){e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers);this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader);this.headers.addClass("ui-accordion-icons")}},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){if(/^ui-accordion/.test(this.id))this.removeAttribute("id")});this._destroyIcons();e=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){if(/^ui-accordion/.test(this.id))this.removeAttribute("id")});if("content"!==this.options.heightStyle)e.css("height","")},_setOption:function(e,t){if("active"!==e){if("event"===e){if(this.options.event)this._off(this.headers,this.options.event);this._setupEvents(t)}this._super(e,t);if("collapsible"===e&&!t&&this.options.active===!1)this._activate(0);if("icons"===e){this._destroyIcons();if(t)this._createIcons()}if("disabled"===e)this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)}else this._activate(t)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var i=e.ui.keyCode,r=this.headers.length,n=this.headers.index(t.target),o=!1;switch(t.keyCode){case i.RIGHT:case i.DOWN:o=this.headers[(n+1)%r];break;case i.LEFT:case i.UP:o=this.headers[(n-1+r)%r];break;case i.SPACE:case i.ENTER:this._eventHandler(t);break;case i.HOME:o=this.headers[0];break;case i.END:o=this.headers[r-1]}if(o){e(t.target).attr("tabIndex",-1);e(o).attr("tabIndex",0);o.focus();t.preventDefault()}}},_panelKeyDown:function(t){if(t.keyCode===e.ui.keyCode.UP&&t.ctrlKey)e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels();if(t.active===!1&&t.collapsible===!0||!this.headers.length){t.active=!1;this.active=e()}else if(t.active===!1)this._activate(0);else if(this.active.length&&!e.contains(this.element[0],this.active[0]))if(this.headers.length===this.headers.find(".ui-state-disabled").length){t.active=!1;this.active=e()}else this._activate(Math.max(0,t.active-1));else t.active=this.headers.index(this.active);this._destroyIcons();this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var i,r=this.options,n=r.heightStyle,o=this.element.parent(),a=this.accordionId="ui-accordion-"+(this.element.attr("id")||++t);this.active=this._findActive(r.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all");this.active.next().addClass("ui-accordion-content-active").show();this.headers.attr("role","tab").each(function(t){var i=e(this),r=i.attr("id"),n=i.next(),o=n.attr("id");if(!r){r=a+"-header-"+t;i.attr("id",r)}if(!o){o=a+"-panel-"+t;n.attr("id",o)}i.attr("aria-controls",o);n.attr("aria-labelledby",r)}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide();if(!this.active.length)this.headers.eq(0).attr("tabIndex",0);else this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"});this._createIcons();this._setupEvents(r.event);if("fill"===n){i=o.height();this.element.siblings(":visible").each(function(){var t=e(this),r=t.css("position");if("absolute"!==r&&"fixed"!==r)i-=t.outerHeight(!0)});this.headers.each(function(){i-=e(this).outerHeight(!0)});this.headers.next().each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")}else if("auto"===n){i=0;this.headers.next().each(function(){i=Math.max(i,e(this).css("height","").height())}).height(i)}},_activate:function(t){var i=this._findActive(t)[0];if(i!==this.active[0]){i=i||this.active[0];this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop})}},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var i={keydown:"_keydown"};if(t)e.each(t.split(" "),function(e,t){i[t]="_eventHandler"});this._off(this.headers.add(this.headers.next()));this._on(this.headers,i);this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._hoverable(this.headers);this._focusable(this.headers)},_eventHandler:function(t){var i=this.options,r=this.active,n=e(t.currentTarget),o=n[0]===r[0],a=o&&i.collapsible,s=a?e():n.next(),l=r.next(),h={oldHeader:r,oldPanel:l,newHeader:a?e():n,newPanel:s};t.preventDefault();if((!o||i.collapsible)&&this._trigger("beforeActivate",t,h)!==!1){i.active=a?!1:this.headers.index(n);this.active=o?e():n;this._toggle(h);r.removeClass("ui-accordion-header-active ui-state-active");if(i.icons)r.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header);if(!o){n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top");if(i.icons)n.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader);n.next().addClass("ui-accordion-content-active")}}},_toggle:function(t){var i=t.newPanel,r=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0);this.prevShow=i;this.prevHide=r;if(this.options.animate)this._animate(i,r,t);else{r.hide();i.show();this._toggleComplete(t)}r.attr({"aria-expanded":"false","aria-hidden":"true"});r.prev().attr("aria-selected","false");if(i.length&&r.length)r.prev().attr("tabIndex",-1);else if(i.length)this.headers.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1);i.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(e,t,n){var o,a,s,l=this,h=0,c=e.length&&(!t.length||e.index()<t.index()),u=this.options.animate||{},f=c&&u.down||u,d=function(){l._toggleComplete(n)};if("number"==typeof f)s=f;if("string"==typeof f)a=f;a=a||f.easing||u.easing;s=s||f.duration||u.duration;if(!t.length)return e.animate(r,s,a,d);if(!e.length)return t.animate(i,s,a,d);o=e.show().outerHeight();t.animate(i,{duration:s,easing:a,step:function(e,t){t.now=Math.round(e)}});e.hide().animate(r,{duration:s,easing:a,complete:d,step:function(e,i){i.now=Math.round(e);if("height"!==i.prop)h+=i.now;else if("content"!==l.options.heightStyle){i.now=Math.round(o-t.outerHeight()-h);h=0}}})},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all");if(t.length)t.parent()[0].className=t.parent()[0].className;this._trigger("activate",null,e)}})}(jQuery);!function(e){var t=0;e.widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var t,i,r,n=this.element[0].nodeName.toLowerCase(),o="textarea"===n,a="input"===n;this.isMultiLine=o?!0:a?!1:this.element.prop("isContentEditable");this.valueMethod=this.element[o||a?"val":"text"];this.isNewMenu=!0;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off");this._on(this.element,{keydown:function(n){if(!this.element.prop("readOnly")){t=!1;r=!1;i=!1;var o=e.ui.keyCode;switch(n.keyCode){case o.PAGE_UP:t=!0;this._move("previousPage",n);break;case o.PAGE_DOWN:t=!0;this._move("nextPage",n);break;case o.UP:t=!0;this._keyEvent("previous",n);break;case o.DOWN:t=!0;this._keyEvent("next",n);break;case o.ENTER:case o.NUMPAD_ENTER:if(this.menu.active){t=!0;n.preventDefault();this.menu.select(n)}break;case o.TAB:if(this.menu.active)this.menu.select(n);break;case o.ESCAPE:if(this.menu.element.is(":visible")){this._value(this.term);this.close(n);n.preventDefault()}break;default:i=!0;this._searchTimeout(n)}}else{t=!0;r=!0;i=!0}},keypress:function(r){if(!t){if(!i){var n=e.ui.keyCode;switch(r.keyCode){case n.PAGE_UP:this._move("previousPage",r);break;case n.PAGE_DOWN:this._move("nextPage",r);break;case n.UP:this._keyEvent("previous",r);break;case n.DOWN:this._keyEvent("next",r)}}}else{t=!1;if(!this.isMultiLine||this.menu.element.is(":visible"))r.preventDefault()
}},input:function(e){if(!r)this._searchTimeout(e);else{r=!1;e.preventDefault()}},focus:function(){this.selectedItem=null;this.previous=this._value()},blur:function(e){if(!this.cancelBlur){clearTimeout(this.searching);this.close(e);this._change(e)}else delete this.cancelBlur}});this._initSource();this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu");this._on(this.menu.element,{mousedown:function(t){t.preventDefault();this.cancelBlur=!0;this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];if(!e(t.target).closest(".ui-menu-item").length)this._delay(function(){var t=this;this.document.one("mousedown",function(r){if(r.target!==t.element[0]&&r.target!==i&&!e.contains(i,r.target))t.close()})})},menufocus:function(t,i){if(this.isNewMenu){this.isNewMenu=!1;if(t.originalEvent&&/^mouse/.test(t.originalEvent.type)){this.menu.blur();this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)});return}}var r=i.item.data("ui-autocomplete-item");if(!1!==this._trigger("focus",t,{item:r})){if(t.originalEvent&&/^key/.test(t.originalEvent.type))this._value(r.value)}else this.liveRegion.text(r.value)},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),r=this.previous;if(this.element[0]!==this.document[0].activeElement){this.element.focus();this.previous=r;this._delay(function(){this.previous=r;this.selectedItem=i})}if(!1!==this._trigger("select",e,{item:i}))this._value(i.value);this.term=this._value();this.close(e);this.selectedItem=i}});this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element);this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching);this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete");this.menu.element.remove();this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t);if("source"===e)this._initSource();if("appendTo"===e)this.menu.element.appendTo(this._appendTo());if("disabled"===e&&t&&this.xhr)this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;if(t)t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0);if(!t)t=this.element.closest(".ui-front");if(!t.length)t=this.document[0].body;return t},_initSource:function(){var t,i,r=this;if(e.isArray(this.options.source)){t=this.options.source;this.source=function(i,r){r(e.ui.autocomplete.filter(t,i.term))}}else if("string"==typeof this.options.source){i=this.options.source;this.source=function(t,n){if(r.xhr)r.xhr.abort();r.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e){n(e)},error:function(){n([])}})}}else this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching);this.searching=this._delay(function(){if(this.term!==this._value()){this.selectedItem=null;this.search(null,e)}},this.options.delay)},search:function(e,t){e=null!=e?e:this._value();this.term=this._value();if(e.length<this.options.minLength)return this.close(t);if(this._trigger("search",t)!==!1)return this._search(e);else return void 0},_search:function(e){this.pending++;this.element.addClass("ui-autocomplete-loading");this.cancelSearch=!1;this.source({term:e},this._response())},_response:function(){var e=this,i=++t;return function(r){if(i===t)e.__response(r);e.pending--;if(!e.pending)e.element.removeClass("ui-autocomplete-loading")}},__response:function(e){if(e)e=this._normalize(e);this._trigger("response",null,{content:e});if(!this.options.disabled&&e&&e.length&&!this.cancelSearch){this._suggest(e);this._trigger("open")}else this._close()},close:function(e){this.cancelSearch=!0;this._close(e)},_close:function(e){if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.blur();this.isNewMenu=!0;this._trigger("close",e)}},_change:function(e){if(this.previous!==this._value())this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){if(t.length&&t[0].label&&t[0].value)return t;else return e.map(t,function(t){if("string"==typeof t)return{label:t,value:t};else return e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t);this.isNewMenu=!0;this.menu.refresh();i.show();this._resizeMenu();i.position(e.extend({of:this.element},this.options.position));if(this.options.autoFocus)this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var r=this;e.each(i,function(e,i){r._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return e("<li>").append(e("<a>").text(i.label)).appendTo(t)},_move:function(e,t){if(this.menu.element.is(":visible"))if(!(this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)))this.menu[e](t);else{this._value(this.term);this.menu.blur()}else this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){if(!this.isMultiLine||this.menu.element.is(":visible")){this._move(e,t);t.preventDefault()}}});e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var r=new RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return r.test(e.label||e.value||e)})}});e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments);if(!this.options.disabled&&!this.cancelSearch){if(e&&e.length)t=this.options.messages.results(e.length);else t=this.options.messages.noResults;this.liveRegion.text(t)}}})}(jQuery);!function(e){var t,i,r,n,o="ui-button ui-widget ui-state-default ui-corner-all",a="ui-state-hover ui-state-active ",s="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",l=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},h=function(t){var i=t.name,r=t.form,n=e([]);if(i){i=i.replace(/'/g,"\\'");if(r)n=e(r).find("[name='"+i+"']");else n=e("[name='"+i+"']",t.ownerDocument).filter(function(){return!this.form})}return n};e.widget("ui.button",{version:"1.10.3",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,l);if("boolean"!=typeof this.options.disabled)this.options.disabled=!!this.element.prop("disabled");else this.element.prop("disabled",this.options.disabled);this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var a=this,s=this.options,c="checkbox"===this.type||"radio"===this.type,u=!c?"ui-state-active":"",f="ui-state-focus";if(null===s.label)s.label="input"===this.type?this.buttonElement.val():this.buttonElement.html();this._hoverable(this.buttonElement);this.buttonElement.addClass(o).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){if(!s.disabled)if(this===t)e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){if(!s.disabled)e(this).removeClass(u)}).bind("click"+this.eventNamespace,function(e){if(s.disabled){e.preventDefault();e.stopImmediatePropagation()}});this.element.bind("focus"+this.eventNamespace,function(){a.buttonElement.addClass(f)}).bind("blur"+this.eventNamespace,function(){a.buttonElement.removeClass(f)});if(c){this.element.bind("change"+this.eventNamespace,function(){if(!n)a.refresh()});this.buttonElement.bind("mousedown"+this.eventNamespace,function(e){if(!s.disabled){n=!1;i=e.pageX;r=e.pageY}}).bind("mouseup"+this.eventNamespace,function(e){if(!s.disabled)if(i!==e.pageX||r!==e.pageY)n=!0})}if("checkbox"===this.type)this.buttonElement.bind("click"+this.eventNamespace,function(){if(s.disabled||n)return!1;else return void 0});else if("radio"===this.type)this.buttonElement.bind("click"+this.eventNamespace,function(){if(s.disabled||n)return!1;e(this).addClass("ui-state-active");a.buttonElement.attr("aria-pressed","true");var t=a.element[0];h(t).not(t).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")});else{this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(s.disabled)return!1;e(this).addClass("ui-state-active");t=this;a.document.one("mouseup",function(){t=null})}).bind("mouseup"+this.eventNamespace,function(){if(s.disabled)return!1;e(this).removeClass("ui-state-active");return void 0}).bind("keydown"+this.eventNamespace,function(t){if(s.disabled)return!1;if(t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)e(this).addClass("ui-state-active")}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")});if(this.buttonElement.is("a"))this.buttonElement.keyup(function(t){if(t.keyCode===e.ui.keyCode.SPACE)e(this).click()})}this._setOption("disabled",s.disabled);this._resetButton()},_determineButtonType:function(){var e,t,i;if(this.element.is("[type=checkbox]"))this.type="checkbox";else if(this.element.is("[type=radio]"))this.type="radio";else if(this.element.is("input"))this.type="input";else this.type="button";if("checkbox"===this.type||"radio"===this.type){e=this.element.parents().last();t="label[for='"+this.element.attr("id")+"']";this.buttonElement=e.find(t);if(!this.buttonElement.length){e=e.length?e.siblings():this.element.siblings();this.buttonElement=e.filter(t);if(!this.buttonElement.length)this.buttonElement=e.find(t)}this.element.addClass("ui-helper-hidden-accessible");i=this.element.is(":checked");if(i)this.buttonElement.addClass("ui-state-active");this.buttonElement.prop("aria-pressed",i)}else this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass(o+" "+a+" "+s).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());if(!this.hasTitle)this.buttonElement.removeAttr("title")},_setOption:function(e,t){this._super(e,t);if("disabled"!==e)this._resetButton();else if(t)this.element.prop("disabled",!0);else this.element.prop("disabled",!1)},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");if(t!==this.options.disabled)this._setOption("disabled",t);if("radio"===this.type)h(this.element[0]).each(function(){if(e(this).is(":checked"))e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true");else e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")});else if("checkbox"===this.type)if(this.element.is(":checked"))this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true");else this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false")},_resetButton:function(){if("input"!==this.type){var t=this.buttonElement.removeClass(s),i=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),r=this.options.icons,n=r.primary&&r.secondary,o=[];if(r.primary||r.secondary){if(this.options.text)o.push("ui-button-text-icon"+(n?"s":r.primary?"-primary":"-secondary"));if(r.primary)t.prepend("<span class='ui-button-icon-primary ui-icon "+r.primary+"'></span>");if(r.secondary)t.append("<span class='ui-button-icon-secondary ui-icon "+r.secondary+"'></span>");if(!this.options.text){o.push(n?"ui-button-icons-only":"ui-button-icon-only");if(!this.hasTitle)t.attr("title",e.trim(i))}}else o.push("ui-button-text-only");t.addClass(o.join(" "))}else if(this.options.label)this.element.val(this.options.label)}});e.widget("ui.buttonset",{version:"1.10.3",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){if("disabled"===e)this.buttons.button("option",e,t);this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery);!function(e,t){function i(){this._curInst=null;this._keyEvent=!1;this._disabledInputs=[];this._datepickerShowing=!1;this._inDialog=!1;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1};e.extend(this._defaults,this.regional[""]);this.dpDiv=r(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function r(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(i,"mouseout",function(){e(this).removeClass("ui-state-hover");if(-1!==this.className.indexOf("ui-datepicker-prev"))e(this).removeClass("ui-datepicker-prev-hover");if(-1!==this.className.indexOf("ui-datepicker-next"))e(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",function(){if(!e.datepicker._isDisabledDatepicker(o.inline?t.parent()[0]:o.input[0])){e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");e(this).addClass("ui-state-hover");if(-1!==this.className.indexOf("ui-datepicker-prev"))e(this).addClass("ui-datepicker-prev-hover");if(-1!==this.className.indexOf("ui-datepicker-next"))e(this).addClass("ui-datepicker-next-hover")}})}function n(t,i){e.extend(t,i);for(var r in i)if(null==i[r])t[r]=i[r];return t}e.extend(e.ui,{datepicker:{version:"1.10.3"}});var o,a="datepicker";e.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){n(this._defaults,e||{});return this},_attachDatepicker:function(t,i){var r,n,o;r=t.nodeName.toLowerCase();n="div"===r||"span"===r;if(!t.id){this.uuid+=1;t.id="dp"+this.uuid}o=this._newInst(e(t),n);o.settings=e.extend({},i||{});if("input"===r)this._connectDatepicker(t,o);else if(n)this._inlineDatepicker(t,o)},_newInst:function(t,i){var n=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:n,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:!i?this.dpDiv:r(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}},_connectDatepicker:function(t,i){var r=e(t);i.append=e([]);i.trigger=e([]);if(!r.hasClass(this.markerClassName)){this._attachments(r,i);r.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp);this._autoSize(i);e.data(t,a,i);if(i.settings.disabled)this._disableDatepicker(t)}},_attachments:function(t,i){var r,n,o,a=this._get(i,"appendText"),s=this._get(i,"isRTL");if(i.append)i.append.remove();if(a){i.append=e("<span class='"+this._appendClass+"'>"+a+"</span>");t[s?"before":"after"](i.append)}t.unbind("focus",this._showDatepicker);if(i.trigger)i.trigger.remove();r=this._get(i,"showOn");if("focus"===r||"both"===r)t.focus(this._showDatepicker);if("button"===r||"both"===r){n=this._get(i,"buttonText");o=this._get(i,"buttonImage");i.trigger=e(this._get(i,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:o,alt:n,title:n}):e("<button type='button'></button>").addClass(this._triggerClass).html(!o?n:e("<img/>").attr({src:o,alt:n,title:n})));t[s?"before":"after"](i.trigger);i.trigger.click(function(){if(e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0])e.datepicker._hideDatepicker();else if(e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]){e.datepicker._hideDatepicker();e.datepicker._showDatepicker(t[0])}else e.datepicker._showDatepicker(t[0]);return!1})}},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,r,n,o=new Date(2009,11,20),a=this._get(e,"dateFormat");if(a.match(/[DM]/)){t=function(e){i=0;r=0;for(n=0;n<e.length;n++)if(e[n].length>i){i=e[n].length;r=n}return r};o.setMonth(t(this._get(e,a.match(/MM/)?"monthNames":"monthNamesShort")));o.setDate(t(this._get(e,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())}e.input.attr("size",this._formatDate(e,o).length)}},_inlineDatepicker:function(t,i){var r=e(t);if(!r.hasClass(this.markerClassName)){r.addClass(this.markerClassName).append(i.dpDiv);e.data(t,a,i);this._setDate(i,this._getDefaultDate(i),!0);this._updateDatepicker(i);this._updateAlternate(i);if(i.settings.disabled)this._disableDatepicker(t);i.dpDiv.css("display","block")}},_dialogDatepicker:function(t,i,r,o,s){var l,h,c,u,f,d=this._dialogInst;if(!d){this.uuid+=1;l="dp"+this.uuid;this._dialogInput=e("<input type='text' id='"+l+"' style='position: absolute; top: -100px; width: 0px;'/>");this._dialogInput.keydown(this._doKeyDown);e("body").append(this._dialogInput);d=this._dialogInst=this._newInst(this._dialogInput,!1);d.settings={};e.data(this._dialogInput[0],a,d)}n(d.settings,o||{});i=i&&i.constructor===Date?this._formatDate(d,i):i;this._dialogInput.val(i);this._pos=s?s.length?s:[s.pageX,s.pageY]:null;if(!this._pos){h=document.documentElement.clientWidth;c=document.documentElement.clientHeight;u=document.documentElement.scrollLeft||document.body.scrollLeft;f=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[h/2-100+u,c/2-150+f]}this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");d.settings.onSelect=r;this._inDialog=!0;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if(e.blockUI)e.blockUI(this.dpDiv);e.data(this._dialogInput[0],a,d);return this},_destroyDatepicker:function(t){var i,r=e(t),n=e.data(t,a);if(r.hasClass(this.markerClassName)){i=t.nodeName.toLowerCase();e.removeData(t,a);if("input"===i){n.append.remove();n.trigger.remove();r.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else if("div"===i||"span"===i)r.removeClass(this.markerClassName).empty()}},_enableDatepicker:function(t){var i,r,n=e(t),o=e.data(t,a);if(n.hasClass(this.markerClassName)){i=t.nodeName.toLowerCase();if("input"===i){t.disabled=!1;o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})}else if("div"===i||"span"===i){r=n.children("."+this._inlineClass);r.children().removeClass("ui-state-disabled");r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)}this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e})}},_disableDatepicker:function(t){var i,r,n=e(t),o=e.data(t,a);if(n.hasClass(this.markerClassName)){i=t.nodeName.toLowerCase();if("input"===i){t.disabled=!0;o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else if("div"===i||"span"===i){r=n.children("."+this._inlineClass);r.children().addClass("ui-state-disabled");r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)}this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e});this._disabledInputs[this._disabledInputs.length]=t}},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,a)}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(i,r,o){var a,s,l,h,c=this._getInst(i);if(2===arguments.length&&"string"==typeof r)return"defaults"===r?e.extend({},e.datepicker._defaults):c?"all"===r?e.extend({},c.settings):this._get(c,r):null;a=r||{};if("string"==typeof r){a={};a[r]=o}if(c){if(this._curInst===c)this._hideDatepicker();s=this._getDateDatepicker(i,!0);l=this._getMinMaxDate(c,"min");h=this._getMinMaxDate(c,"max");n(c.settings,a);if(null!==l&&a.dateFormat!==t&&a.minDate===t)c.settings.minDate=this._formatDate(c,l);if(null!==h&&a.dateFormat!==t&&a.maxDate===t)c.settings.maxDate=this._formatDate(c,h);if("disabled"in a)if(a.disabled)this._disableDatepicker(i);else this._enableDatepicker(i);this._attachments(e(i),c);this._autoSize(c);this._setDate(c,s);this._updateAlternate(c);this._updateDatepicker(c)}},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);if(t)this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);if(i){this._setDate(i,t);this._updateDatepicker(i);this._updateAlternate(i)}},_getDateDatepicker:function(e,t){var i=this._getInst(e);if(i&&!i.inline)this._setDateFromField(i,t);return i?this._getDate(i):null},_doKeyDown:function(t){var i,r,n,o=e.datepicker._getInst(t.target),a=!0,s=o.dpDiv.is(".ui-datepicker-rtl");o._keyEvent=!0;if(e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker();a=!1;break;case 13:n=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",o.dpDiv);if(n[0])e.datepicker._selectDay(t.target,o.selectedMonth,o.selectedYear,n[0]);i=e.datepicker._get(o,"onSelect");if(i){r=e.datepicker._formatDate(o);i.apply(o.input?o.input[0]:null,[r,o])}else e.datepicker._hideDatepicker();return!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(o,"stepBigMonths"):-e.datepicker._get(o,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(o,"stepBigMonths"):+e.datepicker._get(o,"stepMonths"),"M");break;case 35:if(t.ctrlKey||t.metaKey)e.datepicker._clearDate(t.target);a=t.ctrlKey||t.metaKey;break;case 36:if(t.ctrlKey||t.metaKey)e.datepicker._gotoToday(t.target);a=t.ctrlKey||t.metaKey;break;case 37:if(t.ctrlKey||t.metaKey)e.datepicker._adjustDate(t.target,s?1:-1,"D");a=t.ctrlKey||t.metaKey;if(t.originalEvent.altKey)e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(o,"stepBigMonths"):-e.datepicker._get(o,"stepMonths"),"M");break;case 38:if(t.ctrlKey||t.metaKey)e.datepicker._adjustDate(t.target,-7,"D");a=t.ctrlKey||t.metaKey;break;case 39:if(t.ctrlKey||t.metaKey)e.datepicker._adjustDate(t.target,s?-1:1,"D");a=t.ctrlKey||t.metaKey;if(t.originalEvent.altKey)e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(o,"stepBigMonths"):+e.datepicker._get(o,"stepMonths"),"M");break;case 40:if(t.ctrlKey||t.metaKey)e.datepicker._adjustDate(t.target,7,"D");a=t.ctrlKey||t.metaKey;break;default:a=!1}else if(36===t.keyCode&&t.ctrlKey)e.datepicker._showDatepicker(this);else a=!1;if(a){t.preventDefault();t.stopPropagation()}},_doKeyPress:function(t){var i,r,n=e.datepicker._getInst(t.target);if(e.datepicker._get(n,"constrainInput")){i=e.datepicker._possibleChars(e.datepicker._get(n,"dateFormat"));r=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode);return t.ctrlKey||t.metaKey||" ">r||!i||i.indexOf(r)>-1}},_doKeyUp:function(t){var i,r=e.datepicker._getInst(t.target);if(r.input.val()!==r.lastVal)try{i=e.datepicker.parseDate(e.datepicker._get(r,"dateFormat"),r.input?r.input.val():null,e.datepicker._getFormatConfig(r));if(i){e.datepicker._setDateFromField(r);e.datepicker._updateAlternate(r);e.datepicker._updateDatepicker(r)}}catch(n){}return!0},_showDatepicker:function(t){t=t.target||t;if("input"!==t.nodeName.toLowerCase())t=e("input",t.parentNode)[0];if(!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var i,r,o,a,s,l,h;i=e.datepicker._getInst(t);if(e.datepicker._curInst&&e.datepicker._curInst!==i){e.datepicker._curInst.dpDiv.stop(!0,!0);if(i&&e.datepicker._datepickerShowing)e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])}r=e.datepicker._get(i,"beforeShow");o=r?r.apply(t,[t,i]):{};if(o!==!1){n(i.settings,o);i.lastVal=null;e.datepicker._lastInput=t;e.datepicker._setDateFromField(i);if(e.datepicker._inDialog)t.value="";if(!e.datepicker._pos){e.datepicker._pos=e.datepicker._findPos(t);e.datepicker._pos[1]+=t.offsetHeight}a=!1;e(t).parents().each(function(){a|="fixed"===e(this).css("position");return!a});s={left:e.datepicker._pos[0],top:e.datepicker._pos[1]};e.datepicker._pos=null;i.dpDiv.empty();i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});e.datepicker._updateDatepicker(i);s=e.datepicker._checkOffset(i,s,a);i.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":a?"fixed":"absolute",display:"none",left:s.left+"px",top:s.top+"px"});if(!i.inline){l=e.datepicker._get(i,"showAnim");h=e.datepicker._get(i,"duration");i.dpDiv.zIndex(e(t).zIndex()+1);e.datepicker._datepickerShowing=!0;if(e.effects&&e.effects.effect[l])i.dpDiv.show(l,e.datepicker._get(i,"showOptions"),h);else i.dpDiv[l||"show"](l?h:null);if(e.datepicker._shouldFocusInput(i))i.input.focus();e.datepicker._curInst=i}}}},_updateDatepicker:function(t){this.maxRows=4;o=t;t.dpDiv.empty().append(this._generateHTML(t));this._attachHandlers(t);t.dpDiv.find("."+this._dayOverClass+" a").mouseover();var i,r=this._getNumberOfMonths(t),n=r[1],a=17;t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(n>1)t.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",a*n+"em");t.dpDiv[(1!==r[0]||1!==r[1]?"add":"remove")+"Class"]("ui-datepicker-multi");t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t))t.input.focus();if(t.yearshtml){i=t.yearshtml;setTimeout(function(){if(i===t.yearshtml&&t.yearshtml)t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml);i=t.yearshtml=null},0)}},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,i,r){var n=t.dpDiv.outerWidth(),o=t.dpDiv.outerHeight(),a=t.input?t.input.outerWidth():0,s=t.input?t.input.outerHeight():0,l=document.documentElement.clientWidth+(r?0:e(document).scrollLeft()),h=document.documentElement.clientHeight+(r?0:e(document).scrollTop());i.left-=this._get(t,"isRTL")?n-a:0;i.left-=r&&i.left===t.input.offset().left?e(document).scrollLeft():0;i.top-=r&&i.top===t.input.offset().top+s?e(document).scrollTop():0;i.left-=Math.min(i.left,i.left+n>l&&l>n?Math.abs(i.left+n-l):0);i.top-=Math.min(i.top,i.top+o>h&&h>o?Math.abs(o+s):0);return i},_findPos:function(t){var i,r=this._getInst(t),n=this._get(r,"isRTL");for(;t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];i=e(t).offset();return[i.left,i.top]},_hideDatepicker:function(t){var i,r,n,o,s=this._curInst;if(s&&(!t||s===e.data(t,a)))if(this._datepickerShowing){i=this._get(s,"showAnim");r=this._get(s,"duration");n=function(){e.datepicker._tidyDialog(s)};if(e.effects&&(e.effects.effect[i]||e.effects[i]))s.dpDiv.hide(i,e.datepicker._get(s,"showOptions"),r,n);else s.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?r:null,n);if(!i)n();this._datepickerShowing=!1;o=this._get(s,"onClose");if(o)o.apply(s.input?s.input[0]:null,[s.input?s.input.val():"",s]);this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if(e.blockUI){e.unblockUI();e("body").append(this.dpDiv)}}this._inDialog=!1}},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),r=e.datepicker._getInst(i[0]);if(i[0].id!==e.datepicker._mainDivId&&0===i.parents("#"+e.datepicker._mainDivId).length&&!i.hasClass(e.datepicker.markerClassName)&&!i.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||i.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==r)e.datepicker._hideDatepicker()}},_adjustDate:function(t,i,r){var n=e(t),o=this._getInst(n[0]);if(!this._isDisabledDatepicker(n[0])){this._adjustInstDate(o,i+("M"===r?this._get(o,"showCurrentAtPos"):0),r);this._updateDatepicker(o)}},_gotoToday:function(t){var i,r=e(t),n=this._getInst(r[0]);if(this._get(n,"gotoCurrent")&&n.currentDay){n.selectedDay=n.currentDay;n.drawMonth=n.selectedMonth=n.currentMonth;n.drawYear=n.selectedYear=n.currentYear}else{i=new Date;n.selectedDay=i.getDate();n.drawMonth=n.selectedMonth=i.getMonth();n.drawYear=n.selectedYear=i.getFullYear()}this._notifyChange(n);this._adjustDate(r)},_selectMonthYear:function(t,i,r){var n=e(t),o=this._getInst(n[0]);o["selected"+("M"===r?"Month":"Year")]=o["draw"+("M"===r?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10);this._notifyChange(o);this._adjustDate(n)},_selectDay:function(t,i,r,n){var o,a=e(t);if(!e(n).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(a[0])){o=this._getInst(a[0]);o.selectedDay=o.currentDay=e("a",n).html();o.selectedMonth=o.currentMonth=i;o.selectedYear=o.currentYear=r;this._selectDate(t,this._formatDate(o,o.currentDay,o.currentMonth,o.currentYear))}},_clearDate:function(t){var i=e(t);this._selectDate(i,"")},_selectDate:function(t,i){var r,n=e(t),o=this._getInst(n[0]);i=null!=i?i:this._formatDate(o);if(o.input)o.input.val(i);this._updateAlternate(o);r=this._get(o,"onSelect");if(r)r.apply(o.input?o.input[0]:null,[i,o]);else if(o.input)o.input.trigger("change");if(o.inline)this._updateDatepicker(o);else{this._hideDatepicker();this._lastInput=o.input[0];if("object"!=typeof o.input[0])o.input.focus();this._lastInput=null}},_updateAlternate:function(t){var i,r,n,o=this._get(t,"altField");if(o){i=this._get(t,"altFormat")||this._get(t,"dateFormat");r=this._getDate(t);n=this.formatDate(i,r,this._getFormatConfig(t));
e(o).each(function(){e(this).val(n)})}},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());i.setDate(i.getDate()+4-(i.getDay()||7));t=i.getTime();i.setMonth(0);i.setDate(1);return Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(t,i,r){if(null==t||null==i)throw"Invalid arguments";i="object"==typeof i?i.toString():i+"";if(""===i)return null;var n,o,a,s,l=0,h=(r?r.shortYearCutoff:null)||this._defaults.shortYearCutoff,c="string"!=typeof h?h:(new Date).getFullYear()%100+parseInt(h,10),u=(r?r.dayNamesShort:null)||this._defaults.dayNamesShort,f=(r?r.dayNames:null)||this._defaults.dayNames,d=(r?r.monthNamesShort:null)||this._defaults.monthNamesShort,p=(r?r.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,E=-1,y=!1,T=function(e){var i=n+1<t.length&&t.charAt(n+1)===e;if(i)n++;return i},_=function(e){var t=T(e),r="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,n=new RegExp("^\\d{1,"+r+"}"),o=i.substring(l).match(n);if(!o)throw"Missing number at position "+l;l+=o[0].length;return parseInt(o[0],10)},b=function(t,r,n){var o=-1,a=e.map(T(t)?n:r,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});e.each(a,function(e,t){var r=t[1];if(i.substr(l,r.length).toLowerCase()===r.toLowerCase()){o=t[0];l+=r.length;return!1}});if(-1!==o)return o+1;else throw"Unknown name at position "+l},x=function(){if(i.charAt(l)!==t.charAt(n))throw"Unexpected literal at position "+l;l++};for(n=0;n<t.length;n++)if(y)if("'"===t.charAt(n)&&!T("'"))y=!1;else x();else switch(t.charAt(n)){case"d":v=_("d");break;case"D":b("D",u,f);break;case"o":E=_("o");break;case"m":g=_("m");break;case"M":g=b("M",d,p);break;case"y":m=_("y");break;case"@":s=new Date(_("@"));m=s.getFullYear();g=s.getMonth()+1;v=s.getDate();break;case"!":s=new Date((_("!")-this._ticksTo1970)/1e4);m=s.getFullYear();g=s.getMonth()+1;v=s.getDate();break;case"'":if(T("'"))x();else y=!0;break;default:x()}if(l<i.length){a=i.substr(l);if(!/^\s+/.test(a))throw"Extra/unparsed characters found in date: "+a}if(-1===m)m=(new Date).getFullYear();else if(100>m)m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c>=m?0:-100);if(E>-1){g=1;v=E;for(;;){o=this._getDaysInMonth(m,g-1);if(o>=v)break;g++;v-=o}}s=this._daylightSavingAdjust(new Date(m,g-1,v));if(s.getFullYear()!==m||s.getMonth()+1!==g||s.getDate()!==v)throw"Invalid date";return s},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,i){if(!t)return"";var r,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,o=(i?i.dayNames:null)||this._defaults.dayNames,a=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,s=(i?i.monthNames:null)||this._defaults.monthNames,l=function(t){var i=r+1<e.length&&e.charAt(r+1)===t;if(i)r++;return i},h=function(e,t,i){var r=""+t;if(l(e))for(;r.length<i;)r="0"+r;return r},c=function(e,t,i,r){return l(e)?r[t]:i[t]},u="",f=!1;if(t)for(r=0;r<e.length;r++)if(f)if("'"===e.charAt(r)&&!l("'"))f=!1;else u+=e.charAt(r);else switch(e.charAt(r)){case"d":u+=h("d",t.getDate(),2);break;case"D":u+=c("D",t.getDay(),n,o);break;case"o":u+=h("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=h("m",t.getMonth()+1,2);break;case"M":u+=c("M",t.getMonth(),a,s);break;case"y":u+=l("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":u+=t.getTime();break;case"!":u+=1e4*t.getTime()+this._ticksTo1970;break;case"'":if(l("'"))u+="'";else f=!0;break;default:u+=e.charAt(r)}return u},_possibleChars:function(e){var t,i="",r=!1,n=function(i){var r=t+1<e.length&&e.charAt(t+1)===i;if(r)t++;return r};for(t=0;t<e.length;t++)if(r)if("'"===e.charAt(t)&&!n("'"))r=!1;else i+=e.charAt(t);else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":if(n("'"))i+="'";else r=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,i){return e.settings[i]!==t?e.settings[i]:this._defaults[i]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,n=this._getDefaultDate(e),o=n,a=this._getFormatConfig(e);try{o=this.parseDate(i,r,a)||n}catch(s){r=t?"":r}e.selectedDay=o.getDate();e.drawMonth=e.selectedMonth=o.getMonth();e.drawYear=e.selectedYear=o.getFullYear();e.currentDay=r?o.getDate():0;e.currentMonth=r?o.getMonth():0;e.currentYear=r?o.getFullYear():0;this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,i,r){var n=function(e){var t=new Date;t.setDate(t.getDate()+e);return t},o=function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),i,e.datepicker._getFormatConfig(t))}catch(r){}var n=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,o=n.getFullYear(),a=n.getMonth(),s=n.getDate(),l=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,h=l.exec(i);for(;h;){switch(h[2]||"d"){case"d":case"D":s+=parseInt(h[1],10);break;case"w":case"W":s+=7*parseInt(h[1],10);break;case"m":case"M":a+=parseInt(h[1],10);s=Math.min(s,e.datepicker._getDaysInMonth(o,a));break;case"y":case"Y":o+=parseInt(h[1],10);s=Math.min(s,e.datepicker._getDaysInMonth(o,a))}h=l.exec(i)}return new Date(o,a,s)},a=null==i||""===i?r:"string"==typeof i?o(i):"number"==typeof i?isNaN(i)?r:n(i):new Date(i.getTime());a=a&&"Invalid Date"===a.toString()?r:a;if(a){a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0)}return this._daylightSavingAdjust(a)},_daylightSavingAdjust:function(e){if(!e)return null;e.setHours(e.getHours()>12?e.getHours()+2:0);return e},_setDate:function(e,t,i){var r=!t,n=e.selectedMonth,o=e.selectedYear,a=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=a.getDate();e.drawMonth=e.selectedMonth=e.currentMonth=a.getMonth();e.drawYear=e.selectedYear=e.currentYear=a.getFullYear();if((n!==e.selectedMonth||o!==e.selectedYear)&&!i)this._notifyChange(e);this._adjustInstDate(e);if(e.input)e.input.val(r?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var i=this._get(t,"stepMonths"),r="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(r,-i,"M")},next:function(){e.datepicker._adjustDate(r,+i,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(r)},selectDay:function(){e.datepicker._selectDay(r,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return!1},selectMonth:function(){e.datepicker._selectMonthYear(r,this,"M");return!1},selectYear:function(){e.datepicker._selectMonthYear(r,this,"Y");return!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,r,n,o,a,s,l,h,c,u,f,d,p,m,g,v,E,y,T,_,b,x,R,w,H,M,S,C,A,D,P,k,L,F,z,N,I,O,U=new Date,V=this._daylightSavingAdjust(new Date(U.getFullYear(),U.getMonth(),U.getDate())),B=this._get(e,"isRTL"),j=this._get(e,"showButtonPanel"),W=this._get(e,"hideIfNoPrevNext"),G=this._get(e,"navigationAsDateFormat"),X=this._getNumberOfMonths(e),Y=this._get(e,"showCurrentAtPos"),q=this._get(e,"stepMonths"),K=1!==X[0]||1!==X[1],Q=this._daylightSavingAdjust(!e.currentDay?new Date(9999,9,9):new Date(e.currentYear,e.currentMonth,e.currentDay)),Z=this._getMinMaxDate(e,"min"),$=this._getMinMaxDate(e,"max"),J=e.drawMonth-Y,et=e.drawYear;if(0>J){J+=12;et--}if($){t=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-X[0]*X[1]+1,$.getDate()));t=Z&&Z>t?Z:t;for(;this._daylightSavingAdjust(new Date(et,J,1))>t;){J--;if(0>J){J=11;et--}}}e.drawMonth=J;e.drawYear=et;i=this._get(e,"prevText");i=!G?i:this.formatDate(i,this._daylightSavingAdjust(new Date(et,J-q,1)),this._getFormatConfig(e));r=this._canAdjustMonth(e,-1,et,J)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"e":"w")+"'>"+i+"</span></a>":W?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"e":"w")+"'>"+i+"</span></a>";n=this._get(e,"nextText");n=!G?n:this.formatDate(n,this._daylightSavingAdjust(new Date(et,J+q,1)),this._getFormatConfig(e));o=this._canAdjustMonth(e,1,et,J)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"w":"e")+"'>"+n+"</span></a>":W?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"w":"e")+"'>"+n+"</span></a>";a=this._get(e,"currentText");s=this._get(e,"gotoCurrent")&&e.currentDay?Q:V;a=!G?a:this.formatDate(a,s,this._getFormatConfig(e));l=!e.inline?"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>":"";h=j?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(B?l:"")+(this._isInRange(e,s)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+a+"</button>":"")+(B?"":l)+"</div>":"";c=parseInt(this._get(e,"firstDay"),10);c=isNaN(c)?0:c;u=this._get(e,"showWeek");f=this._get(e,"dayNames");d=this._get(e,"dayNamesMin");p=this._get(e,"monthNames");m=this._get(e,"monthNamesShort");g=this._get(e,"beforeShowDay");v=this._get(e,"showOtherMonths");E=this._get(e,"selectOtherMonths");y=this._getDefaultDate(e);T="";for(b=0;b<X[0];b++){x="";this.maxRows=4;for(R=0;R<X[1];R++){w=this._daylightSavingAdjust(new Date(et,J,e.selectedDay));H=" ui-corner-all";M="";if(K){M+="<div class='ui-datepicker-group";if(X[1]>1)switch(R){case 0:M+=" ui-datepicker-group-first";H=" ui-corner-"+(B?"right":"left");break;case X[1]-1:M+=" ui-datepicker-group-last";H=" ui-corner-"+(B?"left":"right");break;default:M+=" ui-datepicker-group-middle";H=""}M+="'>"}M+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+H+"'>"+(/all|left/.test(H)&&0===b?B?o:r:"")+(/all|right/.test(H)&&0===b?B?r:o:"")+this._generateMonthYearHeader(e,J,et,Z,$,b>0||R>0,p,m)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>";S=u?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"";for(_=0;7>_;_++){C=(_+c)%7;S+="<th"+((_+c+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+f[C]+"'>"+d[C]+"</span></th>"}M+=S+"</tr></thead><tbody>";A=this._getDaysInMonth(et,J);if(et===e.selectedYear&&J===e.selectedMonth)e.selectedDay=Math.min(e.selectedDay,A);D=(this._getFirstDayOfMonth(et,J)-c+7)%7;P=Math.ceil((D+A)/7);k=K?this.maxRows>P?this.maxRows:P:P;this.maxRows=k;L=this._daylightSavingAdjust(new Date(et,J,1-D));for(F=0;k>F;F++){M+="<tr>";z=!u?"":"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(L)+"</td>";for(_=0;7>_;_++){N=g?g.apply(e.input?e.input[0]:null,[L]):[!0,""];I=L.getMonth()!==J;O=I&&!E||!N[0]||Z&&Z>L||$&&L>$;z+="<td class='"+((_+c+6)%7>=5?" ui-datepicker-week-end":"")+(I?" ui-datepicker-other-month":"")+(L.getTime()===w.getTime()&&J===e.selectedMonth&&e._keyEvent||y.getTime()===L.getTime()&&y.getTime()===w.getTime()?" "+this._dayOverClass:"")+(O?" "+this._unselectableClass+" ui-state-disabled":"")+(I&&!v?"":" "+N[1]+(L.getTime()===Q.getTime()?" "+this._currentClass:"")+(L.getTime()===V.getTime()?" ui-datepicker-today":""))+"'"+((!I||v)&&N[2]?" title='"+N[2].replace(/'/g,"&#39;")+"'":"")+(O?"":" data-handler='selectDay' data-event='click' data-month='"+L.getMonth()+"' data-year='"+L.getFullYear()+"'")+">"+(I&&!v?"&#xa0;":O?"<span class='ui-state-default'>"+L.getDate()+"</span>":"<a class='ui-state-default"+(L.getTime()===V.getTime()?" ui-state-highlight":"")+(L.getTime()===Q.getTime()?" ui-state-active":"")+(I?" ui-priority-secondary":"")+"' href='#'>"+L.getDate()+"</a>")+"</td>";L.setDate(L.getDate()+1);L=this._daylightSavingAdjust(L)}M+=z+"</tr>"}J++;if(J>11){J=0;et++}M+="</tbody></table>"+(K?"</div>"+(X[0]>0&&R===X[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"");x+=M}T+=x}T+=h;e._keyEvent=!1;return T},_generateMonthYearHeader:function(e,t,i,r,n,o,a,s){var l,h,c,u,f,d,p,m,g=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),E=this._get(e,"showMonthAfterYear"),y="<div class='ui-datepicker-title'>",T="";if(o||!g)T+="<span class='ui-datepicker-month'>"+a[t]+"</span>";else{l=r&&r.getFullYear()===i;h=n&&n.getFullYear()===i;T+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(c=0;12>c;c++)if((!l||c>=r.getMonth())&&(!h||c<=n.getMonth()))T+="<option value='"+c+"'"+(c===t?" selected='selected'":"")+">"+s[c]+"</option>";T+="</select>"}if(!E)y+=T+(o||!g||!v?"&#xa0;":"");if(!e.yearshtml){e.yearshtml="";if(o||!v)y+="<span class='ui-datepicker-year'>"+i+"</span>";else{u=this._get(e,"yearRange").split(":");f=(new Date).getFullYear();d=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?f+parseInt(e,10):parseInt(e,10);return isNaN(t)?f:t};p=d(u[0]);m=Math.max(p,d(u[1]||""));p=r?Math.max(p,r.getFullYear()):p;m=n?Math.min(m,n.getFullYear()):m;e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";for(;m>=p;p++)e.yearshtml+="<option value='"+p+"'"+(p===i?" selected='selected'":"")+">"+p+"</option>";e.yearshtml+="</select>";y+=e.yearshtml;e.yearshtml=null}}y+=this._get(e,"yearSuffix");if(E)y+=(o||!g||!v?"&#xa0;":"")+T;y+="</div>";return y},_adjustInstDate:function(e,t,i){var r=e.drawYear+("Y"===i?t:0),n=e.drawMonth+("M"===i?t:0),o=Math.min(e.selectedDay,this._getDaysInMonth(r,n))+("D"===i?t:0),a=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,n,o)));e.selectedDay=a.getDate();e.drawMonth=e.selectedMonth=a.getMonth();e.drawYear=e.selectedYear=a.getFullYear();if("M"===i||"Y"===i)this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),n=i&&i>t?i:t;return r&&n>r?r:n},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");if(t)t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,r){var n=this._getNumberOfMonths(e),o=this._daylightSavingAdjust(new Date(i,r+(0>t?t:n[0]*n[1]),1));if(0>t)o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth()));return this._isInRange(e,o)},_isInRange:function(e,t){var i,r,n=this._getMinMaxDate(e,"min"),o=this._getMinMaxDate(e,"max"),a=null,s=null,l=this._get(e,"yearRange");if(l){i=l.split(":");r=(new Date).getFullYear();a=parseInt(i[0],10);s=parseInt(i[1],10);if(i[0].match(/[+\-].*/))a+=r;if(i[1].match(/[+\-].*/))s+=r}return(!n||t.getTime()>=n.getTime())&&(!o||t.getTime()<=o.getTime())&&(!a||t.getFullYear()>=a)&&(!s||t.getFullYear()<=s)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10);return{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,r){if(!t){e.currentDay=e.selectedDay;e.currentMonth=e.selectedMonth;e.currentYear=e.selectedYear}var n=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(r,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),n,this._getFormatConfig(e))}});e.fn.datepicker=function(t){if(!this.length)return this;if(!e.datepicker.initialized){e(document).mousedown(e.datepicker._checkExternalClick);e.datepicker.initialized=!0}if(0===e("#"+e.datepicker._mainDivId).length)e("body").append(e.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);if("string"==typeof t&&("isDisabled"===t||"getDate"===t||"widget"===t))return e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i));if("option"===t&&2===arguments.length&&"string"==typeof arguments[1])return e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i));else return this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)})};e.datepicker=new i;e.datepicker.initialized=!1;e.datepicker.uuid=(new Date).getTime();e.datepicker.version="1.10.3"}(jQuery);!function(e){var t={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},i={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};e.widget("ui.dialog",{version:"1.10.3",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var i=e(this).css(t).offset().top;if(0>i)e(this).css("top",t.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height};this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};this.originalTitle=this.element.attr("title");this.options.title=this.options.title||this.originalTitle;this._createWrapper();this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog);this._createTitlebar();this._createButtonPane();if(this.options.draggable&&e.fn.draggable)this._makeDraggable();if(this.options.resizable&&e.fn.resizable)this._makeResizable();this._isOpen=!1},_init:function(){if(this.options.autoOpen)this.open()},_appendTo:function(){var t=this.options.appendTo;if(t&&(t.jquery||t.nodeType))return e(t);else return this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay();this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach();this.uiDialog.stop(!0,!0).remove();if(this.originalTitle)this.element.attr("title",this.originalTitle);e=t.parent.children().eq(t.index);if(e.length&&e[0]!==this.element[0])e.before(this.element);else t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var i=this;if(this._isOpen&&this._trigger("beforeClose",t)!==!1){this._isOpen=!1;this._destroyOverlay();if(!this.opener.filter(":focusable").focus().length)e(this.document[0].activeElement).blur();this._hide(this.uiDialog,this.options.hide,function(){i._trigger("close",t)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,t){var i=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;if(i&&!t)this._trigger("focus",e);return i},open:function(){var t=this;if(!this._isOpen){this._isOpen=!0;this.opener=e(this.document[0].activeElement);this._size();this._position();this._createOverlay();this._moveToTop(null,!0);this._show(this.uiDialog,this.options.show,function(){t._focusTabbable();t._trigger("focus")});this._trigger("open")}else if(this._moveToTop())this._focusTabbable()},_focusTabbable:function(){var e=this.element.find("[autofocus]");if(!e.length)e=this.element.find(":tabbable");if(!e.length)e=this.uiDialogButtonPane.find(":tabbable");if(!e.length)e=this.uiDialogTitlebarClose.filter(":tabbable");if(!e.length)e=this.uiDialog;e.eq(0).focus()},_keepFocus:function(t){function i(){var t=this.document[0].activeElement,i=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);if(!i)this._focusTabbable()}t.preventDefault();i.call(this);this._delay(i)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo());this._on(this.uiDialog,{keydown:function(t){if(!this.options.closeOnEscape||t.isDefaultPrevented()||!t.keyCode||t.keyCode!==e.ui.keyCode.ESCAPE){if(t.keyCode===e.ui.keyCode.TAB){var i=this.uiDialog.find(":tabbable"),r=i.filter(":first"),n=i.filter(":last");if((t.target===n[0]||t.target===this.uiDialog[0])&&!t.shiftKey){r.focus(1);t.preventDefault()}else if((t.target===r[0]||t.target===this.uiDialog[0])&&t.shiftKey){n.focus(1);t.preventDefault()}}}else{t.preventDefault();this.close(t)}},mousedown:function(e){if(this._moveToTop(e))this._focusTabbable()}});if(!this.element.find("[aria-describedby]").length)this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog);this._on(this.uiDialogTitlebar,{mousedown:function(t){if(!e(t.target).closest(".ui-dialog-titlebar-close"))this.uiDialog.focus()}});this.uiDialogTitlebarClose=e("<button></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar);this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault();this.close(e)}});t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar);this._title(t);this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){if(!this.options.title)e.html("&#160;");e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane);this._createButtons()},_createButtons:function(){var t=this,i=this.options.buttons;this.uiDialogButtonPane.remove();this.uiButtonSet.empty();if(!(e.isEmptyObject(i)||e.isArray(i)&&!i.length)){e.each(i,function(i,r){var n,o;r=e.isFunction(r)?{click:r,text:i}:r;r=e.extend({type:"button"},r);n=r.click;r.click=function(){n.apply(t.element[0],arguments)};o={icons:r.icons,text:r.showText};delete r.icons;delete r.showText;e("<button></button>",r).button(o).appendTo(t.uiButtonSet)});this.uiDialog.addClass("ui-dialog-buttons");this.uiDialogButtonPane.appendTo(this.uiDialog)}else this.uiDialog.removeClass("ui-dialog-buttons")},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var i=this,r=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(r,n){e(this).addClass("ui-dialog-dragging");i._blockFrames();i._trigger("dragStart",r,t(n))},drag:function(e,r){i._trigger("drag",e,t(r))},stop:function(n,o){r.position=[o.position.left-i.document.scrollLeft(),o.position.top-i.document.scrollTop()];e(this).removeClass("ui-dialog-dragging");i._unblockFrames();i._trigger("dragStop",n,t(o))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var i=this,r=this.options,n=r.resizable,o=this.uiDialog.css("position"),a="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:r.maxWidth,maxHeight:r.maxHeight,minWidth:r.minWidth,minHeight:this._minHeight(),handles:a,start:function(r,n){e(this).addClass("ui-dialog-resizing");i._blockFrames();i._trigger("resizeStart",r,t(n))},resize:function(e,r){i._trigger("resize",e,t(r))},stop:function(n,o){r.height=e(this).height();r.width=e(this).width();e(this).removeClass("ui-dialog-resizing");i._unblockFrames();i._trigger("resizeStop",n,t(o))}}).css("position",o)},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");if(!e)this.uiDialog.show();this.uiDialog.position(this.options.position);if(!e)this.uiDialog.hide()},_setOptions:function(r){var n=this,o=!1,a={};e.each(r,function(e,r){n._setOption(e,r);if(e in t)o=!0;if(e in i)a[e]=r});if(o){this._size();this._position()}if(this.uiDialog.is(":data(ui-resizable)"))this.uiDialog.resizable("option",a)},_setOption:function(e,t){var i,r,n=this.uiDialog;if("dialogClass"===e)n.removeClass(this.options.dialogClass).addClass(t);if("disabled"!==e){this._super(e,t);if("appendTo"===e)this.uiDialog.appendTo(this._appendTo());if("buttons"===e)this._createButtons();if("closeText"===e)this.uiDialogTitlebarClose.button({label:""+t});if("draggable"===e){i=n.is(":data(ui-draggable)");if(i&&!t)n.draggable("destroy");if(!i&&t)this._makeDraggable()}if("position"===e)this._position();if("resizable"===e){r=n.is(":data(ui-resizable)");if(r&&!t)n.resizable("destroy");if(r&&"string"==typeof t)n.resizable("option","handles",t);if(!r&&t!==!1)this._makeResizable()}if("title"===e)this._title(this.uiDialogTitlebar.find(".ui-dialog-title"))}},_size:function(){var e,t,i,r=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0});if(r.minWidth>r.width)r.width=r.minWidth;e=this.uiDialog.css({height:"auto",width:r.width}).outerHeight();t=Math.max(0,r.minHeight-e);i="number"==typeof r.maxHeight?Math.max(0,r.maxHeight-e):"none";if("auto"===r.height)this.element.css({minHeight:t,maxHeight:i,height:"auto"});else this.element.height(Math.max(0,r.height-e));if(this.uiDialog.is(":data(ui-resizable)"))this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks}},_allowInteraction:function(t){if(e(t.target).closest(".ui-dialog").length)return!0;else return!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=this,i=this.widgetFullName;if(!e.ui.dialog.overlayInstances)this._delay(function(){if(e.ui.dialog.overlayInstances)this.document.bind("focusin.dialog",function(r){if(!t._allowInteraction(r)){r.preventDefault();e(".ui-dialog:visible:last .ui-dialog-content").data(i)._focusTabbable()}})});this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo());this._on(this.overlay,{mousedown:"_keepFocus"});e.ui.dialog.overlayInstances++}},_destroyOverlay:function(){if(this.options.modal)if(this.overlay){e.ui.dialog.overlayInstances--;if(!e.ui.dialog.overlayInstances)this.document.unbind("focusin.dialog");this.overlay.remove();this.overlay=null}}});e.ui.dialog.overlayInstances=0;if(e.uiBackCompat!==!1)e.widget("ui.dialog",e.ui.dialog,{_position:function(){var t,i=this.options.position,r=[],n=[0,0];if(i){if("string"==typeof i||"object"==typeof i&&"0"in i){r=i.split?i.split(" "):[i[0],i[1]];if(1===r.length)r[1]=r[0];e.each(["left","top"],function(e,t){if(+r[e]===r[e]){n[e]=r[e];r[e]=t}});i={my:r[0]+(n[0]<0?n[0]:"+"+n[0])+" "+r[1]+(n[1]<0?n[1]:"+"+n[1]),at:r.join(" ")}}i=e.extend({},e.ui.dialog.prototype.options.position,i)}else i=e.ui.dialog.prototype.options.position;t=this.uiDialog.is(":visible");if(!t)this.uiDialog.show();this.uiDialog.position(i);if(!t)this.uiDialog.hide()}})}(jQuery);!function(e){var t=/up|down|vertical/,i=/up|left|vertical|horizontal/;e.effects.effect.blind=function(r,n){var o,a,s,l=e(this),h=["position","top","bottom","left","right","height","width"],c=e.effects.setMode(l,r.mode||"hide"),u=r.direction||"up",f=t.test(u),d=f?"height":"width",p=f?"top":"left",m=i.test(u),g={},v="show"===c;if(l.parent().is(".ui-effects-wrapper"))e.effects.save(l.parent(),h);else e.effects.save(l,h);l.show();o=e.effects.createWrapper(l).css({overflow:"hidden"});a=o[d]();s=parseFloat(o.css(p))||0;g[d]=v?a:0;if(!m){l.css(f?"bottom":"right",0).css(f?"top":"left","auto").css({position:"absolute"});g[p]=v?s:a+s}if(v){o.css(d,0);if(!m)o.css(p,s+a)}o.animate(g,{duration:r.duration,easing:r.easing,queue:!1,complete:function(){if("hide"===c)l.hide();e.effects.restore(l,h);e.effects.removeWrapper(l);n()}})}}(jQuery);!function(e){e.effects.effect.bounce=function(t,i){var r,n,o,a=e(this),s=["position","top","bottom","left","right","height","width"],l=e.effects.setMode(a,t.mode||"effect"),h="hide"===l,c="show"===l,u=t.direction||"up",f=t.distance,d=t.times||5,p=2*d+(c||h?1:0),m=t.duration/p,g=t.easing,v="up"===u||"down"===u?"top":"left",E="up"===u||"left"===u,y=a.queue(),T=y.length;if(c||h)s.push("opacity");e.effects.save(a,s);a.show();e.effects.createWrapper(a);if(!f)f=a["top"===v?"outerHeight":"outerWidth"]()/3;if(c){o={opacity:1};o[v]=0;a.css("opacity",0).css(v,E?2*-f:2*f).animate(o,m,g)}if(h)f/=Math.pow(2,d-1);o={};o[v]=0;for(r=0;d>r;r++){n={};n[v]=(E?"-=":"+=")+f;a.animate(n,m,g).animate(o,m,g);f=h?2*f:f/2}if(h){n={opacity:0};n[v]=(E?"-=":"+=")+f;a.animate(n,m,g)}a.queue(function(){if(h)a.hide();e.effects.restore(a,s);e.effects.removeWrapper(a);i()});if(T>1)y.splice.apply(y,[1,0].concat(y.splice(T,p+1)));a.dequeue()}}(jQuery);!function(e){e.effects.effect.clip=function(t,i){var r,n,o,a=e(this),s=["position","top","bottom","left","right","height","width"],l=e.effects.setMode(a,t.mode||"hide"),h="show"===l,c=t.direction||"vertical",u="vertical"===c,f=u?"height":"width",d=u?"top":"left",p={};e.effects.save(a,s);a.show();r=e.effects.createWrapper(a).css({overflow:"hidden"});n="IMG"===a[0].tagName?r:a;o=n[f]();if(h){n.css(f,0);n.css(d,o/2)}p[f]=h?o:0;p[d]=h?0:o/2;n.animate(p,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){if(!h)a.hide();e.effects.restore(a,s);e.effects.removeWrapper(a);i()}})}}(jQuery);!function(e){e.effects.effect.drop=function(t,i){var r,n=e(this),o=["position","top","bottom","left","right","opacity","height","width"],a=e.effects.setMode(n,t.mode||"hide"),s="show"===a,l=t.direction||"left",h="up"===l||"down"===l?"top":"left",c="up"===l||"left"===l?"pos":"neg",u={opacity:s?1:0};e.effects.save(n,o);n.show();e.effects.createWrapper(n);r=t.distance||n["top"===h?"outerHeight":"outerWidth"](!0)/2;if(s)n.css("opacity",0).css(h,"pos"===c?-r:r);u[h]=(s?"pos"===c?"+=":"-=":"pos"===c?"-=":"+=")+r;n.animate(u,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){if("hide"===a)n.hide();e.effects.restore(n,o);e.effects.removeWrapper(n);i()}})}}(jQuery);!function(e){e.effects.effect.explode=function(t,i){function r(){y.push(this);if(y.length===u*f)n()}function n(){d.css({visibility:"visible"});e(y).remove();if(!m)d.hide();i()}var o,a,s,l,h,c,u=t.pieces?Math.round(Math.sqrt(t.pieces)):3,f=u,d=e(this),p=e.effects.setMode(d,t.mode||"hide"),m="show"===p,g=d.show().css("visibility","hidden").offset(),v=Math.ceil(d.outerWidth()/f),E=Math.ceil(d.outerHeight()/u),y=[];for(o=0;u>o;o++){l=g.top+o*E;c=o-(u-1)/2;for(a=0;f>a;a++){s=g.left+a*v;h=a-(f-1)/2;d.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-a*v,top:-o*E}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:E,left:s+(m?h*v:0),top:l+(m?c*E:0),opacity:m?0:1}).animate({left:s+(m?0:h*v),top:l+(m?0:c*E),opacity:m?1:0},t.duration||500,t.easing,r)
}}}}(jQuery);!function(e){e.effects.effect.fade=function(t,i){var r=e(this),n=e.effects.setMode(r,t.mode||"toggle");r.animate({opacity:n},{queue:!1,duration:t.duration,easing:t.easing,complete:i})}}(jQuery);!function(e){e.effects.effect.fold=function(t,i){var r,n,o=e(this),a=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(o,t.mode||"hide"),l="show"===s,h="hide"===s,c=t.size||15,u=/([0-9]+)%/.exec(c),f=!!t.horizFirst,d=l!==f,p=d?["width","height"]:["height","width"],m=t.duration/2,g={},v={};e.effects.save(o,a);o.show();r=e.effects.createWrapper(o).css({overflow:"hidden"});n=d?[r.width(),r.height()]:[r.height(),r.width()];if(u)c=parseInt(u[1],10)/100*n[h?0:1];if(l)r.css(f?{height:0,width:c}:{height:c,width:0});g[p[0]]=l?n[0]:c;v[p[1]]=l?n[1]:0;r.animate(g,m,t.easing).animate(v,m,t.easing,function(){if(h)o.hide();e.effects.restore(o,a);e.effects.removeWrapper(o);i()})}}(jQuery);!function(e){e.effects.effect.highlight=function(t,i){var r=e(this),n=["backgroundImage","backgroundColor","opacity"],o=e.effects.setMode(r,t.mode||"show"),a={backgroundColor:r.css("backgroundColor")};if("hide"===o)a.opacity=0;e.effects.save(r,n);r.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(a,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){if("hide"===o)r.hide();e.effects.restore(r,n);i()}})}}(jQuery);!function(e){e.effects.effect.pulsate=function(t,i){var r,n=e(this),o=e.effects.setMode(n,t.mode||"show"),a="show"===o,s="hide"===o,l=a||"hide"===o,h=2*(t.times||5)+(l?1:0),c=t.duration/h,u=0,f=n.queue(),d=f.length;if(a||!n.is(":visible")){n.css("opacity",0).show();u=1}for(r=1;h>r;r++){n.animate({opacity:u},c,t.easing);u=1-u}n.animate({opacity:u},c,t.easing);n.queue(function(){if(s)n.hide();i()});if(d>1)f.splice.apply(f,[1,0].concat(f.splice(d,h+1)));n.dequeue()}}(jQuery);!function(e){e.effects.effect.puff=function(t,i){var r=e(this),n=e.effects.setMode(r,t.mode||"hide"),o="hide"===n,a=parseInt(t.percent,10)||150,s=a/100,l={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:n,complete:i,percent:o?a:100,from:o?l:{height:l.height*s,width:l.width*s,outerHeight:l.outerHeight*s,outerWidth:l.outerWidth*s}});r.effect(t)};e.effects.effect.scale=function(t,i){var r=e(this),n=e.extend(!0,{},t),o=e.effects.setMode(r,t.mode||"effect"),a=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===o?0:100),s=t.direction||"both",l=t.origin,h={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()},c={y:"horizontal"!==s?a/100:1,x:"vertical"!==s?a/100:1};n.effect="size";n.queue=!1;n.complete=i;if("effect"!==o){n.origin=l||["middle","center"];n.restore=!0}n.from=t.from||("show"===o?{height:0,width:0,outerHeight:0,outerWidth:0}:h);n.to={height:h.height*c.y,width:h.width*c.x,outerHeight:h.outerHeight*c.y,outerWidth:h.outerWidth*c.x};if(n.fade){if("show"===o){n.from.opacity=0;n.to.opacity=1}if("hide"===o){n.from.opacity=1;n.to.opacity=0}}r.effect(n)};e.effects.effect.size=function(t,i){var r,n,o,a=e(this),s=["position","top","bottom","left","right","width","height","overflow","opacity"],l=["position","top","bottom","left","right","overflow","opacity"],h=["width","height","overflow"],c=["fontSize"],u=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],f=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],d=e.effects.setMode(a,t.mode||"effect"),p=t.restore||"effect"!==d,m=t.scale||"both",g=t.origin||["middle","center"],v=a.css("position"),E=p?s:l,y={height:0,width:0,outerHeight:0,outerWidth:0};if("show"===d)a.show();r={height:a.height(),width:a.width(),outerHeight:a.outerHeight(),outerWidth:a.outerWidth()};if("toggle"===t.mode&&"show"===d){a.from=t.to||y;a.to=t.from||r}else{a.from=t.from||("show"===d?y:r);a.to=t.to||("hide"===d?y:r)}o={from:{y:a.from.height/r.height,x:a.from.width/r.width},to:{y:a.to.height/r.height,x:a.to.width/r.width}};if("box"===m||"both"===m){if(o.from.y!==o.to.y){E=E.concat(u);a.from=e.effects.setTransition(a,u,o.from.y,a.from);a.to=e.effects.setTransition(a,u,o.to.y,a.to)}if(o.from.x!==o.to.x){E=E.concat(f);a.from=e.effects.setTransition(a,f,o.from.x,a.from);a.to=e.effects.setTransition(a,f,o.to.x,a.to)}}if("content"===m||"both"===m)if(o.from.y!==o.to.y){E=E.concat(c).concat(h);a.from=e.effects.setTransition(a,c,o.from.y,a.from);a.to=e.effects.setTransition(a,c,o.to.y,a.to)}e.effects.save(a,E);a.show();e.effects.createWrapper(a);a.css("overflow","hidden").css(a.from);if(g){n=e.effects.getBaseline(g,r);a.from.top=(r.outerHeight-a.outerHeight())*n.y;a.from.left=(r.outerWidth-a.outerWidth())*n.x;a.to.top=(r.outerHeight-a.to.outerHeight)*n.y;a.to.left=(r.outerWidth-a.to.outerWidth)*n.x}a.css(a.from);if("content"===m||"both"===m){u=u.concat(["marginTop","marginBottom"]).concat(c);f=f.concat(["marginLeft","marginRight"]);h=s.concat(u).concat(f);a.find("*[width]").each(function(){var i=e(this),r={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};if(p)e.effects.save(i,h);i.from={height:r.height*o.from.y,width:r.width*o.from.x,outerHeight:r.outerHeight*o.from.y,outerWidth:r.outerWidth*o.from.x};i.to={height:r.height*o.to.y,width:r.width*o.to.x,outerHeight:r.height*o.to.y,outerWidth:r.width*o.to.x};if(o.from.y!==o.to.y){i.from=e.effects.setTransition(i,u,o.from.y,i.from);i.to=e.effects.setTransition(i,u,o.to.y,i.to)}if(o.from.x!==o.to.x){i.from=e.effects.setTransition(i,f,o.from.x,i.from);i.to=e.effects.setTransition(i,f,o.to.x,i.to)}i.css(i.from);i.animate(i.to,t.duration,t.easing,function(){if(p)e.effects.restore(i,h)})})}a.animate(a.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){if(0===a.to.opacity)a.css("opacity",a.from.opacity);if("hide"===d)a.hide();e.effects.restore(a,E);if(!p)if("static"===v)a.css({position:"relative",top:a.to.top,left:a.to.left});else e.each(["top","left"],function(e,t){a.css(t,function(t,i){var r=parseInt(i,10),n=e?a.to.left:a.to.top;if("auto"===i)return n+"px";else return r+n+"px"})});e.effects.removeWrapper(a);i()}})}}(jQuery);!function(e){e.effects.effect.shake=function(t,i){var r,n=e(this),o=["position","top","bottom","left","right","height","width"],a=e.effects.setMode(n,t.mode||"effect"),s=t.direction||"left",l=t.distance||20,h=t.times||3,c=2*h+1,u=Math.round(t.duration/c),f="up"===s||"down"===s?"top":"left",d="up"===s||"left"===s,p={},m={},g={},v=n.queue(),E=v.length;e.effects.save(n,o);n.show();e.effects.createWrapper(n);p[f]=(d?"-=":"+=")+l;m[f]=(d?"+=":"-=")+2*l;g[f]=(d?"-=":"+=")+2*l;n.animate(p,u,t.easing);for(r=1;h>r;r++)n.animate(m,u,t.easing).animate(g,u,t.easing);n.animate(m,u,t.easing).animate(p,u/2,t.easing).queue(function(){if("hide"===a)n.hide();e.effects.restore(n,o);e.effects.removeWrapper(n);i()});if(E>1)v.splice.apply(v,[1,0].concat(v.splice(E,c+1)));n.dequeue()}}(jQuery);!function(e){e.effects.effect.slide=function(t,i){var r,n=e(this),o=["position","top","bottom","left","right","width","height"],a=e.effects.setMode(n,t.mode||"show"),s="show"===a,l=t.direction||"left",h="up"===l||"down"===l?"top":"left",c="up"===l||"left"===l,u={};e.effects.save(n,o);n.show();r=t.distance||n["top"===h?"outerHeight":"outerWidth"](!0);e.effects.createWrapper(n).css({overflow:"hidden"});if(s)n.css(h,c?isNaN(r)?"-"+r:-r:r);u[h]=(s?c?"+=":"-=":c?"-=":"+=")+r;n.animate(u,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){if("hide"===a)n.hide();e.effects.restore(n,o);e.effects.removeWrapper(n);i()}})}}(jQuery);!function(e){e.effects.effect.transfer=function(t,i){var r=e(this),n=e(t.to),o="fixed"===n.css("position"),a=e("body"),s=o?a.scrollTop():0,l=o?a.scrollLeft():0,h=n.offset(),c={top:h.top-s,left:h.left-l,height:n.innerHeight(),width:n.innerWidth()},u=r.offset(),f=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:u.top-s,left:u.left-l,height:r.innerHeight(),width:r.innerWidth(),position:o?"fixed":"absolute"}).animate(c,t.duration,t.easing,function(){f.remove();i()})}}(jQuery);!function(e){e.widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.mouseHandled=!1;this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(e){if(this.options.disabled)e.preventDefault()},this));if(this.options.disabled)this.element.addClass("ui-state-disabled").attr("aria-disabled","true");this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(t){var i=e(t.target).closest(".ui-menu-item");if(!this.mouseHandled&&i.not(".ui-state-disabled").length){this.mouseHandled=!0;this.select(t);if(i.has(".ui-menu").length)this.expand(t);else if(!this.element.is(":focus")){this.element.trigger("focus",[!0]);if(this.active&&1===this.active.parents(".ui-menu").length)clearTimeout(this.timer)}}},"mouseenter .ui-menu-item":function(t){var i=e(t.currentTarget);i.siblings().children(".ui-state-active").removeClass("ui-state-active");this.focus(t,i)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.children(".ui-menu-item").eq(0);if(!t)this.focus(e,i)},blur:function(t){this._delay(function(){if(!e.contains(this.element[0],this.document[0].activeElement))this.collapseAll(t)})},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(t){if(!e(t.target).closest(".ui-menu").length)this.collapseAll(t);this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show();this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);if(t.data("ui-menu-submenu-carat"))t.remove()});this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var r,n,o,a,s,l=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:if(this.active&&!this.active.is(".ui-state-disabled"))this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:l=!1;n=this.previousFilter||"";o=String.fromCharCode(t.keyCode);a=!1;clearTimeout(this.filterTimer);if(o===n)a=!0;else o=n+o;s=new RegExp("^"+i(o),"i");r=this.activeMenu.children(".ui-menu-item").filter(function(){return s.test(e(this).children("a").text())});r=a&&-1!==r.index(this.active.next())?this.active.nextAll(".ui-menu-item"):r;if(!r.length){o=String.fromCharCode(t.keyCode);s=new RegExp("^"+i(o),"i");r=this.activeMenu.children(".ui-menu-item").filter(function(){return s.test(e(this).children("a").text())})}if(r.length){this.focus(t,r);if(r.length>1){this.previousFilter=o;this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)}else delete this.previousFilter}else delete this.previousFilter}if(l)t.preventDefault()},_activate:function(e){if(!this.active.is(".ui-state-disabled"))if(this.active.children("a[aria-haspopup='true']").length)this.expand(e);else this.select(e)},refresh:function(){var t,i=this.options.icons.submenu,r=this.element.find(this.options.menus);r.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),r=t.prev("a"),n=e("<span>").addClass("ui-menu-icon ui-icon "+i).data("ui-menu-submenu-carat",!0);r.attr("aria-haspopup","true").prepend(n);t.attr("aria-labelledby",r.attr("id"))});t=r.add(this.element);t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()});t.children(":not(.ui-menu-item)").each(function(){var t=e(this);if(!/[^\-\u2014\u2013\s]/.test(t.text()))t.addClass("ui-widget-content ui-menu-divider")});t.children(".ui-state-disabled").attr("aria-disabled","true");if(this.active&&!e.contains(this.element[0],this.active[0]))this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){if("icons"===e)this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu);this._super(e,t)},focus:function(e,t){var i,r;this.blur(e,e&&"focus"===e.type);this._scrollIntoView(t);this.active=t.first();r=this.active.children("a").addClass("ui-state-focus");if(this.options.role)this.element.attr("aria-activedescendant",r.attr("id"));this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active");if(e&&"keydown"===e.type)this._close();else this.timer=this._delay(function(){this._close()},this.delay);i=t.children(".ui-menu");if(i.length&&/^mouse/.test(e.type))this._startOpening(i);this.activeMenu=t.parent();this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var i,r,n,o,a,s;if(this._hasScroll()){i=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0;r=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0;n=t.offset().top-this.activeMenu.offset().top-i-r;o=this.activeMenu.scrollTop();a=this.activeMenu.height();s=t.height();if(0>n)this.activeMenu.scrollTop(o+n);else if(n+s>a)this.activeMenu.scrollTop(o+n-a+s)}},blur:function(e,t){if(!t)clearTimeout(this.timer);if(this.active){this.active.children("a").removeClass("ui-state-focus");this.active=null;this._trigger("blur",e,{item:this.active})}},_startOpening:function(e){clearTimeout(this.timer);if("true"===e.attr("aria-hidden"))this.timer=this._delay(function(){this._close();this._open(e)},this.delay)},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true");t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer);this.timer=this._delay(function(){var r=i?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));if(!r.length)r=this.element;this._close(r);this.blur(t);this.activeMenu=r},this.delay)},_close:function(e){if(!e)e=this.active?this.active.parent():this.element;e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);if(t&&t.length){this._close();this.focus(e,t)}},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();if(t&&t.length){this._open(t.parent());this._delay(function(){this.focus(e,t)})}},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var r;if(this.active)if("first"===e||"last"===e)r=this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1);else r=this.active[e+"All"](".ui-menu-item").eq(0);if(!r||!r.length||!this.active)r=this.activeMenu.children(".ui-menu-item")[t]();this.focus(i,r)},nextPage:function(t){var i,r,n;if(this.active){if(!this.isLastItem())if(this._hasScroll()){r=this.active.offset().top;n=this.element.height();this.active.nextAll(".ui-menu-item").each(function(){i=e(this);return i.offset().top-r-n<0});this.focus(t,i)}else this.focus(t,this.activeMenu.children(".ui-menu-item")[!this.active?"first":"last"]())}else this.next(t)},previousPage:function(t){var i,r,n;if(this.active){if(!this.isFirstItem())if(this._hasScroll()){r=this.active.offset().top;n=this.element.height();this.active.prevAll(".ui-menu-item").each(function(){i=e(this);return i.offset().top-r+n>0});this.focus(t,i)}else this.focus(t,this.activeMenu.children(".ui-menu-item").first())}else this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var i={item:this.active};if(!this.active.has(".ui-menu").length)this.collapseAll(t,!0);this._trigger("select",t,i)}})}(jQuery);!function(e,t){function i(e,t,i){return[parseFloat(e[0])*(d.test(e[0])?t/100:1),parseFloat(e[1])*(d.test(e[1])?i/100:1)]}function r(t,i){return parseInt(e.css(t,i),10)||0}function n(t){var i=t[0];if(9===i.nodeType)return{width:t.width(),height:t.height(),offset:{top:0,left:0}};if(e.isWindow(i))return{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}};if(i.preventDefault)return{width:0,height:0,offset:{top:i.pageY,left:i.pageX}};else return{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var o,a=Math.max,s=Math.abs,l=Math.round,h=/left|center|right/,c=/top|center|bottom/,u=/[\+\-]\d+(\.[\d]+)?%?/,f=/^\w+/,d=/%$/,p=e.fn.position;e.position={scrollbarWidth:function(){if(o!==t)return o;var i,r,n=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),a=n.children()[0];e("body").append(n);i=a.offsetWidth;n.css("overflow","scroll");r=a.offsetWidth;if(i===r)r=n[0].clientWidth;n.remove();return o=i-r},getScrollInfo:function(t){var i=t.isWindow?"":t.element.css("overflow-x"),r=t.isWindow?"":t.element.css("overflow-y"),n="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,o="scroll"===r||"auto"===r&&t.height<t.element[0].scrollHeight;return{width:o?e.position.scrollbarWidth():0,height:n?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),r=e.isWindow(i[0]);return{element:i,isWindow:r,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:r?i.width():i.outerWidth(),height:r?i.height():i.outerHeight()}}};e.fn.position=function(t){if(!t||!t.of)return p.apply(this,arguments);t=e.extend({},t);var o,d,m,g,v,E,y=e(t.of),T=e.position.getWithinInfo(t.within),_=e.position.getScrollInfo(T),b=(t.collision||"flip").split(" "),x={};E=n(y);if(y[0].preventDefault)t.at="left top";d=E.width;m=E.height;g=E.offset;v=e.extend({},g);e.each(["my","at"],function(){var e,i,r=(t[this]||"").split(" ");if(1===r.length)r=h.test(r[0])?r.concat(["center"]):c.test(r[0])?["center"].concat(r):["center","center"];r[0]=h.test(r[0])?r[0]:"center";r[1]=c.test(r[1])?r[1]:"center";e=u.exec(r[0]);i=u.exec(r[1]);x[this]=[e?e[0]:0,i?i[0]:0];t[this]=[f.exec(r[0])[0],f.exec(r[1])[0]]});if(1===b.length)b[1]=b[0];if("right"===t.at[0])v.left+=d;else if("center"===t.at[0])v.left+=d/2;if("bottom"===t.at[1])v.top+=m;else if("center"===t.at[1])v.top+=m/2;o=i(x.at,d,m);v.left+=o[0];v.top+=o[1];return this.each(function(){var n,h,c=e(this),u=c.outerWidth(),f=c.outerHeight(),p=r(this,"marginLeft"),E=r(this,"marginTop"),R=u+p+r(this,"marginRight")+_.width,w=f+E+r(this,"marginBottom")+_.height,H=e.extend({},v),M=i(x.my,c.outerWidth(),c.outerHeight());if("right"===t.my[0])H.left-=u;else if("center"===t.my[0])H.left-=u/2;if("bottom"===t.my[1])H.top-=f;else if("center"===t.my[1])H.top-=f/2;H.left+=M[0];H.top+=M[1];if(!e.support.offsetFractions){H.left=l(H.left);H.top=l(H.top)}n={marginLeft:p,marginTop:E};e.each(["left","top"],function(i,r){if(e.ui.position[b[i]])e.ui.position[b[i]][r](H,{targetWidth:d,targetHeight:m,elemWidth:u,elemHeight:f,collisionPosition:n,collisionWidth:R,collisionHeight:w,offset:[o[0]+M[0],o[1]+M[1]],my:t.my,at:t.at,within:T,elem:c})});if(t.using)h=function(e){var i=g.left-H.left,r=i+d-u,n=g.top-H.top,o=n+m-f,l={target:{element:y,left:g.left,top:g.top,width:d,height:m},element:{element:c,left:H.left,top:H.top,width:u,height:f},horizontal:0>r?"left":i>0?"right":"center",vertical:0>o?"top":n>0?"bottom":"middle"};if(u>d&&s(i+r)<d)l.horizontal="center";if(f>m&&s(n+o)<m)l.vertical="middle";if(a(s(i),s(r))>a(s(n),s(o)))l.important="horizontal";else l.important="vertical";t.using.call(this,e,l)};c.offset(e.extend(H,{using:h}))})};e.ui.position={fit:{left:function(e,t){var i,r=t.within,n=r.isWindow?r.scrollLeft:r.offset.left,o=r.width,s=e.left-t.collisionPosition.marginLeft,l=n-s,h=s+t.collisionWidth-o-n;if(t.collisionWidth>o)if(l>0&&0>=h){i=e.left+l+t.collisionWidth-o-n;e.left+=l-i}else if(h>0&&0>=l)e.left=n;else if(l>h)e.left=n+o-t.collisionWidth;else e.left=n;else if(l>0)e.left+=l;else if(h>0)e.left-=h;else e.left=a(e.left-s,e.left)},top:function(e,t){var i,r=t.within,n=r.isWindow?r.scrollTop:r.offset.top,o=t.within.height,s=e.top-t.collisionPosition.marginTop,l=n-s,h=s+t.collisionHeight-o-n;if(t.collisionHeight>o)if(l>0&&0>=h){i=e.top+l+t.collisionHeight-o-n;e.top+=l-i}else if(h>0&&0>=l)e.top=n;else if(l>h)e.top=n+o-t.collisionHeight;else e.top=n;else if(l>0)e.top+=l;else if(h>0)e.top-=h;else e.top=a(e.top-s,e.top)}},flip:{left:function(e,t){var i,r,n=t.within,o=n.offset.left+n.scrollLeft,a=n.width,l=n.isWindow?n.scrollLeft:n.offset.left,h=e.left-t.collisionPosition.marginLeft,c=h-l,u=h+t.collisionWidth-a-l,f="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,d="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,p=-2*t.offset[0];if(0>c){i=e.left+f+d+p+t.collisionWidth-a-o;if(0>i||i<s(c))e.left+=f+d+p}else if(u>0){r=e.left-t.collisionPosition.marginLeft+f+d+p-l;if(r>0||s(r)<u)e.left+=f+d+p}},top:function(e,t){var i,r,n=t.within,o=n.offset.top+n.scrollTop,a=n.height,l=n.isWindow?n.scrollTop:n.offset.top,h=e.top-t.collisionPosition.marginTop,c=h-l,u=h+t.collisionHeight-a-l,f="top"===t.my[1],d=f?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,p="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];if(0>c){r=e.top+d+p+m+t.collisionHeight-a-o;if(e.top+d+p+m>c&&(0>r||r<s(c)))e.top+=d+p+m}else if(u>0){i=e.top-t.collisionPosition.marginTop+d+p+m-l;if(e.top+d+p+m>u&&(i>0||s(i)<u))e.top+=d+p+m}}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments);e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments);e.ui.position.fit.top.apply(this,arguments)}}};!function(){var t,i,r,n,o,a=document.getElementsByTagName("body")[0],s=document.createElement("div");t=document.createElement(a?"div":"body");r={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(a)e.extend(r,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in r)t.style[o]=r[o];t.appendChild(s);i=a||document.documentElement;i.insertBefore(t,i.firstChild);s.style.cssText="position: absolute; left: 10.7432222px;";n=e(s).offset().left;e.support.offsetFractions=n>10&&11>n;t.innerHTML="";i.removeChild(t)}()}(jQuery);!function(e,t){e.widget("ui.progressbar",{version:"1.10.3",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue();this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min});this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.valueDiv.remove()},value:function(e){if(e===t)return this.options.value;this.options.value=this._constrainedValue(e);this._refreshValue()},_constrainedValue:function(e){if(e===t)e=this.options.value;this.indeterminate=e===!1;if("number"!=typeof e)e=0;return this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value;this._super(e);this.options.value=this._constrainedValue(t);this._refreshValue()},_setOption:function(e,t){if("max"===e)t=Math.max(this.min,t);this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(i.toFixed(0)+"%");this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate);if(this.indeterminate){this.element.removeAttr("aria-valuenow");if(!this.overlayDiv)this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv)}else{this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t});if(this.overlayDiv){this.overlayDiv.remove();this.overlayDiv=null}}if(this.oldValue!==t){this.oldValue=t;this._trigger("change")}if(t===this.options.max)this._trigger("complete")}})}(jQuery);!function(e){var t=5;e.widget("ui.slider",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1;this._mouseSliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all");this._refresh();this._setOption("disabled",this.options.disabled);this._animateOff=!1},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue()},_createHandles:function(){var t,i,r=this.options,n=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),o="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",a=[];i=r.values&&r.values.length||1;if(n.length>i){n.slice(i).remove();n=n.slice(0,i)}for(t=n.length;i>t;t++)a.push(o);this.handles=n.add(e(a.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,i="";if(t.range){if(t.range===!0)if(!t.values)t.values=[this._valueMin(),this._valueMin()];else if(t.values.length&&2!==t.values.length)t.values=[t.values[0],t.values[0]];else if(e.isArray(t.values))t.values=t.values.slice(0);if(!this.range||!this.range.length){this.range=e("<div></div>").appendTo(this.element);i="ui-slider-range ui-widget-header ui-corner-all"}else this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""});this.range.addClass(i+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))}else this.range=e([])},_setupEvents:function(){var e=this.handles.add(this.range).filter("a");this._off(e);this._on(e,this._handleEvents);this._hoverable(e);this._focusable(e)},_destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all");this._mouseDestroy()},_mouseCapture:function(t){var i,r,n,o,a,s,l,h,c=this,u=this.options;if(u.disabled)return!1;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();i={x:t.pageX,y:t.pageY};r=this._normValueFromMouse(i);n=this._valueMax()-this._valueMin()+1;this.handles.each(function(t){var i=Math.abs(r-c.values(t));if(n>i||n===i&&(t===c._lastChangedValue||c.values(t)===u.min)){n=i;o=e(this);a=t}});s=this._start(t,a);if(s===!1)return!1;this._mouseSliding=!0;this._handleIndex=a;o.addClass("ui-state-active").focus();l=o.offset();h=!e(t.target).parents().addBack().is(".ui-slider-handle");this._clickOffset=h?{left:0,top:0}:{left:t.pageX-l.left-o.width()/2,top:t.pageY-l.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover"))this._slide(t,a,r);this._animateOff=!0;return!0},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);this._slide(e,this._handleIndex,i);return!1},_mouseStop:function(e){this.handles.removeClass("ui-state-active");this._mouseSliding=!1;this._stop(e,this._handleIndex);this._change(e,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=!1;return!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,r,n,o;if("horizontal"===this.orientation){t=this.elementSize.width;i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{t=this.elementSize.height;i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}r=i/t;if(r>1)r=1;if(0>r)r=0;if("vertical"===this.orientation)r=1-r;n=this._valueMax()-this._valueMin();o=this._valueMin()+r*n;return this._trimAlignValue(o)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};if(this.options.values&&this.options.values.length){i.value=this.values(t);i.values=this.values()}return this._trigger("start",e,i)},_slide:function(e,t,i){var r,n,o;if(this.options.values&&this.options.values.length){r=this.values(t?0:1);if(2===this.options.values.length&&this.options.range===!0&&(0===t&&i>r||1===t&&r>i))i=r;if(i!==this.values(t)){n=this.values();n[t]=i;o=this._trigger("slide",e,{handle:this.handles[t],value:i,values:n});r=this.values(t?0:1);if(o!==!1)this.values(t,i,!0)}}else if(i!==this.value()){o=this._trigger("slide",e,{handle:this.handles[t],value:i});if(o!==!1)this.value(i)}},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};if(this.options.values&&this.options.values.length){i.value=this.values(t);i.values=this.values()}this._trigger("stop",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};if(this.options.values&&this.options.values.length){i.value=this.values(t);i.values=this.values()}this._lastChangedValue=t;this._trigger("change",e,i)}},value:function(e){if(!arguments.length)return this._value();else{this.options.value=this._trimAlignValue(e);this._refreshValue();this._change(null,0)}},values:function(t,i){var r,n,o;if(!(arguments.length>1))if(arguments.length)if(e.isArray(arguments[0])){r=this.options.values;n=arguments[0];for(o=0;o<r.length;o+=1){r[o]=this._trimAlignValue(n[o]);this._change(null,o)}this._refreshValue()}else if(this.options.values&&this.options.values.length)return this._values(t);else return this.value();else return this._values();else{this.options.values[t]=this._trimAlignValue(i);this._refreshValue();this._change(null,t)}},_setOption:function(t,i){var r,n=0;if("range"===t&&this.options.range===!0)if("min"===i){this.options.value=this._values(0);this.options.values=null}else if("max"===i){this.options.value=this._values(this.options.values.length-1);this.options.values=null}if(e.isArray(this.options.values))n=this.options.values.length;
e.Widget.prototype._setOption.apply(this,arguments);switch(t){case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case"value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case"values":this._animateOff=!0;this._refreshValue();for(r=0;n>r;r+=1)this._change(null,r);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0;this._refreshValue();this._animateOff=!1;break;case"range":this._animateOff=!0;this._refresh();this._animateOff=!1}},_value:function(){var e=this.options.value;e=this._trimAlignValue(e);return e},_values:function(e){var t,i,r;if(arguments.length){t=this.options.values[e];t=this._trimAlignValue(t);return t}else if(this.options.values&&this.options.values.length){i=this.options.values.slice();for(r=0;r<i.length;r+=1)i[r]=this._trimAlignValue(i[r]);return i}else return[]},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,r=e-i;if(2*Math.abs(i)>=t)r+=i>0?t:-t;return parseFloat(r.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,i,r,n,o,a=this.options.range,s=this.options,l=this,h=!this._animateOff?s.animate:!1,c={};if(this.options.values&&this.options.values.length)this.handles.each(function(r){i=100*((l.values(r)-l._valueMin())/(l._valueMax()-l._valueMin()));c["horizontal"===l.orientation?"left":"bottom"]=i+"%";e(this).stop(1,1)[h?"animate":"css"](c,s.animate);if(l.options.range===!0)if("horizontal"===l.orientation){if(0===r)l.range.stop(1,1)[h?"animate":"css"]({left:i+"%"},s.animate);if(1===r)l.range[h?"animate":"css"]({width:i-t+"%"},{queue:!1,duration:s.animate})}else{if(0===r)l.range.stop(1,1)[h?"animate":"css"]({bottom:i+"%"},s.animate);if(1===r)l.range[h?"animate":"css"]({height:i-t+"%"},{queue:!1,duration:s.animate})}t=i});else{r=this.value();n=this._valueMin();o=this._valueMax();i=o!==n?100*((r-n)/(o-n)):0;c["horizontal"===this.orientation?"left":"bottom"]=i+"%";this.handle.stop(1,1)[h?"animate":"css"](c,s.animate);if("min"===a&&"horizontal"===this.orientation)this.range.stop(1,1)[h?"animate":"css"]({width:i+"%"},s.animate);if("max"===a&&"horizontal"===this.orientation)this.range[h?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:s.animate});if("min"===a&&"vertical"===this.orientation)this.range.stop(1,1)[h?"animate":"css"]({height:i+"%"},s.animate);if("max"===a&&"vertical"===this.orientation)this.range[h?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:s.animate})}},_handleEvents:{keydown:function(i){var r,n,o,a,s=e(i.target).data("ui-slider-handle-index");switch(i.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:i.preventDefault();if(!this._keySliding){this._keySliding=!0;e(i.target).addClass("ui-state-active");r=this._start(i,s);if(r===!1)return}}a=this.options.step;if(this.options.values&&this.options.values.length)n=o=this.values(s);else n=o=this.value();switch(i.keyCode){case e.ui.keyCode.HOME:o=this._valueMin();break;case e.ui.keyCode.END:o=this._valueMax();break;case e.ui.keyCode.PAGE_UP:o=this._trimAlignValue(n+(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.PAGE_DOWN:o=this._trimAlignValue(n-(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(n===this._valueMax())return;o=this._trimAlignValue(n+a);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(n===this._valueMin())return;o=this._trimAlignValue(n-a)}this._slide(i,s,o)},click:function(e){e.preventDefault()},keyup:function(t){var i=e(t.target).data("ui-slider-handle-index");if(this._keySliding){this._keySliding=!1;this._stop(t,i);this._change(t,i);e(t.target).removeClass("ui-state-active")}}}})}(jQuery);!function(e){function t(e){return function(){var t=this.element.val();e.apply(this,arguments);this._refresh();if(t!==this.element.val())this._trigger("change")}}e.widget("ui.spinner",{version:"1.10.3",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max);this._setOption("min",this.options.min);this._setOption("step",this.options.step);this._value(this.element.val(),!0);this._draw();this._on(this._events);this._refresh();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},i=this.element;e.each(["min","max","step"],function(e,r){var n=i.attr(r);if(void 0!==n&&n.length)t[r]=n});return t},_events:{keydown:function(e){if(this._start(e)&&this._keydown(e))e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){if(!this.cancelBlur){this._stop();this._refresh();if(this.previous!==this.element.val())this._trigger("change",e)}else delete this.cancelBlur},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=this._delay(function(){if(this.spinning)this._stop(e)},100);e.preventDefault()}},"mousedown .ui-spinner-button":function(t){function i(){var e=this.element[0]===this.document[0].activeElement;if(!e){this.element.focus();this.previous=r;this._delay(function(){this.previous=r})}}var r;r=this.element[0]===this.document[0].activeElement?this.previous:this.element.val();t.preventDefault();i.call(this);this.cancelBlur=!0;this._delay(function(){delete this.cancelBlur;i.call(this)});if(this._start(t)!==!1)this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){if(e(t.currentTarget).hasClass("ui-state-active")){if(this._start(t)===!1)return!1;this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t);return void 0}},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton");this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all");if(this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0)e.height(e.height());if(this.options.disabled)this.disable()},_keydown:function(t){var i=this.options,r=e.ui.keyCode;switch(t.keyCode){case r.UP:this._repeat(null,1,t);return!0;case r.DOWN:this._repeat(null,-1,t);return!0;case r.PAGE_UP:this._repeat(null,i.page,t);return!0;case r.PAGE_DOWN:this._repeat(null,-i.page,t);return!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>"},_start:function(e){if(!this.spinning&&this._trigger("start",e)===!1)return!1;if(!this.counter)this.counter=1;this.spinning=!0;return!0},_repeat:function(e,t,i){e=e||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,t,i)},e);this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;if(!this.counter)this.counter=1;i=this._adjustValue(i+e*this._increment(this.counter));if(!this.spinning||this._trigger("spin",t,{value:i})!==!1){this._value(i);this.counter++}},_increment:function(t){var i=this.options.incremental;if(i)return e.isFunction(i)?i(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1);else return 1},_precision:function(){var e=this._precisionOf(this.options.step);if(null!==this.options.min)e=Math.max(e,this._precisionOf(this.options.min));return e},_precisionOf:function(e){var t=e.toString(),i=t.indexOf(".");return-1===i?0:t.length-i-1},_adjustValue:function(e){var t,i,r=this.options;t=null!==r.min?r.min:0;i=e-t;i=Math.round(i/r.step)*r.step;e=t+i;e=parseFloat(e.toFixed(this._precision()));if(null!==r.max&&e>r.max)return r.max;if(null!==r.min&&e<r.min)return r.min;else return e},_stop:function(e){if(this.spinning){clearTimeout(this.timer);clearTimeout(this.mousewheelTimer);this.counter=0;this.spinning=!1;this._trigger("stop",e)}},_setOption:function(e,t){if("culture"!==e&&"numberFormat"!==e){if("max"===e||"min"===e||"step"===e)if("string"==typeof t)t=this._parse(t);if("icons"===e){this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up);this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)}this._super(e,t);if("disabled"===e)if(t){this.element.prop("disabled",!0);this.buttons.button("disable")}else{this.element.prop("disabled",!1);this.buttons.button("enable")}}else{var i=this._parse(this.element.val());this.options[e]=t;this.element.val(this._format(i))}},_setOptions:t(function(e){this._super(e);this._value(this.element.val())}),_parse:function(e){if("string"==typeof e&&""!==e)e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e;return""===e||isNaN(e)?null:e},_format:function(e){if(""===e)return"";else return window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(e,t){var i;if(""!==e){i=this._parse(e);if(null!==i){if(!t)i=this._adjustValue(i);e=this._format(i)}}this.element.val(e);this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.uiSpinner.replaceWith(this.element)},stepUp:t(function(e){this._stepUp(e)}),_stepUp:function(e){if(this._start()){this._spin((e||1)*this.options.step);this._stop()}},stepDown:t(function(e){this._stepDown(e)}),_stepDown:function(e){if(this._start()){this._spin((e||1)*-this.options.step);this._stop()}},pageUp:t(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:t(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){if(!arguments.length)return this._parse(this.element.val());t(this._value).call(this,e);return void 0},widget:function(){return this.uiSpinner}})}(jQuery);!function(e,t){function i(){return++n}function r(e){return e.hash.length>1&&decodeURIComponent(e.href.replace(o,""))===decodeURIComponent(location.href.replace(o,""))}var n=0,o=/#.*$/;e.widget("ui.tabs",{version:"1.10.3",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t=this,i=this.options;this.running=!1;this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){if(e(this).is(".ui-state-disabled"))t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){if(e(this).closest("li").is(".ui-state-disabled"))this.blur()});this._processTabs();i.active=this._initialActive();if(e.isArray(i.disabled))i.disabled=e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort();if(this.options.active!==!1&&this.anchors.length)this.active=this._findActive(i.active);else this.active=e();this._refresh();if(this.active.length)this.load(i.active)},_initialActive:function(){var t=this.options.active,i=this.options.collapsible,r=location.hash.substring(1);if(null===t){if(r)this.tabs.each(function(i,n){if(e(n).attr("aria-controls")===r){t=i;return!1}});if(null===t)t=this.tabs.index(this.tabs.filter(".ui-tabs-active"));if(null===t||-1===t)t=this.tabs.length?0:!1}if(t!==!1){t=this.tabs.index(this.tabs.eq(t));if(-1===t)t=i?!1:0}if(!i&&t===!1&&this.anchors.length)t=0;return t},_getCreateEventData:function(){return{tab:this.active,panel:!this.active.length?e():this._getPanelForTab(this.active)}},_tabKeydown:function(t){var i=e(this.document[0].activeElement).closest("li"),r=this.tabs.index(i),n=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:r++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:n=!1;r--;break;case e.ui.keyCode.END:r=this.anchors.length-1;break;case e.ui.keyCode.HOME:r=0;break;case e.ui.keyCode.SPACE:t.preventDefault();clearTimeout(this.activating);this._activate(r);return;case e.ui.keyCode.ENTER:t.preventDefault();clearTimeout(this.activating);this._activate(r===this.options.active?!1:r);return;default:return}t.preventDefault();clearTimeout(this.activating);r=this._focusNextTab(r,n);if(!t.ctrlKey){i.attr("aria-selected","false");this.tabs.eq(r).attr("aria-selected","true");this.activating=this._delay(function(){this.option("active",r)},this.delay)}}},_panelKeydown:function(t){if(!this._handlePageNav(t))if(t.ctrlKey&&t.keyCode===e.ui.keyCode.UP){t.preventDefault();this.active.focus()}},_handlePageNav:function(t){if(t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP){this._activate(this._focusNextTab(this.options.active-1,!1));return!0}if(t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN){this._activate(this._focusNextTab(this.options.active+1,!0));return!0}},_findNextTab:function(t,i){function r(){if(t>n)t=0;if(0>t)t=n;return t}var n=this.tabs.length-1;for(;-1!==e.inArray(r(),this.options.disabled);)t=i?t+1:t-1;return t},_focusNextTab:function(e,t){e=this._findNextTab(e,t);this.tabs.eq(e).focus();return e},_setOption:function(e,t){if("active"!==e)if("disabled"!==e){this._super(e,t);if("collapsible"===e){this.element.toggleClass("ui-tabs-collapsible",t);if(!t&&this.options.active===!1)this._activate(0)}if("event"===e)this._setupEvents(t);if("heightStyle"===e)this._setupHeightStyle(t)}else this._setupDisabled(t);else this._activate(t)},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+i()},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,i=this.tablist.children(":has(a[href])");t.disabled=e.map(i.filter(".ui-state-disabled"),function(e){return i.index(e)});this._processTabs();if(t.active===!1||!this.anchors.length){t.active=!1;this.active=e()}else if(this.active.length&&!e.contains(this.tablist[0],this.active[0]))if(this.tabs.length===t.disabled.length){t.active=!1;this.active=e()}else this._activate(this._findNextTab(Math.max(0,t.active-1),!1));else t.active=this.tabs.index(this.active);this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled);this._setupEvents(this.options.event);this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"});if(!this.active.length)this.tabs.eq(0).attr("tabIndex",0);else{this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0});this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})}},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist");this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1});this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1});this.panels=e();this.anchors.each(function(i,n){var o,a,s,l=e(n).uniqueId().attr("id"),h=e(n).closest("li"),c=h.attr("aria-controls");if(r(n)){o=n.hash;a=t.element.find(t._sanitizeSelector(o))}else{s=t._tabId(h);o="#"+s;a=t.element.find(o);if(!a.length){a=t._createPanel(s);a.insertAfter(t.panels[i-1]||t.tablist)}a.attr("aria-live","polite")}if(a.length)t.panels=t.panels.add(a);if(c)h.data("ui-tabs-aria-controls",c);h.attr({"aria-controls":o.substring(1),"aria-labelledby":l});a.attr("aria-labelledby",l)});this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){if(e.isArray(t))if(!t.length)t=!1;else if(t.length===this.anchors.length)t=!0;for(var i,r=0;i=this.tabs[r];r++)if(t===!0||-1!==e.inArray(r,t))e(i).addClass("ui-state-disabled").attr("aria-disabled","true");else e(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var i={click:function(e){e.preventDefault()}};if(t)e.each(t.split(" "),function(e,t){i[t]="_eventHandler"});this._off(this.anchors.add(this.tabs).add(this.panels));this._on(this.anchors,i);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,r=this.element.parent();if("fill"===t){i=r.height();i-=this.element.outerHeight()-this.element.height();this.element.siblings(":visible").each(function(){var t=e(this),r=t.css("position");if("absolute"!==r&&"fixed"!==r)i-=t.outerHeight(!0)});this.element.children().not(this.panels).each(function(){i-=e(this).outerHeight(!0)});this.panels.each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")}else if("auto"===t){i=0;this.panels.each(function(){i=Math.max(i,e(this).height("").height())}).height(i)}},_eventHandler:function(t){var i=this.options,r=this.active,n=e(t.currentTarget),o=n.closest("li"),a=o[0]===r[0],s=a&&i.collapsible,l=s?e():this._getPanelForTab(o),h=!r.length?e():this._getPanelForTab(r),c={oldTab:r,oldPanel:h,newTab:s?e():o,newPanel:l};t.preventDefault();if(!(o.hasClass("ui-state-disabled")||o.hasClass("ui-tabs-loading")||this.running||a&&!i.collapsible||this._trigger("beforeActivate",t,c)===!1)){i.active=s?!1:this.tabs.index(o);this.active=a?e():o;if(this.xhr)this.xhr.abort();if(!h.length&&!l.length)e.error("jQuery UI Tabs: Mismatching fragment identifier.");if(l.length)this.load(this.tabs.index(o),t);this._toggle(t,c)}},_toggle:function(t,i){function r(){o.running=!1;o._trigger("activate",t,i)}function n(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active");if(a.length&&o.options.show)o._show(a,o.options.show,r);else{a.show();r()}}var o=this,a=i.newPanel,s=i.oldPanel;this.running=!0;if(s.length&&this.options.hide)this._hide(s,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");n()});else{i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");s.hide();n()}s.attr({"aria-expanded":"false","aria-hidden":"true"});i.oldTab.attr("aria-selected","false");if(a.length&&s.length)i.oldTab.attr("tabIndex",-1);else if(a.length)this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1);a.attr({"aria-expanded":"true","aria-hidden":"false"});i.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(t){var i,r=this._findActive(t);if(r[0]!==this.active[0]){if(!r.length)r=this.active;i=r.find(".ui-tabs-anchor")[0];this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop})}},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){if("string"==typeof e)e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"));return e},_destroy:function(){if(this.xhr)this.xhr.abort();this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role");this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId();this.tabs.add(this.panels).each(function(){if(e.data(this,"ui-tabs-destroy"))e(this).remove();else e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")});this.tabs.each(function(){var t=e(this),i=t.data("ui-tabs-aria-controls");if(i)t.attr("aria-controls",i).removeData("ui-tabs-aria-controls");else t.removeAttr("aria-controls")});this.panels.show();if("content"!==this.options.heightStyle)this.panels.css("height","")},enable:function(i){var r=this.options.disabled;if(r!==!1){if(i===t)r=!1;else{i=this._getIndex(i);if(e.isArray(r))r=e.map(r,function(e){return e!==i?e:null});else r=e.map(this.tabs,function(e,t){return t!==i?t:null})}this._setupDisabled(r)}},disable:function(i){var r=this.options.disabled;if(r!==!0){if(i===t)r=!0;else{i=this._getIndex(i);if(-1!==e.inArray(i,r))return;if(e.isArray(r))r=e.merge([i],r).sort();else r=[i]}this._setupDisabled(r)}},load:function(t,i){t=this._getIndex(t);var n=this,o=this.tabs.eq(t),a=o.find(".ui-tabs-anchor"),s=this._getPanelForTab(o),l={tab:o,panel:s};if(!r(a[0])){this.xhr=e.ajax(this._ajaxSettings(a,i,l));if(this.xhr&&"canceled"!==this.xhr.statusText){o.addClass("ui-tabs-loading");s.attr("aria-busy","true");this.xhr.success(function(e){setTimeout(function(){s.html(e);n._trigger("load",i,l)},1)}).complete(function(e,t){setTimeout(function(){if("abort"===t)n.panels.stop(!1,!0);o.removeClass("ui-tabs-loading");s.removeAttr("aria-busy");if(e===n.xhr)delete n.xhr},1)})}}},_ajaxSettings:function(t,i,r){var n=this;return{url:t.attr("href"),beforeSend:function(t,o){return n._trigger("beforeLoad",i,e.extend({jqXHR:t,ajaxSettings:o},r))}}},_getPanelForTab:function(t){var i=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}})}(jQuery);!function(e){function t(t,i){var r=(t.attr("aria-describedby")||"").split(/\s+/);r.push(i);t.data("ui-tooltip-id",i).attr("aria-describedby",e.trim(r.join(" ")))}function i(t){var i=t.data("ui-tooltip-id"),r=(t.attr("aria-describedby")||"").split(/\s+/),n=e.inArray(i,r);if(-1!==n)r.splice(n,1);t.removeData("ui-tooltip-id");r=e.trim(r.join(" "));if(r)t.attr("aria-describedby",r);else t.removeAttr("aria-describedby")}var r=0;e.widget("ui.tooltip",{version:"1.10.3",options:{content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"});this.tooltips={};this.parents={};if(this.options.disabled)this._disable()},_setOption:function(t,i){var r=this;if("disabled"!==t){this._super(t,i);if("content"===t)e.each(this.tooltips,function(e,t){r._updateContent(t)})}else{this[i?"_disable":"_enable"]();this.options[t]=i}},_disable:function(){var t=this;e.each(this.tooltips,function(i,r){var n=e.Event("blur");n.target=n.currentTarget=r[0];t.close(n,!0)});this.element.find(this.options.items).addBack().each(function(){var t=e(this);if(t.is("[title]"))t.data("ui-tooltip-title",t.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);if(t.data("ui-tooltip-title"))t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var i=this,r=e(t?t.target:this.element).closest(this.options.items);if(r.length&&!r.data("ui-tooltip-id")){if(r.attr("title"))r.data("ui-tooltip-title",r.attr("title"));r.data("ui-tooltip-open",!0);if(t&&"mouseover"===t.type)r.parents().each(function(){var t,r=e(this);if(r.data("ui-tooltip-open")){t=e.Event("blur");t.target=t.currentTarget=this;i.close(t,!0)}if(r.attr("title")){r.uniqueId();i.parents[this.id]={element:this,title:r.attr("title")};r.attr("title","")}});this._updateContent(r,t)}},_updateContent:function(e,t){var i,r=this.options.content,n=this,o=t?t.type:null;if("string"==typeof r)return this._open(t,e,r);i=r.call(e[0],function(i){if(e.data("ui-tooltip-open"))n._delay(function(){if(t)t.type=o;this._open(t,e,i)})});if(i)this._open(t,e,i)},_open:function(i,r,n){function o(e){h.of=e;if(!a.is(":hidden"))a.position(h)}var a,s,l,h=e.extend({},this.options.position);if(n){a=this._find(r);if(!a.length){if(r.is("[title]"))if(i&&"mouseover"===i.type)r.attr("title","");else r.removeAttr("title");a=this._tooltip(r);t(r,a.attr("id"));a.find(".ui-tooltip-content").html(n);if(this.options.track&&i&&/^mouse/.test(i.type)){this._on(this.document,{mousemove:o});o(i)}else a.position(e.extend({of:r},this.options.position));a.hide();this._show(a,this.options.show);if(this.options.show&&this.options.show.delay)l=this.delayedShow=setInterval(function(){if(a.is(":visible")){o(h.of);clearInterval(l)}},e.fx.interval);this._trigger("open",i,{tooltip:a});s={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var i=e.Event(t);i.currentTarget=r[0];this.close(i,!0)}},remove:function(){this._removeTooltip(a)}};if(!i||"mouseover"===i.type)s.mouseleave="close";if(!i||"focusin"===i.type)s.focusout="close";this._on(!0,r,s)}else a.find(".ui-tooltip-content").html(n)}},close:function(t){var r=this,n=e(t?t.currentTarget:this.element),o=this._find(n);if(!this.closing){clearInterval(this.delayedShow);if(n.data("ui-tooltip-title"))n.attr("title",n.data("ui-tooltip-title"));i(n);o.stop(!0);this._hide(o,this.options.hide,function(){r._removeTooltip(e(this))});n.removeData("ui-tooltip-open");this._off(n,"mouseleave focusout keyup");if(n[0]!==this.element[0])this._off(n,"remove");this._off(this.document,"mousemove");if(t&&"mouseleave"===t.type)e.each(this.parents,function(t,i){e(i.element).attr("title",i.title);delete r.parents[t]});this.closing=!0;this._trigger("close",t,{tooltip:o});this.closing=!1}},_tooltip:function(t){var i="ui-tooltip-"+r++,n=e("<div>").attr({id:i,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));e("<div>").addClass("ui-tooltip-content").appendTo(n);n.appendTo(this.document[0].body);this.tooltips[i]=t;return n},_find:function(t){var i=t.data("ui-tooltip-id");return i?e("#"+i):e()},_removeTooltip:function(e){e.remove();delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(i,r){var n=e.Event("blur");n.target=n.currentTarget=r[0];t.close(n,!0);e("#"+i).remove();if(r.data("ui-tooltip-title")){r.attr("title",r.data("ui-tooltip-title"));r.removeData("ui-tooltip-title")}})}})}(jQuery);define("libs/jquery-ui",function(){});define("text",["module"],function(e){var t,i,r,n,o,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,h="undefined"!=typeof location&&location.href,c=h&&location.protocol&&location.protocol.replace(/\:/,""),u=h&&location.hostname,f=h&&(location.port||void 0),d={},p=e.config&&e.config()||{};t={version:"2.0.10",strip:function(e){if(e){e=e.replace(s,"");var t=e.match(l);if(t)e=t[1]}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;else if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){i=a[t];try{e=new ActiveXObject(i)}catch(r){}if(e){a=[i];break}}return e},parseName:function(e){var t,i,r,n=!1,o=e.indexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");if(-1!==o&&(!a||o>1)){t=e.substring(0,o);i=e.substring(o+1,e.length)}else t=e;r=i||t;o=r.indexOf("!");if(-1!==o){n="strip"===r.substring(o+1);r=r.substring(0,o);if(i)i=r;else t=r}return{moduleName:t,ext:i,strip:n}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,i,r,n){var o,a,s,l=t.xdRegExp.exec(e);if(!l)return!0;o=l[2];a=l[3];a=a.split(":");s=a[1];a=a[0];return!(o&&o!==i||a&&a.toLowerCase()!==r.toLowerCase()||(s||a)&&s!==n)},finishLoad:function(e,i,r,n){r=i?t.strip(r):r;if(p.isBuild)d[e]=r;n(r)},load:function(e,i,r,n){if(!n.isBuild||n.inlineText){p.isBuild=n.isBuild;var o=t.parseName(e),a=o.moduleName+(o.ext?"."+o.ext:""),s=i.toUrl(a),l=p.useXhr||t.useXhr;if(0!==s.indexOf("empty:"))if(!h||l(s,c,u,f))t.get(s,function(i){t.finishLoad(e,o.strip,i,r)},function(e){if(r.error)r.error(e)});else i([a],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,r)});else r()}else r()},write:function(e,i,r){if(d.hasOwnProperty(i)){var n=t.jsEscape(d[i]);r.asModule(e+"!"+i,"define(function () { return '"+n+"';});\n")}},writeFile:function(e,i,r,n,o){var a=t.parseName(i),s=a.ext?"."+a.ext:"",l=a.moduleName+s,h=r.toUrl(a.moduleName+s)+".js";t.load(l,r,function(){var i=function(e){return n(h,e)};i.asModule=function(e,t){return n.asModule(e,h,t)};t.write(e,l,i,o)},o)}};if("node"===p.env||!p.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]){i=require.nodeRequire("fs");t.get=function(e,t,r){try{var n=i.readFileSync(e,"utf8");if(0===n.indexOf(""))n=n.substring(1);t(n)}catch(o){r(o)}}}else if("xhr"===p.env||!p.env&&t.createXhr())t.get=function(e,i,r,n){var o,a=t.createXhr();a.open("GET",e,!0);if(n)for(o in n)if(n.hasOwnProperty(o))a.setRequestHeader(o.toLowerCase(),n[o]);if(p.onXhr)p.onXhr(a,e);a.onreadystatechange=function(){var t,n;if(4===a.readyState){t=a.status;if(t>399&&600>t){n=new Error(e+" HTTP status: "+t);n.xhr=a;r(n)}else i(a.responseText);if(p.onXhrComplete)p.onXhrComplete(a,e)}};a.send(null)};else if("rhino"===p.env||!p.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java)t.get=function(e,t){var i,r,n="utf-8",o=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),n)),l="";try{i=new java.lang.StringBuffer;r=s.readLine();if(r&&r.length()&&65279===r.charAt(0))r=r.substring(1);if(null!==r)i.append(r);for(;null!==(r=s.readLine());){i.append(a);i.append(r)}l=String(i.toString())}finally{s.close()}t(l)};else if("xpconnect"===p.env||!p.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces){r=Components.classes,n=Components.interfaces;Components.utils["import"]("resource://gre/modules/FileUtils.jsm");o="@mozilla.org/windows-registry-key;1"in r;t.get=function(e,t){var i,a,s,l={};if(o)e=e.replace(/\//g,"\\");s=new FileUtils.File(e);try{i=r["@mozilla.org/network/file-input-stream;1"].createInstance(n.nsIFileInputStream);i.init(s,1,0,!1);a=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(n.nsIConverterInputStream);a.init(i,"utf-8",i.available(),n.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER);a.readString(i.available(),l);a.close();i.close();t(l.value)}catch(h){throw new Error((s&&s.path||"")+": "+h)}}}return t});define("glsl",["text"],function(){function e(e){var t="";var i="";var r=e.split("\n");var n="";for(var o=0;o<r.length;o++)if(r[o].indexOf("//#")>-1){if(r[o].indexOf("Fragment")>-1){t=n;n=""}}else{var a=r[o];if(a.indexOf("//")>-1)a=a.substring(0,a.indexOf("//"));if(-1===a.indexOf(";"))a+="\n";n+=a}i=n;return{fragmentShader:"#ifdef GL_ES\nprecision highp float;\n#endif\n"+i,vertexShader:t}
}var t={load:function(t,i,r,n){i(["template!"+t],function(t){if(!n.isBuild)r(e(t));else r(t)})}};return t});define("template",["text"],function(e){function t(e,t,i){var r=i.match(/\{\{(.+?)\}\}/g);if(null===r)return null;var n=r.slice(0),o=n.length,a=0;for(;o>a;){n[a]="template!"+t+n[a].replace(/\s/g,"").replace(/\{\{/g,"").replace(/\}\}/g,"");a++}return{modules:n,matches:r}}var i=[];var r={write:function(e,t,n){if(i.hasOwnProperty(t)){var o=r.jsEscape(i[t]);n.asModule(e+"!"+t,"define(function () { return '"+o+"';});\n")}},load:function(r,n,o,a){e.get(n.toUrl(r),function(e){var s=r.split("/");s=s.slice(0,s.length-1).join("/")+"/";var l=t(n,s,e);if(l)n(l.modules,function(){var t=l.matches.length;for(;t-->0;)e=e.split(l.matches[t]).join(arguments[t]);if(a.isBuild)i[s]=e;o(e)});else{if(a.isBuild)i[s]=e;o(e)}})}};return r});define("utils/math",[],function(){const e=Math.cos;const t=2*Math.PI;const i=.5*Math.PI;const r=Math.PI/180;const n=180/Math.PI;const o=1e-5;var a={PI2:t,HALF_PI:i,DEG2RAD:r,RAD2DEG:n,EPS:o,lerp:function(e,t,i){return t*(1-e)+i*e},cosineInterpolation:function(t,i,r){var n=.5*(1-e(t*Math.PI));return i*(1-n)+r*n},map:function(e,t,i,r,n){return r+(e-t)*(n-r)/(i-t)},normalize:function(e,t,i){return a.map(e,t,i,0,1)},clamp:function(e,t,i){return t>e?t:e>i?i:e},random:function(e,t){return void 0===t?Math.random()*e:Math.random()*(t-e)+e}};return a});define("utils/shader",[],function(){function e(e,n,o,a){function s(t,i){e=t;n=i;l.style.width=t+"px";l.style.height=i+"px";l.width=t*h;l.height=i*h;c.uniform2f(d.uResolution,t*h,i*h);c.viewport(0,0,e,n)}var l=document.createElement("canvas"),h=1;var c=l.getContext("experimental-webgl",{alpha:!0,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:a||!1}),u=c.createShader(c.VERTEX_SHADER),f=c.createShader(c.FRAGMENT_SHADER),d=c.createProgram();c.clearColor(0,0,0,0);c.disable(c.DEPTH_TEST);c.shaderSource(u,i);c.compileShader(u);c.shaderSource(f,t+o);c.compileShader(f);if(!c.getShaderParameter(f,c.COMPILE_STATUS)){console.error("You fucked up... "+c.getShaderInfoLog(f));return null}c.attachShader(d,u);c.attachShader(d,f);c.linkProgram(d);c.useProgram(d);d.aVertex=c.getAttribLocation(d,"aVertex");d.uResolution=c.getUniformLocation(d,"uResolution");d.uTime=c.getUniformLocation(d,"uTime");var p=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,p);c.bufferData(c.ARRAY_BUFFER,r,c.STATIC_DRAW);c.vertexAttribPointer(d.aVertex,2,c.FLOAT,!1,0,0);c.enableVertexAttribArray(d.aVertex);return{draw:function(t){c.viewport(0,0,e,n);c.uniform1fv(d.uTime,[t||0]);c.drawArrays(c.TRIANGLES,0,6)},size:s,gl:c,getUniformLocation:function(e){return c.getUniformLocation(d,e)},uniformFloat:function(e,t){c.uniform1fv(e,[t])},domElement:l}}var t="#ifdef GL_ES\nprecision highp float;\n#endif\n";var i=["attribute highp vec2 aVertex;","void main(void) {","gl_Position = vec4( aVertex, 1.0, 1.0);","}"].join("\n");var r=new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]);new Uint16Array([0,1,3,3,1,2]);return{create:e}});define("utils/noise",["./shader"],function(e){var t=e.create(100,100,["vec4 encodeFloat(float v)","{","vec4 c = vec4(0.0, 0.0, 0.0, 0.0);","if (v < 0.0) {","c[0] += 64.0;","v = -v;","}","float f = 0.0;","float e = ceil(log2(v));","float m = v * exp2(-e);","if (e < 0.0) {","e = -e;","c[0] += 128.0;","}","c[0] += e;","m *= 255.0;","f = floor(m);","c[1] = f;","m  -= f;","m *= 255.0;","f = floor(m);","c[2] = f;","m  -= f;","m *= 255.0;","c[3] = floor(m);","return c * 3.921569E-03;","}","vec4 mod289(vec4 x) {return x - floor(x * (1.0 / 289.0)) * 289.0; }","float mod289(float x) {return x - floor(x * (1.0 / 289.0)) * 289.0; }","vec4 permute(vec4 x) {return mod289(((x*34.0)+1.0)*x); }","float permute(float x) {return mod289(((x*34.0)+1.0)*x); }","vec4 taylorInvSqrt(vec4 r) {return 1.79284291400159 - 0.85373472095314 * r; }","float taylorInvSqrt(float r) {return 1.79284291400159 - 0.85373472095314 * r; }","vec4 grad4(float j, vec4 ip) {const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0); vec4 p,s; p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0; p.w = 1.5 - dot(abs(p.xyz), ones.xyz); s = vec4(lessThan(p, vec4(0.0))); p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www; return p; }","#define F4 0.309016994374947451","float snoise(vec4 v) {const vec4  C = vec4( 0.138196601125011, 0.276393202250021, 0.414589803375032, -0.447213595499958); vec4 i  = floor(v + dot(v, vec4(F4)) ); vec4 x0 = v -   i + dot(i, C.xxxx); vec4 i0; vec3 isX = step( x0.yzw, x0.xxx ); vec3 isYZ = step( x0.zww, x0.yyz ); i0.x = isX.x + isX.y + isX.z; i0.yzw = 1.0 - isX; i0.y += isYZ.x + isYZ.y; i0.zw += 1.0 - isYZ.xy; i0.z += isYZ.z; i0.w += 1.0 - isYZ.z; vec4 i3 = clamp( i0, 0.0, 1.0 ); vec4 i2 = clamp( i0-1.0, 0.0, 1.0 ); vec4 i1 = clamp( i0-2.0, 0.0, 1.0 ); vec4 x1 = x0 - i1 + C.xxxx; vec4 x2 = x0 - i2 + C.yyyy; vec4 x3 = x0 - i3 + C.zzzz; vec4 x4 = x0 + C.wwww; i = mod289(i); float j0 = permute( permute( permute( permute(i.w) + i.z) + i.y) + i.x); vec4 j1 = permute( permute( permute( permute (i.w + vec4(i1.w, i2.w, i3.w, 1.0 )) + i.z + vec4(i1.z, i2.z, i3.z, 1.0 )) + i.y + vec4(i1.y, i2.y, i3.y, 1.0 )) + i.x + vec4(i1.x, i2.x, i3.x, 1.0 )); vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ; vec4 p0 = grad4(j0,   ip); vec4 p1 = grad4(j1.x, ip); vec4 p2 = grad4(j1.y, ip); vec4 p3 = grad4(j1.z, ip); vec4 p4 = grad4(j1.w, ip); vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3))); p0 *= norm.x; p1 *= norm.y; p2 *= norm.z; p3 *= norm.w; p4 *= taylorInvSqrt(dot(p4,p4)); vec3 m0 = max(0.6 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0); vec2 m1 = max(0.6 - vec2(dot(x3,x3), dot(x4,x4)            ), 0.0); m0 = m0 * m0; m1 = m1 * m1; return 49.0 * ( dot(m0*m0, vec3( dot( p0, x0 ), dot( p1, x1 ), dot( p2, x2 ))) + dot(m1*m1, vec2( dot( p3, x3 ), dot( p4, x4 ) ) ) ) ; }","uniform vec2 uResolution;","uniform float uFrequency;","uniform float uOffset;","uniform float uDivisor;","uniform float uTime;","uniform float uComplexity;","float fbm( vec3 p ){","return snoise( vec4( p * uFrequency , uTime )) + ( snoise( vec4( p * uFrequency * 2.0, uTime )) * 0.5 );","}","float volume( vec3 p ){","vec3 q = vec3( fbm( p * 2.0  + vec3(0.0, 0.0, 0.0 )),","fbm( p * 2.0 + vec3(0.2, -2.0, 0.1 )),","fbm( p * 2.0 + vec3(0.2, 0.3, 0.2 )));","return fbm( p + uComplexity * q );","}","void main(void) {","vec3 origin = vec3( 0.5 );","vec2 uv = gl_FragCoord.xy / uResolution.xy * uDivisor;","vec2 tile = floor( uv );","float z = tile.y * uDivisor + tile.x;","vec2 m = fract( uv );","z /= pow( uDivisor, 2.0 );","float noise = volume( vec3( m, z ));","float d = 1.0 - length( origin - vec3( m, z ));","gl_FragColor = vec4( vec3( d * 0.4 + noise * d * 1.9) , 1.0 );","}"].join("\n"),!0);var i=(t.getUniformLocation("uOffset"),t.getUniformLocation("uDivisor")),r=t.getUniformLocation("uComplexity"),n=t.getUniformLocation("uFrequency");document.body.appendChild(t.domElement);t.domElement.style.display="none";return{noise3D:function(e,o,a,s,l,h){var c=Math.ceil(Math.sqrt(a)),a=Math.pow(c,2);size=4*e*o*a,volume=new Uint8Array(size);s=s||1;h|=Math.random();t.uniformFloat(i,c);t.uniformFloat(n,s);t.uniformFloat(r,l);t.size(e*c,o*c);t.draw(h);t.gl.readPixels(0,0,e*c,o*c,t.gl.RGBA,t.gl.UNSIGNED_BYTE,volume);var u=function(t,i,r){var n=Math.floor(r/c)*c*e*o,a=r%c*e,s=a+n,l=i*c*e;return volume[4*(s+l+t)]/256};u.volume=volume;return u}}});var THREE=THREE||{REVISION:"59"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};THREE.extend=function(e,t){if(Object.keys){var i=Object.keys(t);for(var r=0,n=i.length;n>r;r++){var o=i[r];Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))}}else{var a={}.hasOwnProperty;for(var o in t)if(a.call(t,o))e[o]=t[o]}return e};!function(){var e=0;var t=["ms","moz","webkit","o"];for(var i=0;i<t.length&&!self.requestAnimationFrame;++i){self.requestAnimationFrame=self[t[i]+"RequestAnimationFrame"];self.cancelAnimationFrame=self[t[i]+"CancelAnimationFrame"]||self[t[i]+"CancelRequestAnimationFrame"]}if(void 0===self.requestAnimationFrame&&void 0!==self["setTimeout"])self.requestAnimationFrame=function(t){var i=Date.now(),r=Math.max(0,16-(i-e));var n=self.setTimeout(function(){t(i+r)},r);e=i+r;return n};if(void 0===self.cancelAnimationFrame&&void 0!==self["clearTimeout"])self.cancelAnimationFrame=function(e){self.clearTimeout(e)}}();THREE.CullFaceNone=0;THREE.CullFaceBack=1;THREE.CullFaceFront=2;THREE.CullFaceFrontBack=3;THREE.FrontFaceDirectionCW=0;THREE.FrontFaceDirectionCCW=1;THREE.BasicShadowMap=0;THREE.PCFShadowMap=1;THREE.PCFSoftShadowMap=2;THREE.FrontSide=0;THREE.BackSide=1;THREE.DoubleSide=2;THREE.NoShading=0;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NoBlending=0;THREE.NormalBlending=1;THREE.AdditiveBlending=2;THREE.SubtractiveBlending=3;THREE.MultiplyBlending=4;THREE.CustomBlending=5;THREE.AddEquation=100;THREE.SubtractEquation=101;THREE.ReverseSubtractEquation=102;THREE.ZeroFactor=200;THREE.OneFactor=201;THREE.SrcColorFactor=202;THREE.OneMinusSrcColorFactor=203;THREE.SrcAlphaFactor=204;THREE.OneMinusSrcAlphaFactor=205;THREE.DstAlphaFactor=206;THREE.OneMinusDstAlphaFactor=207;THREE.DstColorFactor=208;THREE.OneMinusDstColorFactor=209;THREE.SrcAlphaSaturateFactor=210;THREE.MultiplyOperation=0;THREE.MixOperation=1;THREE.AddOperation=2;THREE.UVMapping=function(){};THREE.CubeReflectionMapping=function(){};THREE.CubeRefractionMapping=function(){};THREE.SphericalReflectionMapping=function(){};THREE.SphericalRefractionMapping=function(){};THREE.RepeatWrapping=1e3;THREE.ClampToEdgeWrapping=1001;THREE.MirroredRepeatWrapping=1002;THREE.NearestFilter=1003;THREE.NearestMipMapNearestFilter=1004;THREE.NearestMipMapLinearFilter=1005;THREE.LinearFilter=1006;THREE.LinearMipMapNearestFilter=1007;THREE.LinearMipMapLinearFilter=1008;THREE.UnsignedByteType=1009;THREE.ByteType=1010;THREE.ShortType=1011;THREE.UnsignedShortType=1012;THREE.IntType=1013;THREE.UnsignedIntType=1014;THREE.FloatType=1015;THREE.UnsignedShort4444Type=1016;THREE.UnsignedShort5551Type=1017;THREE.UnsignedShort565Type=1018;THREE.AlphaFormat=1019;THREE.RGBFormat=1020;THREE.RGBAFormat=1021;THREE.LuminanceFormat=1022;THREE.LuminanceAlphaFormat=1023;THREE.RGB_S3TC_DXT1_Format=2001;THREE.RGBA_S3TC_DXT1_Format=2002;THREE.RGBA_S3TC_DXT3_Format=2003;THREE.RGBA_S3TC_DXT5_Format=2004;THREE.Color=function(e){if(void 0!==e)this.set(e);return this};THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(e){if(e instanceof THREE.Color)this.copy(e);else if("number"==typeof e)this.setHex(e);else if("string"==typeof e)this.setStyle(e);return this},setHex:function(e){e=Math.floor(e);this.r=(255&e>>16)/255;this.g=(255&e>>8)/255;this.b=(255&e)/255;return this},setRGB:function(e,t,i){this.r=e;this.g=t;this.b=i;return this},setHSL:function(e,t,i){if(0===t)this.r=this.g=this.b=i;else{var r=function(e,t,i){if(0>i)i+=1;if(i>1)i-=1;if(1/6>i)return e+6*(t-e)*i;if(.5>i)return t;if(2/3>i)return e+6*(t-e)*(2/3-i);else return e};var n=.5>=i?i*(1+t):i+t-i*t;var o=2*i-n;this.r=r(o,n,e+1/3);this.g=r(o,n,e);this.b=r(o,n,e-1/3)}return this},setStyle:function(e){if(/^rgb\((\d+),(\d+),(\d+)\)$/i.test(e)){var t=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(e);this.r=Math.min(255,parseInt(t[1],10))/255;this.g=Math.min(255,parseInt(t[2],10))/255;this.b=Math.min(255,parseInt(t[3],10))/255;return this}if(/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(e)){var t=/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(e);this.r=Math.min(100,parseInt(t[1],10))/100;this.g=Math.min(100,parseInt(t[2],10))/100;this.b=Math.min(100,parseInt(t[3],10))/100;return this}if(/^\#([0-9a-f]{6})$/i.test(e)){var t=/^\#([0-9a-f]{6})$/i.exec(e);this.setHex(parseInt(t[1],16));return this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(e)){var t=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e);this.setHex(parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3],16));return this}if(/^(\w+)$/i.test(e)){this.setHex(THREE.ColorKeywords[e]);return this}},copy:function(e){this.r=e.r;this.g=e.g;this.b=e.b;return this},copyGammaToLinear:function(e){this.r=e.r*e.r;this.g=e.g*e.g;this.b=e.b*e.b;return this},copyLinearToGamma:function(e){this.r=Math.sqrt(e.r);this.g=Math.sqrt(e.g);this.b=Math.sqrt(e.b);return this},convertGammaToLinear:function(){var e=this.r,t=this.g,i=this.b;this.r=e*e;this.g=t*t;this.b=i*i;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(){var e={h:0,s:0,l:0};return function(){var t=this.r,i=this.g,r=this.b;var n=Math.max(t,i,r);var o=Math.min(t,i,r);var a,s;var l=(o+n)/2;if(o===n){a=0;s=0}else{var h=n-o;s=.5>=l?h/(n+o):h/(2-n-o);switch(n){case t:a=(i-r)/h+(r>i?6:0);break;case i:a=(r-t)/h+2;break;case r:a=(t-i)/h+4}a/=6}e.h=a;e.s=s;e.l=l;return e}}(),getStyle:function(){return"rgb("+(0|255*this.r)+","+(0|255*this.g)+","+(0|255*this.b)+")"},offsetHSL:function(e,t,i){var r=this.getHSL();r.h+=e;r.s+=t;r.l+=i;this.setHSL(r.h,r.s,r.l);return this},add:function(e){this.r+=e.r;this.g+=e.g;this.b+=e.b;return this},addColors:function(e,t){this.r=e.r+t.r;this.g=e.g+t.g;this.b=e.b+t.b;return this},addScalar:function(e){this.r+=e;this.g+=e;this.b+=e;return this},multiply:function(e){this.r*=e.r;this.g*=e.g;this.b*=e.b;return this},multiplyScalar:function(e){this.r*=e;this.g*=e;this.b*=e;return this},lerp:function(e,t){this.r+=(e.r-this.r)*t;this.g+=(e.g-this.g)*t;this.b+=(e.b-this.b)*t;return this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}};THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};THREE.Quaternion=function(e,t,i,r){this._x=e||0;this._y=t||0;this._z=i||0;this._w=void 0!==r?r:1};THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,_euler:void 0,_updateEuler:function(){if(void 0!==this._euler)this._euler.setFromQuaternion(this,void 0,!1)},get x(){return this._x},set x(e){this._x=e;this._updateEuler()},get y(){return this._y},set y(e){this._y=e;this._updateEuler()},get z(){return this._z},set z(e){this._z=e;this._updateEuler()},get w(){return this._w},set w(e){this._w=e;this._updateEuler()},set:function(e,t,i,r){this._x=e;this._y=t;this._z=i;this._w=r;this._updateEuler();return this},copy:function(e){this._x=e._x;this._y=e._y;this._z=e._z;this._w=e._w;this._updateEuler();return this},setFromEuler:function(e,t){if(void 0===typeof e["order"])console.error("ERROR: Quaternion's .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var i=Math.cos(e._x/2);var r=Math.cos(e._y/2);var n=Math.cos(e._z/2);var o=Math.sin(e._x/2);var a=Math.sin(e._y/2);var s=Math.sin(e._z/2);if(void 0===e.order||"XYZ"===e.order){this._x=o*r*n+i*a*s;this._y=i*a*n-o*r*s;this._z=i*r*s+o*a*n;this._w=i*r*n-o*a*s}else if("YXZ"===e.order){this._x=o*r*n+i*a*s;this._y=i*a*n-o*r*s;this._z=i*r*s-o*a*n;this._w=i*r*n+o*a*s}else if("ZXY"===e.order){this._x=o*r*n-i*a*s;this._y=i*a*n+o*r*s;this._z=i*r*s+o*a*n;this._w=i*r*n-o*a*s}else if("ZYX"===e.order){this._x=o*r*n-i*a*s;this._y=i*a*n+o*r*s;this._z=i*r*s-o*a*n;this._w=i*r*n+o*a*s}else if("YZX"===e.order){this._x=o*r*n+i*a*s;this._y=i*a*n+o*r*s;this._z=i*r*s-o*a*n;this._w=i*r*n-o*a*s}else if("XZY"===e.order){this._x=o*r*n-i*a*s;this._y=i*a*n-o*r*s;this._z=i*r*s+o*a*n;this._w=i*r*n+o*a*s}if(t!==!1)this._updateEuler();return this},setFromAxisAngle:function(e,t){var i=t/2,r=Math.sin(i);this._x=e.x*r;this._y=e.y*r;this._z=e.z*r;this._w=Math.cos(i);this._updateEuler();return this},setFromRotationMatrix:function(e){var t,i=e.elements,r=i[0],n=i[4],o=i[8],a=i[1],s=i[5],l=i[9],h=i[2],c=i[6],u=i[10],f=r+s+u;if(f>0){t=.5/Math.sqrt(f+1);this._w=.25/t;this._x=(c-l)*t;this._y=(o-h)*t;this._z=(a-n)*t}else if(r>s&&r>u){t=2*Math.sqrt(1+r-s-u);this._w=(c-l)/t;this._x=.25*t;this._y=(n+a)/t;this._z=(o+h)/t}else if(s>u){t=2*Math.sqrt(1+s-r-u);this._w=(o-h)/t;this._x=(n+a)/t;this._y=.25*t;this._z=(l+c)/t}else{t=2*Math.sqrt(1+u-r-s);this._w=(a-n)/t;this._x=(o+h)/t;this._y=(l+c)/t;this._z=.25*t}this._updateEuler();return this},inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this._updateEuler();return this},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();if(0===e){this._x=0;this._y=0;this._z=0;this._w=1}else{e=1/e;this._x=this._x*e;this._y=this._y*e;this._z=this._z*e;this._w=this._w*e}return this},multiply:function(e,t){if(void 0!==t){console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.");return this.multiplyQuaternions(e,t)}return this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var i=e._x,r=e._y,n=e._z,o=e._w;var a=t._x,s=t._y,l=t._z,h=t._w;this._x=i*h+o*a+r*l-n*s;this._y=r*h+o*s+n*a-i*l;this._z=n*h+o*l+i*s-r*a;this._w=o*h-i*a-r*s-n*l;this._updateEuler();return this},multiplyVector3:function(e){console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return e.applyQuaternion(this)},slerp:function(e,t){var i=this._x,r=this._y,n=this._z,o=this._w;var a=o*e._w+i*e._x+r*e._y+n*e._z;if(0>a){this._w=-e._w;this._x=-e._x;this._y=-e._y;this._z=-e._z;a=-a}else this.copy(e);if(a>=1){this._w=o;this._x=i;this._y=r;this._z=n;return this}var s=Math.acos(a);var l=Math.sqrt(1-a*a);if(Math.abs(l)<.001){this._w=.5*(o+this._w);this._x=.5*(i+this._x);this._y=.5*(r+this._y);this._z=.5*(n+this._z);return this}var h=Math.sin((1-t)*s)/l,c=Math.sin(t*s)/l;this._w=o*h+this._w*c;this._x=i*h+this._x*c;this._y=r*h+this._y*c;this._z=n*h+this._z*c;this._updateEuler();return this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e){this._x=e[0];this._y=e[1];this._z=e[2];this._w=e[3];this._updateEuler();return this},toArray:function(){return[this._x,this._y,this._z,this._w]},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}};THREE.Quaternion.slerp=function(e,t,i,r){return i.copy(e).slerp(t,r)};THREE.Vector2=function(e,t){this.x=e||0;this.y=t||0};THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(e,t){this.x=e;this.y=t;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},copy:function(e){this.x=e.x;this.y=e.y;return this},add:function(e,t){if(void 0!==t){console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(e,t)}this.x+=e.x;this.y+=e.y;return this},addVectors:function(e,t){this.x=e.x+t.x;this.y=e.y+t.y;return this},addScalar:function(e){this.x+=e;this.y+=e;return this},sub:function(e,t){if(void 0!==t){console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(e,t)}this.x-=e.x;this.y-=e.y;return this},subVectors:function(e,t){this.x=e.x-t.x;this.y=e.y-t.y;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;return this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t;this.y*=t}else{this.x=0;this.y=0}return this},min:function(e){if(this.x>e.x)this.x=e.x;if(this.y>e.y)this.y=e.y;return this},max:function(e){if(this.x<e.x)this.x=e.x;if(this.y<e.y)this.y=e.y;return this},clamp:function(e,t){if(this.x<e.x)this.x=e.x;else if(this.x>t.x)this.x=t.x;if(this.y<e.y)this.y=e.y;else if(this.y>t.y)this.y=t.y;return this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},setLength:function(e){var t=this.length();if(0!==t&&e!==t)this.multiplyScalar(e/t);return this},lerp:function(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;return this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e){this.x=e[0];this.y=e[1];return this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}};THREE.Vector3=function(e,t,i){this.x=e||0;this.y=t||0;this.z=i||0};THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(e,t,i){this.x=e;this.y=t;this.z=i;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setZ:function(e){this.z=e;return this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},copy:function(e){this.x=e.x;this.y=e.y;this.z=e.z;return this},add:function(e,t){if(void 0!==t){console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(e,t)}this.x+=e.x;this.y+=e.y;this.z+=e.z;return this},addScalar:function(e){this.x+=e;this.y+=e;this.z+=e;return this},addVectors:function(e,t){this.x=e.x+t.x;this.y=e.y+t.y;this.z=e.z+t.z;return this},sub:function(e,t){if(void 0!==t){console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(e,t)}this.x-=e.x;this.y-=e.y;this.z-=e.z;return this},subVectors:function(e,t){this.x=e.x-t.x;this.y=e.y-t.y;this.z=e.z-t.z;return this},multiply:function(e,t){if(void 0!==t){console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.");return this.multiplyVectors(e,t)}this.x*=e.x;this.y*=e.y;this.z*=e.z;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;this.z*=e;return this},multiplyVectors:function(e,t){this.x=e.x*t.x;this.y=e.y*t.y;this.z=e.z*t.z;return this},applyMatrix3:function(e){var t=this.x;var i=this.y;var r=this.z;var n=e.elements;this.x=n[0]*t+n[3]*i+n[6]*r;this.y=n[1]*t+n[4]*i+n[7]*r;this.z=n[2]*t+n[5]*i+n[8]*r;return this},applyMatrix4:function(e){var t=this.x,i=this.y,r=this.z;var n=e.elements;this.x=n[0]*t+n[4]*i+n[8]*r+n[12];this.y=n[1]*t+n[5]*i+n[9]*r+n[13];this.z=n[2]*t+n[6]*i+n[10]*r+n[14];return this},applyProjection:function(e){var t=this.x,i=this.y,r=this.z;var n=e.elements;var o=1/(n[3]*t+n[7]*i+n[11]*r+n[15]);this.x=(n[0]*t+n[4]*i+n[8]*r+n[12])*o;this.y=(n[1]*t+n[5]*i+n[9]*r+n[13])*o;this.z=(n[2]*t+n[6]*i+n[10]*r+n[14])*o;return this},applyQuaternion:function(e){var t=this.x;var i=this.y;var r=this.z;var n=e.x;var o=e.y;var a=e.z;var s=e.w;var l=s*t+o*r-a*i;var h=s*i+a*t-n*r;var c=s*r+n*i-o*t;var u=-n*t-o*i-a*r;this.x=l*s+u*-n+h*-a-c*-o;this.y=h*s+u*-o+c*-n-l*-a;this.z=c*s+u*-a+l*-o-h*-n;return this},transformDirection:function(e){var t=this.x,i=this.y,r=this.z;var n=e.elements;this.x=n[0]*t+n[4]*i+n[8]*r;this.y=n[1]*t+n[5]*i+n[9]*r;this.z=n[2]*t+n[6]*i+n[10]*r;this.normalize();return this},divide:function(e){this.x/=e.x;this.y/=e.y;this.z/=e.z;return this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t;this.y*=t;this.z*=t}else{this.x=0;this.y=0;this.z=0}return this},min:function(e){if(this.x>e.x)this.x=e.x;if(this.y>e.y)this.y=e.y;if(this.z>e.z)this.z=e.z;return this},max:function(e){if(this.x<e.x)this.x=e.x;if(this.y<e.y)this.y=e.y;if(this.z<e.z)this.z=e.z;return this},clamp:function(e,t){if(this.x<e.x)this.x=e.x;else if(this.x>t.x)this.x=t.x;if(this.y<e.y)this.y=e.y;else if(this.y>t.y)this.y=t.y;if(this.z<e.z)this.z=e.z;else if(this.z>t.z)this.z=t.z;return this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();if(0!==t&&e!==t)this.multiplyScalar(e/t);return this},lerp:function(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;this.z+=(e.z-this.z)*t;return this},cross:function(e,t){if(void 0!==t){console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.");return this.crossVectors(e,t)}var i=this.x,r=this.y,n=this.z;this.x=r*e.z-n*e.y;this.y=n*e.x-i*e.z;this.z=i*e.y-r*e.x;return this},crossVectors:function(e,t){this.x=e.y*t.z-e.z*t.y;this.y=e.z*t.x-e.x*t.z;this.z=e.x*t.y-e.y*t.x;return this},angleTo:function(e){var t=this.dot(e)/(this.length()*e.length());return Math.acos(THREE.Math.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x;var i=this.y-e.y;var r=this.z-e.z;return t*t+i*i+r*r},setEulerFromRotationMatrix:function(){console.error("REMOVED: Vector3's setEulerFromRotationMatrix has been removed in favor of Euler.setFromRotationMatrix(), please update your code.")},setEulerFromQuaternion:function(){console.error("REMOVED: Vector3's setEulerFromQuaternion: has been removed in favor of Euler.setFromQuaternion(), please update your code.")},getPositionFromMatrix:function(e){this.x=e.elements[12];this.y=e.elements[13];this.z=e.elements[14];return this},getScaleFromMatrix:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length();var i=this.set(e.elements[4],e.elements[5],e.elements[6]).length();var r=this.set(e.elements[8],e.elements[9],e.elements[10]).length();this.x=t;this.y=i;this.z=r;return this},getColumnFromMatrix:function(e,t){var i=4*e;var r=t.elements;this.x=r[i];this.y=r[i+1];this.z=r[i+2];return this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e){this.x=e[0];this.y=e[1];this.z=e[2];return this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}};THREE.extend(THREE.Vector3.prototype,{applyEuler:function(){var e=new THREE.Quaternion;return function(t){if(void 0===typeof t["order"])console.error("ERROR: Vector3's .applyEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var i=e.setFromEuler(t);this.applyQuaternion(i);return this}}(),applyAxisAngle:function(){var e=new THREE.Quaternion;return function(t,i){var r=e.setFromAxisAngle(t,i);this.applyQuaternion(r);return this}}(),projectOnVector:function(){var e=new THREE.Vector3;return function(t){e.copy(t).normalize();var i=this.dot(e);return this.copy(e).multiplyScalar(i)}}(),projectOnPlane:function(){var e=new THREE.Vector3;return function(t){e.copy(this).projectOnVector(t);return this.sub(e)}}(),reflect:function(){var e=new THREE.Vector3;return function(t){e.copy(this).projectOnVector(t).multiplyScalar(2);return this.subVectors(e,this)}}()});THREE.Vector4=function(e,t,i,r){this.x=e||0;this.y=t||0;this.z=i||0;this.w=void 0!==r?r:1};THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(e,t,i,r){this.x=e;this.y=t;this.z=i;this.w=r;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setZ:function(e){this.z=e;return this},setW:function(e){this.w=e;return this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},copy:function(e){this.x=e.x;this.y=e.y;this.z=e.z;this.w=void 0!==e.w?e.w:1;return this},add:function(e,t){if(void 0!==t){console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(e,t)}this.x+=e.x;this.y+=e.y;this.z+=e.z;this.w+=e.w;return this},addScalar:function(e){this.x+=e;this.y+=e;this.z+=e;this.w+=e;return this},addVectors:function(e,t){this.x=e.x+t.x;this.y=e.y+t.y;this.z=e.z+t.z;this.w=e.w+t.w;return this},sub:function(e,t){if(void 0!==t){console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(e,t)}this.x-=e.x;this.y-=e.y;this.z-=e.z;this.w-=e.w;return this},subVectors:function(e,t){this.x=e.x-t.x;this.y=e.y-t.y;this.z=e.z-t.z;this.w=e.w-t.w;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;this.z*=e;this.w*=e;return this},applyMatrix4:function(e){var t=this.x;var i=this.y;var r=this.z;var n=this.w;var o=e.elements;this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*n;
this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*n;this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*n;this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*n;return this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t;this.y*=t;this.z*=t;this.w*=t}else{this.x=0;this.y=0;this.z=0;this.w=1}return this},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);if(1e-4>t){this.x=1;this.y=0;this.z=0}else{this.x=e.x/t;this.y=e.y/t;this.z=e.z/t}return this},setAxisAngleFromRotationMatrix:function(e){var t,i,r,n,o=.01,a=.1,s=e.elements,l=s[0],h=s[4],c=s[8],u=s[1],f=s[5],d=s[9],p=s[2],m=s[6],g=s[10];if(Math.abs(h-u)<o&&Math.abs(c-p)<o&&Math.abs(d-m)<o){if(Math.abs(h+u)<a&&Math.abs(c+p)<a&&Math.abs(d+m)<a&&Math.abs(l+f+g-3)<a){this.set(1,0,0,0);return this}t=Math.PI;var v=(l+1)/2;var E=(f+1)/2;var y=(g+1)/2;var T=(h+u)/4;var _=(c+p)/4;var b=(d+m)/4;if(v>E&&v>y)if(o>v){i=0;r=.707106781;n=.707106781}else{i=Math.sqrt(v);r=T/i;n=_/i}else if(E>y)if(o>E){i=.707106781;r=0;n=.707106781}else{r=Math.sqrt(E);i=T/r;n=b/r}else if(o>y){i=.707106781;r=.707106781;n=0}else{n=Math.sqrt(y);i=_/n;r=b/n}this.set(i,r,n,t);return this}var x=Math.sqrt((m-d)*(m-d)+(c-p)*(c-p)+(u-h)*(u-h));if(Math.abs(x)<.001)x=1;this.x=(m-d)/x;this.y=(c-p)/x;this.z=(u-h)/x;this.w=Math.acos((l+f+g-1)/2);return this},min:function(e){if(this.x>e.x)this.x=e.x;if(this.y>e.y)this.y=e.y;if(this.z>e.z)this.z=e.z;if(this.w>e.w)this.w=e.w;return this},max:function(e){if(this.x<e.x)this.x=e.x;if(this.y<e.y)this.y=e.y;if(this.z<e.z)this.z=e.z;if(this.w<e.w)this.w=e.w;return this},clamp:function(e,t){if(this.x<e.x)this.x=e.x;else if(this.x>t.x)this.x=t.x;if(this.y<e.y)this.y=e.y;else if(this.y>t.y)this.y=t.y;if(this.z<e.z)this.z=e.z;else if(this.z>t.z)this.z=t.z;if(this.w<e.w)this.w=e.w;else if(this.w>t.w)this.w=t.w;return this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();if(0!==t&&e!==t)this.multiplyScalar(e/t);return this},lerp:function(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;this.z+=(e.z-this.z)*t;this.w+=(e.w-this.w)*t;return this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e){this.x=e[0];this.y=e[1];this.z=e[2];this.w=e[3];return this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}};THREE.Euler=function(e,t,i,r){this._x=e||0;this._y=t||0;this._z=i||0;this._order=r||THREE.Euler.DefaultOrder};THREE.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];THREE.Euler.DefaultOrder="XYZ";THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,_quaternion:void 0,_updateQuaternion:function(){if(void 0!==this._quaternion)this._quaternion.setFromEuler(this,!1)},get x(){return this._x},set x(e){this._x=e;this._updateQuaternion()},get y(){return this._y},set y(e){this._y=e;this._updateQuaternion()},get z(){return this._z},set z(e){this._z=e;this._updateQuaternion()},get order(){return this._order},set order(e){this._order=e;this._updateQuaternion()},set:function(e,t,i,r){this._x=e;this._y=t;this._z=i;this._order=r||this._order;this._updateQuaternion();return this},copy:function(e){this._x=e._x;this._y=e._y;this._z=e._z;this._order=e._order;this._updateQuaternion();return this},setFromRotationMatrix:function(e,t){function i(e){return Math.min(Math.max(e,-1),1)}var r=e.elements;var n=r[0],o=r[4],a=r[8];var s=r[1],l=r[5],h=r[9];var c=r[2],u=r[6],f=r[10];t=t||this._order;if("XYZ"===t){this._y=Math.asin(i(a));if(Math.abs(a)<.99999){this._x=Math.atan2(-h,f);this._z=Math.atan2(-o,n)}else{this._x=Math.atan2(u,l);this._z=0}}else if("YXZ"===t){this._x=Math.asin(-i(h));if(Math.abs(h)<.99999){this._y=Math.atan2(a,f);this._z=Math.atan2(s,l)}else{this._y=Math.atan2(-c,n);this._z=0}}else if("ZXY"===t){this._x=Math.asin(i(u));if(Math.abs(u)<.99999){this._y=Math.atan2(-c,f);this._z=Math.atan2(-o,l)}else{this._y=0;this._z=Math.atan2(s,n)}}else if("ZYX"===t){this._y=Math.asin(-i(c));if(Math.abs(c)<.99999){this._x=Math.atan2(u,f);this._z=Math.atan2(s,n)}else{this._x=0;this._z=Math.atan2(-o,l)}}else if("YZX"===t){this._z=Math.asin(i(s));if(Math.abs(s)<.99999){this._x=Math.atan2(-h,l);this._y=Math.atan2(-c,n)}else{this._x=0;this._y=Math.atan2(a,f)}}else if("XZY"===t){this._z=Math.asin(-i(o));if(Math.abs(o)<.99999){this._x=Math.atan2(u,l);this._y=Math.atan2(a,n)}else{this._x=Math.atan2(-h,f);this._y=0}}else console.warn("WARNING: Euler.setFromRotationMatrix() given unsupported order: "+t);this._order=t;this._updateQuaternion();return this},setFromQuaternion:function(e,t,i){function r(e){return Math.min(Math.max(e,-1),1)}var n=e.x*e.x;var o=e.y*e.y;var a=e.z*e.z;var s=e.w*e.w;t=t||this._order;if("XYZ"===t){this._x=Math.atan2(2*(e.x*e.w-e.y*e.z),s-n-o+a);this._y=Math.asin(r(2*(e.x*e.z+e.y*e.w)));this._z=Math.atan2(2*(e.z*e.w-e.x*e.y),s+n-o-a)}else if("YXZ"===t){this._x=Math.asin(r(2*(e.x*e.w-e.y*e.z)));this._y=Math.atan2(2*(e.x*e.z+e.y*e.w),s-n-o+a);this._z=Math.atan2(2*(e.x*e.y+e.z*e.w),s-n+o-a)}else if("ZXY"===t){this._x=Math.asin(r(2*(e.x*e.w+e.y*e.z)));this._y=Math.atan2(2*(e.y*e.w-e.z*e.x),s-n-o+a);this._z=Math.atan2(2*(e.z*e.w-e.x*e.y),s-n+o-a)}else if("ZYX"===t){this._x=Math.atan2(2*(e.x*e.w+e.z*e.y),s-n-o+a);this._y=Math.asin(r(2*(e.y*e.w-e.x*e.z)));this._z=Math.atan2(2*(e.x*e.y+e.z*e.w),s+n-o-a)}else if("YZX"===t){this._x=Math.atan2(2*(e.x*e.w-e.z*e.y),s-n+o-a);this._y=Math.atan2(2*(e.y*e.w-e.x*e.z),s+n-o-a);this._z=Math.asin(r(2*(e.x*e.y+e.z*e.w)))}else if("XZY"===t){this._x=Math.atan2(2*(e.x*e.w+e.y*e.z),s-n+o-a);this._y=Math.atan2(2*(e.x*e.z+e.y*e.w),s+n-o-a);this._z=Math.asin(r(2*(e.z*e.w-e.x*e.y)))}else console.warn("WARNING: Euler.setFromQuaternion() given unsupported order: "+t);this._order=t;if(i!==!1)this._updateQuaternion();return this},reorder:function(){var e=new THREE.Quaternion;return function(t){e.setFromEuler(this);this.setFromQuaternion(e,t)}}(),fromArray:function(e){this._x=e[0];this._y=e[1];this._z=e[2];if(void 0!==e[3])this._order=e[3];this._updateQuaternion();return this},toArray:function(){return[this._x,this._y,this._z,this._order]},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},clone:function(){return new THREE.Euler(this._x,this._y,this._z,this._order)}};THREE.Line3=function(e,t){this.start=void 0!==e?e:new THREE.Vector3;this.end=void 0!==t?t:new THREE.Vector3};THREE.Line3.prototype={constructor:THREE.Line3,set:function(e,t){this.start.copy(e);this.end.copy(t);return this},copy:function(e){this.start.copy(e.start);this.end.copy(e.end);return this},center:function(e){var t=e||new THREE.Vector3;return t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){var t=e||new THREE.Vector3;return t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var i=t||new THREE.Vector3;return this.delta(i).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new THREE.Vector3;var t=new THREE.Vector3;return function(i,r){e.subVectors(i,this.start);t.subVectors(this.end,this.start);var n=t.dot(t);var o=t.dot(e);var a=o/n;if(r)a=THREE.Math.clamp(a,0,1);return a}}(),closestPointToPoint:function(e,t,i){var r=this.closestPointToPointParameter(e,t);var n=i||new THREE.Vector3;return this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(e){this.start.applyMatrix4(e);this.end.applyMatrix4(e);return this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}};THREE.Box2=function(e,t){this.min=void 0!==e?e:new THREE.Vector2(1/0,1/0);this.max=void 0!==t?t:new THREE.Vector2(-1/0,-1/0)};THREE.Box2.prototype={constructor:THREE.Box2,set:function(e,t){this.min.copy(e);this.max.copy(t);return this},setFromPoints:function(e){if(e.length>0){var t=e[0];this.min.copy(t);this.max.copy(t);for(var i=1,r=e.length;r>i;i++){t=e[i];if(t.x<this.min.x)this.min.x=t.x;else if(t.x>this.max.x)this.max.x=t.x;if(t.y<this.min.y)this.min.y=t.y;else if(t.y>this.max.y)this.max.y=t.y}}else this.makeEmpty();return this},setFromCenterAndSize:function(){var e=new THREE.Vector2;return function(t,i){var r=e.copy(i).multiplyScalar(.5);this.min.copy(t).sub(r);this.max.copy(t).add(r);return this}}(),copy:function(e){this.min.copy(e.min);this.max.copy(e.max);return this},makeEmpty:function(){this.min.x=this.min.y=1/0;this.max.x=this.max.y=-1/0;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(e){var t=e||new THREE.Vector2;return t.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){var t=e||new THREE.Vector2;return t.subVectors(this.max,this.min)},expandByPoint:function(e){this.min.min(e);this.max.max(e);return this},expandByVector:function(e){this.min.sub(e);this.max.add(e);return this},expandByScalar:function(e){this.min.addScalar(-e);this.max.addScalar(e);return this},containsPoint:function(e){if(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)return!1;else return!0},containsBox:function(e){if(this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y)return!0;else return!1},getParameter:function(e){return new THREE.Vector2((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(e){if(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)return!1;else return!0},clampPoint:function(e,t){var i=t||new THREE.Vector2;return i.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new THREE.Vector2;return function(t){var i=e.copy(t).clamp(this.min,this.max);return i.sub(t).length()}}(),intersect:function(e){this.min.max(e.min);this.max.min(e.max);return this},union:function(e){this.min.min(e.min);this.max.max(e.max);return this},translate:function(e){this.min.add(e);this.max.add(e);return this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}};THREE.Box3=function(e,t){this.min=void 0!==e?e:new THREE.Vector3(1/0,1/0,1/0);this.max=void 0!==t?t:new THREE.Vector3(-1/0,-1/0,-1/0)};THREE.Box3.prototype={constructor:THREE.Box3,set:function(e,t){this.min.copy(e);this.max.copy(t);return this},setFromPoints:function(e){if(e.length>0){var t=e[0];this.min.copy(t);this.max.copy(t);for(var i=1,r=e.length;r>i;i++){t=e[i];if(t.x<this.min.x)this.min.x=t.x;else if(t.x>this.max.x)this.max.x=t.x;if(t.y<this.min.y)this.min.y=t.y;else if(t.y>this.max.y)this.max.y=t.y;if(t.z<this.min.z)this.min.z=t.z;else if(t.z>this.max.z)this.max.z=t.z}}else this.makeEmpty();return this},setFromCenterAndSize:function(){var e=new THREE.Vector3;return function(t,i){var r=e.copy(i).multiplyScalar(.5);this.min.copy(t).sub(r);this.max.copy(t).add(r);return this}}(),setFromObject:function(){var e=new THREE.Vector3;return function(t){var i=this;t.updateMatrixWorld(!0);this.makeEmpty();t.traverse(function(t){if(void 0!==t.geometry&&void 0!==t.geometry.vertices){var r=t.geometry.vertices;for(var n=0,o=r.length;o>n;n++){e.copy(r[n]);e.applyMatrix4(t.matrixWorld);i.expandByPoint(e)}}});return this}}(),copy:function(e){this.min.copy(e.min);this.max.copy(e.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=1/0;this.max.x=this.max.y=this.max.z=-1/0;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(e){var t=e||new THREE.Vector3;return t.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){var t=e||new THREE.Vector3;return t.subVectors(this.max,this.min)},expandByPoint:function(e){this.min.min(e);this.max.max(e);return this},expandByVector:function(e){this.min.sub(e);this.max.add(e);return this},expandByScalar:function(e){this.min.addScalar(-e);this.max.addScalar(e);return this},containsPoint:function(e){if(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)return!1;else return!0},containsBox:function(e){if(this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z)return!0;else return!1},getParameter:function(e){return new THREE.Vector3((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){if(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)return!1;else return!0},clampPoint:function(e,t){var i=t||new THREE.Vector3;return i.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new THREE.Vector3;return function(t){var i=e.copy(t).clamp(this.min,this.max);return i.sub(t).length()}}(),getBoundingSphere:function(){var e=new THREE.Vector3;return function(t){var i=t||new THREE.Sphere;i.center=this.center();i.radius=.5*this.size(e).length();return i}}(),intersect:function(e){this.min.max(e.min);this.max.min(e.max);return this},union:function(e){this.min.min(e.min);this.max.max(e.max);return this},applyMatrix4:function(){var e=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(t){e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t);e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t);e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t);e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t);e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t);e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t);e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t);e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t);this.makeEmpty();this.setFromPoints(e);return this}}(),translate:function(e){this.min.add(e);this.max.add(e);return this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}};THREE.Matrix3=function(e,t,i,r,n,o,a,s,l){this.elements=new Float32Array(9);this.set(void 0!==e?e:1,t||0,i||0,r||0,void 0!==n?n:1,o||0,a||0,s||0,void 0!==l?l:1)};THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(e,t,i,r,n,o,a,s,l){var h=this.elements;h[0]=e;h[3]=t;h[6]=i;h[1]=r;h[4]=n;h[7]=o;h[2]=a;h[5]=s;h[8]=l;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(e){var t=e.elements;this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]);return this},multiplyVector3:function(e){console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return e.applyMatrix3(this)},multiplyVector3Array:function(){var e=new THREE.Vector3;return function(t){for(var i=0,r=t.length;r>i;i+=3){e.x=t[i];e.y=t[i+1];e.z=t[i+2];e.applyMatrix3(this);t[i]=e.x;t[i+1]=e.y;t[i+2]=e.z}return t}}(),multiplyScalar:function(e){var t=this.elements;t[0]*=e;t[3]*=e;t[6]*=e;t[1]*=e;t[4]*=e;t[7]*=e;t[2]*=e;t[5]*=e;t[8]*=e;return this},determinant:function(){var e=this.elements;var t=e[0],i=e[1],r=e[2],n=e[3],o=e[4],a=e[5],s=e[6],l=e[7],h=e[8];return t*o*h-t*a*l-i*n*h+i*a*s+r*n*l-r*o*s},getInverse:function(e,t){var i=e.elements;var r=this.elements;r[0]=i[10]*i[5]-i[6]*i[9];r[1]=-i[10]*i[1]+i[2]*i[9];r[2]=i[6]*i[1]-i[2]*i[5];r[3]=-i[10]*i[4]+i[6]*i[8];r[4]=i[10]*i[0]-i[2]*i[8];r[5]=-i[6]*i[0]+i[2]*i[4];r[6]=i[9]*i[4]-i[5]*i[8];r[7]=-i[9]*i[0]+i[1]*i[8];r[8]=i[5]*i[0]-i[1]*i[4];var n=i[0]*r[0]+i[1]*r[3]+i[2]*r[6];if(0===n){var o="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(o);else console.warn(o);this.identity();return this}this.multiplyScalar(1/n);return this},transpose:function(){var e,t=this.elements;e=t[1];t[1]=t[3];t[3]=e;e=t[2];t[2]=t[6];t[6]=e;e=t[5];t[5]=t[7];t[7]=e;return this},getNormalMatrix:function(e){this.getInverse(e).transpose();return this},transposeIntoArray:function(e){var t=this.elements;e[0]=t[0];e[1]=t[3];e[2]=t[6];e[3]=t[1];e[4]=t[4];e[5]=t[7];e[6]=t[2];e[7]=t[5];e[8]=t[8];return this},clone:function(){var e=this.elements;return new THREE.Matrix3(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])}};THREE.Matrix4=function(e,t,i,r,n,o,a,s,l,h,c,u,f,d,p,m){this.elements=new Float32Array(16);var g=this.elements;g[0]=void 0!==e?e:1;g[4]=t||0;g[8]=i||0;g[12]=r||0;g[1]=n||0;g[5]=void 0!==o?o:1;g[9]=a||0;g[13]=s||0;g[2]=l||0;g[6]=h||0;g[10]=void 0!==c?c:1;g[14]=u||0;g[3]=f||0;g[7]=d||0;g[11]=p||0;g[15]=void 0!==m?m:1};THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(e,t,i,r,n,o,a,s,l,h,c,u,f,d,p,m){var g=this.elements;g[0]=e;g[4]=t;g[8]=i;g[12]=r;g[1]=n;g[5]=o;g[9]=a;g[13]=s;g[2]=l;g[6]=h;g[10]=c;g[14]=u;g[3]=f;g[7]=d;g[11]=p;g[15]=m;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(e){this.elements.set(e.elements);return this},extractPosition:function(e){console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(e)},copyPosition:function(e){var t=this.elements;var i=e.elements;t[12]=i[12];t[13]=i[13];t[14]=i[14];return this},extractRotation:function(){var e=new THREE.Vector3;return function(t){var i=this.elements;var r=t.elements;var n=1/e.set(r[0],r[1],r[2]).length();var o=1/e.set(r[4],r[5],r[6]).length();var a=1/e.set(r[8],r[9],r[10]).length();i[0]=r[0]*n;i[1]=r[1]*n;i[2]=r[2]*n;i[4]=r[4]*o;i[5]=r[5]*o;i[6]=r[6]*o;i[8]=r[8]*a;i[9]=r[9]*a;i[10]=r[10]*a;return this}}(),makeRotationFromEuler:function(e){if(void 0===typeof e["order"])console.error("ERROR: Matrix's .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var t=this.elements;var i=e.x,r=e.y,n=e.z;var o=Math.cos(i),a=Math.sin(i);var s=Math.cos(r),l=Math.sin(r);var h=Math.cos(n),c=Math.sin(n);if(void 0===e.order||"XYZ"===e.order){var u=o*h,f=o*c,d=a*h,p=a*c;t[0]=s*h;t[4]=-s*c;t[8]=l;t[1]=f+d*l;t[5]=u-p*l;t[9]=-a*s;t[2]=p-u*l;t[6]=d+f*l;t[10]=o*s}else if("YXZ"===e.order){var m=s*h,g=s*c,v=l*h,E=l*c;t[0]=m+E*a;t[4]=v*a-g;t[8]=o*l;t[1]=o*c;t[5]=o*h;t[9]=-a;t[2]=g*a-v;t[6]=E+m*a;t[10]=o*s}else if("ZXY"===e.order){var m=s*h,g=s*c,v=l*h,E=l*c;t[0]=m-E*a;t[4]=-o*c;t[8]=v+g*a;t[1]=g+v*a;t[5]=o*h;t[9]=E-m*a;t[2]=-o*l;t[6]=a;t[10]=o*s}else if("ZYX"===e.order){var u=o*h,f=o*c,d=a*h,p=a*c;t[0]=s*h;t[4]=d*l-f;t[8]=u*l+p;t[1]=s*c;t[5]=p*l+u;t[9]=f*l-d;t[2]=-l;t[6]=a*s;t[10]=o*s}else if("YZX"===e.order){var y=o*s,T=o*l,_=a*s,b=a*l;t[0]=s*h;t[4]=b-y*c;t[8]=_*c+T;t[1]=c;t[5]=o*h;t[9]=-a*h;t[2]=-l*h;t[6]=T*c+_;t[10]=y-b*c}else if("XZY"===e.order){var y=o*s,T=o*l,_=a*s,b=a*l;t[0]=s*h;t[4]=-c;t[8]=l*h;t[1]=y*c+b;t[5]=o*h;t[9]=T*c-_;t[2]=_*c-T;t[6]=a*h;t[10]=b*c+y}t[3]=0;t[7]=0;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return this},setRotationFromQuaternion:function(e){console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code.");return this.makeRotationFromQuaternion(e)},makeRotationFromQuaternion:function(e){var t=this.elements;var i=e.x,r=e.y,n=e.z,o=e.w;var a=i+i,s=r+r,l=n+n;var h=i*a,c=i*s,u=i*l;var f=r*s,d=r*l,p=n*l;var m=o*a,g=o*s,v=o*l;t[0]=1-(f+p);t[4]=c-v;t[8]=u+g;t[1]=c+v;t[5]=1-(h+p);t[9]=d-m;t[2]=u-g;t[6]=d+m;t[10]=1-(h+f);t[3]=0;t[7]=0;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return this},lookAt:function(){var e=new THREE.Vector3;var t=new THREE.Vector3;var i=new THREE.Vector3;return function(r,n,o){var a=this.elements;i.subVectors(r,n).normalize();if(0===i.length())i.z=1;e.crossVectors(o,i).normalize();if(0===e.length()){i.x+=1e-4;e.crossVectors(o,i).normalize()}t.crossVectors(i,e);a[0]=e.x;a[4]=t.x;a[8]=i.x;a[1]=e.y;a[5]=t.y;a[9]=i.y;a[2]=e.z;a[6]=t.z;a[10]=i.z;return this}}(),multiply:function(e,t){if(void 0!==t){console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.");return this.multiplyMatrices(e,t)}return this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var i=e.elements;var r=t.elements;var n=this.elements;var o=i[0],a=i[4],s=i[8],l=i[12];var h=i[1],c=i[5],u=i[9],f=i[13];var d=i[2],p=i[6],m=i[10],g=i[14];var v=i[3],E=i[7],y=i[11],T=i[15];var _=r[0],b=r[4],x=r[8],R=r[12];var w=r[1],H=r[5],M=r[9],S=r[13];var C=r[2],A=r[6],D=r[10],P=r[14];var k=r[3],L=r[7],F=r[11],z=r[15];n[0]=o*_+a*w+s*C+l*k;n[4]=o*b+a*H+s*A+l*L;n[8]=o*x+a*M+s*D+l*F;n[12]=o*R+a*S+s*P+l*z;n[1]=h*_+c*w+u*C+f*k;n[5]=h*b+c*H+u*A+f*L;n[9]=h*x+c*M+u*D+f*F;n[13]=h*R+c*S+u*P+f*z;n[2]=d*_+p*w+m*C+g*k;n[6]=d*b+p*H+m*A+g*L;n[10]=d*x+p*M+m*D+g*F;n[14]=d*R+p*S+m*P+g*z;n[3]=v*_+E*w+y*C+T*k;n[7]=v*b+E*H+y*A+T*L;n[11]=v*x+E*M+y*D+T*F;n[15]=v*R+E*S+y*P+T*z;return this},multiplyToArray:function(e,t,i){var r=this.elements;this.multiplyMatrices(e,t);i[0]=r[0];i[1]=r[1];i[2]=r[2];i[3]=r[3];i[4]=r[4];i[5]=r[5];i[6]=r[6];i[7]=r[7];i[8]=r[8];i[9]=r[9];i[10]=r[10];i[11]=r[11];i[12]=r[12];i[13]=r[13];i[14]=r[14];i[15]=r[15];return this},multiplyScalar:function(e){var t=this.elements;t[0]*=e;t[4]*=e;t[8]*=e;t[12]*=e;t[1]*=e;t[5]*=e;t[9]*=e;t[13]*=e;t[2]*=e;t[6]*=e;t[10]*=e;t[14]*=e;t[3]*=e;t[7]*=e;t[11]*=e;t[15]*=e;return this},multiplyVector3:function(e){console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");return e.applyProjection(this)},multiplyVector4:function(e){console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return e.applyMatrix4(this)},multiplyVector3Array:function(){var e=new THREE.Vector3;return function(t){for(var i=0,r=t.length;r>i;i+=3){e.x=t[i];e.y=t[i+1];e.z=t[i+2];e.applyProjection(this);t[i]=e.x;t[i+1]=e.y;t[i+2]=e.z}return t}}(),rotateAxis:function(e){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");e.transformDirection(this)},crossVector:function(e){console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return e.applyMatrix4(this)},determinant:function(){var e=this.elements;var t=e[0],i=e[4],r=e[8],n=e[12];var o=e[1],a=e[5],s=e[9],l=e[13];var h=e[2],c=e[6],u=e[10],f=e[14];var d=e[3],p=e[7],m=e[11],g=e[15];return d*(+n*s*c-r*l*c-n*a*u+i*l*u+r*a*f-i*s*f)+p*(+t*s*f-t*l*u+n*o*u-r*o*f+r*l*h-n*s*h)+m*(+t*l*c-t*a*f-n*o*c+i*o*f+n*a*h-i*l*h)+g*(-r*a*h-t*s*c+t*a*u+r*o*c-i*o*u+i*s*h)},transpose:function(){var e=this.elements;var t;t=e[1];e[1]=e[4];e[4]=t;t=e[2];e[2]=e[8];e[8]=t;t=e[6];e[6]=e[9];e[9]=t;t=e[3];e[3]=e[12];e[12]=t;t=e[7];e[7]=e[13];e[13]=t;t=e[11];e[11]=e[14];e[14]=t;return this},flattenToArray:function(e){var t=this.elements;e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[8]=t[8];e[9]=t[9];e[10]=t[10];e[11]=t[11];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15];return e},flattenToArrayOffset:function(e,t){var i=this.elements;e[t]=i[0];e[t+1]=i[1];e[t+2]=i[2];e[t+3]=i[3];e[t+4]=i[4];e[t+5]=i[5];e[t+6]=i[6];e[t+7]=i[7];e[t+8]=i[8];e[t+9]=i[9];e[t+10]=i[10];e[t+11]=i[11];e[t+12]=i[12];e[t+13]=i[13];e[t+14]=i[14];e[t+15]=i[15];return e},getPosition:function(){var e=new THREE.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");var t=this.elements;return e.set(t[12],t[13],t[14])}}(),setPosition:function(e){var t=this.elements;t[12]=e.x;t[13]=e.y;t[14]=e.z;return this},getInverse:function(e,t){var i=this.elements;var r=e.elements;var n=r[0],o=r[4],a=r[8],s=r[12];var l=r[1],h=r[5],c=r[9],u=r[13];var f=r[2],d=r[6],p=r[10],m=r[14];var g=r[3],v=r[7],E=r[11],y=r[15];i[0]=c*m*v-u*p*v+u*d*E-h*m*E-c*d*y+h*p*y;i[4]=s*p*v-a*m*v-s*d*E+o*m*E+a*d*y-o*p*y;i[8]=a*u*v-s*c*v+s*h*E-o*u*E-a*h*y+o*c*y;i[12]=s*c*d-a*u*d-s*h*p+o*u*p+a*h*m-o*c*m;i[1]=u*p*g-c*m*g-u*f*E+l*m*E+c*f*y-l*p*y;i[5]=a*m*g-s*p*g+s*f*E-n*m*E-a*f*y+n*p*y;i[9]=s*c*g-a*u*g-s*l*E+n*u*E+a*l*y-n*c*y;i[13]=a*u*f-s*c*f+s*l*p-n*u*p-a*l*m+n*c*m;i[2]=h*m*g-u*d*g+u*f*v-l*m*v-h*f*y+l*d*y;i[6]=s*d*g-o*m*g-s*f*v+n*m*v+o*f*y-n*d*y;i[10]=o*u*g-s*h*g+s*l*v-n*u*v-o*l*y+n*h*y;i[14]=s*h*f-o*u*f-s*l*d+n*u*d+o*l*m-n*h*m;i[3]=c*d*g-h*p*g-c*f*v+l*p*v+h*f*E-l*d*E;i[7]=o*p*g-a*d*g+a*f*v-n*p*v-o*f*E+n*d*E;i[11]=a*h*g-o*c*g-a*l*v+n*c*v+o*l*E-n*h*E;i[15]=o*c*f-a*h*f+a*l*d-n*c*d-o*l*p+n*h*p;var T=n*i[0]+l*i[4]+f*i[8]+g*i[12];if(0==T){var _="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(_);else console.warn(_);this.identity();return this}this.multiplyScalar(1/T);return this},translate:function(){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},scale:function(e){var t=this.elements;var i=e.x,r=e.y,n=e.z;t[0]*=i;t[4]*=r;t[8]*=n;t[1]*=i;t[5]*=r;t[9]*=n;t[2]*=i;t[6]*=r;t[10]*=n;t[3]*=i;t[7]*=r;t[11]*=n;return this},getMaxScaleOnAxis:function(){var e=this.elements;var t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];var i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6];var r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,Math.max(i,r)))},makeTranslation:function(e,t,i){this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1);return this},makeRotationX:function(e){var t=Math.cos(e),i=Math.sin(e);this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1);return this},makeRotationY:function(e){var t=Math.cos(e),i=Math.sin(e);this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1);return this},makeRotationZ:function(e){var t=Math.cos(e),i=Math.sin(e);this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(e,t){var i=Math.cos(t);var r=Math.sin(t);var n=1-i;var o=e.x,a=e.y,s=e.z;var l=n*o,h=n*a;this.set(l*o+i,l*a-r*s,l*s+r*a,0,l*a+r*s,h*a+i,h*s-r*o,0,l*s-r*a,h*s+r*o,n*s*s+i,0,0,0,0,1);return this},makeScale:function(e,t,i){this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1);return this},compose:function(e,t,i){this.makeRotationFromQuaternion(t);this.scale(i);this.setPosition(e);return this},decompose:function(){var e=new THREE.Vector3;var t=new THREE.Matrix4;return function(i,r,n){var o=this.elements;var a=e.set(o[0],o[1],o[2]).length();var s=e.set(o[4],o[5],o[6]).length();var l=e.set(o[8],o[9],o[10]).length();i.x=o[12];i.y=o[13];i.z=o[14];t.elements.set(this.elements);var h=1/a;var c=1/s;var u=1/l;t.elements[0]*=h;t.elements[1]*=h;t.elements[2]*=h;t.elements[4]*=c;t.elements[5]*=c;t.elements[6]*=c;t.elements[8]*=u;t.elements[9]*=u;t.elements[10]*=u;r.setFromRotationMatrix(t);n.x=a;n.y=s;n.z=l;return this}}(),makeFrustum:function(e,t,i,r,n,o){var a=this.elements;var s=2*n/(t-e);var l=2*n/(r-i);var h=(t+e)/(t-e);var c=(r+i)/(r-i);var u=-(o+n)/(o-n);var f=-2*o*n/(o-n);a[0]=s;a[4]=0;a[8]=h;a[12]=0;a[1]=0;a[5]=l;a[9]=c;a[13]=0;a[2]=0;a[6]=0;a[10]=u;a[14]=f;a[3]=0;a[7]=0;a[11]=-1;a[15]=0;return this},makePerspective:function(e,t,i,r){var n=i*Math.tan(THREE.Math.degToRad(.5*e));var o=-n;var a=o*t;var s=n*t;return this.makeFrustum(a,s,o,n,i,r)},makeOrthographic:function(e,t,i,r,n,o){var a=this.elements;var s=t-e;var l=i-r;var h=o-n;var c=(t+e)/s;var u=(i+r)/l;var f=(o+n)/h;a[0]=2/s;a[4]=0;a[8]=0;a[12]=-c;a[1]=0;a[5]=2/l;a[9]=0;a[13]=-u;a[2]=0;a[6]=0;a[10]=-2/h;a[14]=-f;a[3]=0;a[7]=0;a[11]=0;a[15]=1;return this},fromArray:function(e){this.elements.set(e);return this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},clone:function(){var e=this.elements;return new THREE.Matrix4(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])}};THREE.Ray=function(e,t){this.origin=void 0!==e?e:new THREE.Vector3;this.direction=void 0!==t?t:new THREE.Vector3};THREE.Ray.prototype={constructor:THREE.Ray,set:function(e,t){this.origin.copy(e);this.direction.copy(t);return this},copy:function(e){this.origin.copy(e.origin);this.direction.copy(e.direction);return this},at:function(e,t){var i=t||new THREE.Vector3;return i.copy(this.direction).multiplyScalar(e).add(this.origin)},recast:function(){var e=new THREE.Vector3;return function(t){this.origin.copy(this.at(t,e));return this}}(),closestPointToPoint:function(e,t){var i=t||new THREE.Vector3;i.subVectors(e,this.origin);var r=i.dot(this.direction);if(0>r)return i.copy(this.origin);else return i.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(){var e=new THREE.Vector3;return function(t){var i=e.subVectors(t,this.origin).dot(this.direction);if(0>i)return this.origin.distanceTo(t);e.copy(this.direction).multiplyScalar(i).add(this.origin);return e.distanceTo(t)}}(),distanceSqToSegment:function(e,t,i,r){var n=e.clone().add(t).multiplyScalar(.5);var o=t.clone().sub(e).normalize();var a=.5*e.distanceTo(t);var s=this.origin.clone().sub(n);var l=-this.direction.dot(o);var h=s.dot(this.direction);var c=-s.dot(o);var u=s.lengthSq();var f=Math.abs(1-l*l);var d,p,m,g;if(f>=0){d=l*c-h;p=l*h-c;g=a*f;if(d>=0)if(p>=-g)if(g>=p){var v=1/f;d*=v;p*=v;m=d*(d+l*p+2*h)+p*(l*d+p+2*c)+u}else{p=a;d=Math.max(0,-(l*p+h));m=-d*d+p*(p+2*c)+u}else{p=-a;d=Math.max(0,-(l*p+h));m=-d*d+p*(p+2*c)+u}else if(-g>=p){d=Math.max(0,-(-l*a+h));p=d>0?-a:Math.min(Math.max(-a,-c),a);m=-d*d+p*(p+2*c)+u}else if(g>=p){d=0;p=Math.min(Math.max(-a,-c),a);m=p*(p+2*c)+u}else{d=Math.max(0,-(l*a+h));p=d>0?a:Math.min(Math.max(-a,-c),a);m=-d*d+p*(p+2*c)+u}}else{p=l>0?-a:a;d=Math.max(0,-(l*p+h));m=-d*d+p*(p+2*c)+u}if(i)i.copy(this.direction.clone().multiplyScalar(d).add(this.origin));if(r)r.copy(o.clone().multiplyScalar(p).add(n));return m},isIntersectionSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},isIntersectionPlane:function(e){var t=e.distanceToPoint(this.origin);if(0===t)return!0;var i=e.normal.dot(this.direction);if(0>i*t)return!0;else return!1},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0==t)if(0==e.distanceToPoint(this.origin))return 0;else return null;var i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null},intersectPlane:function(e,t){var i=this.distanceToPlane(e);if(null===i)return null;else return this.at(i,t)},applyMatrix4:function(e){this.direction.add(this.origin).applyMatrix4(e);this.origin.applyMatrix4(e);this.direction.sub(this.origin);return this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}};THREE.Sphere=function(e,t){this.center=void 0!==e?e:new THREE.Vector3;this.radius=void 0!==t?t:0};THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(e,t){this.center.copy(e);this.radius=t;return this},setFromPoints:function(e){var t,i=0;for(var r=0,n=e.length;n>r;r++){t=e[r].lengthSq();i=Math.max(i,t)}this.center.set(0,0,0);this.radius=Math.sqrt(i);return this},copy:function(e){this.center.copy(e.center);this.radius=e.radius;return this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},clampPoint:function(e,t){var i=this.center.distanceToSquared(e);var r=t||new THREE.Vector3;r.copy(e);if(i>this.radius*this.radius){r.sub(this.center).normalize();r.multiplyScalar(this.radius).add(this.center)}return r
},getBoundingBox:function(e){var t=e||new THREE.Box3;t.set(this.center,this.center);t.expandByScalar(this.radius);return t},applyMatrix4:function(e){this.center.applyMatrix4(e);this.radius=this.radius*e.getMaxScaleOnAxis();return this},translate:function(e){this.center.add(e);return this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}};THREE.Frustum=function(e,t,i,r,n,o){this.planes=[void 0!==e?e:new THREE.Plane,void 0!==t?t:new THREE.Plane,void 0!==i?i:new THREE.Plane,void 0!==r?r:new THREE.Plane,void 0!==n?n:new THREE.Plane,void 0!==o?o:new THREE.Plane]};THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(e,t,i,r,n,o){var a=this.planes;a[0].copy(e);a[1].copy(t);a[2].copy(i);a[3].copy(r);a[4].copy(n);a[5].copy(o);return this},copy:function(e){var t=this.planes;for(var i=0;6>i;i++)t[i].copy(e.planes[i]);return this},setFromMatrix:function(e){var t=this.planes;var i=e.elements;var r=i[0],n=i[1],o=i[2],a=i[3];var s=i[4],l=i[5],h=i[6],c=i[7];var u=i[8],f=i[9],d=i[10],p=i[11];var m=i[12],g=i[13],v=i[14],E=i[15];t[0].setComponents(a-r,c-s,p-u,E-m).normalize();t[1].setComponents(a+r,c+s,p+u,E+m).normalize();t[2].setComponents(a+n,c+l,p+f,E+g).normalize();t[3].setComponents(a-n,c-l,p-f,E-g).normalize();t[4].setComponents(a-o,c-h,p-d,E-v).normalize();t[5].setComponents(a+o,c+h,p+d,E+v).normalize();return this},intersectsObject:function(){var e=new THREE.Vector3;return function(t){var i=t.geometry;var r=t.matrixWorld;if(null===i.boundingSphere)i.computeBoundingSphere();var n=-i.boundingSphere.radius*r.getMaxScaleOnAxis();e.getPositionFromMatrix(r);var o=this.planes;for(var a=0;6>a;a++){var s=o[a].distanceToPoint(e);if(n>s)return!1}return!0}}(),intersectsSphere:function(e){var t=this.planes;var i=e.center;var r=-e.radius;for(var n=0;6>n;n++){var o=t[n].distanceToPoint(i);if(r>o)return!1}return!0},intersectsBox:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(i){var r=this.planes;for(var n=0;6>n;n++){var o=r[n];e.x=o.normal.x>0?i.min.x:i.max.x;t.x=o.normal.x>0?i.max.x:i.min.x;e.y=o.normal.y>0?i.min.y:i.max.y;t.y=o.normal.y>0?i.max.y:i.min.y;e.z=o.normal.z>0?i.min.z:i.max.z;t.z=o.normal.z>0?i.max.z:i.min.z;var a=o.distanceToPoint(e);var s=o.distanceToPoint(t);if(0>a&&0>s)return!1}return!0}}(),containsPoint:function(e){var t=this.planes;for(var i=0;6>i;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}};THREE.Plane=function(e,t){this.normal=void 0!==e?e:new THREE.Vector3(1,0,0);this.constant=void 0!==t?t:0};THREE.Plane.prototype={constructor:THREE.Plane,set:function(e,t){this.normal.copy(e);this.constant=t;return this},setComponents:function(e,t,i,r){this.normal.set(e,t,i);this.constant=r;return this},setFromNormalAndCoplanarPoint:function(e,t){this.normal.copy(e);this.constant=-t.dot(this.normal);return this},setFromCoplanarPoints:function(){var e=new THREE.Vector3;var t=new THREE.Vector3;return function(i,r,n){var o=e.subVectors(n,r).cross(t.subVectors(i,r)).normalize();this.setFromNormalAndCoplanarPoint(o,i);return this}}(),copy:function(e){this.normal.copy(e.normal);this.constant=e.constant;return this},normalize:function(){var e=1/this.normal.length();this.normal.multiplyScalar(e);this.constant*=e;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var i=this.distanceToPoint(e);var r=t||new THREE.Vector3;return r.copy(this.normal).multiplyScalar(i)},isIntersectionLine:function(e){var t=this.distanceToPoint(e.start);var i=this.distanceToPoint(e.end);return 0>t&&i>0||0>i&&t>0},intersectLine:function(){var e=new THREE.Vector3;return function(t,i){var r=i||new THREE.Vector3;var n=t.delta(e);var o=this.normal.dot(n);if(0==o)if(0==this.distanceToPoint(t.start))return r.copy(t.start);else return void 0;var a=-(t.start.dot(this.normal)+this.constant)/o;if(0>a||a>1)return void 0;else return r.copy(n).multiplyScalar(a).add(t.start)}}(),coplanarPoint:function(e){var t=e||new THREE.Vector3;return t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new THREE.Vector3;var t=new THREE.Vector3;return function(i,r){r=r||(new THREE.Matrix3).getNormalMatrix(i);var n=e.copy(this.normal).applyMatrix3(r);var o=this.coplanarPoint(t);o.applyMatrix4(i);this.setFromNormalAndCoplanarPoint(n,o);return this}}(),translate:function(e){this.constant=this.constant-e.dot(this.normal);return this},equals:function(e){return e.normal.equals(this.normal)&&e.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}};THREE.Math={PI2:2*Math.PI,generateUUID:function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");var t=new Array(36);var i,r=0;return function(){for(var n=0;36>n;n++)if(8==n||13==n||18==n||23==n)t[n]="-";else if(14==n)t[n]="4";else{if(2>=r)r=0|33554432+16777216*Math.random();i=15&r;r>>=4;t[n]=e[19==n?8|3&i:i]}return t.join("")}}(),clamp:function(e,t,i){return t>e?t:e>i?i:e},clampBottom:function(e,t){return t>e?t:e},mapLinear:function(e,t,i,r,n){return r+(e-t)*(n-r)/(i-t)},smoothstep:function(e,t,i){if(t>=e)return 0;if(e>=i)return 1;e=(e-t)/(i-t);return e*e*(3-2*e)},smootherstep:function(e,t,i){if(t>=e)return 0;if(e>=i)return 1;e=(e-t)/(i-t);return e*e*e*(e*(6*e-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},sign:function(e){return 0>e?-1:e>0?1:0},degToRad:function(){var e=Math.PI/180;return function(t){return t*e}}(),radToDeg:function(){var e=180/Math.PI;return function(t){return t*e}}()};THREE.Spline=function(e){function t(e,t,i,r,n,o,a){var s=.5*(i-e),l=.5*(r-t);return(2*(t-i)+s+l)*a+(-3*(t-i)-2*s-l)*o+s*n+t}this.points=e;var i,r,n,o,a,s,l,h,c,u=[],f={x:0,y:0,z:0};this.initFromArray=function(e){this.points=[];for(var t=0;t<e.length;t++)this.points[t]={x:e[t][0],y:e[t][1],z:e[t][2]}};this.getPoint=function(e){i=(this.points.length-1)*e;r=Math.floor(i);n=i-r;u[0]=0===r?r:r-1;u[1]=r;u[2]=r>this.points.length-2?this.points.length-1:r+1;u[3]=r>this.points.length-3?this.points.length-1:r+2;s=this.points[u[0]];l=this.points[u[1]];h=this.points[u[2]];c=this.points[u[3]];o=n*n;a=n*o;f.x=t(s.x,l.x,h.x,c.x,n,o,a);f.y=t(s.y,l.y,h.y,c.y,n,o,a);f.z=t(s.z,l.z,h.z,c.z,n,o,a);return f};this.getControlPointsArray=function(){var e,t,i=this.points.length,r=[];for(e=0;i>e;e++){t=this.points[e];r[e]=[t.x,t.y,t.z]}return r};this.getLength=function(e){var t,i,r,n,o=0,a=0,s=0,l=new THREE.Vector3,h=new THREE.Vector3,c=[],u=0;c[0]=0;if(!e)e=100;r=this.points.length*e;l.copy(this.points[0]);for(t=1;r>t;t++){i=t/r;n=this.getPoint(i);h.copy(n);u+=h.distanceTo(l);l.copy(n);o=(this.points.length-1)*i;a=Math.floor(o);if(a!=s){c[a]=u;s=a}}c[c.length]=u;return{chunks:c,total:u}};this.reparametrizeByArcLength=function(e){var t,i,r,n,o,a,s,l,h=[],c=new THREE.Vector3,u=this.getLength();h.push(c.copy(this.points[0]).clone());for(t=1;t<this.points.length;t++){a=u.chunks[t]-u.chunks[t-1];s=Math.ceil(e*a/u.total);n=(t-1)/(this.points.length-1);o=t/(this.points.length-1);for(i=1;s-1>i;i++){r=n+i*(1/s)*(o-n);l=this.getPoint(r);h.push(c.copy(l).clone())}h.push(c.copy(this.points[t]).clone())}this.points=h}};THREE.Triangle=function(e,t,i){this.a=void 0!==e?e:new THREE.Vector3;this.b=void 0!==t?t:new THREE.Vector3;this.c=void 0!==i?i:new THREE.Vector3};THREE.Triangle.normal=function(){var e=new THREE.Vector3;return function(t,i,r,n){var o=n||new THREE.Vector3;o.subVectors(r,i);e.subVectors(t,i);o.cross(e);var a=o.lengthSq();if(a>0)return o.multiplyScalar(1/Math.sqrt(a));else return o.set(0,0,0)}}();THREE.Triangle.barycoordFromPoint=function(){var e=new THREE.Vector3;var t=new THREE.Vector3;var i=new THREE.Vector3;return function(r,n,o,a,s){e.subVectors(a,n);t.subVectors(o,n);i.subVectors(r,n);var l=e.dot(e);var h=e.dot(t);var c=e.dot(i);var u=t.dot(t);var f=t.dot(i);var d=l*u-h*h;var p=s||new THREE.Vector3;if(0==d)return p.set(-2,-1,-1);var m=1/d;var g=(u*c-h*f)*m;var v=(l*f-h*c)*m;return p.set(1-g-v,v,g)}}();THREE.Triangle.containsPoint=function(){var e=new THREE.Vector3;return function(t,i,r,n){var o=THREE.Triangle.barycoordFromPoint(t,i,r,n,e);return o.x>=0&&o.y>=0&&o.x+o.y<=1}}();THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(e,t,i){this.a.copy(e);this.b.copy(t);this.c.copy(i);return this},setFromPointsAndIndices:function(e,t,i,r){this.a.copy(e[t]);this.b.copy(e[i]);this.c.copy(e[r]);return this},copy:function(e){this.a.copy(e.a);this.b.copy(e.b);this.c.copy(e.c);return this},area:function(){var e=new THREE.Vector3;var t=new THREE.Vector3;return function(){e.subVectors(this.c,this.b);t.subVectors(this.a,this.b);return.5*e.cross(t).length()}}(),midpoint:function(e){var t=e||new THREE.Vector3;return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return THREE.Triangle.normal(this.a,this.b,this.c,e)},plane:function(e){var t=e||new THREE.Plane;return t.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return THREE.Triangle.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return THREE.Triangle.containsPoint(e,this.a,this.b,this.c)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)},clone:function(){return(new THREE.Triangle).copy(this)}};THREE.Vertex=function(e){console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead.");return e};THREE.UV=function(e,t){console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead.");return new THREE.Vector2(e,t)};THREE.Clock=function(e){this.autoStart=void 0!==e?e:!0;this.startTime=0;this.oldTime=0;this.elapsedTime=0;this.running=!1};THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();this.oldTime=this.startTime;this.running=!0},stop:function(){this.getElapsedTime();this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)this.start();if(this.running){var t=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();e=.001*(t-this.oldTime);this.oldTime=t;this.elapsedTime+=e}return e}};THREE.EventDispatcher=function(){};THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(e){e.addEventListener=THREE.EventDispatcher.prototype.addEventListener;e.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener;e.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener;e.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(e,t){if(void 0===this._listeners)this._listeners={};var i=this._listeners;if(void 0===i[e])i[e]=[];if(-1===i[e].indexOf(t))i[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var i=this._listeners;if(void 0!==i[e]&&-1!==i[e].indexOf(t))return!0;else return!1},removeEventListener:function(e,t){if(void 0!==this._listeners){var i=this._listeners;var r=i[e].indexOf(t);if(-1!==r)i[e].splice(r,1)}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners;var i=t[e.type];if(void 0!==i){e.target=this;for(var r=0,n=i.length;n>r;r++)i[r].call(this,e)}}}};!function(e){e.Raycaster=function(t,i,r,n){this.ray=new e.Ray(t,i);if(this.ray.direction.lengthSq()>0)this.ray.direction.normalize();this.near=r||0;this.far=n||1/0};var t=new e.Sphere;var i=new e.Ray;var r=new e.Plane;var n=new e.Vector3;var o=new e.Vector3;var a=new e.Matrix4;var s=function(e,t){return e.distance-t.distance};var l=function(s,h,c){if(s instanceof e.Particle){o.getPositionFromMatrix(s.matrixWorld);var u=h.ray.distanceToPoint(o);if(u>s.scale.x)return c;c.push({distance:u,point:s.position,face:null,object:s})}else if(s instanceof e.LOD){o.getPositionFromMatrix(s.matrixWorld);var u=h.ray.origin.distanceTo(o);l(s.getObjectForDistance(u),h,c)}else if(s instanceof e.Mesh){var f=s.geometry;o.getPositionFromMatrix(s.matrixWorld);if(null===f.boundingSphere)f.computeBoundingSphere();t.set(o,f.boundingSphere.radius*s.matrixWorld.getMaxScaleOnAxis());if(h.ray.isIntersectionSphere(t)===!1)return c;var d=f.vertices;if(f instanceof e.BufferGeometry){var p=s.material;if(void 0===p)return c;if(f.dynamic===!1)return c;var m=s.material instanceof e.MeshFaceMaterial;var g=m===!0?s.material.materials:null;var v=s.material.side;var E,y,T;var _=h.precision;a.getInverse(s.matrixWorld);i.copy(h.ray).applyMatrix4(a);var b;var x=!1;if(f.attributes.index){x=!0;b=f.attributes.index.numItems/3}else b=f.attributes.position.numItems/9;var R=new e.Vector3;var w=new e.Vector3;var H=new e.Vector3;new e.Vector3;new e.Vector3;for(var M=0;M<f.offsets.length;++M){var S=f.offsets[M].start;var C=f.offsets[M].count;var A=f.offsets[M].index;for(var D=S,P=S+C;P>D;D+=3){if(x){E=A+f.attributes.index.array[D];y=A+f.attributes.index.array[D+1];T=A+f.attributes.index.array[D+2]}else{E=A;y=A+1;T=A+2}R.set(f.attributes.position.array[3*E],f.attributes.position.array[3*E+1],f.attributes.position.array[3*E+2]);w.set(f.attributes.position.array[3*y],f.attributes.position.array[3*y+1],f.attributes.position.array[3*y+2]);H.set(f.attributes.position.array[3*T],f.attributes.position.array[3*T+1],f.attributes.position.array[3*T+2]);r.setFromCoplanarPoints(R,w,H);var k=i.distanceToPlane(r);if(!(_>k))if(null!==k){v=p.side;if(v!==e.DoubleSide){var L=i.direction.dot(r.normal);if(!(v===e.FrontSide?0>L:L>0))continue}if(!(k<h.near||k>h.far)){n=i.at(k,n);if(e.Triangle.containsPoint(n,R,w,H)!==!1)c.push({distance:k,point:h.ray.at(k),face:null,faceIndex:null,object:s});else;}else;}else;else;}}}else if(f instanceof e.Geometry){var m=s.material instanceof e.MeshFaceMaterial;var g=m===!0?s.material.materials:null;var v=s.material.side;var E,y,T,F;var _=h.precision;a.getInverse(s.matrixWorld);i.copy(h.ray).applyMatrix4(a);for(var z=0,b=f.faces.length;b>z;z++){var N=f.faces[z];var p=m===!0?g[N.materialIndex]:s.material;if(void 0!==p){r.setFromNormalAndCoplanarPoint(N.normal,d[N.a]);var k=i.distanceToPlane(r);if(!(_>k))if(null!==k){v=p.side;if(v!==e.DoubleSide){var L=i.direction.dot(r.normal);if(!(v===e.FrontSide?0>L:L>0))continue}if(!(k<h.near||k>h.far)){n=i.at(k,n);if(N instanceof e.Face3){E=d[N.a];y=d[N.b];T=d[N.c];if(e.Triangle.containsPoint(n,E,y,T)===!1)continue}else if(N instanceof e.Face4){E=d[N.a];y=d[N.b];T=d[N.c];F=d[N.d];if(e.Triangle.containsPoint(n,E,y,F)===!1&&e.Triangle.containsPoint(n,y,T,F)===!1)continue}else throw Error("face type not supported");c.push({distance:k,point:h.ray.at(k),face:N,faceIndex:z,object:s})}else;}else;else;}else;}}}else if(s instanceof e.Line){var _=h.linePrecision;var I=_*_;var f=s.geometry;if(null===f.boundingSphere)f.computeBoundingSphere();o.getPositionFromMatrix(s.matrixWorld);t.set(o,f.boundingSphere.radius*s.matrixWorld.getMaxScaleOnAxis());if(h.ray.isIntersectionSphere(t)===!1)return c;a.getInverse(s.matrixWorld);i.copy(h.ray).applyMatrix4(a);i.direction.normalize();var d=f.vertices;var O=d.length;var U=new e.Vector3;var V=new e.Vector3;var B=s.type===e.LineStrip?1:2;for(var D=0;O-1>D;D+=B){var j=i.distanceSqToSegment(d[D],d[D+1],V,U);if(I>=j){var u=i.origin.distanceTo(V);if(h.near<=u&&u<=h.far)c.push({distance:u,point:U.clone().applyMatrix4(s.matrixWorld),face:null,faceIndex:null,object:s})}}}};var h=function(e,t,i){var r=e.getDescendants();for(var n=0,o=r.length;o>n;n++)l(r[n],t,i)};e.Raycaster.prototype.precision=1e-4;e.Raycaster.prototype.linePrecision=1;e.Raycaster.prototype.set=function(e,t){this.ray.set(e,t);if(this.ray.direction.length()>0)this.ray.direction.normalize()};e.Raycaster.prototype.intersectObject=function(e,t){var i=[];if(t===!0)h(e,this,i);l(e,this,i);i.sort(s);return i};e.Raycaster.prototype.intersectObjects=function(e,t){var i=[];for(var r=0,n=e.length;n>r;r++){l(e[r],this,i);if(t===!0)h(e[r],this,i)}i.sort(s);return i}}(THREE);THREE.Object3D=function(){this.id=THREE.Object3DIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.parent=void 0;this.children=[];this.up=new THREE.Vector3(0,1,0);this.position=new THREE.Vector3;this.rotation=new THREE.Euler;this.quaternion=new THREE.Quaternion;this.scale=new THREE.Vector3(1,1,1);this.rotation._quaternion=this.quaternion;this.quaternion._euler=this.rotation;this.renderDepth=null;this.rotationAutoUpdate=!0;this.matrix=new THREE.Matrix4;this.matrixWorld=new THREE.Matrix4;this.matrixAutoUpdate=!0;this.matrixWorldNeedsUpdate=!0;this.visible=!0;this.castShadow=!1;this.receiveShadow=!1;this.frustumCulled=!0;this.userData={}};THREE.Object3D.prototype={constructor:THREE.Object3D,get eulerOrder(){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order.");return this.rotation.order},set eulerOrder(e){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order.");this.rotation.order=e},get useQuaternion(){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(){var e=new THREE.Matrix4;return function(t){this.matrix.multiplyMatrices(t,this.matrix);this.position.getPositionFromMatrix(this.matrix);this.scale.getScaleFromMatrix(this.matrix);e.extractRotation(this.matrix);this.quaternion.setFromRotationMatrix(e)}}(),setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new THREE.Quaternion;return function(t,i){e.setFromAxisAngle(t,i);this.quaternion.multiply(e);return this}}(),rotateX:function(){var e=new THREE.Vector3(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new THREE.Vector3(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new THREE.Vector3(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new THREE.Vector3;return function(t,i){e.copy(t);e.applyQuaternion(this.quaternion);this.position.add(e.multiplyScalar(i));return this}}(),translate:function(e,t){console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed.");return this.translateOnAxis(t,e)},translateX:function(){var e=new THREE.Vector3(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new THREE.Vector3(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new THREE.Vector3(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new THREE.Matrix4;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new THREE.Matrix4;return function(t){e.lookAt(t,this.position,this.up);this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(e!==this){if(e instanceof THREE.Object3D){if(void 0!==e.parent)e.parent.remove(e);e.parent=this;e.dispatchEvent({type:"added"});this.children.push(e);var t=this;for(;void 0!==t.parent;)t=t.parent;if(void 0!==t&&t instanceof THREE.Scene)t.__addObject(e)}}else console.warn("THREE.Object3D.add: An object can't be added as a child of itself.")},remove:function(e){var t=this.children.indexOf(e);if(-1!==t){e.parent=void 0;e.dispatchEvent({type:"removed"});this.children.splice(t,1);var i=this;for(;void 0!==i.parent;)i=i.parent;if(void 0!==i&&i instanceof THREE.Scene)i.__removeObject(e)}},traverse:function(e){e(this);for(var t=0,i=this.children.length;i>t;t++)this.children[t].traverse(e)},getObjectById:function(e,t){for(var i=0,r=this.children.length;r>i;i++){var n=this.children[i];if(n.id===e)return n;if(t===!0){n=n.getObjectById(e,t);if(void 0!==n)return n}}return void 0},getObjectByName:function(e,t){for(var i=0,r=this.children.length;r>i;i++){var n=this.children[i];if(n.name===e)return n;if(t===!0){n=n.getObjectByName(e,t);if(void 0!==n)return n}}return void 0},getChildByName:function(e,t){console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(e,t)},getDescendants:function(e){if(void 0===e)e=[];Array.prototype.push.apply(e,this.children);for(var t=0,i=this.children.length;i>t;t++)this.children[t].getDescendants(e);return e},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){if(this.matrixAutoUpdate===!0)this.updateMatrix();if(this.matrixWorldNeedsUpdate===!0||e===!0){if(void 0===this.parent)this.matrixWorld.copy(this.matrix);else this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix);this.matrixWorldNeedsUpdate=!1;e=!0}for(var t=0,i=this.children.length;i>t;t++)this.children[t].updateMatrixWorld(e)},clone:function(e,t){if(void 0===e)e=new THREE.Object3D;if(void 0===t)t=!0;e.name=this.name;e.up.copy(this.up);e.position.copy(this.position);e.quaternion.copy(this.quaternion);e.scale.copy(this.scale);e.renderDepth=this.renderDepth;e.rotationAutoUpdate=this.rotationAutoUpdate;e.matrix.copy(this.matrix);e.matrixWorld.copy(this.matrixWorld);e.matrixAutoUpdate=this.matrixAutoUpdate;e.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;e.visible=this.visible;e.castShadow=this.castShadow;e.receiveShadow=this.receiveShadow;e.frustumCulled=this.frustumCulled;e.userData=JSON.parse(JSON.stringify(this.userData));if(t===!0)for(var i=0;i<this.children.length;i++){var r=this.children[i];e.add(r.clone())}return e}};THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype);THREE.Object3DIdCount=0;THREE.Projector=function(){function e(){if(h===_){var e=new THREE.RenderableObject;T.push(e);_++;h++;return e}return T[h++]}function t(){if(u===x){var e=new THREE.RenderableVertex;b.push(e);x++;u++;return e}return b[u++]}function i(){if(d===w){var e=new THREE.RenderableFace3;R.push(e);w++;d++;return e}return R[d++]}function r(){if(p===M){var e=new THREE.RenderableFace4;H.push(e);M++;p++;return e}return H[p++]}function n(){if(g===C){var e=new THREE.RenderableLine;S.push(e);C++;g++;return e}return S[g++]}function o(){if(E===D){var e=new THREE.RenderableParticle;A.push(e);D++;E++;return e}return A[E++]}function a(e,t){if(e.z!==t.z)return t.z-e.z;else if(e.id!==t.id)return e.id-t.id;else return 0}function s(e,t){var i=0,r=1,n=e.z+e.w,o=t.z+t.w,a=-e.z+e.w,s=-t.z+t.w;if(n>=0&&o>=0&&a>=0&&s>=0)return!0;else if(0>n&&0>o||0>a&&0>s)return!1;else{if(0>n)i=Math.max(i,n/(n-o));else if(0>o)r=Math.min(r,n/(n-o));if(0>a)i=Math.max(i,a/(a-s));else if(0>s)r=Math.min(r,a/(a-s));if(i>r)return!1;else{e.lerp(t,i);t.lerp(e,1-r);return!0}}}var l,h,c,u,f,d,p,m,g,v,E,y,T=[],_=0,b=[],x=0,R=[],w=0,H=[],M=0,S=[],C=0,A=[],D=0,P={objects:[],sprites:[],lights:[],elements:[]},k=new THREE.Vector3,L=new THREE.Vector4,F=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),z=new THREE.Box3,N=new Array(3),I=new Array(4),O=new THREE.Matrix4,U=new THREE.Matrix4,V=new THREE.Matrix4,B=new THREE.Matrix3,j=new THREE.Matrix3,W=new THREE.Vector3,G=new THREE.Frustum,X=new THREE.Vector4,Y=new THREE.Vector4;this.projectVector=function(e,t){t.matrixWorldInverse.getInverse(t.matrixWorld);U.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse);return e.applyProjection(U)};this.unprojectVector=function(e,t){t.projectionMatrixInverse.getInverse(t.projectionMatrix);U.multiplyMatrices(t.matrixWorld,t.projectionMatrixInverse);return e.applyProjection(U)};this.pickingRay=function(e,t){e.z=-1;var i=new THREE.Vector3(e.x,e.y,1);this.unprojectVector(e,t);this.unprojectVector(i,t);i.sub(e).normalize();return new THREE.Raycaster(e,i)};var q=function(t){l=e();l.id=t.id;l.object=t;if(null!==t.renderDepth)l.z=t.renderDepth;else{k.getPositionFromMatrix(t.matrixWorld);k.applyProjection(U);l.z=k.z}return l};var K=function(e){if(e.visible!==!1){if(e instanceof THREE.Light)P.lights.push(e);else if(e instanceof THREE.Mesh||e instanceof THREE.Line){if(e.frustumCulled===!1||G.intersectsObject(e)===!0)P.objects.push(q(e))}else if(e instanceof THREE.Sprite||e instanceof THREE.Particle)P.sprites.push(q(e));for(var t=0,i=e.children.length;i>t;t++)K(e.children[t])}};var Q=function(e,t){h=0;P.objects.length=0;P.sprites.length=0;P.lights.length=0;K(e);if(t===!0)P.objects.sort(a)};this.projectScene=function(e,l,h,T){var _,x,R,w,H,M,S,C,A,D,k,q,K,Z,$,J,et,tt,it,rt,nt,ot,at,st,lt,ht,ct=!1;d=0;p=0;g=0;E=0;P.elements.length=0;if(e.autoUpdate===!0)e.updateMatrixWorld();if(void 0===l.parent)l.updateMatrixWorld();O.copy(l.matrixWorldInverse.getInverse(l.matrixWorld));U.multiplyMatrices(l.projectionMatrix,O);j.getNormalMatrix(O);G.setFromMatrix(U);Q(e,h);for(_=0,x=P.objects.length;x>_;_++){K=P.objects[_].object;y=K.matrixWorld;u=0;if(K instanceof THREE.Mesh){Z=K.geometry;$=Z.vertices;J=Z.faces;it=Z.faceVertexUvs;B.getNormalMatrix(y);lt=K.material instanceof THREE.MeshFaceMaterial;ht=lt===!0?K.material:null;for(R=0,w=$.length;w>R;R++){c=t();c.positionWorld.copy($[R]).applyMatrix4(y);c.positionScreen.copy(c.positionWorld).applyMatrix4(U);var ut=1/c.positionScreen.w;c.positionScreen.x*=ut;c.positionScreen.y*=ut;c.positionScreen.z*=ut;c.visible=!(c.positionScreen.x<-1||c.positionScreen.x>1||c.positionScreen.y<-1||c.positionScreen.y>1||c.positionScreen.z<-1||c.positionScreen.z>1)}for(H=0,M=J.length;M>H;H++){et=J[H];var ft=lt===!0?ht.materials[et.materialIndex]:K.material;if(void 0!==ft){var dt=ft.side;if(et instanceof THREE.Face3){nt=b[et.a];ot=b[et.b];at=b[et.c];N[0]=nt.positionScreen;N[1]=ot.positionScreen;N[2]=at.positionScreen;if(nt.visible===!0||ot.visible===!0||at.visible===!0||F.isIntersectionBox(z.setFromPoints(N))){ct=(at.positionScreen.x-nt.positionScreen.x)*(ot.positionScreen.y-nt.positionScreen.y)-(at.positionScreen.y-nt.positionScreen.y)*(ot.positionScreen.x-nt.positionScreen.x)<0;if(dt===THREE.DoubleSide||ct===(dt===THREE.FrontSide)){f=i();f.id=K.id;f.v1.copy(nt);f.v2.copy(ot);f.v3.copy(at)}else continue}else continue}else if(et instanceof THREE.Face4){nt=b[et.a];ot=b[et.b];at=b[et.c];st=b[et.d];I[0]=nt.positionScreen;I[1]=ot.positionScreen;I[2]=at.positionScreen;I[3]=st.positionScreen;if(nt.visible===!0||ot.visible===!0||at.visible===!0||st.visible===!0||F.isIntersectionBox(z.setFromPoints(I))){ct=(st.positionScreen.x-nt.positionScreen.x)*(ot.positionScreen.y-nt.positionScreen.y)-(st.positionScreen.y-nt.positionScreen.y)*(ot.positionScreen.x-nt.positionScreen.x)<0||(ot.positionScreen.x-at.positionScreen.x)*(st.positionScreen.y-at.positionScreen.y)-(ot.positionScreen.y-at.positionScreen.y)*(st.positionScreen.x-at.positionScreen.x)<0;if(dt===THREE.DoubleSide||ct===(dt===THREE.FrontSide)){f=r();f.id=K.id;f.v1.copy(nt);f.v2.copy(ot);f.v3.copy(at);f.v4.copy(st)}else continue}else continue}f.normalModel.copy(et.normal);if(ct===!1&&(dt===THREE.BackSide||dt===THREE.DoubleSide))f.normalModel.negate();f.normalModel.applyMatrix3(B).normalize();f.normalModelView.copy(f.normalModel).applyMatrix3(j);f.centroidModel.copy(et.centroid).applyMatrix4(y);tt=et.vertexNormals;for(S=0,C=tt.length;C>S;S++){var pt=f.vertexNormalsModel[S];pt.copy(tt[S]);if(ct===!1&&(dt===THREE.BackSide||dt===THREE.DoubleSide))pt.negate();pt.applyMatrix3(B).normalize();var mt=f.vertexNormalsModelView[S];mt.copy(pt).applyMatrix3(j)}f.vertexNormalsLength=tt.length;for(A=0,D=it.length;D>A;A++){rt=it[A][H];if(void 0!==rt)for(k=0,q=rt.length;q>k;k++)f.uvs[A][k]=rt[k];else;}f.color=et.color;f.material=ft;W.copy(f.centroidModel).applyProjection(U);f.z=W.z;P.elements.push(f)}else;}}else if(K instanceof THREE.Line){V.multiplyMatrices(U,y);$=K.geometry.vertices;nt=t();nt.positionScreen.copy($[0]).applyMatrix4(V);var gt=K.type===THREE.LinePieces?2:1;for(R=1,w=$.length;w>R;R++){nt=t();nt.positionScreen.copy($[R]).applyMatrix4(V);if(!((R+1)%gt>0)){ot=b[u-2];X.copy(nt.positionScreen);Y.copy(ot.positionScreen);if(s(X,Y)===!0){X.multiplyScalar(1/X.w);Y.multiplyScalar(1/Y.w);m=n();m.id=K.id;m.v1.positionScreen.copy(X);m.v2.positionScreen.copy(Y);m.z=Math.max(X.z,Y.z);m.material=K.material;if(K.material.vertexColors===THREE.VertexColors){m.vertexColors[0].copy(K.geometry.colors[R]);m.vertexColors[1].copy(K.geometry.colors[R-1])}P.elements.push(m)}}else;}}}for(_=0,x=P.sprites.length;x>_;_++){K=P.sprites[_].object;y=K.matrixWorld;if(K instanceof THREE.Particle){L.set(y.elements[12],y.elements[13],y.elements[14],1);L.applyMatrix4(U);var ut=1/L.w;L.z*=ut;if(L.z>0&&L.z<1){v=o();v.id=K.id;v.x=L.x*ut;v.y=L.y*ut;v.z=L.z;v.object=K;v.rotation=K.rotation.z;v.scale.x=K.scale.x*Math.abs(v.x-(L.x+l.projectionMatrix.elements[0])/(L.w+l.projectionMatrix.elements[12]));v.scale.y=K.scale.y*Math.abs(v.y-(L.y+l.projectionMatrix.elements[5])/(L.w+l.projectionMatrix.elements[13]));v.material=K.material;P.elements.push(v)}}}if(T===!0)P.elements.sort(a);return P}};THREE.Face3=function(e,t,i,r,n,o){this.a=e;this.b=t;this.c=i;this.normal=r instanceof THREE.Vector3?r:new THREE.Vector3;this.vertexNormals=r instanceof Array?r:[];this.color=n instanceof THREE.Color?n:new THREE.Color;this.vertexColors=n instanceof Array?n:[];this.vertexTangents=[];this.materialIndex=void 0!==o?o:0;this.centroid=new THREE.Vector3};THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var e=new THREE.Face3(this.a,this.b,this.c);e.normal.copy(this.normal);e.color.copy(this.color);e.centroid.copy(this.centroid);e.materialIndex=this.materialIndex;var t,i;for(t=0,i=this.vertexNormals.length;i>t;t++)e.vertexNormals[t]=this.vertexNormals[t].clone();for(t=0,i=this.vertexColors.length;i>t;t++)e.vertexColors[t]=this.vertexColors[t].clone();for(t=0,i=this.vertexTangents.length;i>t;t++)e.vertexTangents[t]=this.vertexTangents[t].clone();return e}};THREE.Face4=function(e,t,i,r,n,o,a){this.a=e;this.b=t;this.c=i;this.d=r;this.normal=n instanceof THREE.Vector3?n:new THREE.Vector3;this.vertexNormals=n instanceof Array?n:[];this.color=o instanceof THREE.Color?o:new THREE.Color;this.vertexColors=o instanceof Array?o:[];this.vertexTangents=[];this.materialIndex=void 0!==a?a:0;this.centroid=new THREE.Vector3};THREE.Face4.prototype={constructor:THREE.Face4,clone:function(){var e=new THREE.Face4(this.a,this.b,this.c,this.d);e.normal.copy(this.normal);e.color.copy(this.color);e.centroid.copy(this.centroid);e.materialIndex=this.materialIndex;var t,i;for(t=0,i=this.vertexNormals.length;i>t;t++)e.vertexNormals[t]=this.vertexNormals[t].clone();for(t=0,i=this.vertexColors.length;i>t;t++)e.vertexColors[t]=this.vertexColors[t].clone();for(t=0,i=this.vertexTangents.length;i>t;t++)e.vertexTangents[t]=this.vertexTangents[t].clone();return e}};THREE.Geometry=function(){this.id=THREE.GeometryIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.vertices=[];this.colors=[];this.normals=[];this.faces=[];this.faceUvs=[[]];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingBox=null;this.boundingSphere=null;this.hasTangents=!1;this.dynamic=!0;this.verticesNeedUpdate=!1;this.elementsNeedUpdate=!1;this.uvsNeedUpdate=!1;this.normalsNeedUpdate=!1;this.tangentsNeedUpdate=!1;this.colorsNeedUpdate=!1;this.lineDistancesNeedUpdate=!1;this.buffersNeedUpdate=!1};THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(e){var t=(new THREE.Matrix3).getNormalMatrix(e);
for(var i=0,r=this.vertices.length;r>i;i++){var n=this.vertices[i];n.applyMatrix4(e)}for(var i=0,r=this.faces.length;r>i;i++){var o=this.faces[i];o.normal.applyMatrix3(t).normalize();for(var a=0,s=o.vertexNormals.length;s>a;a++)o.vertexNormals[a].applyMatrix3(t).normalize();o.centroid.applyMatrix4(e)}if(this.boundingBox instanceof THREE.Box3)this.computeBoundingBox();if(this.boundingSphere instanceof THREE.Sphere)this.computeBoundingSphere()},computeCentroids:function(){var e,t,i;for(e=0,t=this.faces.length;t>e;e++){i=this.faces[e];i.centroid.set(0,0,0);if(i instanceof THREE.Face3){i.centroid.add(this.vertices[i.a]);i.centroid.add(this.vertices[i.b]);i.centroid.add(this.vertices[i.c]);i.centroid.divideScalar(3)}else if(i instanceof THREE.Face4){i.centroid.add(this.vertices[i.a]);i.centroid.add(this.vertices[i.b]);i.centroid.add(this.vertices[i.c]);i.centroid.add(this.vertices[i.d]);i.centroid.divideScalar(4)}}},computeFaceNormals:function(){var e=new THREE.Vector3,t=new THREE.Vector3;for(var i=0,r=this.faces.length;r>i;i++){var n=this.faces[i];var o=this.vertices[n.a];var a=this.vertices[n.b];var s=this.vertices[n.c];e.subVectors(s,a);t.subVectors(o,a);e.cross(t);e.normalize();n.normal.copy(e)}},computeVertexNormals:function(e){var t,i,r,n,o,a;if(void 0===this.__tmpVertices){this.__tmpVertices=new Array(this.vertices.length);a=this.__tmpVertices;for(t=0,i=this.vertices.length;i>t;t++)a[t]=new THREE.Vector3;for(r=0,n=this.faces.length;n>r;r++){o=this.faces[r];if(o instanceof THREE.Face3)o.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];else if(o instanceof THREE.Face4)o.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]}}else{a=this.__tmpVertices;for(t=0,i=this.vertices.length;i>t;t++)a[t].set(0,0,0)}if(e){var s,l,h,c;var u=new THREE.Vector3,f=new THREE.Vector3,d=new THREE.Vector3,p=new THREE.Vector3,m=new THREE.Vector3;for(r=0,n=this.faces.length;n>r;r++){o=this.faces[r];if(o instanceof THREE.Face3){s=this.vertices[o.a];l=this.vertices[o.b];h=this.vertices[o.c];u.subVectors(h,l);f.subVectors(s,l);u.cross(f);a[o.a].add(u);a[o.b].add(u);a[o.c].add(u)}else if(o instanceof THREE.Face4){s=this.vertices[o.a];l=this.vertices[o.b];h=this.vertices[o.c];c=this.vertices[o.d];d.subVectors(c,l);f.subVectors(s,l);d.cross(f);a[o.a].add(d);a[o.b].add(d);a[o.d].add(d);p.subVectors(c,h);m.subVectors(l,h);p.cross(m);a[o.b].add(p);a[o.c].add(p);a[o.d].add(p)}}}else for(r=0,n=this.faces.length;n>r;r++){o=this.faces[r];if(o instanceof THREE.Face3){a[o.a].add(o.normal);a[o.b].add(o.normal);a[o.c].add(o.normal)}else if(o instanceof THREE.Face4){a[o.a].add(o.normal);a[o.b].add(o.normal);a[o.c].add(o.normal);a[o.d].add(o.normal)}}for(t=0,i=this.vertices.length;i>t;t++)a[t].normalize();for(r=0,n=this.faces.length;n>r;r++){o=this.faces[r];if(o instanceof THREE.Face3){o.vertexNormals[0].copy(a[o.a]);o.vertexNormals[1].copy(a[o.b]);o.vertexNormals[2].copy(a[o.c])}else if(o instanceof THREE.Face4){o.vertexNormals[0].copy(a[o.a]);o.vertexNormals[1].copy(a[o.b]);o.vertexNormals[2].copy(a[o.c]);o.vertexNormals[3].copy(a[o.d])}}},computeMorphNormals:function(){var e,t,i,r,n;for(i=0,r=this.faces.length;r>i;i++){n=this.faces[i];if(!n.__originalFaceNormal)n.__originalFaceNormal=n.normal.clone();else n.__originalFaceNormal.copy(n.normal);if(!n.__originalVertexNormals)n.__originalVertexNormals=[];for(e=0,t=n.vertexNormals.length;t>e;e++)if(!n.__originalVertexNormals[e])n.__originalVertexNormals[e]=n.vertexNormals[e].clone();else n.__originalVertexNormals[e].copy(n.vertexNormals[e])}var o=new THREE.Geometry;o.faces=this.faces;for(e=0,t=this.morphTargets.length;t>e;e++){if(!this.morphNormals[e]){this.morphNormals[e]={};this.morphNormals[e].faceNormals=[];this.morphNormals[e].vertexNormals=[];var a=this.morphNormals[e].faceNormals;var s=this.morphNormals[e].vertexNormals;var l,h;for(i=0,r=this.faces.length;r>i;i++){n=this.faces[i];l=new THREE.Vector3;if(n instanceof THREE.Face3)h={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3};else h={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3,d:new THREE.Vector3};a.push(l);s.push(h)}}var c=this.morphNormals[e];o.vertices=this.morphTargets[e].vertices;o.computeFaceNormals();o.computeVertexNormals();var l,h;for(i=0,r=this.faces.length;r>i;i++){n=this.faces[i];l=c.faceNormals[i];h=c.vertexNormals[i];l.copy(n.normal);if(n instanceof THREE.Face3){h.a.copy(n.vertexNormals[0]);h.b.copy(n.vertexNormals[1]);h.c.copy(n.vertexNormals[2])}else{h.a.copy(n.vertexNormals[0]);h.b.copy(n.vertexNormals[1]);h.c.copy(n.vertexNormals[2]);h.d.copy(n.vertexNormals[3])}}}for(i=0,r=this.faces.length;r>i;i++){n=this.faces[i];n.normal=n.__originalFaceNormal;n.vertexNormals=n.__originalVertexNormals}},computeTangents:function(){function e(e,t,i,r,n,o,a){h=e.vertices[t];c=e.vertices[i];u=e.vertices[r];f=l[n];d=l[o];p=l[a];m=c.x-h.x;g=u.x-h.x;v=c.y-h.y;E=u.y-h.y;y=c.z-h.z;T=u.z-h.z;_=d.x-f.x;b=p.x-f.x;x=d.y-f.y;R=p.y-f.y;w=1/(_*R-b*x);D.set((R*m-x*g)*w,(R*v-x*E)*w,(R*y-x*T)*w);P.set((_*g-b*m)*w,(_*E-b*v)*w,(_*T-b*y)*w);C[t].add(D);C[i].add(D);C[r].add(D);A[t].add(P);A[i].add(P);A[r].add(P)}var t,i,r,n,o,a,s,l,h,c,u,f,d,p,m,g,v,E,y,T,_,b,x,R,w,H,M,S,C=[],A=[],D=new THREE.Vector3,P=new THREE.Vector3,k=new THREE.Vector3,L=new THREE.Vector3,F=new THREE.Vector3;for(r=0,n=this.vertices.length;n>r;r++){C[r]=new THREE.Vector3;A[r]=new THREE.Vector3}for(t=0,i=this.faces.length;i>t;t++){s=this.faces[t];l=this.faceVertexUvs[0][t];if(s instanceof THREE.Face3)e(this,s.a,s.b,s.c,0,1,2);else if(s instanceof THREE.Face4){e(this,s.a,s.b,s.d,0,1,3);e(this,s.b,s.c,s.d,1,2,3)}}var z=["a","b","c","d"];for(t=0,i=this.faces.length;i>t;t++){s=this.faces[t];for(o=0;o<s.vertexNormals.length;o++){F.copy(s.vertexNormals[o]);a=s[z[o]];H=C[a];k.copy(H);k.sub(F.multiplyScalar(F.dot(H))).normalize();L.crossVectors(s.vertexNormals[o],H);M=L.dot(A[a]);S=0>M?-1:1;s.vertexTangents[o]=new THREE.Vector4(k.x,k.y,k.z,S)}}this.hasTangents=!0},computeLineDistances:function(){var e=0;var t=this.vertices;for(var i=0,r=t.length;r>i;i++){if(i>0)e+=t[i].distanceTo(t[i-1]);this.lineDistances[i]=e}},computeBoundingBox:function(){if(null===this.boundingBox)this.boundingBox=new THREE.Box3;this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){if(null===this.boundingSphere)this.boundingSphere=new THREE.Sphere;this.boundingSphere.setFromPoints(this.vertices)},mergeVertices:function(){var e={};var t=[],i=[];var r,n;var o=4;var a=Math.pow(10,o);var s,l,h;var c,u,f,d;this.__tmpVertices=void 0;for(s=0,l=this.vertices.length;l>s;s++){r=this.vertices[s];n=Math.round(r.x*a)+"_"+Math.round(r.y*a)+"_"+Math.round(r.z*a);if(void 0===e[n]){e[n]=s;t.push(this.vertices[s]);i[s]=t.length-1}else i[s]=i[e[n]]}var p=[];for(s=0,l=this.faces.length;l>s;s++){h=this.faces[s];if(h instanceof THREE.Face3){h.a=i[h.a];h.b=i[h.b];h.c=i[h.c];c=[h.a,h.b,h.c];var m=-1;for(var g=0;3>g;g++)if(c[g]==c[(g+1)%3]){m=g;p.push(s);break}}else if(h instanceof THREE.Face4){h.a=i[h.a];h.b=i[h.b];h.c=i[h.c];h.d=i[h.d];c=[h.a,h.b,h.c,h.d];var m=-1;for(var g=0;4>g;g++)if(c[g]==c[(g+1)%4]){if(m>=0)p.push(s);m=g}if(m>=0){c.splice(m,1);var v=new THREE.Face3(c[0],c[1],c[2],h.normal,h.color,h.materialIndex);for(u=0,f=this.faceVertexUvs.length;f>u;u++){d=this.faceVertexUvs[u][s];if(d)d.splice(m,1)}if(h.vertexNormals&&h.vertexNormals.length>0){v.vertexNormals=h.vertexNormals;v.vertexNormals.splice(m,1)}if(h.vertexColors&&h.vertexColors.length>0){v.vertexColors=h.vertexColors;v.vertexColors.splice(m,1)}this.faces[s]=v}}}for(s=p.length-1;s>=0;s--){this.faces.splice(s,1);for(u=0,f=this.faceVertexUvs.length;f>u;u++)this.faceVertexUvs[u].splice(s,1)}var E=this.vertices.length-t.length;this.vertices=t;return E},clone:function(){var e=new THREE.Geometry;var t=this.vertices;for(var i=0,r=t.length;r>i;i++)e.vertices.push(t[i].clone());var n=this.faces;for(var i=0,r=n.length;r>i;i++)e.faces.push(n[i].clone());var o=this.faceVertexUvs[0];for(var i=0,r=o.length;r>i;i++){var a=o[i],s=[];for(var l=0,h=a.length;h>l;l++)s.push(new THREE.Vector2(a[l].x,a[l].y));e.faceVertexUvs[0].push(s)}return e},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype);THREE.GeometryIdCount=0;THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++;this.uuid=THREE.Math.generateUUID();this.attributes={};this.dynamic=!1;this.offsets=[];this.boundingBox=null;this.boundingSphere=null;this.hasTangents=!1;this.morphTargets=[]};THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,applyMatrix:function(e){var t;var i;if(this.attributes["position"])t=this.attributes["position"].array;if(this.attributes["normal"])i=this.attributes["normal"].array;if(void 0!==t){e.multiplyVector3Array(t);this.verticesNeedUpdate=!0}if(void 0!==i){var r=(new THREE.Matrix3).getNormalMatrix(e);r.multiplyVector3Array(i);this.normalizeNormals();this.normalsNeedUpdate=!0}},computeBoundingBox:function(){if(null===this.boundingBox)this.boundingBox=new THREE.Box3;var e=this.attributes["position"].array;if(e){var t=this.boundingBox;var i,r,n;if(e.length>=3){t.min.x=t.max.x=e[0];t.min.y=t.max.y=e[1];t.min.z=t.max.z=e[2]}for(var o=3,a=e.length;a>o;o+=3){i=e[o];r=e[o+1];n=e[o+2];if(i<t.min.x)t.min.x=i;else if(i>t.max.x)t.max.x=i;if(r<t.min.y)t.min.y=r;else if(r>t.max.y)t.max.y=r;if(n<t.min.z)t.min.z=n;else if(n>t.max.z)t.max.z=n}}if(void 0===e||0===e.length){this.boundingBox.min.set(0,0,0);this.boundingBox.max.set(0,0,0)}},computeBoundingSphere:function(){if(null===this.boundingSphere)this.boundingSphere=new THREE.Sphere;var e=this.attributes["position"].array;if(e){var t,i=0;var r,n,o;for(var a=0,s=e.length;s>a;a+=3){r=e[a];n=e[a+1];o=e[a+2];t=r*r+n*n+o*o;if(t>i)i=t}this.boundingSphere.radius=Math.sqrt(i)}},computeVertexNormals:function(){if(this.attributes["position"]){var e,t;var i,r;var n=this.attributes["position"].array.length;if(void 0===this.attributes["normal"])this.attributes["normal"]={itemSize:3,array:new Float32Array(n)};else for(e=0,t=this.attributes["normal"].array.length;t>e;e++)this.attributes["normal"].array[e]=0;var o=this.attributes["position"].array;var a=this.attributes["normal"].array;var s,l,h,c,u,f,d=new THREE.Vector3,p=new THREE.Vector3,m=new THREE.Vector3,g=new THREE.Vector3,v=new THREE.Vector3;if(this.attributes["index"]){var E=this.attributes["index"].array;var y=this.offsets;for(i=0,r=y.length;r>i;++i){var T=y[i].start;var _=y[i].count;var b=y[i].index;for(e=T,t=T+_;t>e;e+=3){s=b+E[e];l=b+E[e+1];h=b+E[e+2];c=o[3*s];u=o[3*s+1];f=o[3*s+2];d.set(c,u,f);c=o[3*l];u=o[3*l+1];f=o[3*l+2];p.set(c,u,f);c=o[3*h];u=o[3*h+1];f=o[3*h+2];m.set(c,u,f);g.subVectors(m,p);v.subVectors(d,p);g.cross(v);a[3*s]+=g.x;a[3*s+1]+=g.y;a[3*s+2]+=g.z;a[3*l]+=g.x;a[3*l+1]+=g.y;a[3*l+2]+=g.z;a[3*h]+=g.x;a[3*h+1]+=g.y;a[3*h+2]+=g.z}}}else for(e=0,t=o.length;t>e;e+=9){c=o[e];u=o[e+1];f=o[e+2];d.set(c,u,f);c=o[e+3];u=o[e+4];f=o[e+5];p.set(c,u,f);c=o[e+6];u=o[e+7];f=o[e+8];m.set(c,u,f);g.subVectors(m,p);v.subVectors(d,p);g.cross(v);a[e]=g.x;a[e+1]=g.y;a[e+2]=g.z;a[e+3]=g.x;a[e+4]=g.y;a[e+5]=g.z;a[e+6]=g.x;a[e+7]=g.y;a[e+8]=g.z}this.normalizeNormals();this.normalsNeedUpdate=!0}},normalizeNormals:function(){var e=this.attributes["normal"].array;var t,i,r,n;for(var o=0,a=e.length;a>o;o+=3){t=e[o];i=e[o+1];r=e[o+2];n=1/Math.sqrt(t*t+i*i+r*r);e[o]*=n;e[o+1]*=n;e[o+2]*=n}},computeTangents:function(){function e(e,t,i){f=r[3*e];d=r[3*e+1];p=r[3*e+2];m=r[3*t];g=r[3*t+1];v=r[3*t+2];E=r[3*i];y=r[3*i+1];T=r[3*i+2];_=o[2*e];b=o[2*e+1];x=o[2*t];R=o[2*t+1];w=o[2*i];H=o[2*i+1];M=m-f;S=E-f;C=g-d;A=y-d;D=v-p;P=T-p;k=x-_;L=w-_;F=R-b;z=H-b;N=1/(k*z-L*F);I.set((z*M-F*S)*N,(z*C-F*A)*N,(z*D-F*P)*N);O.set((k*S-L*M)*N,(k*A-L*C)*N,(k*P-L*D)*N);h[e].add(I);h[t].add(I);h[i].add(I);c[e].add(O);c[t].add(O);c[i].add(O)}function t(e){J.x=n[3*e];J.y=n[3*e+1];J.z=n[3*e+2];et.copy(J);it=h[e];Z.copy(it);Z.sub(J.multiplyScalar(J.dot(it))).normalize();$.crossVectors(et,it);rt=$.dot(c[e]);tt=0>rt?-1:1;l[4*e]=Z.x;l[4*e+1]=Z.y;l[4*e+2]=Z.z;l[4*e+3]=tt}if(void 0!==this.attributes["index"]&&void 0!==this.attributes["position"]&&void 0!==this.attributes["normal"]&&void 0!==this.attributes["uv"]){var i=this.attributes["index"].array;var r=this.attributes["position"].array;var n=this.attributes["normal"].array;var o=this.attributes["uv"].array;var a=r.length/3;if(void 0===this.attributes["tangent"]){var s=4*a;this.attributes["tangent"]={itemSize:4,array:new Float32Array(s)}}var l=this.attributes["tangent"].array;var h=[],c=[];for(var u=0;a>u;u++){h[u]=new THREE.Vector3;c[u]=new THREE.Vector3}var f,d,p,m,g,v,E,y,T,_,b,x,R,w,H,M,S,C,A,D,P,k,L,F,z,N;var I=new THREE.Vector3,O=new THREE.Vector3;var U,V;var B,j;var W,G,X;var Y=this.offsets;for(B=0,j=Y.length;j>B;++B){var q=Y[B].start;var K=Y[B].count;var Q=Y[B].index;for(U=q,V=q+K;V>U;U+=3){W=Q+i[U];G=Q+i[U+1];X=Q+i[U+2];e(W,G,X)}}var Z=new THREE.Vector3,$=new THREE.Vector3;var J=new THREE.Vector3,et=new THREE.Vector3;var tt,it,rt;for(B=0,j=Y.length;j>B;++B){var q=Y[B].start;var K=Y[B].count;var Q=Y[B].index;for(U=q,V=q+K;V>U;U+=3){W=Q+i[U];G=Q+i[U+1];X=Q+i[U+2];t(W);t(G);t(X)}}this.hasTangents=!0;this.tangentsNeedUpdate=!0}else console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()")},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype);THREE.Camera=function(){THREE.Object3D.call(this);this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4;this.projectionMatrixInverse=new THREE.Matrix4};THREE.Camera.prototype=Object.create(THREE.Object3D.prototype);THREE.Camera.prototype.lookAt=function(){var e=new THREE.Matrix4;return function(t){e.lookAt(this.position,t,this.up);this.quaternion.setFromRotationMatrix(e)}}();THREE.OrthographicCamera=function(e,t,i,r,n,o){THREE.Camera.call(this);this.left=e;this.right=t;this.top=i;this.bottom=r;this.near=void 0!==n?n:.1;this.far=void 0!==o?o:2e3;this.updateProjectionMatrix()};THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype);THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)};THREE.PerspectiveCamera=function(e,t,i,r){THREE.Camera.call(this);this.fov=void 0!==e?e:50;this.aspect=void 0!==t?t:1;this.near=void 0!==i?i:.1;this.far=void 0!==r?r:2e3;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype);THREE.PerspectiveCamera.prototype.setLens=function(e,t){if(void 0===t)t=24;this.fov=2*THREE.Math.radToDeg(Math.atan(t/(2*e)));this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype.setViewOffset=function(e,t,i,r,n,o){this.fullWidth=e;this.fullHeight=t;this.x=i;this.y=r;this.width=n;this.height=o;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var e=this.fullWidth/this.fullHeight;var t=Math.tan(THREE.Math.degToRad(.5*this.fov))*this.near;var i=-t;var r=e*i;var n=e*t;var o=Math.abs(n-r);var a=Math.abs(t-i);this.projectionMatrix.makeFrustum(r+this.x*o/this.fullWidth,r+(this.x+this.width)*o/this.fullWidth,t-(this.y+this.height)*a/this.fullHeight,t-this.y*a/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)};THREE.Light=function(e){THREE.Object3D.call(this);this.color=new THREE.Color(e)};THREE.Light.prototype=Object.create(THREE.Object3D.prototype);THREE.Light.prototype.clone=function(e){if(void 0===e)e=new THREE.Light;THREE.Object3D.prototype.clone.call(this,e);e.color.copy(this.color);return e};THREE.AmbientLight=function(e){THREE.Light.call(this,e)};THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype);THREE.AmbientLight.prototype.clone=function(){var e=new THREE.AmbientLight;THREE.Light.prototype.clone.call(this,e);return e};THREE.AreaLight=function(e,t){THREE.Light.call(this,e);this.normal=new THREE.Vector3(0,-1,0);this.right=new THREE.Vector3(1,0,0);this.intensity=void 0!==t?t:1;this.width=1;this.height=1;this.constantAttenuation=1.5;this.linearAttenuation=.5;this.quadraticAttenuation=.1};THREE.AreaLight.prototype=Object.create(THREE.Light.prototype);THREE.DirectionalLight=function(e,t){THREE.Light.call(this,e);this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==t?t:1;this.castShadow=!1;this.onlyShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5e3;this.shadowCameraLeft=-500;this.shadowCameraRight=500;this.shadowCameraTop=500;this.shadowCameraBottom=-500;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=.5;this.shadowMapWidth=512;this.shadowMapHeight=512;this.shadowCascade=!1;this.shadowCascadeOffset=new THREE.Vector3(0,0,-1e3);this.shadowCascadeCount=2;this.shadowCascadeBias=[0,0,0];this.shadowCascadeWidth=[512,512,512];this.shadowCascadeHeight=[512,512,512];this.shadowCascadeNearZ=[-1,.99,.998];this.shadowCascadeFarZ=[.99,.998,1];this.shadowCascadeArray=[];this.shadowMap=null;this.shadowMapSize=null;this.shadowCamera=null;this.shadowMatrix=null};THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype);THREE.DirectionalLight.prototype.clone=function(){var e=new THREE.DirectionalLight;THREE.Light.prototype.clone.call(this,e);e.target=this.target.clone();e.intensity=this.intensity;e.castShadow=this.castShadow;e.onlyShadow=this.onlyShadow;return e};THREE.HemisphereLight=function(e,t,i){THREE.Light.call(this,e);this.position.set(0,100,0);this.groundColor=new THREE.Color(t);this.intensity=void 0!==i?i:1};THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype);THREE.HemisphereLight.prototype.clone=function(){var e=new THREE.PointLight;THREE.Light.prototype.clone.call(this,e);e.groundColor.copy(this.groundColor);e.intensity=this.intensity;return e};THREE.PointLight=function(e,t,i){THREE.Light.call(this,e);this.intensity=void 0!==t?t:1;this.distance=void 0!==i?i:0};THREE.PointLight.prototype=Object.create(THREE.Light.prototype);THREE.PointLight.prototype.clone=function(){var e=new THREE.PointLight;THREE.Light.prototype.clone.call(this,e);e.intensity=this.intensity;e.distance=this.distance;return e};THREE.SpotLight=function(e,t,i,r,n){THREE.Light.call(this,e);this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==t?t:1;this.distance=void 0!==i?i:0;this.angle=void 0!==r?r:Math.PI/3;this.exponent=void 0!==n?n:10;this.castShadow=!1;this.onlyShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5e3;this.shadowCameraFov=50;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=.5;this.shadowMapWidth=512;this.shadowMapHeight=512;this.shadowMap=null;this.shadowMapSize=null;this.shadowCamera=null;this.shadowMatrix=null};THREE.SpotLight.prototype=Object.create(THREE.Light.prototype);THREE.SpotLight.prototype.clone=function(){var e=new THREE.SpotLight;THREE.Light.prototype.clone.call(this,e);e.target=this.target.clone();e.intensity=this.intensity;e.distance=this.distance;e.angle=this.angle;e.exponent=this.exponent;e.castShadow=this.castShadow;e.onlyShadow=this.onlyShadow;return e};THREE.Loader=function(e){this.showStatus=e;this.statusDomElement=e?THREE.Loader.prototype.addStatusElement():null;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:"anonymous",addStatusElement:function(){var e=document.createElement("div");e.style.position="absolute";e.style.right="0px";e.style.top="0px";e.style.fontSize="0.8em";e.style.textAlign="left";e.style.background="rgba(0,0,0,0.25)";e.style.color="#fff";e.style.width="120px";e.style.padding="0.5em 0.5em 0.5em 0.5em";e.style.zIndex=1e3;e.innerHTML="Loading ...";return e},updateProgress:function(e){var t="Loaded ";if(e.total)t+=(100*e.loaded/e.total).toFixed(0)+"%";else t+=(e.loaded/1e3).toFixed(2)+" KB";this.statusDomElement.innerHTML=t},extractUrlBase:function(e){var t=e.split("/");t.pop();return(t.length<1?".":t.join("/"))+"/"},initMaterials:function(e,t){var i=[];for(var r=0;r<e.length;++r)i[r]=THREE.Loader.prototype.createMaterial(e[r],t);return i},needsTangents:function(e){for(var t=0,i=e.length;i>t;t++){var r=e[t];if(r instanceof THREE.ShaderMaterial)return!0}return!1},createMaterial:function(e,t){function i(e){var t=Math.log(e)/Math.LN2;return Math.floor(t)==t}function r(e){var t=Math.log(e)/Math.LN2;return Math.pow(2,Math.round(t))}function n(e,t){var n=new Image;n.onload=function(){if(!i(this.width)||!i(this.height)){var t=r(this.width);var n=r(this.height);e.image.width=t;e.image.height=n;e.image.getContext("2d").drawImage(this,0,0,t,n)}else e.image=this;e.needsUpdate=!0};n.crossOrigin=s.crossOrigin;n.src=t}function o(e,i,r,o,a,s,l){var h=/\.dds$/i.test(r);var c=t+"/"+r;if(h){var u=THREE.ImageUtils.loadCompressedTexture(c);e[i]=u}else{var u=document.createElement("canvas");e[i]=new THREE.Texture(u)}e[i].sourceFile=r;if(o){e[i].repeat.set(o[0],o[1]);if(1!==o[0])e[i].wrapS=THREE.RepeatWrapping;if(1!==o[1])e[i].wrapT=THREE.RepeatWrapping}if(a)e[i].offset.set(a[0],a[1]);if(s){var f={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping};if(void 0!==f[s[0]])e[i].wrapS=f[s[0]];if(void 0!==f[s[1]])e[i].wrapT=f[s[1]]}if(l)e[i].anisotropy=l;if(!h)n(e[i],c)}function a(e){return(255*e[0]<<16)+(255*e[1]<<8)+255*e[2]}var s=this;var l="MeshLambertMaterial";var h={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(e.shading){var c=e.shading.toLowerCase();if("phong"===c)l="MeshPhongMaterial";else if("basic"===c)l="MeshBasicMaterial"}if(void 0!==e.blending&&void 0!==THREE[e.blending])h.blending=THREE[e.blending];if(void 0!==e.transparent||e.opacity<1)h.transparent=e.transparent;if(void 0!==e.depthTest)h.depthTest=e.depthTest;if(void 0!==e.depthWrite)h.depthWrite=e.depthWrite;if(void 0!==e.visible)h.visible=e.visible;if(void 0!==e.flipSided)h.side=THREE.BackSide;if(void 0!==e.doubleSided)h.side=THREE.DoubleSide;if(void 0!==e.wireframe)h.wireframe=e.wireframe;if(void 0!==e.vertexColors)if("face"===e.vertexColors)h.vertexColors=THREE.FaceColors;else if(e.vertexColors)h.vertexColors=THREE.VertexColors;if(e.colorDiffuse)h.color=a(e.colorDiffuse);else if(e.DbgColor)h.color=e.DbgColor;if(e.colorSpecular)h.specular=a(e.colorSpecular);if(e.colorAmbient)h.ambient=a(e.colorAmbient);if(e.transparency)h.opacity=e.transparency;if(e.specularCoef)h.shininess=e.specularCoef;if(e.mapDiffuse&&t)o(h,"map",e.mapDiffuse,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);if(e.mapLight&&t)o(h,"lightMap",e.mapLight,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);if(e.mapBump&&t)o(h,"bumpMap",e.mapBump,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);if(e.mapNormal&&t)o(h,"normalMap",e.mapNormal,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);if(e.mapSpecular&&t)o(h,"specularMap",e.mapSpecular,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);if(e.mapBumpScale)h.bumpScale=e.mapBumpScale;if(e.mapNormal){var u=THREE.ShaderLib["normalmap"];var f=THREE.UniformsUtils.clone(u.uniforms);f["tNormal"].value=h.normalMap;if(e.mapNormalFactor)f["uNormalScale"].value.set(e.mapNormalFactor,e.mapNormalFactor);if(h.map){f["tDiffuse"].value=h.map;f["enableDiffuse"].value=!0}if(h.specularMap){f["tSpecular"].value=h.specularMap;f["enableSpecular"].value=!0}if(h.lightMap){f["tAO"].value=h.lightMap;f["enableAO"].value=!0}f["uDiffuseColor"].value.setHex(h.color);f["uSpecularColor"].value.setHex(h.specular);f["uAmbientColor"].value.setHex(h.ambient);f["uShininess"].value=h.shininess;if(void 0!==h.opacity)f["uOpacity"].value=h.opacity;var d={fragmentShader:u.fragmentShader,vertexShader:u.vertexShader,uniforms:f,lights:!0,fog:!0};var p=new THREE.ShaderMaterial(d);if(h.transparent)p.transparent=!0}else var p=new THREE[l](h);if(void 0!==e.DbgName)p.name=e.DbgName;return p}};THREE.XHRLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager};THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(e,t,i,r){var n=this;var o=new XMLHttpRequest;if(void 0!==t)o.addEventListener("load",function(i){n.manager.itemEnd(e);t(i.target.responseText)},!1);if(void 0!==i)o.addEventListener("progress",function(e){i(e)},!1);if(void 0!==r)o.addEventListener("error",function(e){r(e)},!1);if(void 0!==this.crossOrigin)o.crossOrigin=this.crossOrigin;o.open("GET",e,!0);o.send(null);n.manager.itemStart(e)},setCrossOrigin:function(e){this.crossOrigin=e}};THREE.ImageLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager};THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(e,t,i,r){var n=this;var o=document.createElement("img");if(void 0!==t)o.addEventListener("load",function(){n.manager.itemEnd(e);t(this)},!1);if(void 0!==i)o.addEventListener("progress",function(e){i(e)},!1);if(void 0!==r)o.addEventListener("error",function(e){r(e)},!1);if(void 0!==this.crossOrigin)o.crossOrigin=this.crossOrigin;o.src=e;n.manager.itemStart(e)},setCrossOrigin:function(e){this.crossOrigin=e}};THREE.JSONLoader=function(e){THREE.Loader.call(this,e);this.withCredentials=!1};THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype);THREE.JSONLoader.prototype.load=function(e,t,i){i=i&&"string"==typeof i?i:this.extractUrlBase(e);this.onLoadStart();this.loadAjaxJSON(this,e,t,i)};THREE.JSONLoader.prototype.loadAjaxJSON=function(e,t,i,r,n){var o=new XMLHttpRequest;var a=0;o.onreadystatechange=function(){if(o.readyState===o.DONE)if(200===o.status||0===o.status){if(o.responseText){var s=JSON.parse(o.responseText);var l=e.parse(s,r);i(l.geometry,l.materials)}else console.warn("THREE.JSONLoader: ["+t+"] seems to be unreachable or file there is empty");e.onLoadComplete()}else console.error("THREE.JSONLoader: Couldn't load ["+t+"] ["+o.status+"]");else if(o.readyState===o.LOADING){if(n){if(0===a)a=o.getResponseHeader("Content-Length");n({total:a,loaded:o.responseText.length})}}else if(o.readyState===o.HEADERS_RECEIVED)if(void 0!==n)a=o.getResponseHeader("Content-Length")};o.open("GET",t,!0);o.withCredentials=this.withCredentials;o.send(null)};THREE.JSONLoader.prototype.parse=function(e,t){function i(t){function i(e,t){return e&1<<t}var r,n,a,s,l,h,c,u,f,d,p,m,g,v,E,y,T,_,b,x,R,w,H,M,S,C,A,D=e.faces,P=e.vertices,k=e.normals,L=e.colors,F=0;if(void 0!==e.uvs){for(r=0;r<e.uvs.length;r++)if(e.uvs[r].length)F++;for(r=0;F>r;r++){o.faceUvs[r]=[];o.faceVertexUvs[r]=[]}}s=0;l=P.length;for(;l>s;){x=new THREE.Vector3;x.x=P[s++]*t;x.y=P[s++]*t;x.z=P[s++]*t;o.vertices.push(x)}s=0;l=D.length;for(;l>s;){p=D[s++];m=i(p,0);g=i(p,1);v=i(p,2);E=i(p,3);y=i(p,4);T=i(p,5);_=i(p,6);b=i(p,7);if(m){R=new THREE.Face4;R.a=D[s++];R.b=D[s++];R.c=D[s++];R.d=D[s++];h=4}else{R=new THREE.Face3;R.a=D[s++];R.b=D[s++];R.c=D[s++];h=3}if(g){d=D[s++];R.materialIndex=d}a=o.faces.length;if(v)for(r=0;F>r;r++){M=e.uvs[r];f=D[s++];C=M[2*f];A=M[2*f+1];o.faceUvs[r][a]=new THREE.Vector2(C,A)}if(E)for(r=0;F>r;r++){M=e.uvs[r];S=[];for(n=0;h>n;n++){f=D[s++];C=M[2*f];A=M[2*f+1];S[n]=new THREE.Vector2(C,A)}o.faceVertexUvs[r][a]=S}if(y){u=3*D[s++];H=new THREE.Vector3;H.x=k[u++];H.y=k[u++];H.z=k[u];R.normal=H}if(T)for(r=0;h>r;r++){u=3*D[s++];H=new THREE.Vector3;H.x=k[u++];H.y=k[u++];H.z=k[u];R.vertexNormals.push(H)}if(_){c=D[s++];w=new THREE.Color(L[c]);R.color=w}if(b)for(r=0;h>r;r++){c=D[s++];w=new THREE.Color(L[c]);R.vertexColors.push(w)}o.faces.push(R)}}function r(){var t,i,r,n,a,s,l,h,c,u;if(e.skinWeights)for(t=0,i=e.skinWeights.length;i>t;t+=2){r=e.skinWeights[t];n=e.skinWeights[t+1];a=0;s=0;o.skinWeights.push(new THREE.Vector4(r,n,a,s))}if(e.skinIndices)for(t=0,i=e.skinIndices.length;i>t;t+=2){l=e.skinIndices[t];h=e.skinIndices[t+1];c=0;u=0;o.skinIndices.push(new THREE.Vector4(l,h,c,u))}o.bones=e.bones;o.animation=e.animation}function n(t){if(void 0!==e.morphTargets){var i,r,n,a,s,l;for(i=0,r=e.morphTargets.length;r>i;i++){o.morphTargets[i]={};o.morphTargets[i].name=e.morphTargets[i].name;o.morphTargets[i].vertices=[];s=o.morphTargets[i].vertices;l=e.morphTargets[i].vertices;for(n=0,a=l.length;a>n;n+=3){var h=new THREE.Vector3;h.x=l[n]*t;h.y=l[n+1]*t;h.z=l[n+2]*t;s.push(h)}}}if(void 0!==e.morphColors){var i,r,c,u,f,d,p;for(i=0,r=e.morphColors.length;r>i;i++){o.morphColors[i]={};o.morphColors[i].name=e.morphColors[i].name;o.morphColors[i].colors=[];f=o.morphColors[i].colors;d=e.morphColors[i].colors;for(c=0,u=d.length;u>c;c+=3){p=new THREE.Color(16755200);p.setRGB(d[c],d[c+1],d[c+2]);f.push(p)}}}}var o=new THREE.Geometry,a=void 0!==e.scale?1/e.scale:1;i(a);r();n(a);o.computeCentroids();o.computeFaceNormals();o.computeBoundingSphere();if(void 0===e.materials)return{geometry:o};else{var s=this.initMaterials(e.materials,t);if(this.needsTangents(s))o.computeTangents();return{geometry:o,materials:s}}};THREE.LoadingManager=function(e,t,i){var r=this;var n=0,o=0;this.onLoad=e;this.onProgress=t;this.onError=i;this.itemStart=function(){o++};this.itemEnd=function(e){n++;if(void 0!==r.onProgress)r.onProgress(e,n,o);if(n===o&&void 0!==r.onLoad)r.onLoad()}};THREE.DefaultLoadingManager=new THREE.LoadingManager;THREE.GeometryLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager};THREE.GeometryLoader.prototype={constructor:THREE.GeometryLoader,load:function(e,t){var i=this;var r=new THREE.XHRLoader;r.setCrossOrigin(this.crossOrigin);r.load(e,function(e){t(i.parse(JSON.parse(e)))})},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(){}};THREE.MaterialLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager};THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(e,t){var i=this;var r=new THREE.XHRLoader;r.setCrossOrigin(this.crossOrigin);r.load(e,function(e){t(i.parse(JSON.parse(e)))})},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t;switch(e.type){case"MeshBasicMaterial":t=new THREE.MeshBasicMaterial({color:e.color,opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshLambertMaterial":t=new THREE.MeshLambertMaterial({color:e.color,ambient:e.ambient,emissive:e.emissive,opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshPhongMaterial":t=new THREE.MeshPhongMaterial({color:e.color,ambient:e.ambient,emissive:e.emissive,specular:e.specular,shininess:e.shininess,opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshNormalMaterial":t=new THREE.MeshNormalMaterial({opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshDepthMaterial":t=new THREE.MeshDepthMaterial({opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe})}if(void 0!==e.vertexColors)t.vertexColors=e.vertexColors;return t}};THREE.ObjectLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager};THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(e,t){var i=this;var r=new THREE.XHRLoader(i.manager);r.setCrossOrigin(this.crossOrigin);r.load(e,function(e){t(i.parse(JSON.parse(e)))})},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t=this.parseGeometries(e.geometries);var i=this.parseMaterials(e.materials);var r=this.parseObject(e.object,t,i);return r},parseGeometries:function(e){var t={};if(void 0!==e){var i=new THREE.JSONLoader;for(var r=0,n=e.length;n>r;r++){var o;var a=e[r];switch(a.type){case"PlaneGeometry":o=new THREE.PlaneGeometry(a.width,a.height,a.widthSegments,a.heightSegments);break;case"CubeGeometry":o=new THREE.CubeGeometry(a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments);break;case"CylinderGeometry":o=new THREE.CylinderGeometry(a.radiusTop,a.radiusBottom,a.height,a.radiusSegments,a.heightSegments,a.openEnded);break;case"SphereGeometry":o=new THREE.SphereGeometry(a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength);break;case"IcosahedronGeometry":o=new THREE.IcosahedronGeometry(a.radius,a.detail);
break;case"TorusGeometry":o=new THREE.TorusGeometry(a.radius,a.tube,a.radialSegments,a.tubularSegments,a.arc);break;case"TorusKnotGeometry":o=new THREE.TorusKnotGeometry(a.radius,a.tube,a.radialSegments,a.tubularSegments,a.p,a.q,a.heightScale);break;case"Geometry":o=i.parse(a.data).geometry}o.uuid=a.uuid;if(void 0!==a.name)o.name=a.name;t[a.uuid]=o}}return t},parseMaterials:function(e){var t={};if(void 0!==e){var i=new THREE.MaterialLoader;for(var r=0,n=e.length;n>r;r++){var o=e[r];var a=i.parse(o);a.uuid=o.uuid;if(void 0!==o.name)a.name=o.name;t[o.uuid]=a}}return t},parseObject:function(){var e=new THREE.Matrix4;return function(t,i,r){var n;switch(t.type){case"Scene":n=new THREE.Scene;break;case"PerspectiveCamera":n=new THREE.PerspectiveCamera(t.fov,t.aspect,t.near,t.far);break;case"OrthographicCamera":n=new THREE.OrthographicCamera(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":n=new THREE.AmbientLight(t.color);break;case"DirectionalLight":n=new THREE.DirectionalLight(t.color,t.intensity);break;case"PointLight":n=new THREE.PointLight(t.color,t.intensity,t.distance);break;case"SpotLight":n=new THREE.SpotLight(t.color,t.intensity,t.distance,t.angle,t.exponent);break;case"HemisphereLight":n=new THREE.HemisphereLight(t.color,t.groundColor,t.intensity);break;case"Mesh":var o=i[t.geometry];var a=r[t.material];if(void 0===o)console.error("THREE.ObjectLoader: Undefined geometry "+t.geometry);if(void 0===a)console.error("THREE.ObjectLoader: Undefined material "+t.material);n=new THREE.Mesh(o,a);break;default:n=new THREE.Object3D}n.uuid=t.uuid;if(void 0!==t.name)n.name=t.name;if(void 0!==t.matrix){e.fromArray(t.matrix);e.decompose(n.position,n.quaternion,n.scale)}else{if(void 0!==t.position)n.position.fromArray(t.position);if(void 0!==t.rotation)n.rotation.fromArray(t.rotation);if(void 0!==t.scale)n.scale.fromArray(t.scale)}if(void 0!==t.visible)n.visible=t.visible;if(void 0!==t.userData)n.userData=t.userData;if(void 0!==t.children)for(var s in t.children)n.add(this.parseObject(t.children[s],i,r));return n}}()};THREE.SceneLoader=function(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){};this.callbackSync=function(){};this.callbackProgress=function(){};this.geometryHandlers={};this.hierarchyHandlers={};this.addGeometryHandler("ascii",THREE.JSONLoader)};THREE.SceneLoader.prototype={constructor:THREE.SceneLoader,load:function(e,t){var i=this;var r=new THREE.XHRLoader(i.manager);r.setCrossOrigin(this.crossOrigin);r.load(e,function(r){i.parse(JSON.parse(r),t,e)})},setCrossOrigin:function(e){this.crossOrigin=e},addGeometryHandler:function(e,t){this.geometryHandlers[e]={loaderClass:t}},addHierarchyHandler:function(e,t){this.hierarchyHandlers[e]={loaderClass:t}},parse:function(e,t,i){function r(e,t){if("relativeToHTML"==t)return e;else return m+"/"+e}function n(){o(C.scene,D.objects)}function o(e,t){var i,n,a,s,l,c;for(var u in t){var f=C.objects[u];var d=t[u];if(void 0===f){if(d.type&&d.type in p.hierarchyHandlers){if(void 0===d.loading){var m={type:1,url:1,material:1,position:1,rotation:1,scale:1,visible:1,children:1,userData:1,skin:1,morph:1,mirroredLoop:1,duration:1};var y={};for(var T in d)if(!(T in m))y[T]=d[T];v=C.materials[d.material];d.loading=!0;var _=p.hierarchyHandlers[d.type]["loaderObject"];if(_.options)_.load(r(d.url,D.urlBaseType),h(u,e,v,d));else _.load(r(d.url,D.urlBaseType),h(u,e,v,d),y)}}else if(void 0!==d.geometry){g=C.geometries[d.geometry];if(g){var w=!1;v=C.materials[d.material];w=v instanceof THREE.ShaderMaterial;a=d.position;s=d.rotation;l=d.scale;i=d.matrix;c=d.quaternion;if(!d.material)v=new THREE.MeshFaceMaterial(C.face_materials[d.geometry]);if(v instanceof THREE.MeshFaceMaterial&&0===v.materials.length)v=new THREE.MeshFaceMaterial(C.face_materials[d.geometry]);if(v instanceof THREE.MeshFaceMaterial)for(var H=0;H<v.materials.length;H++)w=w||v.materials[H]instanceof THREE.ShaderMaterial;if(w)g.computeTangents();if(d.skin)f=new THREE.SkinnedMesh(g,v);else if(d.morph){f=new THREE.MorphAnimMesh(g,v);if(void 0!==d.duration)f.duration=d.duration;if(void 0!==d.time)f.time=d.time;if(void 0!==d.mirroredLoop)f.mirroredLoop=d.mirroredLoop;if(v.morphNormals)g.computeMorphNormals()}else f=new THREE.Mesh(g,v);f.name=u;if(i){f.matrixAutoUpdate=!1;f.matrix.set(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9],i[10],i[11],i[12],i[13],i[14],i[15])}else{f.position.fromArray(a);if(c)f.quaternion.fromArray(c);else f.rotation.fromArray(s);f.scale.fromArray(l)}f.visible=d.visible;f.castShadow=d.castShadow;f.receiveShadow=d.receiveShadow;e.add(f);C.objects[u]=f}}else if("DirectionalLight"===d.type||"PointLight"===d.type||"AmbientLight"===d.type){x=void 0!==d.color?d.color:16777215;R=void 0!==d.intensity?d.intensity:1;if("DirectionalLight"===d.type){a=d.direction;b=new THREE.DirectionalLight(x,R);b.position.fromArray(a);if(d.target){A.push({object:b,targetName:d.target});b.target=null}}else if("PointLight"===d.type){a=d.position;n=d.distance;b=new THREE.PointLight(x,R,n);b.position.fromArray(a)}else if("AmbientLight"===d.type)b=new THREE.AmbientLight(x);e.add(b);b.name=u;C.lights[u]=b;C.objects[u]=b}else if("PerspectiveCamera"===d.type||"OrthographicCamera"===d.type){a=d.position;s=d.rotation;c=d.quaternion;if("PerspectiveCamera"===d.type)E=new THREE.PerspectiveCamera(d.fov,d.aspect,d.near,d.far);else if("OrthographicCamera"===d.type)E=new THREE.OrthographicCamera(d.left,d.right,d.top,d.bottom,d.near,d.far);E.name=u;E.position.fromArray(a);if(void 0!==c)E.quaternion.fromArray(c);else if(void 0!==s)E.rotation.fromArray(s);e.add(E);C.cameras[u]=E;C.objects[u]=E}else{a=d.position;s=d.rotation;l=d.scale;c=d.quaternion;f=new THREE.Object3D;f.name=u;f.position.fromArray(a);if(c)f.quaternion.fromArray(c);else f.rotation.fromArray(s);f.scale.fromArray(l);f.visible=void 0!==d.visible?d.visible:!1;e.add(f);C.objects[u]=f;C.empties[u]=f}if(f){if(void 0!==d.userData)for(var M in d.userData){var S=d.userData[M];f.userData[M]=S}if(void 0!==d.groups)for(var H=0;H<d.groups.length;H++){var P=d.groups[H];if(void 0===C.groups[P])C.groups[P]=[];C.groups[P].push(u)}}}if(void 0!==f&&void 0!==d.children)o(f,d.children)}}function a(e,t,i){C.geometries[i]=e;C.face_materials[i]=t;n()}function s(e,t,i,r,o){var a=o.position;var s=o.rotation;var l=o.quaternion;var h=o.scale;e.position.fromArray(a);if(l)e.quaternion.fromArray(l);else e.rotation.fromArray(s);e.scale.fromArray(h);if(r)e.traverse(function(e){e.material=r});var c=void 0!==o.visible?o.visible:!0;e.traverse(function(e){e.visible=c});i.add(e);e.name=t;C.objects[t]=e;n()}function l(e){return function(t,i){t.name=e;a(t,i,e);w-=1;p.onLoadComplete();u()}}function h(e,t,i,r){return function(n){var o;if(n.content)o=n.content;else if(n.dae)o=n.scene;else o=n;s(o,e,t,i,r);w-=1;p.onLoadComplete();u()}}function c(e){return function(t,i){t.name=e;C.geometries[e]=t;C.face_materials[e]=i}}function u(){var e={totalModels:M,totalTextures:S,loadedModels:M-w,loadedTextures:S-H};p.callbackProgress(e,C);p.onLoadProgress();if(0===w&&0===H){f();t(C)}}function f(){for(var e=0;e<A.length;e++){var t=A[e];var i=C.objects[t.targetName];if(i)t.object.target=i;else{t.object.target=new THREE.Object3D;C.scene.add(t.object.target)}t.object.target.userData.targetInverse=t.object}}function d(e,t){t(e);if(void 0!==e.children)for(var i in e.children)d(e.children[i],t)}var p=this;var m=THREE.Loader.prototype.extractUrlBase(i);var g,v,E,y,T,_,b,x,R,w,H,M,S,C;var A=[];var D=e;for(var P in this.geometryHandlers){var k=this.geometryHandlers[P]["loaderClass"];this.geometryHandlers[P]["loaderObject"]=new k}for(var P in this.hierarchyHandlers){var k=this.hierarchyHandlers[P]["loaderClass"];this.hierarchyHandlers[P]["loaderObject"]=new k}w=0;H=0;C={scene:new THREE.Scene,geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}};if(D.transform){var L=D.transform.position,F=D.transform.rotation,z=D.transform.scale;if(L)C.scene.position.fromArray(L);if(F)C.scene.rotation.fromArray(F);if(z)C.scene.scale.fromArray(z);if(L||F||z){C.scene.updateMatrix();C.scene.updateMatrixWorld()}}var N=function(e){H-=e;u();p.onLoadComplete()};var I=function(e){return function(){N(e)}};var O,U;for(O in D.fogs){U=D.fogs[O];if("linear"===U.type)y=new THREE.Fog(0,U.near,U.far);else if("exp2"===U.type)y=new THREE.FogExp2(0,U.density);_=U.color;y.color.setRGB(_[0],_[1],_[2]);C.fogs[O]=y}var V,B;for(V in D.geometries){B=D.geometries[V];if(B.type in this.geometryHandlers){w+=1;p.onLoadStart()}}for(var j in D.objects)d(D.objects[j],function(e){if(e.type&&e.type in p.hierarchyHandlers){w+=1;p.onLoadStart()}});M=w;for(V in D.geometries){B=D.geometries[V];if("cube"===B.type){g=new THREE.CubeGeometry(B.width,B.height,B.depth,B.widthSegments,B.heightSegments,B.depthSegments);g.name=V;C.geometries[V]=g}else if("plane"===B.type){g=new THREE.PlaneGeometry(B.width,B.height,B.widthSegments,B.heightSegments);g.name=V;C.geometries[V]=g}else if("sphere"===B.type){g=new THREE.SphereGeometry(B.radius,B.widthSegments,B.heightSegments);g.name=V;C.geometries[V]=g}else if("cylinder"===B.type){g=new THREE.CylinderGeometry(B.topRad,B.botRad,B.height,B.radSegs,B.heightSegs);g.name=V;C.geometries[V]=g}else if("torus"===B.type){g=new THREE.TorusGeometry(B.radius,B.tube,B.segmentsR,B.segmentsT);g.name=V;C.geometries[V]=g}else if("icosahedron"===B.type){g=new THREE.IcosahedronGeometry(B.radius,B.subdivisions);g.name=V;C.geometries[V]=g}else if(B.type in this.geometryHandlers){var W={};for(var G in B)if("type"!==G&&"url"!==G)W[G]=B[G];var X=this.geometryHandlers[B.type]["loaderObject"];X.load(r(B.url,D.urlBaseType),l(V),W)}else if("embedded"===B.type){var Y=D.embeds[B.id],q="";Y.metadata=D.metadata;if(Y){var K=this.geometryHandlers["ascii"]["loaderObject"];var Q=K.parse(Y,q);c(V)(Q.geometry,Q.materials)}}}var Z,$;for(Z in D.textures){$=D.textures[Z];if($.url instanceof Array){H+=$.url.length;for(var J=0;J<$.url.length;J++)p.onLoadStart()}else{H+=1;p.onLoadStart()}}S=H;for(Z in D.textures){$=D.textures[Z];if(void 0!==$.mapping&&void 0!==THREE[$.mapping])$.mapping=new THREE[$.mapping];if($.url instanceof Array){var et=$.url.length;var tt=[];for(var it=0;et>it;it++)tt[it]=r($.url[it],D.urlBaseType);var rt=/\.dds$/i.test(tt[0]);if(rt)T=THREE.ImageUtils.loadCompressedTextureCube(tt,$.mapping,I(et));else T=THREE.ImageUtils.loadTextureCube(tt,$.mapping,I(et))}else{var rt=/\.dds$/i.test($.url);var nt=r($.url,D.urlBaseType);var ot=I(1);if(rt)T=THREE.ImageUtils.loadCompressedTexture(nt,$.mapping,ot);else T=THREE.ImageUtils.loadTexture(nt,$.mapping,ot);if(void 0!==THREE[$.minFilter])T.minFilter=THREE[$.minFilter];if(void 0!==THREE[$.magFilter])T.magFilter=THREE[$.magFilter];if($.anisotropy)T.anisotropy=$.anisotropy;if($.repeat){T.repeat.set($.repeat[0],$.repeat[1]);if(1!==$.repeat[0])T.wrapS=THREE.RepeatWrapping;if(1!==$.repeat[1])T.wrapT=THREE.RepeatWrapping}if($.offset)T.offset.set($.offset[0],$.offset[1]);if($.wrap){var at={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping};if(void 0!==at[$.wrap[0]])T.wrapS=at[$.wrap[0]];if(void 0!==at[$.wrap[1]])T.wrapT=at[$.wrap[1]]}}C.textures[Z]=T}var st,lt;var ht;for(st in D.materials){lt=D.materials[st];for(ht in lt.parameters)if("envMap"===ht||"map"===ht||"lightMap"===ht||"bumpMap"===ht)lt.parameters[ht]=C.textures[lt.parameters[ht]];else if("shading"===ht)lt.parameters[ht]="flat"===lt.parameters[ht]?THREE.FlatShading:THREE.SmoothShading;else if("side"===ht)if("double"==lt.parameters[ht])lt.parameters[ht]=THREE.DoubleSide;else if("back"==lt.parameters[ht])lt.parameters[ht]=THREE.BackSide;else lt.parameters[ht]=THREE.FrontSide;else if("blending"===ht)lt.parameters[ht]=lt.parameters[ht]in THREE?THREE[lt.parameters[ht]]:THREE.NormalBlending;else if("combine"===ht)lt.parameters[ht]=lt.parameters[ht]in THREE?THREE[lt.parameters[ht]]:THREE.MultiplyOperation;else if("vertexColors"===ht){if("face"==lt.parameters[ht])lt.parameters[ht]=THREE.FaceColors;else if(lt.parameters[ht])lt.parameters[ht]=THREE.VertexColors}else if("wrapRGB"===ht){var ct=lt.parameters[ht];lt.parameters[ht]=new THREE.Vector3(ct[0],ct[1],ct[2])}if(void 0!==lt.parameters.opacity&&lt.parameters.opacity<1)lt.parameters.transparent=!0;if(lt.parameters.normalMap){var ut=THREE.ShaderLib["normalmap"];var ft=THREE.UniformsUtils.clone(ut.uniforms);var dt=lt.parameters.color;var pt=lt.parameters.specular;var mt=lt.parameters.ambient;var gt=lt.parameters.shininess;ft["tNormal"].value=C.textures[lt.parameters.normalMap];if(lt.parameters.normalScale)ft["uNormalScale"].value.set(lt.parameters.normalScale[0],lt.parameters.normalScale[1]);if(lt.parameters.map){ft["tDiffuse"].value=lt.parameters.map;ft["enableDiffuse"].value=!0}if(lt.parameters.envMap){ft["tCube"].value=lt.parameters.envMap;ft["enableReflection"].value=!0;ft["uReflectivity"].value=lt.parameters.reflectivity}if(lt.parameters.lightMap){ft["tAO"].value=lt.parameters.lightMap;ft["enableAO"].value=!0}if(lt.parameters.specularMap){ft["tSpecular"].value=C.textures[lt.parameters.specularMap];ft["enableSpecular"].value=!0}if(lt.parameters.displacementMap){ft["tDisplacement"].value=C.textures[lt.parameters.displacementMap];ft["enableDisplacement"].value=!0;ft["uDisplacementBias"].value=lt.parameters.displacementBias;ft["uDisplacementScale"].value=lt.parameters.displacementScale}ft["uDiffuseColor"].value.setHex(dt);ft["uSpecularColor"].value.setHex(pt);ft["uAmbientColor"].value.setHex(mt);ft["uShininess"].value=gt;if(lt.parameters.opacity)ft["uOpacity"].value=lt.parameters.opacity;var vt={fragmentShader:ut.fragmentShader,vertexShader:ut.vertexShader,uniforms:ft,lights:!0,fog:!0};v=new THREE.ShaderMaterial(vt)}else v=new THREE[lt.type](lt.parameters);v.name=st;C.materials[st]=v}for(st in D.materials){lt=D.materials[st];if(lt.parameters.materials){var Et=[];for(var it=0;it<lt.parameters.materials.length;it++){var yt=lt.parameters.materials[it];Et.push(C.materials[yt])}C.materials[st].materials=Et}}n();if(C.cameras&&D.defaults.camera)C.currentCamera=C.cameras[D.defaults.camera];if(C.fogs&&D.defaults.fog)C.scene.fog=C.fogs[D.defaults.fog];p.callbackSync(C);u()}};THREE.TextureLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager};THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(e,t){var i=this;var r=new THREE.ImageLoader(i.manager);r.setCrossOrigin(this.crossOrigin);r.load(e,function(e){var i=new THREE.Texture(e);i.needsUpdate=!0;if(void 0!==t)t(i)})},setCrossOrigin:function(e){this.crossOrigin=e}};THREE.Material=function(){this.id=THREE.MaterialIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.side=THREE.FrontSide;this.opacity=1;this.transparent=!1;this.blending=THREE.NormalBlending;this.blendSrc=THREE.SrcAlphaFactor;this.blendDst=THREE.OneMinusSrcAlphaFactor;this.blendEquation=THREE.AddEquation;this.depthTest=!0;this.depthWrite=!0;this.polygonOffset=!1;this.polygonOffsetFactor=0;this.polygonOffsetUnits=0;this.alphaTest=0;this.overdraw=0;this.visible=!0;this.needsUpdate=!0};THREE.Material.prototype={constructor:THREE.Material,setValues:function(e){if(void 0!==e)for(var t in e){var i=e[t];if(void 0!==i){if(t in this){var r=this[t];if(r instanceof THREE.Color)r.set(i);else if(r instanceof THREE.Vector3&&i instanceof THREE.Vector3)r.copy(i);else if("overdraw"==t)this[t]=Number(i);else this[t]=i}}else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},clone:function(e){if(void 0===e)e=new THREE.Material;e.name=this.name;e.side=this.side;e.opacity=this.opacity;e.transparent=this.transparent;e.blending=this.blending;e.blendSrc=this.blendSrc;e.blendDst=this.blendDst;e.blendEquation=this.blendEquation;e.depthTest=this.depthTest;e.depthWrite=this.depthWrite;e.polygonOffset=this.polygonOffset;e.polygonOffsetFactor=this.polygonOffsetFactor;e.polygonOffsetUnits=this.polygonOffsetUnits;e.alphaTest=this.alphaTest;e.overdraw=this.overdraw;e.visible=this.visible;return e},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Material.prototype);THREE.MaterialIdCount=0;THREE.LineBasicMaterial=function(e){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.linewidth=1;this.linecap="round";this.linejoin="round";this.vertexColors=!1;this.fog=!0;this.setValues(e)};THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineBasicMaterial.prototype.clone=function(){var e=new THREE.LineBasicMaterial;THREE.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.linewidth=this.linewidth;e.linecap=this.linecap;e.linejoin=this.linejoin;e.vertexColors=this.vertexColors;e.fog=this.fog;return e};THREE.LineDashedMaterial=function(e){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.linewidth=1;this.scale=1;this.dashSize=3;this.gapSize=1;this.vertexColors=!1;this.fog=!0;this.setValues(e)};THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineDashedMaterial.prototype.clone=function(){var e=new THREE.LineDashedMaterial;THREE.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.linewidth=this.linewidth;e.scale=this.scale;e.dashSize=this.dashSize;e.gapSize=this.gapSize;e.vertexColors=this.vertexColors;e.fog=this.fog;return e};THREE.MeshBasicMaterial=function(e){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=null;this.lightMap=null;this.specularMap=null;this.envMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.vertexColors=THREE.NoColors;this.skinning=!1;this.morphTargets=!1;this.setValues(e)};THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshBasicMaterial.prototype.clone=function(){var e=new THREE.MeshBasicMaterial;THREE.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.map=this.map;e.lightMap=this.lightMap;e.specularMap=this.specularMap;e.envMap=this.envMap;e.combine=this.combine;e.reflectivity=this.reflectivity;e.refractionRatio=this.refractionRatio;e.fog=this.fog;e.shading=this.shading;e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;e.wireframeLinecap=this.wireframeLinecap;e.wireframeLinejoin=this.wireframeLinejoin;e.vertexColors=this.vertexColors;e.skinning=this.skinning;e.morphTargets=this.morphTargets;return e};THREE.MeshLambertMaterial=function(e){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.map=null;this.lightMap=null;this.specularMap=null;this.envMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.vertexColors=THREE.NoColors;this.skinning=!1;this.morphTargets=!1;this.morphNormals=!1;this.setValues(e)};THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshLambertMaterial.prototype.clone=function(){var e=new THREE.MeshLambertMaterial;THREE.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.ambient.copy(this.ambient);e.emissive.copy(this.emissive);e.wrapAround=this.wrapAround;e.wrapRGB.copy(this.wrapRGB);e.map=this.map;e.lightMap=this.lightMap;e.specularMap=this.specularMap;e.envMap=this.envMap;e.combine=this.combine;e.reflectivity=this.reflectivity;e.refractionRatio=this.refractionRatio;e.fog=this.fog;e.shading=this.shading;e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;e.wireframeLinecap=this.wireframeLinecap;e.wireframeLinejoin=this.wireframeLinejoin;e.vertexColors=this.vertexColors;e.skinning=this.skinning;e.morphTargets=this.morphTargets;e.morphNormals=this.morphNormals;return e};THREE.MeshPhongMaterial=function(e){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.specular=new THREE.Color(1118481);this.shininess=30;this.metal=!1;this.perPixel=!0;this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.map=null;this.lightMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.specularMap=null;this.envMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.vertexColors=THREE.NoColors;this.skinning=!1;this.morphTargets=!1;this.morphNormals=!1;this.setValues(e)};THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshPhongMaterial.prototype.clone=function(){var e=new THREE.MeshPhongMaterial;THREE.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.ambient.copy(this.ambient);e.emissive.copy(this.emissive);e.specular.copy(this.specular);e.shininess=this.shininess;e.metal=this.metal;e.perPixel=this.perPixel;e.wrapAround=this.wrapAround;e.wrapRGB.copy(this.wrapRGB);e.map=this.map;e.lightMap=this.lightMap;e.bumpMap=this.bumpMap;e.bumpScale=this.bumpScale;e.normalMap=this.normalMap;e.normalScale.copy(this.normalScale);e.specularMap=this.specularMap;e.envMap=this.envMap;e.combine=this.combine;e.reflectivity=this.reflectivity;e.refractionRatio=this.refractionRatio;e.fog=this.fog;e.shading=this.shading;e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;e.wireframeLinecap=this.wireframeLinecap;e.wireframeLinejoin=this.wireframeLinejoin;e.vertexColors=this.vertexColors;e.skinning=this.skinning;e.morphTargets=this.morphTargets;e.morphNormals=this.morphNormals;return e};THREE.MeshDepthMaterial=function(e){THREE.Material.call(this);this.wireframe=!1;this.wireframeLinewidth=1;this.setValues(e)};THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshDepthMaterial.prototype.clone=function(){var e=new THREE.MeshDepthMaterial;THREE.Material.prototype.clone.call(this,e);e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;return e};THREE.MeshNormalMaterial=function(e){THREE.Material.call(this,e);this.shading=THREE.FlatShading;this.wireframe=!1;this.wireframeLinewidth=1;this.morphTargets=!1;this.setValues(e)};THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshNormalMaterial.prototype.clone=function(){var e=new THREE.MeshNormalMaterial;THREE.Material.prototype.clone.call(this,e);e.shading=this.shading;e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;return e};THREE.MeshFaceMaterial=function(e){this.materials=e instanceof Array?e:[]};THREE.MeshFaceMaterial.prototype.clone=function(){return new THREE.MeshFaceMaterial(this.materials.slice(0))};THREE.ParticleBasicMaterial=function(e){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=null;this.size=1;this.sizeAttenuation=!0;this.vertexColors=!1;this.fog=!0;this.setValues(e)};THREE.ParticleBasicMaterial.prototype=Object.create(THREE.Material.prototype);THREE.ParticleBasicMaterial.prototype.clone=function(){var e=new THREE.ParticleBasicMaterial;THREE.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.map=this.map;e.size=this.size;e.sizeAttenuation=this.sizeAttenuation;e.vertexColors=this.vertexColors;e.fog=this.fog;return e};THREE.ParticleCanvasMaterial=function(e){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.program=function(){};this.setValues(e)};THREE.ParticleCanvasMaterial.prototype=Object.create(THREE.Material.prototype);THREE.ParticleCanvasMaterial.prototype.clone=function(){var e=new THREE.ParticleCanvasMaterial;THREE.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.program=this.program;return e};THREE.ShaderMaterial=function(e){THREE.Material.call(this);this.fragmentShader="void main() {}";this.vertexShader="void main() {}";this.uniforms={};this.defines={};this.attributes=null;this.shading=THREE.SmoothShading;this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.fog=!1;this.lights=!1;this.vertexColors=THREE.NoColors;this.skinning=!1;this.morphTargets=!1;this.morphNormals=!1;this.setValues(e)};THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype);THREE.ShaderMaterial.prototype.clone=function(){var e=new THREE.ShaderMaterial;THREE.Material.prototype.clone.call(this,e);e.fragmentShader=this.fragmentShader;e.vertexShader=this.vertexShader;e.uniforms=THREE.UniformsUtils.clone(this.uniforms);e.attributes=this.attributes;e.defines=this.defines;e.shading=this.shading;e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;e.fog=this.fog;e.lights=this.lights;e.vertexColors=this.vertexColors;e.skinning=this.skinning;e.morphTargets=this.morphTargets;e.morphNormals=this.morphNormals;return e};THREE.SpriteMaterial=function(e){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=new THREE.Texture;this.useScreenCoordinates=!0;this.depthTest=!this.useScreenCoordinates;this.sizeAttenuation=!this.useScreenCoordinates;this.scaleByViewport=!this.sizeAttenuation;this.alignment=THREE.SpriteAlignment.center.clone();this.fog=!1;this.uvOffset=new THREE.Vector2(0,0);this.uvScale=new THREE.Vector2(1,1);this.setValues(e);e=e||{};if(void 0===e.depthTest)this.depthTest=!this.useScreenCoordinates;if(void 0===e.sizeAttenuation)this.sizeAttenuation=!this.useScreenCoordinates;if(void 0===e.scaleByViewport)this.scaleByViewport=!this.sizeAttenuation};THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype);THREE.SpriteMaterial.prototype.clone=function(){var e=new THREE.SpriteMaterial;THREE.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.map=this.map;e.useScreenCoordinates=this.useScreenCoordinates;e.sizeAttenuation=this.sizeAttenuation;e.scaleByViewport=this.scaleByViewport;e.alignment.copy(this.alignment);e.uvOffset.copy(this.uvOffset);e.uvScale.copy(this.uvScale);e.fog=this.fog;return e};THREE.SpriteAlignment={};THREE.SpriteAlignment.topLeft=new THREE.Vector2(1,-1);THREE.SpriteAlignment.topCenter=new THREE.Vector2(0,-1);THREE.SpriteAlignment.topRight=new THREE.Vector2(-1,-1);THREE.SpriteAlignment.centerLeft=new THREE.Vector2(1,0);THREE.SpriteAlignment.center=new THREE.Vector2(0,0);THREE.SpriteAlignment.centerRight=new THREE.Vector2(-1,0);THREE.SpriteAlignment.bottomLeft=new THREE.Vector2(1,1);THREE.SpriteAlignment.bottomCenter=new THREE.Vector2(0,1);THREE.SpriteAlignment.bottomRight=new THREE.Vector2(-1,1);THREE.Texture=function(e,t,i,r,n,o,a,s,l){this.id=THREE.TextureIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.image=e;this.mipmaps=[];this.mapping=void 0!==t?t:new THREE.UVMapping;this.wrapS=void 0!==i?i:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==r?r:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==n?n:THREE.LinearFilter;this.minFilter=void 0!==o?o:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==l?l:1;this.format=void 0!==a?a:THREE.RGBAFormat;this.type=void 0!==s?s:THREE.UnsignedByteType;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.needsUpdate=!1;this.onUpdate=null};THREE.Texture.prototype={constructor:THREE.Texture,clone:function(e){if(void 0===e)e=new THREE.Texture;e.image=this.image;e.mipmaps=this.mipmaps.slice(0);e.mapping=this.mapping;e.wrapS=this.wrapS;e.wrapT=this.wrapT;e.magFilter=this.magFilter;e.minFilter=this.minFilter;e.anisotropy=this.anisotropy;e.format=this.format;e.type=this.type;e.offset.copy(this.offset);e.repeat.copy(this.repeat);e.generateMipmaps=this.generateMipmaps;e.premultiplyAlpha=this.premultiplyAlpha;e.flipY=this.flipY;e.unpackAlignment=this.unpackAlignment;return e},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype);THREE.TextureIdCount=0;THREE.CompressedTexture=function(e,t,i,r,n,o,a,s,l,h,c){THREE.Texture.call(this,null,o,a,s,l,h,r,n,c);this.image={width:t,height:i};this.mipmaps=e;this.generateMipmaps=!1};THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CompressedTexture.prototype.clone=function(){var e=new THREE.CompressedTexture;THREE.Texture.prototype.clone.call(this,e);return e};THREE.DataTexture=function(e,t,i,r,n,o,a,s,l,h,c){THREE.Texture.call(this,null,o,a,s,l,h,r,n,c);this.image={data:e,width:t,height:i}};THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype);THREE.DataTexture.prototype.clone=function(){var e=new THREE.DataTexture;THREE.Texture.prototype.clone.call(this,e);return e};THREE.Particle=function(e){THREE.Object3D.call(this);this.material=e};THREE.Particle.prototype=Object.create(THREE.Object3D.prototype);THREE.Particle.prototype.clone=function(e){if(void 0===e)e=new THREE.Particle(this.material);THREE.Object3D.prototype.clone.call(this,e);return e};THREE.ParticleSystem=function(e,t){THREE.Object3D.call(this);this.geometry=void 0!==e?e:new THREE.Geometry;this.material=void 0!==t?t:new THREE.ParticleBasicMaterial({color:16777215*Math.random()});this.sortParticles=!1;this.frustumCulled=!1};THREE.ParticleSystem.prototype=Object.create(THREE.Object3D.prototype);THREE.ParticleSystem.prototype.clone=function(e){if(void 0===e)e=new THREE.ParticleSystem(this.geometry,this.material);e.sortParticles=this.sortParticles;THREE.Object3D.prototype.clone.call(this,e);return e};THREE.Line=function(e,t,i){THREE.Object3D.call(this);this.geometry=void 0!==e?e:new THREE.Geometry;this.material=void 0!==t?t:new THREE.LineBasicMaterial({color:16777215*Math.random()});this.type=void 0!==i?i:THREE.LineStrip};THREE.LineStrip=0;THREE.LinePieces=1;THREE.Line.prototype=Object.create(THREE.Object3D.prototype);THREE.Line.prototype.clone=function(e){if(void 0===e)e=new THREE.Line(this.geometry,this.material,this.type);THREE.Object3D.prototype.clone.call(this,e);return e};THREE.Mesh=function(e,t){THREE.Object3D.call(this);this.geometry=void 0!==e?e:new THREE.Geometry;this.material=void 0!==t?t:new THREE.MeshBasicMaterial({color:16777215*Math.random()});this.updateMorphTargets()};THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype);THREE.Mesh.prototype.updateMorphTargets=function(){if(this.geometry.morphTargets.length>0){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var e=0,t=this.geometry.morphTargets.length;t>e;e++){this.morphTargetInfluences.push(0);this.morphTargetDictionary[this.geometry.morphTargets[e].name]=e}}};THREE.Mesh.prototype.getMorphTargetIndexByName=function(e){if(void 0!==this.morphTargetDictionary[e])return this.morphTargetDictionary[e];console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+e+" does not exist. Returning 0.");return 0};THREE.Mesh.prototype.clone=function(e){if(void 0===e)e=new THREE.Mesh(this.geometry,this.material);THREE.Object3D.prototype.clone.call(this,e);return e};THREE.Bone=function(e){THREE.Object3D.call(this);this.skin=e;this.skinMatrix=new THREE.Matrix4};THREE.Bone.prototype=Object.create(THREE.Object3D.prototype);THREE.Bone.prototype.update=function(e,t){if(this.matrixAutoUpdate)t|=this.updateMatrix();if(t||this.matrixWorldNeedsUpdate){if(e)this.skinMatrix.multiplyMatrices(e,this.matrix);else this.skinMatrix.copy(this.matrix);this.matrixWorldNeedsUpdate=!1;t=!0}var i,r=this.children.length;for(i=0;r>i;i++)this.children[i].update(this.skinMatrix,t)};THREE.SkinnedMesh=function(e,t,i){THREE.Mesh.call(this,e,t);this.useVertexTexture=void 0!==i?i:!0;this.identityMatrix=new THREE.Matrix4;this.bones=[];this.boneMatrices=[];var r,n,o,a,s,l;if(this.geometry&&void 0!==this.geometry.bones){for(r=0;r<this.geometry.bones.length;r++){o=this.geometry.bones[r];a=o.pos;s=o.rotq;l=o.scl;n=this.addBone();n.name=o.name;n.position.set(a[0],a[1],a[2]);n.quaternion.set(s[0],s[1],s[2],s[3]);
if(void 0!==l)n.scale.set(l[0],l[1],l[2]);else n.scale.set(1,1,1)}for(r=0;r<this.bones.length;r++){o=this.geometry.bones[r];n=this.bones[r];if(-1===o.parent)this.add(n);else this.bones[o.parent].add(n)}var h=this.bones.length;if(this.useVertexTexture){var c;if(h>256)c=64;else if(h>64)c=32;else if(h>16)c=16;else c=8;this.boneTextureWidth=c;this.boneTextureHeight=c;this.boneMatrices=new Float32Array(4*this.boneTextureWidth*this.boneTextureHeight);this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType);this.boneTexture.minFilter=THREE.NearestFilter;this.boneTexture.magFilter=THREE.NearestFilter;this.boneTexture.generateMipmaps=!1;this.boneTexture.flipY=!1}else this.boneMatrices=new Float32Array(16*h);this.pose()}};THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.SkinnedMesh.prototype.addBone=function(e){if(void 0===e)e=new THREE.Bone(this);this.bones.push(e);return e};THREE.SkinnedMesh.prototype.updateMatrixWorld=function(){var e=new THREE.Matrix4;return function(t){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||t){if(this.parent)this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix);else this.matrixWorld.copy(this.matrix);this.matrixWorldNeedsUpdate=!1;t=!0}for(var i=0,r=this.children.length;r>i;i++){var n=this.children[i];if(n instanceof THREE.Bone)n.update(this.identityMatrix,!1);else n.updateMatrixWorld(!0)}if(void 0==this.boneInverses){this.boneInverses=[];for(var o=0,a=this.bones.length;a>o;o++){var s=new THREE.Matrix4;s.getInverse(this.bones[o].skinMatrix);this.boneInverses.push(s)}}for(var o=0,a=this.bones.length;a>o;o++){e.multiplyMatrices(this.bones[o].skinMatrix,this.boneInverses[o]);e.flattenToArrayOffset(this.boneMatrices,16*o)}if(this.useVertexTexture)this.boneTexture.needsUpdate=!0}}();THREE.SkinnedMesh.prototype.pose=function(){this.updateMatrixWorld(!0);this.normalizeSkinWeights()};THREE.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof THREE.Geometry)for(var e=0;e<this.geometry.skinIndices.length;e++){var t=this.geometry.skinWeights[e];var i=1/t.lengthManhattan();if(1/0!==i)t.multiplyScalar(i);else t.set(1)}else;};THREE.SkinnedMesh.prototype.clone=function(e){if(void 0===e)e=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture);THREE.Mesh.prototype.clone.call(this,e);return e};THREE.MorphAnimMesh=function(e,t){THREE.Mesh.call(this,e,t);this.duration=1e3;this.mirroredLoop=!1;this.time=0;this.lastKeyframe=0;this.currentKeyframe=0;this.direction=1;this.directionBackwards=!1;this.setFrameRange(0,this.geometry.morphTargets.length-1)};THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.MorphAnimMesh.prototype.setFrameRange=function(e,t){this.startKeyframe=e;this.endKeyframe=t;this.length=this.endKeyframe-this.startKeyframe+1};THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1;this.directionBackwards=!1};THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1;this.directionBackwards=!0};THREE.MorphAnimMesh.prototype.parseAnimations=function(){var e=this.geometry;if(!e.animations)e.animations={};var t,i=e.animations;var r=/([a-z]+)(\d+)/;for(var n=0,o=e.morphTargets.length;o>n;n++){var a=e.morphTargets[n];var s=a.name.match(r);if(s&&s.length>1){var l=s[1];s[2];if(!i[l])i[l]={start:1/0,end:-1/0};var h=i[l];if(n<h.start)h.start=n;if(n>h.end)h.end=n;if(!t)t=l}}e.firstAnimation=t};THREE.MorphAnimMesh.prototype.setAnimationLabel=function(e,t,i){if(!this.geometry.animations)this.geometry.animations={};this.geometry.animations[e]={start:t,end:i}};THREE.MorphAnimMesh.prototype.playAnimation=function(e,t){var i=this.geometry.animations[e];if(i){this.setFrameRange(i.start,i.end);this.duration=1e3*((i.end-i.start)/t);this.time=0}else console.warn("animation["+e+"] undefined")};THREE.MorphAnimMesh.prototype.updateAnimation=function(e){var t=this.duration/this.length;this.time+=this.direction*e;if(this.mirroredLoop){if(this.time>this.duration||this.time<0){this.direction*=-1;if(this.time>this.duration){this.time=this.duration;this.directionBackwards=!0}if(this.time<0){this.time=0;this.directionBackwards=!1}}}else{this.time=this.time%this.duration;if(this.time<0)this.time+=this.duration}var i=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/t),0,this.length-1);if(i!==this.currentKeyframe){this.morphTargetInfluences[this.lastKeyframe]=0;this.morphTargetInfluences[this.currentKeyframe]=1;this.morphTargetInfluences[i]=0;this.lastKeyframe=this.currentKeyframe;this.currentKeyframe=i}var r=this.time%t/t;if(this.directionBackwards)r=1-r;this.morphTargetInfluences[this.currentKeyframe]=r;this.morphTargetInfluences[this.lastKeyframe]=1-r};THREE.MorphAnimMesh.prototype.clone=function(e){if(void 0===e)e=new THREE.MorphAnimMesh(this.geometry,this.material);e.duration=this.duration;e.mirroredLoop=this.mirroredLoop;e.time=this.time;e.lastKeyframe=this.lastKeyframe;e.currentKeyframe=this.currentKeyframe;e.direction=this.direction;e.directionBackwards=this.directionBackwards;THREE.Mesh.prototype.clone.call(this,e);return e};THREE.Ribbon=function(e,t){THREE.Object3D.call(this);this.geometry=e;this.material=t};THREE.Ribbon.prototype=Object.create(THREE.Object3D.prototype);THREE.Ribbon.prototype.clone=function(e){if(void 0===e)e=new THREE.Ribbon(this.geometry,this.material);THREE.Object3D.prototype.clone.call(this,e);return e};THREE.LOD=function(){THREE.Object3D.call(this);this.objects=[]};THREE.LOD.prototype=Object.create(THREE.Object3D.prototype);THREE.LOD.prototype.addLevel=function(e,t){if(void 0===t)t=0;t=Math.abs(t);for(var i=0;i<this.objects.length&&!(t<this.objects[i].distance);i++);this.objects.splice(i,0,{distance:t,object:e});this.add(e)};THREE.LOD.prototype.getObjectForDistance=function(e){for(var t=1,i=this.objects.length;i>t&&!(e<this.objects[t].distance);t++);return this.objects[t-1].object};THREE.LOD.prototype.update=function(){var e=new THREE.Vector3;var t=new THREE.Vector3;return function(i){if(this.objects.length>1){e.getPositionFromMatrix(i.matrixWorld);t.getPositionFromMatrix(this.matrixWorld);var r=e.distanceTo(t);this.objects[0].object.visible=!0;for(var n=1,o=this.objects.length;o>n&&r>=this.objects[n].distance;n++){this.objects[n-1].object.visible=!1;this.objects[n].object.visible=!0}for(;o>n;n++)this.objects[n].object.visible=!1}}}();THREE.LOD.prototype.clone=function(){};THREE.Sprite=function(e){THREE.Object3D.call(this);this.material=void 0!==e?e:new THREE.SpriteMaterial;this.rotation3d=this.rotation;this.rotation=0};THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype);THREE.Sprite.prototype.updateMatrix=function(){this.rotation3d.set(0,0,this.rotation,this.rotation3d.order);this.quaternion.setFromEuler(this.rotation3d);this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0};THREE.Sprite.prototype.clone=function(e){if(void 0===e)e=new THREE.Sprite(this.material);THREE.Object3D.prototype.clone.call(this,e);return e};THREE.Scene=function(){THREE.Object3D.call(this);this.fog=null;this.overrideMaterial=null;this.autoUpdate=!0;this.matrixAutoUpdate=!1;this.__objects=[];this.__lights=[];this.__objectsAdded=[];this.__objectsRemoved=[]};THREE.Scene.prototype=Object.create(THREE.Object3D.prototype);THREE.Scene.prototype.__addObject=function(e){if(e instanceof THREE.Light){if(-1===this.__lights.indexOf(e))this.__lights.push(e);if(e.target&&void 0===e.target.parent)this.add(e.target)}else if(!(e instanceof THREE.Camera||e instanceof THREE.Bone))if(-1===this.__objects.indexOf(e)){this.__objects.push(e);this.__objectsAdded.push(e);var t=this.__objectsRemoved.indexOf(e);if(-1!==t)this.__objectsRemoved.splice(t,1)}for(var i=0;i<e.children.length;i++)this.__addObject(e.children[i])};THREE.Scene.prototype.__removeObject=function(e){if(e instanceof THREE.Light){var t=this.__lights.indexOf(e);if(-1!==t)this.__lights.splice(t,1)}else if(!(e instanceof THREE.Camera)){var t=this.__objects.indexOf(e);if(-1!==t){this.__objects.splice(t,1);this.__objectsRemoved.push(e);var i=this.__objectsAdded.indexOf(e);if(-1!==i)this.__objectsAdded.splice(i,1)}}for(var r=0;r<e.children.length;r++)this.__removeObject(e.children[r])};THREE.Scene.prototype.clone=function(e){if(void 0===e)e=new THREE.Scene;THREE.Object3D.prototype.clone.call(this,e);if(null!==this.fog)e.fog=this.fog.clone();if(null!==this.overrideMaterial)e.overrideMaterial=this.overrideMaterial.clone();e.autoUpdate=this.autoUpdate;e.matrixAutoUpdate=this.matrixAutoUpdate;return e};THREE.Fog=function(e,t,i){this.name="";this.color=new THREE.Color(e);this.near=void 0!==t?t:1;this.far=void 0!==i?i:1e3};THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)};THREE.FogExp2=function(e,t){this.name="";this.color=new THREE.Color(e);this.density=void 0!==t?t:25e-5};THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)};THREE.CanvasRenderer=function(e){function t(){Ut.setRGB(0,0,0);Vt.setRGB(0,0,0);Bt.setRGB(0,0,0);for(var e=0,t=H.length;t>e;e++){var i=H[e];var r=i.color;if(i instanceof THREE.AmbientLight)Ut.add(r);else if(i instanceof THREE.DirectionalLight)Vt.add(r);else if(i instanceof THREE.PointLight)Bt.add(r)}}function i(e,t,i){for(var r=0,n=H.length;n>r;r++){var o=H[r];Lt.copy(o.color);if(o instanceof THREE.DirectionalLight){var a=jt.getPositionFromMatrix(o.matrixWorld).normalize();var s=t.dot(a);if(0>=s)continue;s*=o.intensity;i.add(Lt.multiplyScalar(s))}else if(o instanceof THREE.PointLight){var a=jt.getPositionFromMatrix(o.matrixWorld);var s=t.dot(jt.subVectors(a,e).normalize());if(0>=s)continue;s*=0==o.distance?1:1-Math.min(e.distanceTo(a)/o.distance,1);if(0==s)continue;s*=o.intensity;i.add(Lt.multiplyScalar(s))}}}function r(e,t,i){m(i.opacity);g(i.blending);var r,n,o,a,s,l,h;if(i instanceof THREE.ParticleBasicMaterial)if(null===i.map){o=t.object.scale.x;a=t.object.scale.y;o*=t.scale.x*C;a*=t.scale.y*A;Ot.min.set(e.x-o,e.y-a);Ot.max.set(e.x+o,e.y+a);if(Nt.isIntersectionBox(Ot)===!1){Ot.makeEmpty();return}_(i.color.getStyle());dt.save();dt.translate(e.x,e.y);dt.rotate(-t.rotation);dt.scale(o,a);dt.fillRect(-1,-1,2,2);dt.restore()}else{s=i.map.image;l=s.width>>1;h=s.height>>1;o=t.scale.x*C;a=t.scale.y*A;r=o*l;n=a*h;Ot.min.set(e.x-r,e.y-n);Ot.max.set(e.x+r,e.y+n);if(Nt.isIntersectionBox(Ot)===!1){Ot.makeEmpty();return}dt.save();dt.translate(e.x,e.y);dt.rotate(-t.rotation);dt.scale(o,-a);dt.translate(-l,-h);dt.drawImage(s,0,0);dt.restore()}else if(i instanceof THREE.ParticleCanvasMaterial){r=t.scale.x*C;n=t.scale.y*A;Ot.min.set(e.x-r,e.y-n);Ot.max.set(e.x+r,e.y+n);if(Nt.isIntersectionBox(Ot)===!1){Ot.makeEmpty();return}T(i.color.getStyle());_(i.color.getStyle());dt.save();dt.translate(e.x,e.y);dt.rotate(-t.rotation);dt.scale(r,n);i.program(dt);dt.restore()}}function n(e,t,i,r){m(r.opacity);g(r.blending);dt.beginPath();dt.moveTo(e.positionScreen.x,e.positionScreen.y);dt.lineTo(t.positionScreen.x,t.positionScreen.y);if(r instanceof THREE.LineBasicMaterial){v(r.linewidth);E(r.linecap);y(r.linejoin);if(r.vertexColors!==THREE.VertexColors)T(r.color.getStyle());else{var n=i.vertexColors[0].getStyle();var o=i.vertexColors[1].getStyle();if(n===o)T(n);else{try{var a=dt.createLinearGradient(e.positionScreen.x,e.positionScreen.y,t.positionScreen.x,t.positionScreen.y);a.addColorStop(0,n);a.addColorStop(1,o)}catch(s){a=n}T(a)}}dt.stroke();Ot.expandByScalar(2*r.linewidth)}else if(r instanceof THREE.LineDashedMaterial){v(r.linewidth);E(r.linecap);y(r.linejoin);T(r.color.getStyle());b(r.dashSize,r.gapSize);dt.stroke();Ot.expandByScalar(2*r.linewidth);b(null,null)}}function o(e,t,r,n,o,a,l,p){ct.info.render.vertices+=3;ct.info.render.faces++;m(p.opacity);g(p.blending);z=e.positionScreen.x;N=e.positionScreen.y;I=t.positionScreen.x;O=t.positionScreen.y;U=r.positionScreen.x;V=r.positionScreen.y;s(z,N,I,O,U,V);if((p instanceof THREE.MeshLambertMaterial||p instanceof THREE.MeshPhongMaterial)&&null===p.map){Pt.copy(p.color);kt.copy(p.emissive);if(p.vertexColors===THREE.FaceColors)Pt.multiply(l.color);if(p.wireframe===!1&&p.shading==THREE.SmoothShading&&3==l.vertexNormalsLength){St.copy(Ut);Ct.copy(Ut);At.copy(Ut);i(l.v1.positionWorld,l.vertexNormalsModel[0],St);i(l.v2.positionWorld,l.vertexNormalsModel[1],Ct);i(l.v3.positionWorld,l.vertexNormalsModel[2],At);St.multiply(Pt).add(kt);Ct.multiply(Pt).add(kt);At.multiply(Pt).add(kt);Dt.addColors(Ct,At).multiplyScalar(.5);Q=d(St,Ct,At,Dt);f(z,N,I,O,U,V,0,0,1,0,0,1,Q)}else{Mt.copy(Ut);i(l.centroidModel,l.normalModel,Mt);Mt.multiply(Pt).add(kt);p.wireframe===!0?h(Mt,p.wireframeLinewidth,p.wireframeLinecap,p.wireframeLinejoin):c(Mt)}}else if(p instanceof THREE.MeshBasicMaterial||p instanceof THREE.MeshLambertMaterial||p instanceof THREE.MeshPhongMaterial)if(null!==p.map){if(p.map.mapping instanceof THREE.UVMapping){Z=l.uvs[0];u(z,N,I,O,U,V,Z[n].x,Z[n].y,Z[o].x,Z[o].y,Z[a].x,Z[a].y,p.map)}}else if(null!==p.envMap){if(p.envMap.mapping instanceof THREE.SphericalReflectionMapping){jt.copy(l.vertexNormalsModelView[n]);$=.5*jt.x+.5;J=.5*jt.y+.5;jt.copy(l.vertexNormalsModelView[o]);et=.5*jt.x+.5;tt=.5*jt.y+.5;jt.copy(l.vertexNormalsModelView[a]);it=.5*jt.x+.5;rt=.5*jt.y+.5;u(z,N,I,O,U,V,$,J,et,tt,it,rt,p.envMap)}}else{Mt.copy(p.color);if(p.vertexColors===THREE.FaceColors)Mt.multiply(l.color);p.wireframe===!0?h(Mt,p.wireframeLinewidth,p.wireframeLinecap,p.wireframeLinejoin):c(Mt)}else if(p instanceof THREE.MeshDepthMaterial){q=D.near;K=D.far;St.r=St.g=St.b=1-x(e.positionScreen.z*e.positionScreen.w,q,K);Ct.r=Ct.g=Ct.b=1-x(t.positionScreen.z*t.positionScreen.w,q,K);At.r=At.g=At.b=1-x(r.positionScreen.z*r.positionScreen.w,q,K);Dt.addColors(Ct,At).multiplyScalar(.5);Q=d(St,Ct,At,Dt);f(z,N,I,O,U,V,0,0,1,0,0,1,Q)}else if(p instanceof THREE.MeshNormalMaterial){var v;if(p.shading==THREE.FlatShading){v=l.normalModelView;Mt.setRGB(v.x,v.y,v.z).multiplyScalar(.5).addScalar(.5);p.wireframe===!0?h(Mt,p.wireframeLinewidth,p.wireframeLinecap,p.wireframeLinejoin):c(Mt)}else if(p.shading==THREE.SmoothShading){v=l.vertexNormalsModelView[n];St.setRGB(v.x,v.y,v.z).multiplyScalar(.5).addScalar(.5);v=l.vertexNormalsModelView[o];Ct.setRGB(v.x,v.y,v.z).multiplyScalar(.5).addScalar(.5);v=l.vertexNormalsModelView[a];At.setRGB(v.x,v.y,v.z).multiplyScalar(.5).addScalar(.5);Dt.addColors(Ct,At).multiplyScalar(.5);Q=d(St,Ct,At,Dt);f(z,N,I,O,U,V,0,0,1,0,0,1,Q)}}}function a(e,t,r,n,a,u,p,v){ct.info.render.vertices+=4;ct.info.render.faces++;m(v.opacity);g(v.blending);if(!(void 0!==v.map&&null!==v.map||void 0!==v.envMap&&null!==v.envMap)){z=e.positionScreen.x;N=e.positionScreen.y;I=t.positionScreen.x;O=t.positionScreen.y;U=r.positionScreen.x;V=r.positionScreen.y;B=n.positionScreen.x;j=n.positionScreen.y;W=a.positionScreen.x;G=a.positionScreen.y;X=u.positionScreen.x;Y=u.positionScreen.y;if(v instanceof THREE.MeshLambertMaterial||v instanceof THREE.MeshPhongMaterial){Pt.copy(v.color);kt.copy(v.emissive);if(v.vertexColors===THREE.FaceColors)Pt.multiply(p.color);if(v.wireframe===!1&&v.shading==THREE.SmoothShading&&4==p.vertexNormalsLength){St.copy(Ut);Ct.copy(Ut);At.copy(Ut);Dt.copy(Ut);i(p.v1.positionWorld,p.vertexNormalsModel[0],St);i(p.v2.positionWorld,p.vertexNormalsModel[1],Ct);i(p.v4.positionWorld,p.vertexNormalsModel[3],At);i(p.v3.positionWorld,p.vertexNormalsModel[2],Dt);St.multiply(Pt).add(kt);Ct.multiply(Pt).add(kt);At.multiply(Pt).add(kt);Dt.multiply(Pt).add(kt);Q=d(St,Ct,At,Dt);s(z,N,I,O,B,j);f(z,N,I,O,B,j,0,0,1,0,0,1,Q);s(W,G,U,V,X,Y);f(W,G,U,V,X,Y,1,0,1,1,0,1,Q)}else{Mt.copy(Ut);i(p.centroidModel,p.normalModel,Mt);Mt.multiply(Pt).add(kt);l(z,N,I,O,U,V,B,j);v.wireframe===!0?h(Mt,v.wireframeLinewidth,v.wireframeLinecap,v.wireframeLinejoin):c(Mt)}}else if(v instanceof THREE.MeshBasicMaterial){Mt.copy(v.color);if(v.vertexColors===THREE.FaceColors)Mt.multiply(p.color);l(z,N,I,O,U,V,B,j);v.wireframe===!0?h(Mt,v.wireframeLinewidth,v.wireframeLinecap,v.wireframeLinejoin):c(Mt)}else if(v instanceof THREE.MeshNormalMaterial){var E;if(v.shading==THREE.FlatShading){E=p.normalModelView;Mt.setRGB(E.x,E.y,E.z).multiplyScalar(.5).addScalar(.5);l(z,N,I,O,U,V,B,j);v.wireframe===!0?h(Mt,v.wireframeLinewidth,v.wireframeLinecap,v.wireframeLinejoin):c(Mt)}else if(v.shading==THREE.SmoothShading){E=p.vertexNormalsModelView[0];St.setRGB(E.x,E.y,E.z).multiplyScalar(.5).addScalar(.5);E=p.vertexNormalsModelView[1];Ct.setRGB(E.x,E.y,E.z).multiplyScalar(.5).addScalar(.5);E=p.vertexNormalsModelView[3];At.setRGB(E.x,E.y,E.z).multiplyScalar(.5).addScalar(.5);E=p.vertexNormalsModelView[2];Dt.setRGB(E.x,E.y,E.z).multiplyScalar(.5).addScalar(.5);Q=d(St,Ct,At,Dt);s(z,N,I,O,B,j);f(z,N,I,O,B,j,0,0,1,0,0,1,Q);s(W,G,U,V,X,Y);f(W,G,U,V,X,Y,1,0,1,1,0,1,Q)}}else if(v instanceof THREE.MeshDepthMaterial){q=D.near;K=D.far;St.r=St.g=St.b=1-x(e.positionScreen.z*e.positionScreen.w,q,K);Ct.r=Ct.g=Ct.b=1-x(t.positionScreen.z*t.positionScreen.w,q,K);At.r=At.g=At.b=1-x(n.positionScreen.z*n.positionScreen.w,q,K);Dt.r=Dt.g=Dt.b=1-x(r.positionScreen.z*r.positionScreen.w,q,K);Q=d(St,Ct,At,Dt);s(z,N,I,O,B,j);f(z,N,I,O,B,j,0,0,1,0,0,1,Q);s(W,G,U,V,X,Y);f(W,G,U,V,X,Y,1,0,1,1,0,1,Q)}}else{o(e,t,n,0,1,3,p,v);o(a,r,u,1,2,3,p,v)}}function s(e,t,i,r,n,o){dt.beginPath();dt.moveTo(e,t);dt.lineTo(i,r);dt.lineTo(n,o);dt.closePath()}function l(e,t,i,r,n,o,a,s){dt.beginPath();dt.moveTo(e,t);dt.lineTo(i,r);dt.lineTo(n,o);dt.lineTo(a,s);dt.closePath()}function h(e,t,i,r){v(t);E(i);y(r);T(e.getStyle());dt.stroke();Ot.expandByScalar(2*t)}function c(e){_(e.getStyle());dt.fill()}function u(e,t,i,r,n,o,a,s,l,h,u,f,d){if(!(d instanceof THREE.DataTexture||void 0===d.image||0==d.image.width)){if(d.needsUpdate===!0){var p=d.wrapS==THREE.RepeatWrapping;var m=d.wrapT==THREE.RepeatWrapping;Ft[d.id]=dt.createPattern(d.image,p===!0&&m===!0?"repeat":p===!0&&m===!1?"repeat-x":p===!1&&m===!0?"repeat-y":"no-repeat");d.needsUpdate=!1}void 0===Ft[d.id]?_("rgba(0,0,0,1)"):_(Ft[d.id]);var g,v,E,y,T,b,x,R,w=d.offset.x/d.repeat.x,H=d.offset.y/d.repeat.y,M=d.image.width*d.repeat.x,S=d.image.height*d.repeat.y;a=(a+w)*M;s=(1-s+H)*S;l=(l+w)*M;h=(1-h+H)*S;u=(u+w)*M;f=(1-f+H)*S;i-=e;r-=t;n-=e;o-=t;l-=a;h-=s;u-=a;f-=s;x=l*f-u*h;if(0!==x){R=1/x;g=(f*i-h*n)*R;v=(f*r-h*o)*R;E=(l*n-u*i)*R;y=(l*o-u*r)*R;T=e-g*a-E*s;b=t-v*a-y*s;dt.save();dt.transform(g,v,E,y,T,b);dt.fill();dt.restore()}else{if(void 0===zt[d.id]){var C=document.createElement("canvas");C.width=d.image.width;C.height=d.image.height;var A=C.getContext("2d");A.drawImage(d.image,0,0);zt[d.id]=A.getImageData(0,0,d.image.width,d.image.height).data}var D=zt[d.id];var P=4*(Math.floor(a)+Math.floor(s)*d.image.width);Mt.setRGB(D[P]/255,D[P+1]/255,D[P+2]/255);c(Mt)}}}function f(e,t,i,r,n,o,a,s,l,h,c,u,f){var d,p,m,g,v,E,y,T,_=f.width-1,b=f.height-1;a*=_;s*=b;l*=_;h*=b;c*=_;u*=b;i-=e;r-=t;n-=e;o-=t;l-=a;h-=s;c-=a;u-=s;y=l*u-c*h;T=1/y;d=(u*i-h*n)*T;p=(u*r-h*o)*T;m=(l*n-c*i)*T;g=(l*o-c*r)*T;v=e-d*a-m*s;E=t-p*a-g*s;dt.save();dt.transform(d,p,m,g,v,E);dt.clip();dt.drawImage(f,0,0);dt.restore()}function d(e,t,i,r){st[0]=0|255*e.r;st[1]=0|255*e.g;st[2]=0|255*e.b;st[4]=0|255*t.r;st[5]=0|255*t.g;st[6]=0|255*t.b;st[8]=0|255*i.r;st[9]=0|255*i.g;st[10]=0|255*i.b;st[12]=0|255*r.r;st[13]=0|255*r.g;st[14]=0|255*r.b;ot.putImageData(at,0,0);ht.drawImage(nt,0,0);return lt}function p(e,t,i){var r,n=t.x-e.x,o=t.y-e.y,a=n*n+o*o;if(0!==a){r=i/Math.sqrt(a);n*=r;o*=r;t.x+=n;t.y+=o;e.x-=n;e.y-=o}}function m(e){if(gt!==e){dt.globalAlpha=e;gt=e}}function g(e){if(vt!==e){if(e===THREE.NormalBlending)dt.globalCompositeOperation="source-over";else if(e===THREE.AdditiveBlending)dt.globalCompositeOperation="lighter";else if(e===THREE.SubtractiveBlending)dt.globalCompositeOperation="darker";vt=e}}function v(e){if(Tt!==e){dt.lineWidth=e;Tt=e}}function E(e){if(_t!==e){dt.lineCap=e;_t=e}}function y(e){if(bt!==e){dt.lineJoin=e;bt=e}}function T(e){if(Et!==e){dt.strokeStyle=e;Et=e}}function _(e){if(yt!==e){dt.fillStyle=e;yt=e}}function b(e,t){if(xt!==e||Rt!==t){dt.setLineDash([e,t]);xt=e;Rt=t}}console.log("THREE.CanvasRenderer",THREE.REVISION);var x=THREE.Math.smoothstep;e=e||{};var R,w,H,M,S,C,A,D,P,k,L,F,z,N,I,O,U,V,B,j,W,G,X,Y,q,K,Q,Z,$,J,et,tt,it,rt,nt,ot,at,st,lt,ht,ct=this,ut=new THREE.Projector,ft=void 0!==e.canvas?e.canvas:document.createElement("canvas"),dt=ft.getContext("2d"),pt=new THREE.Color(0),mt=0,gt=1,vt=0,Et=null,yt=null,Tt=null,_t=null,bt=null,xt=null,Rt=0,wt=new THREE.RenderableVertex,Ht=new THREE.RenderableVertex,Mt=new THREE.Color,St=new THREE.Color,Ct=new THREE.Color,At=new THREE.Color,Dt=new THREE.Color,Pt=new THREE.Color,kt=new THREE.Color,Lt=new THREE.Color,Ft={},zt={},Nt=new THREE.Box2,It=new THREE.Box2,Ot=new THREE.Box2,Ut=new THREE.Color,Vt=new THREE.Color,Bt=new THREE.Color,jt=new THREE.Vector3,Wt=16;nt=document.createElement("canvas");nt.width=nt.height=2;ot=nt.getContext("2d");ot.fillStyle="rgba(0,0,0,1)";ot.fillRect(0,0,2,2);at=ot.getImageData(0,0,2,2);st=at.data;lt=document.createElement("canvas");lt.width=lt.height=Wt;ht=lt.getContext("2d");ht.translate(-Wt/2,-Wt/2);ht.scale(Wt,Wt);Wt--;if(void 0===dt.setLineDash)if(void 0!==dt.mozDash)dt.setLineDash=function(e){dt.mozDash=null!==e[0]?e:null};else dt.setLineDash=function(){};this.domElement=ft;this.devicePixelRatio=void 0!==e.devicePixelRatio?e.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1;this.autoClear=!0;this.sortObjects=!0;this.sortElements=!0;this.info={render:{vertices:0,faces:0}};this.supportsVertexTextures=function(){};this.setFaceCulling=function(){};this.setSize=function(e,t,i){M=e*this.devicePixelRatio;S=t*this.devicePixelRatio;C=Math.floor(M/2);A=Math.floor(S/2);ft.width=M;ft.height=S;if(1!==this.devicePixelRatio&&i!==!1){ft.style.width=e+"px";ft.style.height=t+"px"}Nt.set(new THREE.Vector2(-C,-A),new THREE.Vector2(C,A));It.set(new THREE.Vector2(-C,-A),new THREE.Vector2(C,A));gt=1;vt=0;Et=null;yt=null;Tt=null;_t=null;bt=null};this.setClearColor=function(e,t){pt.set(e);mt=void 0!==t?t:1;It.set(new THREE.Vector2(-C,-A),new THREE.Vector2(C,A))};this.setClearColorHex=function(e,t){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(e,t)};this.getMaxAnisotropy=function(){return 0};this.clear=function(){dt.setTransform(1,0,0,-1,C,A);if(It.empty()===!1){It.intersect(Nt);It.expandByScalar(2);if(1>mt)dt.clearRect(0|It.min.x,0|It.min.y,0|It.max.x-It.min.x,0|It.max.y-It.min.y);if(mt>0){g(THREE.NormalBlending);m(1);_("rgba("+Math.floor(255*pt.r)+","+Math.floor(255*pt.g)+","+Math.floor(255*pt.b)+","+mt+")");dt.fillRect(0|It.min.x,0|It.min.y,0|It.max.x-It.min.x,0|It.max.y-It.min.y)}It.makeEmpty()}};this.render=function(e,i){if(i instanceof THREE.Camera!=!1){if(this.autoClear===!0)this.clear();dt.setTransform(1,0,0,-1,C,A);ct.info.render.vertices=0;ct.info.render.faces=0;R=ut.projectScene(e,i,this.sortObjects,this.sortElements);w=R.elements;H=R.lights;D=i;t();for(var s=0,l=w.length;l>s;s++){var h=w[s];var c=h.material;if(void 0!==c&&c.visible!==!1){Ot.makeEmpty();if(h instanceof THREE.RenderableParticle){P=h;P.x*=C;P.y*=A;r(P,h,c)}else if(h instanceof THREE.RenderableLine){P=h.v1;k=h.v2;P.positionScreen.x*=C;P.positionScreen.y*=A;k.positionScreen.x*=C;k.positionScreen.y*=A;Ot.setFromPoints([P.positionScreen,k.positionScreen]);if(Nt.isIntersectionBox(Ot)===!0)n(P,k,h,c)}else if(h instanceof THREE.RenderableFace3){P=h.v1;k=h.v2;L=h.v3;if(P.positionScreen.z<-1||P.positionScreen.z>1)continue;if(k.positionScreen.z<-1||k.positionScreen.z>1)continue;if(L.positionScreen.z<-1||L.positionScreen.z>1)continue;P.positionScreen.x*=C;P.positionScreen.y*=A;k.positionScreen.x*=C;k.positionScreen.y*=A;L.positionScreen.x*=C;L.positionScreen.y*=A;if(c.overdraw>0){p(P.positionScreen,k.positionScreen,c.overdraw);p(k.positionScreen,L.positionScreen,c.overdraw);p(L.positionScreen,P.positionScreen,c.overdraw)}Ot.setFromPoints([P.positionScreen,k.positionScreen,L.positionScreen]);if(Nt.isIntersectionBox(Ot)===!0)o(P,k,L,0,1,2,h,c)}else if(h instanceof THREE.RenderableFace4){P=h.v1;k=h.v2;L=h.v3;F=h.v4;if(P.positionScreen.z<-1||P.positionScreen.z>1)continue;if(k.positionScreen.z<-1||k.positionScreen.z>1)continue;if(L.positionScreen.z<-1||L.positionScreen.z>1)continue;if(F.positionScreen.z<-1||F.positionScreen.z>1)continue;P.positionScreen.x*=C;P.positionScreen.y*=A;k.positionScreen.x*=C;k.positionScreen.y*=A;L.positionScreen.x*=C;L.positionScreen.y*=A;F.positionScreen.x*=C;F.positionScreen.y*=A;wt.positionScreen.copy(k.positionScreen);Ht.positionScreen.copy(F.positionScreen);if(c.overdraw>0){p(P.positionScreen,k.positionScreen,c.overdraw);p(k.positionScreen,F.positionScreen,c.overdraw);p(F.positionScreen,P.positionScreen,c.overdraw);p(L.positionScreen,wt.positionScreen,c.overdraw);p(L.positionScreen,Ht.positionScreen,c.overdraw)}Ot.setFromPoints([P.positionScreen,k.positionScreen,L.positionScreen,F.positionScreen]);if(Nt.isIntersectionBox(Ot)===!0)a(P,k,L,F,wt,Ht,h,c)}It.union(Ot)}else;}dt.setTransform(1,0,0,1,0,0)}else console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.")}};THREE.ShaderChunk={fog_pars_fragment:["#ifdef USE_FOG","uniform vec3 fogColor;","#ifdef FOG_EXP2","uniform float fogDensity;","#else","uniform float fogNear;","uniform float fogFar;","#endif","#endif"].join("\n"),fog_fragment:["#ifdef USE_FOG","float depth = gl_FragCoord.z / gl_FragCoord.w;","#ifdef FOG_EXP2","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","#else","float fogFactor = smoothstep( fogNear, fogFar, depth );","#endif","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","#endif"].join("\n"),envmap_pars_fragment:["#ifdef USE_ENVMAP","uniform float reflectivity;","uniform samplerCube envMap;","uniform float flipEnvMap;","uniform int combine;","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","uniform bool useRefract;","uniform float refractionRatio;","#else","varying vec3 vReflect;","#endif","#endif"].join("\n"),envmap_fragment:["#ifdef USE_ENVMAP","vec3 reflectVec;","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","if ( useRefract ) {","reflectVec = refract( cameraToVertex, normal, refractionRatio );","} else { ","reflectVec = reflect( cameraToVertex, normal );","}","#else","reflectVec = vReflect;","#endif","#ifdef DOUBLE_SIDED","float flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );","vec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );","#else","vec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );","#endif","#ifdef GAMMA_INPUT","cubeColor.xyz *= cubeColor.xyz;","#endif","if ( combine == 1 ) {","gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );","} else if ( combine == 2 ) {","gl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;","} else {","gl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );","}","#endif"].join("\n"),envmap_pars_vertex:["#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )","varying vec3 vReflect;","uniform float refractionRatio;","uniform bool useRefract;","#endif"].join("\n"),worldpos_vertex:["#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )","#ifdef USE_SKINNING","vec4 worldPosition = modelMatrix * skinned;","#endif","#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )","vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );","#endif","#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","#endif","#endif"].join("\n"),envmap_vertex:["#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )","vec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;","worldNormal = normalize( worldNormal );","vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );","if ( useRefract ) {","vReflect = refract( cameraToVertex, worldNormal, refractionRatio );","} else {","vReflect = reflect( cameraToVertex, worldNormal );","}","#endif"].join("\n"),map_particle_pars_fragment:["#ifdef USE_MAP","uniform sampler2D map;","#endif"].join("\n"),map_particle_fragment:["#ifdef USE_MAP","gl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );","#endif"].join("\n"),map_pars_vertex:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","varying vec2 vUv;","uniform vec4 offsetRepeat;","#endif"].join("\n"),map_pars_fragment:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","varying vec2 vUv;","#endif","#ifdef USE_MAP","uniform sampler2D map;","#endif"].join("\n"),map_vertex:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","vUv = uv * offsetRepeat.zw + offsetRepeat.xy;","#endif"].join("\n"),map_fragment:["#ifdef USE_MAP","vec4 texelColor = texture2D( map, vUv );","#ifdef GAMMA_INPUT","texelColor.xyz *= texelColor.xyz;","#endif","gl_FragColor = gl_FragColor * texelColor;","#endif"].join("\n"),lightmap_pars_fragment:["#ifdef USE_LIGHTMAP","varying vec2 vUv2;","uniform sampler2D lightMap;","#endif"].join("\n"),lightmap_pars_vertex:["#ifdef USE_LIGHTMAP","varying vec2 vUv2;","#endif"].join("\n"),lightmap_fragment:["#ifdef USE_LIGHTMAP","gl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );","#endif"].join("\n"),lightmap_vertex:["#ifdef USE_LIGHTMAP","vUv2 = uv2;","#endif"].join("\n"),bumpmap_pars_fragment:["#ifdef USE_BUMPMAP","uniform sampler2D bumpMap;","uniform float bumpScale;","vec2 dHdxy_fwd() {","vec2 dSTdx = dFdx( vUv );","vec2 dSTdy = dFdy( vUv );","float Hll = bumpScale * texture2D( bumpMap, vUv ).x;","float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;","float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;","return vec2( dBx, dBy );","}","vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {","vec3 vSigmaX = dFdx( surf_pos );","vec3 vSigmaY = dFdy( surf_pos );","vec3 vN = surf_norm;","vec3 R1 = cross( vSigmaY, vN );","vec3 R2 = cross( vN, vSigmaX );","float fDet = dot( vSigmaX, R1 );","vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );","return normalize( abs( fDet ) * surf_norm - vGrad );","}","#endif"].join("\n"),normalmap_pars_fragment:["#ifdef USE_NORMALMAP","uniform sampler2D normalMap;","uniform vec2 normalScale;","vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {","vec3 q0 = dFdx( eye_pos.xyz );","vec3 q1 = dFdy( eye_pos.xyz );","vec2 st0 = dFdx( vUv.st );","vec2 st1 = dFdy( vUv.st );","vec3 S = normalize(  q0 * st1.t - q1 * st0.t );","vec3 T = normalize( -q0 * st1.s + q1 * st0.s );","vec3 N = normalize( surf_norm );","vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;","mapN.xy = normalScale * mapN.xy;","mat3 tsn = mat3( S, T, N );","return normalize( tsn * mapN );","}","#endif"].join("\n"),specularmap_pars_fragment:["#ifdef USE_SPECULARMAP","uniform sampler2D specularMap;","#endif"].join("\n"),specularmap_fragment:["float specularStrength;","#ifdef USE_SPECULARMAP","vec4 texelSpecular = texture2D( specularMap, vUv );","specularStrength = texelSpecular.r;","#else","specularStrength = 1.0;","#endif"].join("\n"),lights_lambert_pars_vertex:["uniform vec3 ambient;","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif"].join("\n"),lights_lambert_vertex:["vLightFront = vec3( 0.0 );","#ifdef DOUBLE_SIDED","vLightBack = vec3( 0.0 );","#endif","transformedNormal = normalize( transformedNormal );","#if MAX_DIR_LIGHTS > 0","for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","float dotProduct = dot( transformedNormal, dirVector );","vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","directionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","directionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += directionalLightColor[ i ] * directionalLightWeighting;","#ifdef DOUBLE_SIDED","vLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;","#endif","}","#endif","#if MAX_POINT_LIGHTS > 0","for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","float dotProduct = dot( transformedNormal, lVector );","vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","pointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","pointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;","#ifdef DOUBLE_SIDED","vLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","float dotProduct = dot( transformedNormal, lVector );","vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","spotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","spotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;","#ifdef DOUBLE_SIDED","vLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;","#endif","}","}","#endif","#if MAX_HEMI_LIGHTS > 0","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( transformedNormal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","float hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;","vLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","#ifdef DOUBLE_SIDED","vLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );","#endif","}","#endif","vLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;","#ifdef DOUBLE_SIDED","vLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;","#endif"].join("\n"),lights_phong_pars_vertex:["#ifndef PHONG_PER_PIXEL","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","varying vec4 vPointLight[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","varying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","varying vec3 vWorldPosition;","#endif"].join("\n"),lights_phong_vertex:["#ifndef PHONG_PER_PIXEL","#if MAX_POINT_LIGHTS > 0","for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","vPointLight[ i ] = vec4( lVector, lDistance );","}","#endif","#if MAX_SPOT_LIGHTS > 0","for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","vSpotLight[ i ] = vec4( lVector, lDistance );","}","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","vWorldPosition = worldPosition.xyz;","#endif"].join("\n"),lights_phong_pars_fragment:["uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","#ifdef PHONG_PER_PIXEL","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#else","varying vec4 vPointLight[ MAX_POINT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","#ifdef PHONG_PER_PIXEL","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#else","varying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","varying vec3 vWorldPosition;","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif","varying vec3 vViewPosition;","varying vec3 vNormal;"].join("\n"),lights_phong_fragment:["vec3 normal = normalize( vNormal );","vec3 viewPosition = normalize( vViewPosition );","#ifdef DOUBLE_SIDED","normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );","#endif","#ifdef USE_NORMALMAP","normal = perturbNormal2Arb( -vViewPosition, normal );","#elif defined( USE_BUMPMAP )","normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );","#endif","#if MAX_POINT_LIGHTS > 0","vec3 pointDiffuse  = vec3( 0.0 );","vec3 pointSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","#ifdef PHONG_PER_PIXEL","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","#else","vec3 lVector = normalize( vPointLight[ i ].xyz );","float lDistance = vPointLight[ i ].w;","#endif","float dotProduct = dot( normal, lVector );","#ifdef WRAP_AROUND","float pointDiffuseWeightFull = max( dotProduct, 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","#else","float pointDiffuseWeight = max( dotProduct, 0.0 );","#endif","pointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;","vec3 pointHalfVector = normalize( lVector + viewPosition );","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );","pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;","#else","pointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","vec3 spotDiffuse  = vec3( 0.0 );","vec3 spotSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","#ifdef PHONG_PER_PIXEL","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","#else","vec3 lVector = normalize( vSpotLight[ i ].xyz );","float lDistance = vSpotLight[ i ].w;","#endif","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","float dotProduct = dot( normal, lVector );","#ifdef WRAP_AROUND","float spotDiffuseWeightFull = max( dotProduct, 0.0 );","float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","#else","float spotDiffuseWeight = max( dotProduct, 0.0 );","#endif","spotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;","vec3 spotHalfVector = normalize( lVector + viewPosition );","float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );","spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;","#else","spotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;","#endif","}","}","#endif","#if MAX_DIR_LIGHTS > 0","vec3 dirDiffuse  = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, dirVector );","#ifdef WRAP_AROUND","float dirDiffuseWeightFull = max( dotProduct, 0.0 );","float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );","#else","float dirDiffuseWeight = max( dotProduct, 0.0 );","#endif","dirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );","dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","#else","dirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;","#endif","}","#endif","#if MAX_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","hemiDiffuse += diffuse * hemiColor;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","float hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","float hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float dotProductGround = dot( normal, lVectorGround );","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );","vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );","hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );","#else","hemiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;","#endif","}","#endif","vec3 totalDiffuse = vec3( 0.0 );","vec3 totalSpecular = vec3( 0.0 );","#if MAX_DIR_LIGHTS > 0","totalDiffuse += dirDiffuse;","totalSpecular += dirSpecular;","#endif","#if MAX_HEMI_LIGHTS > 0","totalDiffuse += hemiDiffuse;","totalSpecular += hemiSpecular;","#endif","#if MAX_POINT_LIGHTS > 0","totalDiffuse += pointDiffuse;","totalSpecular += pointSpecular;","#endif","#if MAX_SPOT_LIGHTS > 0","totalDiffuse += spotDiffuse;","totalSpecular += spotSpecular;","#endif","#ifdef METAL","gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );","#else","gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;","#endif"].join("\n"),color_pars_fragment:["#ifdef USE_COLOR","varying vec3 vColor;","#endif"].join("\n"),color_fragment:["#ifdef USE_COLOR","gl_FragColor = gl_FragColor * vec4( vColor, opacity );","#endif"].join("\n"),color_pars_vertex:["#ifdef USE_COLOR","varying vec3 vColor;","#endif"].join("\n"),color_vertex:["#ifdef USE_COLOR","#ifdef GAMMA_INPUT","vColor = color * color;","#else","vColor = color;","#endif","#endif"].join("\n"),skinning_pars_vertex:["#ifdef USE_SKINNING","#ifdef BONE_TEXTURE","uniform sampler2D boneTexture;","mat4 getBoneMatrix( const in float i ) {","float j = i * 4.0;","float x = mod( j, N_BONE_PIXEL_X );","float y = floor( j / N_BONE_PIXEL_X );","const float dx = 1.0 / N_BONE_PIXEL_X;","const float dy = 1.0 / N_BONE_PIXEL_Y;","y = dy * ( y + 0.5 );","vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );","vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );","vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );","vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );","mat4 bone = mat4( v1, v2, v3, v4 );","return bone;","}","#else","uniform mat4 boneGlobalMatrices[ MAX_BONES ];","mat4 getBoneMatrix( const in float i ) {","mat4 bone = boneGlobalMatrices[ int(i) ];","return bone;","}","#endif","#endif"].join("\n"),skinbase_vertex:["#ifdef USE_SKINNING","mat4 boneMatX = getBoneMatrix( skinIndex.x );","mat4 boneMatY = getBoneMatrix( skinIndex.y );","#endif"].join("\n"),skinning_vertex:["#ifdef USE_SKINNING","#ifdef USE_MORPHTARGETS","vec4 skinVertex = vec4( morphed, 1.0 );","#else","vec4 skinVertex = vec4( position, 1.0 );","#endif","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","#endif"].join("\n"),morphtarget_pars_vertex:["#ifdef USE_MORPHTARGETS","#ifndef USE_MORPHNORMALS","uniform float morphTargetInfluences[ 8 ];","#else","uniform float morphTargetInfluences[ 4 ];","#endif","#endif"].join("\n"),morphtarget_vertex:["#ifdef USE_MORPHTARGETS","vec3 morphed = vec3( 0.0 );","morphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];","morphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];","morphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];","morphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];","#ifndef USE_MORPHNORMALS","morphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];","morphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];","morphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];","morphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];","#endif","morphed += position;","#endif"].join("\n"),default_vertex:["vec4 mvPosition;","#ifdef USE_SKINNING","mvPosition = modelViewMatrix * skinned;","#endif","#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )","mvPosition = modelViewMatrix * vec4( morphed, 1.0 );","#endif","#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )","mvPosition = modelViewMatrix * vec4( position, 1.0 );","#endif","gl_Position = projectionMatrix * mvPosition;"].join("\n"),morphnormal_vertex:["#ifdef USE_MORPHNORMALS","vec3 morphedNormal = vec3( 0.0 );","morphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];","morphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];","morphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];","morphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];","morphedNormal += normal;","#endif"].join("\n"),skinnormal_vertex:["#ifdef USE_SKINNING","mat4 skinMatrix = skinWeight.x * boneMatX;","skinMatrix 	+= skinWeight.y * boneMatY;","#ifdef USE_MORPHNORMALS","vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );","#else","vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );","#endif","#endif"].join("\n"),defaultnormal_vertex:["vec3 objectNormal;","#ifdef USE_SKINNING","objectNormal = skinnedNormal.xyz;","#endif","#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )","objectNormal = morphedNormal;","#endif","#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )","objectNormal = normal;","#endif","#ifdef FLIP_SIDED","objectNormal = -objectNormal;","#endif","vec3 transformedNormal = normalMatrix * objectNormal;"].join("\n"),shadowmap_pars_fragment:["#ifdef USE_SHADOWMAP","uniform sampler2D shadowMap[ MAX_SHADOWS ];","uniform vec2 shadowMapSize[ MAX_SHADOWS ];","uniform float shadowDarkness[ MAX_SHADOWS ];","uniform float shadowBias[ MAX_SHADOWS ];","varying vec4 vShadowCoord[ MAX_SHADOWS ];","float unpackDepth( const in vec4 rgba_depth ) {","const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );","float depth = dot( rgba_depth, bit_shift );","return depth;","}","#endif"].join("\n"),shadowmap_fragment:["#ifdef USE_SHADOWMAP","#ifdef SHADOWMAP_DEBUG","vec3 frustumColors[3];","frustumColors[0] = vec3( 1.0, 0.5, 0.0 );","frustumColors[1] = vec3( 0.0, 1.0, 0.8 );","frustumColors[2] = vec3( 0.0, 0.5, 1.0 );","#endif","#ifdef SHADOWMAP_CASCADE","int inFrustumCount = 0;","#endif","float fDepth;","vec3 shadowColor = vec3( 1.0 );","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;","bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );","bool inFrustum = all( inFrustumVec );","#ifdef SHADOWMAP_CASCADE","inFrustumCount += int( inFrustum );","bvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );","#else","bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );","#endif","bool frustumTest = all( frustumTestVec );","if ( frustumTest ) {","shadowCoord.z += shadowBias[ i ];","#if defined( SHADOWMAP_TYPE_PCF )","float shadow = 0.0;","const float shadowDelta = 1.0 / 9.0;","float xPixelOffset = 1.0 / shadowMapSize[ i ].x;","float yPixelOffset = 1.0 / shadowMapSize[ i ].y;","float dx0 = -1.25 * xPixelOffset;","float dy0 = -1.25 * yPixelOffset;","float dx1 = 1.25 * xPixelOffset;","float dy1 = 1.25 * yPixelOffset;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );","#elif defined( SHADOWMAP_TYPE_PCF_SOFT )","float shadow = 0.0;","float xPixelOffset = 1.0 / shadowMapSize[ i ].x;","float yPixelOffset = 1.0 / shadowMapSize[ i ].y;","float dx0 = -1.0 * xPixelOffset;","float dy0 = -1.0 * yPixelOffset;","float dx1 = 1.0 * xPixelOffset;","float dy1 = 1.0 * yPixelOffset;","mat3 shadowKernel;","mat3 depthKernel;","depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );","depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );","depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );","depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );","depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );","depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );","depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );","depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );","depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );","vec3 shadowZ = vec3( shadowCoord.z );","shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));","shadowKernel[0] *= vec3(0.25);","shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));","shadowKernel[1] *= vec3(0.25);","shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));","shadowKernel[2] *= vec3(0.25);","vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );","shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );","shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );","vec4 shadowValues;","shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );","shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );","shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );","shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );","shadow = dot( shadowValues, vec4( 1.0 ) );","shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );","#else","vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );","float fDepth = unpackDepth( rgbaDepth );","if ( fDepth < shadowCoord.z )","shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );","#endif","}","#ifdef SHADOWMAP_DEBUG","#ifdef SHADOWMAP_CASCADE","if ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];","#else","if ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];","#endif","#endif","}","#ifdef GAMMA_OUTPUT","shadowColor *= shadowColor;","#endif","gl_FragColor.xyz = gl_FragColor.xyz * shadowColor;","#endif"].join("\n"),shadowmap_pars_vertex:["#ifdef USE_SHADOWMAP","varying vec4 vShadowCoord[ MAX_SHADOWS ];","uniform mat4 shadowMatrix[ MAX_SHADOWS ];","#endif"].join("\n"),shadowmap_vertex:["#ifdef USE_SHADOWMAP","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;","}","#endif"].join("\n"),alphatest_fragment:["#ifdef ALPHATEST","if ( gl_FragColor.a < ALPHATEST ) discard;","#endif"].join("\n"),linear_to_gamma_fragment:["#ifdef GAMMA_OUTPUT","gl_FragColor.xyz = sqrt( gl_FragColor.xyz );","#endif"].join("\n")};
THREE.UniformsUtils={merge:function(e){var t,i,r,n={};for(t=0;t<e.length;t++){r=this.clone(e[t]);for(i in r)n[i]=r[i]}return n},clone:function(e){var t,i,r,n={};for(t in e){n[t]={};for(i in e[t]){r=e[t][i];if(r instanceof THREE.Color||r instanceof THREE.Vector2||r instanceof THREE.Vector3||r instanceof THREE.Vector4||r instanceof THREE.Matrix4||r instanceof THREE.Texture)n[t][i]=r.clone();else if(r instanceof Array)n[t][i]=r.slice();else n[t][i]=r}}return n}};THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}};THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib["common"],THREE.UniformsLib["fog"],THREE.UniformsLib["shadowmap"]]),vertexShader:[THREE.ShaderChunk["map_pars_vertex"],THREE.ShaderChunk["lightmap_pars_vertex"],THREE.ShaderChunk["envmap_pars_vertex"],THREE.ShaderChunk["color_pars_vertex"],THREE.ShaderChunk["morphtarget_pars_vertex"],THREE.ShaderChunk["skinning_pars_vertex"],THREE.ShaderChunk["shadowmap_pars_vertex"],"void main() {",THREE.ShaderChunk["map_vertex"],THREE.ShaderChunk["lightmap_vertex"],THREE.ShaderChunk["color_vertex"],THREE.ShaderChunk["skinbase_vertex"],"#ifdef USE_ENVMAP",THREE.ShaderChunk["morphnormal_vertex"],THREE.ShaderChunk["skinnormal_vertex"],THREE.ShaderChunk["defaultnormal_vertex"],"#endif",THREE.ShaderChunk["morphtarget_vertex"],THREE.ShaderChunk["skinning_vertex"],THREE.ShaderChunk["default_vertex"],THREE.ShaderChunk["worldpos_vertex"],THREE.ShaderChunk["envmap_vertex"],THREE.ShaderChunk["shadowmap_vertex"],"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",THREE.ShaderChunk["color_pars_fragment"],THREE.ShaderChunk["map_pars_fragment"],THREE.ShaderChunk["lightmap_pars_fragment"],THREE.ShaderChunk["envmap_pars_fragment"],THREE.ShaderChunk["fog_pars_fragment"],THREE.ShaderChunk["shadowmap_pars_fragment"],THREE.ShaderChunk["specularmap_pars_fragment"],"void main() {","gl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk["map_fragment"],THREE.ShaderChunk["alphatest_fragment"],THREE.ShaderChunk["specularmap_fragment"],THREE.ShaderChunk["lightmap_fragment"],THREE.ShaderChunk["color_fragment"],THREE.ShaderChunk["envmap_fragment"],THREE.ShaderChunk["shadowmap_fragment"],THREE.ShaderChunk["linear_to_gamma_fragment"],THREE.ShaderChunk["fog_fragment"],"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib["common"],THREE.UniformsLib["fog"],THREE.UniformsLib["lights"],THREE.UniformsLib["shadowmap"],{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","varying vec3 vLightBack;","#endif",THREE.ShaderChunk["map_pars_vertex"],THREE.ShaderChunk["lightmap_pars_vertex"],THREE.ShaderChunk["envmap_pars_vertex"],THREE.ShaderChunk["lights_lambert_pars_vertex"],THREE.ShaderChunk["color_pars_vertex"],THREE.ShaderChunk["morphtarget_pars_vertex"],THREE.ShaderChunk["skinning_pars_vertex"],THREE.ShaderChunk["shadowmap_pars_vertex"],"void main() {",THREE.ShaderChunk["map_vertex"],THREE.ShaderChunk["lightmap_vertex"],THREE.ShaderChunk["color_vertex"],THREE.ShaderChunk["morphnormal_vertex"],THREE.ShaderChunk["skinbase_vertex"],THREE.ShaderChunk["skinnormal_vertex"],THREE.ShaderChunk["defaultnormal_vertex"],THREE.ShaderChunk["morphtarget_vertex"],THREE.ShaderChunk["skinning_vertex"],THREE.ShaderChunk["default_vertex"],THREE.ShaderChunk["worldpos_vertex"],THREE.ShaderChunk["envmap_vertex"],THREE.ShaderChunk["lights_lambert_vertex"],THREE.ShaderChunk["shadowmap_vertex"],"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","varying vec3 vLightBack;","#endif",THREE.ShaderChunk["color_pars_fragment"],THREE.ShaderChunk["map_pars_fragment"],THREE.ShaderChunk["lightmap_pars_fragment"],THREE.ShaderChunk["envmap_pars_fragment"],THREE.ShaderChunk["fog_pars_fragment"],THREE.ShaderChunk["shadowmap_pars_fragment"],THREE.ShaderChunk["specularmap_pars_fragment"],"void main() {","gl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk["map_fragment"],THREE.ShaderChunk["alphatest_fragment"],THREE.ShaderChunk["specularmap_fragment"],"#ifdef DOUBLE_SIDED","if ( gl_FrontFacing )","gl_FragColor.xyz *= vLightFront;","else","gl_FragColor.xyz *= vLightBack;","#else","gl_FragColor.xyz *= vLightFront;","#endif",THREE.ShaderChunk["lightmap_fragment"],THREE.ShaderChunk["color_fragment"],THREE.ShaderChunk["envmap_fragment"],THREE.ShaderChunk["shadowmap_fragment"],THREE.ShaderChunk["linear_to_gamma_fragment"],THREE.ShaderChunk["fog_fragment"],"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib["common"],THREE.UniformsLib["bump"],THREE.UniformsLib["normalmap"],THREE.UniformsLib["fog"],THREE.UniformsLib["lights"],THREE.UniformsLib["shadowmap"],{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","varying vec3 vNormal;",THREE.ShaderChunk["map_pars_vertex"],THREE.ShaderChunk["lightmap_pars_vertex"],THREE.ShaderChunk["envmap_pars_vertex"],THREE.ShaderChunk["lights_phong_pars_vertex"],THREE.ShaderChunk["color_pars_vertex"],THREE.ShaderChunk["morphtarget_pars_vertex"],THREE.ShaderChunk["skinning_pars_vertex"],THREE.ShaderChunk["shadowmap_pars_vertex"],"void main() {",THREE.ShaderChunk["map_vertex"],THREE.ShaderChunk["lightmap_vertex"],THREE.ShaderChunk["color_vertex"],THREE.ShaderChunk["morphnormal_vertex"],THREE.ShaderChunk["skinbase_vertex"],THREE.ShaderChunk["skinnormal_vertex"],THREE.ShaderChunk["defaultnormal_vertex"],"vNormal = normalize( transformedNormal );",THREE.ShaderChunk["morphtarget_vertex"],THREE.ShaderChunk["skinning_vertex"],THREE.ShaderChunk["default_vertex"],"vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk["worldpos_vertex"],THREE.ShaderChunk["envmap_vertex"],THREE.ShaderChunk["lights_phong_vertex"],THREE.ShaderChunk["shadowmap_vertex"],"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform vec3 ambient;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;",THREE.ShaderChunk["color_pars_fragment"],THREE.ShaderChunk["map_pars_fragment"],THREE.ShaderChunk["lightmap_pars_fragment"],THREE.ShaderChunk["envmap_pars_fragment"],THREE.ShaderChunk["fog_pars_fragment"],THREE.ShaderChunk["lights_phong_pars_fragment"],THREE.ShaderChunk["shadowmap_pars_fragment"],THREE.ShaderChunk["bumpmap_pars_fragment"],THREE.ShaderChunk["normalmap_pars_fragment"],THREE.ShaderChunk["specularmap_pars_fragment"],"void main() {","gl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk["map_fragment"],THREE.ShaderChunk["alphatest_fragment"],THREE.ShaderChunk["specularmap_fragment"],THREE.ShaderChunk["lights_phong_fragment"],THREE.ShaderChunk["lightmap_fragment"],THREE.ShaderChunk["color_fragment"],THREE.ShaderChunk["envmap_fragment"],THREE.ShaderChunk["shadowmap_fragment"],THREE.ShaderChunk["linear_to_gamma_fragment"],THREE.ShaderChunk["fog_fragment"],"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib["particle"],THREE.UniformsLib["shadowmap"]]),vertexShader:["uniform float size;","uniform float scale;",THREE.ShaderChunk["color_pars_vertex"],THREE.ShaderChunk["shadowmap_pars_vertex"],"void main() {",THREE.ShaderChunk["color_vertex"],"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","#ifdef USE_SIZEATTENUATION","gl_PointSize = size * ( scale / length( mvPosition.xyz ) );","#else","gl_PointSize = size;","#endif","gl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk["worldpos_vertex"],THREE.ShaderChunk["shadowmap_vertex"],"}"].join("\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",THREE.ShaderChunk["color_pars_fragment"],THREE.ShaderChunk["map_particle_pars_fragment"],THREE.ShaderChunk["fog_pars_fragment"],THREE.ShaderChunk["shadowmap_pars_fragment"],"void main() {","gl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk["map_particle_fragment"],THREE.ShaderChunk["alphatest_fragment"],THREE.ShaderChunk["color_fragment"],THREE.ShaderChunk["shadowmap_fragment"],THREE.ShaderChunk["fog_fragment"],"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib["common"],THREE.UniformsLib["fog"],{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",THREE.ShaderChunk["color_pars_vertex"],"void main() {",THREE.ShaderChunk["color_vertex"],"vLineDistance = scale * lineDistance;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",THREE.ShaderChunk["color_pars_fragment"],THREE.ShaderChunk["fog_pars_fragment"],"void main() {","if ( mod( vLineDistance, totalSize ) > dashSize ) {","discard;","}","gl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk["color_fragment"],THREE.ShaderChunk["fog_fragment"],"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:["void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;","void main() {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float color = 1.0 - smoothstep( mNear, mFar, depth );","gl_FragColor = vec4( vec3( color ), opacity );","}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk["morphtarget_pars_vertex"],"void main() {","vNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk["morphtarget_vertex"],THREE.ShaderChunk["default_vertex"],"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;","void main() {","gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );","}"].join("\n")},normalmap:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib["fog"],THREE.UniformsLib["lights"],THREE.UniformsLib["shadowmap"],{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new THREE.Vector2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new THREE.Color(16777215)},uSpecularColor:{type:"c",value:new THREE.Color(1118481)},uAmbientColor:{type:"c",value:new THREE.Color(16777215)},uShininess:{type:"f",value:30},uOpacity:{type:"f",value:1},useRefract:{type:"i",value:0},uRefractionRatio:{type:"f",value:.98},uReflectivity:{type:"f",value:.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 uAmbientColor;","uniform vec3 uDiffuseColor;","uniform vec3 uSpecularColor;","uniform float uShininess;","uniform float uOpacity;","uniform bool enableDiffuse;","uniform bool enableSpecular;","uniform bool enableAO;","uniform bool enableReflection;","uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tSpecular;","uniform sampler2D tAO;","uniform samplerCube tCube;","uniform vec2 uNormalScale;","uniform bool useRefract;","uniform float uRefractionRatio;","uniform float uReflectivity;","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",THREE.ShaderChunk["shadowmap_pars_fragment"],THREE.ShaderChunk["fog_pars_fragment"],"void main() {","gl_FragColor = vec4( vec3( 1.0 ), uOpacity );","vec3 specularTex = vec3( 1.0 );","vec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;","normalTex.xy *= uNormalScale;","normalTex = normalize( normalTex );","if( enableDiffuse ) {","#ifdef GAMMA_INPUT","vec4 texelColor = texture2D( tDiffuse, vUv );","texelColor.xyz *= texelColor.xyz;","gl_FragColor = gl_FragColor * texelColor;","#else","gl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );","#endif","}","if( enableAO ) {","#ifdef GAMMA_INPUT","vec4 aoColor = texture2D( tAO, vUv );","aoColor.xyz *= aoColor.xyz;","gl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;","#else","gl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;","#endif","}","if( enableSpecular )","specularTex = texture2D( tSpecular, vUv ).xyz;","mat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );","vec3 finalNormal = tsb * normalTex;","#ifdef FLIP_SIDED","finalNormal = -finalNormal;","#endif","vec3 normal = normalize( finalNormal );","vec3 viewPosition = normalize( vViewPosition );","#if MAX_POINT_LIGHTS > 0","vec3 pointDiffuse = vec3( 0.0 );","vec3 pointSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 pointVector = lPosition.xyz + vViewPosition.xyz;","float pointDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","pointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );","pointVector = normalize( pointVector );","#ifdef WRAP_AROUND","float pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","#else","float pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );","#endif","pointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;","vec3 pointHalfVector = normalize( pointVector + viewPosition );","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );","pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;","#else","pointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","vec3 spotDiffuse = vec3( 0.0 );","vec3 spotSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 spotVector = lPosition.xyz + vViewPosition.xyz;","float spotDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","spotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );","spotVector = normalize( spotVector );","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","#ifdef WRAP_AROUND","float spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );","float spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );","vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","#else","float spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );","#endif","spotDiffuse += spotDistance * spotLightColor[ i ] * uDiffuseColor * spotDiffuseWeight * spotEffect;","vec3 spotHalfVector = normalize( spotVector + viewPosition );","float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","float spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );","spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;","#else","spotSpecular += spotDistance * spotLightColor[ i ] * uSpecularColor * spotSpecularWeight * spotDiffuseWeight * spotEffect;","#endif","}","}","#endif","#if MAX_DIR_LIGHTS > 0","vec3 dirDiffuse = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","#ifdef WRAP_AROUND","float directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );","float directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );","#else","float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );","#endif","dirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );","dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","#else","dirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;","#endif","}","#endif","#if MAX_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","hemiDiffuse += uDiffuseColor * hemiColor;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","float hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","float hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float dotProductGround = dot( normal, lVectorGround );","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlickSky = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );","vec3 schlickGround = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );","hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );","#else","hemiSpecular += uSpecularColor * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;","#endif","}","#endif","vec3 totalDiffuse = vec3( 0.0 );","vec3 totalSpecular = vec3( 0.0 );","#if MAX_DIR_LIGHTS > 0","totalDiffuse += dirDiffuse;","totalSpecular += dirSpecular;","#endif","#if MAX_HEMI_LIGHTS > 0","totalDiffuse += hemiDiffuse;","totalSpecular += hemiSpecular;","#endif","#if MAX_POINT_LIGHTS > 0","totalDiffuse += pointDiffuse;","totalSpecular += pointSpecular;","#endif","#if MAX_SPOT_LIGHTS > 0","totalDiffuse += spotDiffuse;","totalSpecular += spotSpecular;","#endif","#ifdef METAL","gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor + totalSpecular );","#else","gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor ) + totalSpecular;","#endif","if ( enableReflection ) {","vec3 vReflect;","vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","if ( useRefract ) {","vReflect = refract( cameraToVertex, normal, uRefractionRatio );","} else {","vReflect = reflect( cameraToVertex, normal );","}","vec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );","#ifdef GAMMA_INPUT","cubeColor.xyz *= cubeColor.xyz;","#endif","gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );","}",THREE.ShaderChunk["shadowmap_fragment"],THREE.ShaderChunk["linear_to_gamma_fragment"],THREE.ShaderChunk["fog_fragment"],"}"].join("\n"),vertexShader:["attribute vec4 tangent;","uniform vec2 uOffset;","uniform vec2 uRepeat;","uniform bool enableDisplacement;","#ifdef VERTEX_TEXTURES","uniform sampler2D tDisplacement;","uniform float uDisplacementScale;","uniform float uDisplacementBias;","#endif","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",THREE.ShaderChunk["skinning_pars_vertex"],THREE.ShaderChunk["shadowmap_pars_vertex"],"void main() {",THREE.ShaderChunk["skinbase_vertex"],THREE.ShaderChunk["skinnormal_vertex"],"#ifdef USE_SKINNING","vNormal = normalize( normalMatrix * skinnedNormal.xyz );","vec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );","vTangent = normalize( normalMatrix * skinnedTangent.xyz );","#else","vNormal = normalize( normalMatrix * normal );","vTangent = normalize( normalMatrix * tangent.xyz );","#endif","vBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );","vUv = uv * uRepeat + uOffset;","vec3 displacedPosition;","#ifdef VERTEX_TEXTURES","if ( enableDisplacement ) {","vec3 dv = texture2D( tDisplacement, uv ).xyz;","float df = uDisplacementScale * dv.x + uDisplacementBias;","displacedPosition = position + normalize( normal ) * df;","} else {","#ifdef USE_SKINNING","vec4 skinVertex = vec4( position, 1.0 );","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","displacedPosition  = skinned.xyz;","#else","displacedPosition = position;","#endif","}","#else","#ifdef USE_SKINNING","vec4 skinVertex = vec4( position, 1.0 );","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","displacedPosition  = skinned.xyz;","#else","displacedPosition = position;","#endif","#endif","vec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );","vec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );","gl_Position = projectionMatrix * mvPosition;","vWorldPosition = worldPosition.xyz;","vViewPosition = -mvPosition.xyz;","#ifdef USE_SHADOWMAP","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;","}","#endif","}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;","void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vWorldPosition = worldPosition.xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;","void main() {","gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );","}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk["morphtarget_pars_vertex"],THREE.ShaderChunk["skinning_pars_vertex"],"void main() {",THREE.ShaderChunk["skinbase_vertex"],THREE.ShaderChunk["morphtarget_vertex"],THREE.ShaderChunk["skinning_vertex"],THREE.ShaderChunk["default_vertex"],"}"].join("\n"),fragmentShader:["vec4 pack_depth( const in float depth ) {","const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","const vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","vec4 res = fract( depth * bit_shift );","res -= res.xxyz * bit_mask;","return res;","}","void main() {","gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","}"].join("\n")}};THREE.WebGLRenderer=function(e){function t(e){e.__webglVertexBuffer=Ti.createBuffer();e.__webglColorBuffer=Ti.createBuffer();It.info.memory.geometries++}function i(e){e.__webglVertexBuffer=Ti.createBuffer();e.__webglColorBuffer=Ti.createBuffer();e.__webglLineDistanceBuffer=Ti.createBuffer();It.info.memory.geometries++}function r(e){e.__webglVertexBuffer=Ti.createBuffer();e.__webglColorBuffer=Ti.createBuffer();e.__webglNormalBuffer=Ti.createBuffer();It.info.memory.geometries++}function n(e){e.__webglVertexBuffer=Ti.createBuffer();e.__webglNormalBuffer=Ti.createBuffer();e.__webglTangentBuffer=Ti.createBuffer();e.__webglColorBuffer=Ti.createBuffer();e.__webglUVBuffer=Ti.createBuffer();e.__webglUV2Buffer=Ti.createBuffer();e.__webglSkinIndicesBuffer=Ti.createBuffer();e.__webglSkinWeightsBuffer=Ti.createBuffer();e.__webglFaceBuffer=Ti.createBuffer();e.__webglLineBuffer=Ti.createBuffer();var t,i;if(e.numMorphTargets){e.__webglMorphTargetsBuffers=[];for(t=0,i=e.numMorphTargets;i>t;t++)e.__webglMorphTargetsBuffers.push(Ti.createBuffer())}if(e.numMorphNormals){e.__webglMorphNormalsBuffers=[];for(t=0,i=e.numMorphNormals;i>t;t++)e.__webglMorphNormalsBuffers.push(Ti.createBuffer())}It.info.memory.geometries++}function o(e){if(e.__webglCustomAttributesList)for(var t in e.__webglCustomAttributesList)Ti.deleteBuffer(e.__webglCustomAttributesList[t].buffer)}function a(e,t){var i=e.vertices.length;var r=t.material;if(r.attributes){if(void 0===e.__webglCustomAttributesList)e.__webglCustomAttributesList=[];for(var n in r.attributes){var o=r.attributes[n];if(!o.__webglInitialized||o.createUniqueBuffers){o.__webglInitialized=!0;var a=1;if("v2"===o.type)a=2;else if("v3"===o.type)a=3;else if("v4"===o.type)a=4;else if("c"===o.type)a=3;o.size=a;o.array=new Float32Array(i*a);o.buffer=Ti.createBuffer();o.buffer.belongsToAttribute=n;o.needsUpdate=!0}e.__webglCustomAttributesList.push(o)}}}function s(e,t){var i=e.vertices.length;e.__vertexArray=new Float32Array(3*i);e.__colorArray=new Float32Array(3*i);e.__sortArray=[];e.__webglParticleCount=i;a(e,t)}function l(e,t){var i=e.vertices.length;e.__vertexArray=new Float32Array(3*i);e.__colorArray=new Float32Array(3*i);e.__lineDistanceArray=new Float32Array(1*i);e.__webglLineCount=i;a(e,t)}function h(e,t){var i=e.vertices.length;e.__vertexArray=new Float32Array(3*i);e.__colorArray=new Float32Array(3*i);e.__normalArray=new Float32Array(3*i);e.__webglVertexCount=i;a(e,t)}function c(e,t){var i=t.geometry,r=e.faces3,n=e.faces4,o=3*r.length+4*n.length,a=1*r.length+2*n.length,s=3*r.length+4*n.length,l=u(t,e),h=m(l),c=d(l),f=p(l);e.__vertexArray=new Float32Array(3*o);if(c)e.__normalArray=new Float32Array(3*o);if(i.hasTangents)e.__tangentArray=new Float32Array(4*o);if(f)e.__colorArray=new Float32Array(3*o);if(h){if(i.faceUvs.length>0||i.faceVertexUvs.length>0)e.__uvArray=new Float32Array(2*o);if(i.faceUvs.length>1||i.faceVertexUvs.length>1)e.__uv2Array=new Float32Array(2*o)}if(t.geometry.skinWeights.length&&t.geometry.skinIndices.length){e.__skinIndexArray=new Float32Array(4*o);e.__skinWeightArray=new Float32Array(4*o)}e.__faceArray=new Uint16Array(3*a);e.__lineArray=new Uint16Array(2*s);var g,v;if(e.numMorphTargets){e.__morphTargetsArrays=[];for(g=0,v=e.numMorphTargets;v>g;g++)e.__morphTargetsArrays.push(new Float32Array(3*o))}if(e.numMorphNormals){e.__morphNormalsArrays=[];for(g=0,v=e.numMorphNormals;v>g;g++)e.__morphNormalsArrays.push(new Float32Array(3*o))}e.__webglFaceCount=3*a;e.__webglLineCount=2*s;if(l.attributes){if(void 0===e.__webglCustomAttributesList)e.__webglCustomAttributesList=[];for(var E in l.attributes){var y=l.attributes[E];var T={};for(var _ in y)T[_]=y[_];if(!T.__webglInitialized||T.createUniqueBuffers){T.__webglInitialized=!0;var b=1;if("v2"===T.type)b=2;else if("v3"===T.type)b=3;else if("v4"===T.type)b=4;else if("c"===T.type)b=3;T.size=b;T.array=new Float32Array(o*b);T.buffer=Ti.createBuffer();T.buffer.belongsToAttribute=E;y.needsUpdate=!0;T.__original=y}e.__webglCustomAttributesList.push(T)}}e.__inittedArrays=!0}function u(e,t){return e.material instanceof THREE.MeshFaceMaterial?e.material.materials[t.materialIndex]:e.material}function f(e){return e&&void 0!==e.shading&&e.shading===THREE.SmoothShading}function d(e){if(e instanceof THREE.MeshBasicMaterial&&!e.envMap||e instanceof THREE.MeshDepthMaterial)return!1;
if(f(e))return THREE.SmoothShading;else return THREE.FlatShading}function p(e){if(e.vertexColors)return e.vertexColors;else return!1}function m(e){if(e.map||e.lightMap||e.bumpMap||e.normalMap||e.specularMap||e instanceof THREE.ShaderMaterial)return!0;else return!1}function g(e){var t,i,r;for(t in e.attributes){if("index"===t)r=Ti.ELEMENT_ARRAY_BUFFER;else r=Ti.ARRAY_BUFFER;i=e.attributes[t];if(void 0===i.numItems)i.numItems=i.array.length;i.buffer=Ti.createBuffer();Ti.bindBuffer(r,i.buffer);Ti.bufferData(r,i.array,Ti.STATIC_DRAW)}}function v(e,t,i){var r,n,o,a,s,l,h,c,u,f,d,p,m=e.vertices,g=m.length,v=e.colors,E=v.length,y=e.__vertexArray,T=e.__colorArray,_=e.__sortArray,b=e.verticesNeedUpdate,x=(e.elementsNeedUpdate,e.colorsNeedUpdate),R=e.__webglCustomAttributesList;if(i.sortParticles){mi.copy(pi);mi.multiply(i.matrixWorld);for(r=0;g>r;r++){o=m[r];gi.copy(o);gi.applyProjection(mi);_[r]=[gi.z,r]}_.sort(H);for(r=0;g>r;r++){o=m[_[r][1]];a=3*r;y[a]=o.x;y[a+1]=o.y;y[a+2]=o.z}for(n=0;E>n;n++){a=3*n;l=v[_[n][1]];T[a]=l.r;T[a+1]=l.g;T[a+2]=l.b}if(R)for(h=0,c=R.length;c>h;h++){p=R[h];if(void 0===p.boundTo||"vertices"===p.boundTo){a=0;f=p.value.length;if(1===p.size)for(u=0;f>u;u++){s=_[u][1];p.array[u]=p.value[s]}else if(2===p.size)for(u=0;f>u;u++){s=_[u][1];d=p.value[s];p.array[a]=d.x;p.array[a+1]=d.y;a+=2}else if(3===p.size)if("c"===p.type)for(u=0;f>u;u++){s=_[u][1];d=p.value[s];p.array[a]=d.r;p.array[a+1]=d.g;p.array[a+2]=d.b;a+=3}else for(u=0;f>u;u++){s=_[u][1];d=p.value[s];p.array[a]=d.x;p.array[a+1]=d.y;p.array[a+2]=d.z;a+=3}else if(4===p.size)for(u=0;f>u;u++){s=_[u][1];d=p.value[s];p.array[a]=d.x;p.array[a+1]=d.y;p.array[a+2]=d.z;p.array[a+3]=d.w;a+=4}}else;}}else{if(b)for(r=0;g>r;r++){o=m[r];a=3*r;y[a]=o.x;y[a+1]=o.y;y[a+2]=o.z}if(x)for(n=0;E>n;n++){l=v[n];a=3*n;T[a]=l.r;T[a+1]=l.g;T[a+2]=l.b}if(R)for(h=0,c=R.length;c>h;h++){p=R[h];if(p.needsUpdate&&(void 0===p.boundTo||"vertices"===p.boundTo)){f=p.value.length;a=0;if(1===p.size)for(u=0;f>u;u++)p.array[u]=p.value[u];else if(2===p.size)for(u=0;f>u;u++){d=p.value[u];p.array[a]=d.x;p.array[a+1]=d.y;a+=2}else if(3===p.size)if("c"===p.type)for(u=0;f>u;u++){d=p.value[u];p.array[a]=d.r;p.array[a+1]=d.g;p.array[a+2]=d.b;a+=3}else for(u=0;f>u;u++){d=p.value[u];p.array[a]=d.x;p.array[a+1]=d.y;p.array[a+2]=d.z;a+=3}else if(4===p.size)for(u=0;f>u;u++){d=p.value[u];p.array[a]=d.x;p.array[a+1]=d.y;p.array[a+2]=d.z;p.array[a+3]=d.w;a+=4}}}}if(b||i.sortParticles){Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglVertexBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,y,t)}if(x||i.sortParticles){Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglColorBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,T,t)}if(R)for(h=0,c=R.length;c>h;h++){p=R[h];if(p.needsUpdate||i.sortParticles){Ti.bindBuffer(Ti.ARRAY_BUFFER,p.buffer);Ti.bufferData(Ti.ARRAY_BUFFER,p.array,t)}}}function E(e,t){var i,r,n,o,a,s,l,h,c,u,f,d,p=e.vertices,m=e.colors,g=e.lineDistances,v=p.length,E=m.length,y=g.length,T=e.__vertexArray,_=e.__colorArray,b=e.__lineDistanceArray,x=e.verticesNeedUpdate,R=e.colorsNeedUpdate,w=e.lineDistancesNeedUpdate,H=e.__webglCustomAttributesList;if(x){for(i=0;v>i;i++){o=p[i];a=3*i;T[a]=o.x;T[a+1]=o.y;T[a+2]=o.z}Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglVertexBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,T,t)}if(R){for(r=0;E>r;r++){s=m[r];a=3*r;_[a]=s.r;_[a+1]=s.g;_[a+2]=s.b}Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglColorBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,_,t)}if(w){for(n=0;y>n;n++)b[n]=g[n];Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglLineDistanceBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,b,t)}if(H)for(l=0,h=H.length;h>l;l++){d=H[l];if(d.needsUpdate&&(void 0===d.boundTo||"vertices"===d.boundTo)){a=0;u=d.value.length;if(1===d.size)for(c=0;u>c;c++)d.array[c]=d.value[c];else if(2===d.size)for(c=0;u>c;c++){f=d.value[c];d.array[a]=f.x;d.array[a+1]=f.y;a+=2}else if(3===d.size)if("c"===d.type)for(c=0;u>c;c++){f=d.value[c];d.array[a]=f.r;d.array[a+1]=f.g;d.array[a+2]=f.b;a+=3}else for(c=0;u>c;c++){f=d.value[c];d.array[a]=f.x;d.array[a+1]=f.y;d.array[a+2]=f.z;a+=3}else if(4===d.size)for(c=0;u>c;c++){f=d.value[c];d.array[a]=f.x;d.array[a+1]=f.y;d.array[a+2]=f.z;d.array[a+3]=f.w;a+=4}Ti.bindBuffer(Ti.ARRAY_BUFFER,d.buffer);Ti.bufferData(Ti.ARRAY_BUFFER,d.array,t)}}}function y(e,t){var i,r,n,o,a,s,l,h,c,u,f,d,p,m=e.vertices,g=e.colors,v=e.normals,E=m.length,y=g.length,T=v.length,_=e.__vertexArray,b=e.__colorArray,x=e.__normalArray,R=e.verticesNeedUpdate,w=e.colorsNeedUpdate,H=e.normalsNeedUpdate,M=e.__webglCustomAttributesList;if(R){for(i=0;E>i;i++){o=m[i];a=3*i;_[a]=o.x;_[a+1]=o.y;_[a+2]=o.z}Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglVertexBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,_,t)}if(w){for(r=0;y>r;r++){s=g[r];a=3*r;b[a]=s.r;b[a+1]=s.g;b[a+2]=s.b}Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglColorBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,b,t)}if(H){for(n=0;T>n;n++){l=v[n];a=3*n;x[a]=l.x;x[a+1]=l.y;x[a+2]=l.z}Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglNormalBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,x,t)}if(M)for(h=0,c=M.length;c>h;h++){d=M[h];if(d.needsUpdate&&(void 0===d.boundTo||"vertices"===d.boundTo)){a=0;f=d.value.length;if(1===d.size)for(u=0;f>u;u++)d.array[u]=d.value[u];else if(2===d.size)for(u=0;f>u;u++){p=d.value[u];d.array[a]=p.x;d.array[a+1]=p.y;a+=2}else if(3===d.size)if("c"===d.type)for(u=0;f>u;u++){p=d.value[u];d.array[a]=p.r;d.array[a+1]=p.g;d.array[a+2]=p.b;a+=3}else for(u=0;f>u;u++){p=d.value[u];d.array[a]=p.x;d.array[a+1]=p.y;d.array[a+2]=p.z;a+=3}else if(4===d.size)for(u=0;f>u;u++){p=d.value[u];d.array[a]=p.x;d.array[a+1]=p.y;d.array[a+2]=p.z;d.array[a+3]=p.w;a+=4}Ti.bindBuffer(Ti.ARRAY_BUFFER,d.buffer);Ti.bufferData(Ti.ARRAY_BUFFER,d.array,t)}}}function T(e,t,i,r,n){if(e.__inittedArrays){var o=d(n),a=p(n),s=m(n),l=o===THREE.SmoothShading;var h,c,u,f,g,v,E,y,T,_,b,x,R,w,H,M,S,C,A,D,P,k,L,F,z,N,I,O,U,V,B,j,W,G,X,Y,q,K,Q,Z,$,J,et,tt,it,rt,nt,ot,at=0,st=0,lt=0,ht=0,ct=0,ut=0,ft=0,dt=0,pt=0,mt=0,gt=0,vt=0,Et=0,yt=e.__vertexArray,Tt=e.__uvArray,_t=e.__uv2Array,bt=e.__normalArray,xt=e.__tangentArray,Rt=e.__colorArray,wt=e.__skinIndexArray,Ht=e.__skinWeightArray,Mt=e.__morphTargetsArrays,St=e.__morphNormalsArrays,Ct=e.__webglCustomAttributesList,At=e.__faceArray,Dt=e.__lineArray,Pt=t.geometry,kt=Pt.verticesNeedUpdate,Lt=Pt.elementsNeedUpdate,Ft=Pt.uvsNeedUpdate,zt=Pt.normalsNeedUpdate,Nt=Pt.tangentsNeedUpdate,It=Pt.colorsNeedUpdate,Ot=Pt.morphTargetsNeedUpdate,Ut=Pt.vertices,Vt=e.faces3,Bt=e.faces4,jt=Pt.faces,Wt=Pt.faceVertexUvs[0],Gt=Pt.faceVertexUvs[1],Xt=(Pt.colors,Pt.skinIndices),Yt=Pt.skinWeights,qt=Pt.morphTargets,Kt=Pt.morphNormals;if(kt){for(h=0,c=Vt.length;c>h;h++){f=jt[Vt[h]];x=Ut[f.a];R=Ut[f.b];w=Ut[f.c];yt[st]=x.x;yt[st+1]=x.y;yt[st+2]=x.z;yt[st+3]=R.x;yt[st+4]=R.y;yt[st+5]=R.z;yt[st+6]=w.x;yt[st+7]=w.y;yt[st+8]=w.z;st+=9}for(h=0,c=Bt.length;c>h;h++){f=jt[Bt[h]];x=Ut[f.a];R=Ut[f.b];w=Ut[f.c];H=Ut[f.d];yt[st]=x.x;yt[st+1]=x.y;yt[st+2]=x.z;yt[st+3]=R.x;yt[st+4]=R.y;yt[st+5]=R.z;yt[st+6]=w.x;yt[st+7]=w.y;yt[st+8]=w.z;yt[st+9]=H.x;yt[st+10]=H.y;yt[st+11]=H.z;st+=12}Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglVertexBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,yt,i)}if(Ot)for($=0,J=qt.length;J>$;$++){gt=0;for(h=0,c=Vt.length;c>h;h++){it=Vt[h];f=jt[it];x=qt[$].vertices[f.a];R=qt[$].vertices[f.b];w=qt[$].vertices[f.c];et=Mt[$];et[gt]=x.x;et[gt+1]=x.y;et[gt+2]=x.z;et[gt+3]=R.x;et[gt+4]=R.y;et[gt+5]=R.z;et[gt+6]=w.x;et[gt+7]=w.y;et[gt+8]=w.z;if(n.morphNormals){if(l){rt=Kt[$].vertexNormals[it];D=rt.a;P=rt.b;k=rt.c}else{D=Kt[$].faceNormals[it];P=D;k=D}tt=St[$];tt[gt]=D.x;tt[gt+1]=D.y;tt[gt+2]=D.z;tt[gt+3]=P.x;tt[gt+4]=P.y;tt[gt+5]=P.z;tt[gt+6]=k.x;tt[gt+7]=k.y;tt[gt+8]=k.z}gt+=9}for(h=0,c=Bt.length;c>h;h++){it=Bt[h];f=jt[it];x=qt[$].vertices[f.a];R=qt[$].vertices[f.b];w=qt[$].vertices[f.c];H=qt[$].vertices[f.d];et=Mt[$];et[gt]=x.x;et[gt+1]=x.y;et[gt+2]=x.z;et[gt+3]=R.x;et[gt+4]=R.y;et[gt+5]=R.z;et[gt+6]=w.x;et[gt+7]=w.y;et[gt+8]=w.z;et[gt+9]=H.x;et[gt+10]=H.y;et[gt+11]=H.z;if(n.morphNormals){if(l){rt=Kt[$].vertexNormals[it];D=rt.a;P=rt.b;k=rt.c;L=rt.d}else{D=Kt[$].faceNormals[it];P=D;k=D;L=D}tt=St[$];tt[gt]=D.x;tt[gt+1]=D.y;tt[gt+2]=D.z;tt[gt+3]=P.x;tt[gt+4]=P.y;tt[gt+5]=P.z;tt[gt+6]=k.x;tt[gt+7]=k.y;tt[gt+8]=k.z;tt[gt+9]=L.x;tt[gt+10]=L.y;tt[gt+11]=L.z}gt+=12}Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[$]);Ti.bufferData(Ti.ARRAY_BUFFER,Mt[$],i);if(n.morphNormals){Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[$]);Ti.bufferData(Ti.ARRAY_BUFFER,St[$],i)}}if(Yt.length){for(h=0,c=Vt.length;c>h;h++){f=jt[Vt[h]];O=Yt[f.a];U=Yt[f.b];V=Yt[f.c];Ht[mt]=O.x;Ht[mt+1]=O.y;Ht[mt+2]=O.z;Ht[mt+3]=O.w;Ht[mt+4]=U.x;Ht[mt+5]=U.y;Ht[mt+6]=U.z;Ht[mt+7]=U.w;Ht[mt+8]=V.x;Ht[mt+9]=V.y;Ht[mt+10]=V.z;Ht[mt+11]=V.w;j=Xt[f.a];W=Xt[f.b];G=Xt[f.c];wt[mt]=j.x;wt[mt+1]=j.y;wt[mt+2]=j.z;wt[mt+3]=j.w;wt[mt+4]=W.x;wt[mt+5]=W.y;wt[mt+6]=W.z;wt[mt+7]=W.w;wt[mt+8]=G.x;wt[mt+9]=G.y;wt[mt+10]=G.z;wt[mt+11]=G.w;mt+=12}for(h=0,c=Bt.length;c>h;h++){f=jt[Bt[h]];O=Yt[f.a];U=Yt[f.b];V=Yt[f.c];B=Yt[f.d];Ht[mt]=O.x;Ht[mt+1]=O.y;Ht[mt+2]=O.z;Ht[mt+3]=O.w;Ht[mt+4]=U.x;Ht[mt+5]=U.y;Ht[mt+6]=U.z;Ht[mt+7]=U.w;Ht[mt+8]=V.x;Ht[mt+9]=V.y;Ht[mt+10]=V.z;Ht[mt+11]=V.w;Ht[mt+12]=B.x;Ht[mt+13]=B.y;Ht[mt+14]=B.z;Ht[mt+15]=B.w;j=Xt[f.a];W=Xt[f.b];G=Xt[f.c];X=Xt[f.d];wt[mt]=j.x;wt[mt+1]=j.y;wt[mt+2]=j.z;wt[mt+3]=j.w;wt[mt+4]=W.x;wt[mt+5]=W.y;wt[mt+6]=W.z;wt[mt+7]=W.w;wt[mt+8]=G.x;wt[mt+9]=G.y;wt[mt+10]=G.z;wt[mt+11]=G.w;wt[mt+12]=X.x;wt[mt+13]=X.y;wt[mt+14]=X.z;wt[mt+15]=X.w;mt+=16}if(mt>0){Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglSkinIndicesBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,wt,i);Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglSkinWeightsBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,Ht,i)}}if(It&&a){for(h=0,c=Vt.length;c>h;h++){f=jt[Vt[h]];E=f.vertexColors;y=f.color;if(3===E.length&&a===THREE.VertexColors){F=E[0];z=E[1];N=E[2]}else{F=y;z=y;N=y}Rt[pt]=F.r;Rt[pt+1]=F.g;Rt[pt+2]=F.b;Rt[pt+3]=z.r;Rt[pt+4]=z.g;Rt[pt+5]=z.b;Rt[pt+6]=N.r;Rt[pt+7]=N.g;Rt[pt+8]=N.b;pt+=9}for(h=0,c=Bt.length;c>h;h++){f=jt[Bt[h]];E=f.vertexColors;y=f.color;if(4===E.length&&a===THREE.VertexColors){F=E[0];z=E[1];N=E[2];I=E[3]}else{F=y;z=y;N=y;I=y}Rt[pt]=F.r;Rt[pt+1]=F.g;Rt[pt+2]=F.b;Rt[pt+3]=z.r;Rt[pt+4]=z.g;Rt[pt+5]=z.b;Rt[pt+6]=N.r;Rt[pt+7]=N.g;Rt[pt+8]=N.b;Rt[pt+9]=I.r;Rt[pt+10]=I.g;Rt[pt+11]=I.b;pt+=12}if(pt>0){Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglColorBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,Rt,i)}}if(Nt&&Pt.hasTangents){for(h=0,c=Vt.length;c>h;h++){f=jt[Vt[h]];T=f.vertexTangents;M=T[0];S=T[1];C=T[2];xt[ft]=M.x;xt[ft+1]=M.y;xt[ft+2]=M.z;xt[ft+3]=M.w;xt[ft+4]=S.x;xt[ft+5]=S.y;xt[ft+6]=S.z;xt[ft+7]=S.w;xt[ft+8]=C.x;xt[ft+9]=C.y;xt[ft+10]=C.z;xt[ft+11]=C.w;ft+=12}for(h=0,c=Bt.length;c>h;h++){f=jt[Bt[h]];T=f.vertexTangents;M=T[0];S=T[1];C=T[2];A=T[3];xt[ft]=M.x;xt[ft+1]=M.y;xt[ft+2]=M.z;xt[ft+3]=M.w;xt[ft+4]=S.x;xt[ft+5]=S.y;xt[ft+6]=S.z;xt[ft+7]=S.w;xt[ft+8]=C.x;xt[ft+9]=C.y;xt[ft+10]=C.z;xt[ft+11]=C.w;xt[ft+12]=A.x;xt[ft+13]=A.y;xt[ft+14]=A.z;xt[ft+15]=A.w;ft+=16}Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglTangentBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,xt,i)}if(zt&&o){for(h=0,c=Vt.length;c>h;h++){f=jt[Vt[h]];g=f.vertexNormals;v=f.normal;if(3===g.length&&l)for(Y=0;3>Y;Y++){K=g[Y];bt[ut]=K.x;bt[ut+1]=K.y;bt[ut+2]=K.z;ut+=3}else for(Y=0;3>Y;Y++){bt[ut]=v.x;bt[ut+1]=v.y;bt[ut+2]=v.z;ut+=3}}for(h=0,c=Bt.length;c>h;h++){f=jt[Bt[h]];g=f.vertexNormals;v=f.normal;if(4===g.length&&l)for(Y=0;4>Y;Y++){K=g[Y];bt[ut]=K.x;bt[ut+1]=K.y;bt[ut+2]=K.z;ut+=3}else for(Y=0;4>Y;Y++){bt[ut]=v.x;bt[ut+1]=v.y;bt[ut+2]=v.z;ut+=3}}Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglNormalBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,bt,i)}if(Ft&&Wt&&s){for(h=0,c=Vt.length;c>h;h++){u=Vt[h];_=Wt[u];if(void 0!==_)for(Y=0;3>Y;Y++){Q=_[Y];Tt[lt]=Q.x;Tt[lt+1]=Q.y;lt+=2}else;}for(h=0,c=Bt.length;c>h;h++){u=Bt[h];_=Wt[u];if(void 0!==_)for(Y=0;4>Y;Y++){Q=_[Y];Tt[lt]=Q.x;Tt[lt+1]=Q.y;lt+=2}else;}if(lt>0){Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglUVBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,Tt,i)}}if(Ft&&Gt&&s){for(h=0,c=Vt.length;c>h;h++){u=Vt[h];b=Gt[u];if(void 0!==b)for(Y=0;3>Y;Y++){Z=b[Y];_t[ht]=Z.x;_t[ht+1]=Z.y;ht+=2}else;}for(h=0,c=Bt.length;c>h;h++){u=Bt[h];b=Gt[u];if(void 0!==b)for(Y=0;4>Y;Y++){Z=b[Y];_t[ht]=Z.x;_t[ht+1]=Z.y;ht+=2}else;}if(ht>0){Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglUV2Buffer);Ti.bufferData(Ti.ARRAY_BUFFER,_t,i)}}if(Lt){for(h=0,c=Vt.length;c>h;h++){At[ct]=at;At[ct+1]=at+1;At[ct+2]=at+2;ct+=3;Dt[dt]=at;Dt[dt+1]=at+1;Dt[dt+2]=at;Dt[dt+3]=at+2;Dt[dt+4]=at+1;Dt[dt+5]=at+2;dt+=6;at+=3}for(h=0,c=Bt.length;c>h;h++){At[ct]=at;At[ct+1]=at+1;At[ct+2]=at+3;At[ct+3]=at+1;At[ct+4]=at+2;At[ct+5]=at+3;ct+=6;Dt[dt]=at;Dt[dt+1]=at+1;Dt[dt+2]=at;Dt[dt+3]=at+3;Dt[dt+4]=at+1;Dt[dt+5]=at+2;Dt[dt+6]=at+2;Dt[dt+7]=at+3;dt+=8;at+=4}Ti.bindBuffer(Ti.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer);Ti.bufferData(Ti.ELEMENT_ARRAY_BUFFER,At,i);Ti.bindBuffer(Ti.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer);Ti.bufferData(Ti.ELEMENT_ARRAY_BUFFER,Dt,i)}if(Ct)for(Y=0,q=Ct.length;q>Y;Y++){ot=Ct[Y];if(ot.__original.needsUpdate){vt=0;Et=0;if(1===ot.size){if(void 0===ot.boundTo||"vertices"===ot.boundTo){for(h=0,c=Vt.length;c>h;h++){f=jt[Vt[h]];ot.array[vt]=ot.value[f.a];ot.array[vt+1]=ot.value[f.b];ot.array[vt+2]=ot.value[f.c];vt+=3}for(h=0,c=Bt.length;c>h;h++){f=jt[Bt[h]];ot.array[vt]=ot.value[f.a];ot.array[vt+1]=ot.value[f.b];ot.array[vt+2]=ot.value[f.c];ot.array[vt+3]=ot.value[f.d];vt+=4}}else if("faces"===ot.boundTo){for(h=0,c=Vt.length;c>h;h++){nt=ot.value[Vt[h]];ot.array[vt]=nt;ot.array[vt+1]=nt;ot.array[vt+2]=nt;vt+=3}for(h=0,c=Bt.length;c>h;h++){nt=ot.value[Bt[h]];ot.array[vt]=nt;ot.array[vt+1]=nt;ot.array[vt+2]=nt;ot.array[vt+3]=nt;vt+=4}}}else if(2===ot.size){if(void 0===ot.boundTo||"vertices"===ot.boundTo){for(h=0,c=Vt.length;c>h;h++){f=jt[Vt[h]];x=ot.value[f.a];R=ot.value[f.b];w=ot.value[f.c];ot.array[vt]=x.x;ot.array[vt+1]=x.y;ot.array[vt+2]=R.x;ot.array[vt+3]=R.y;ot.array[vt+4]=w.x;ot.array[vt+5]=w.y;vt+=6}for(h=0,c=Bt.length;c>h;h++){f=jt[Bt[h]];x=ot.value[f.a];R=ot.value[f.b];w=ot.value[f.c];H=ot.value[f.d];ot.array[vt]=x.x;ot.array[vt+1]=x.y;ot.array[vt+2]=R.x;ot.array[vt+3]=R.y;ot.array[vt+4]=w.x;ot.array[vt+5]=w.y;ot.array[vt+6]=H.x;ot.array[vt+7]=H.y;vt+=8}}else if("faces"===ot.boundTo){for(h=0,c=Vt.length;c>h;h++){nt=ot.value[Vt[h]];x=nt;R=nt;w=nt;ot.array[vt]=x.x;ot.array[vt+1]=x.y;ot.array[vt+2]=R.x;ot.array[vt+3]=R.y;ot.array[vt+4]=w.x;ot.array[vt+5]=w.y;vt+=6}for(h=0,c=Bt.length;c>h;h++){nt=ot.value[Bt[h]];x=nt;R=nt;w=nt;H=nt;ot.array[vt]=x.x;ot.array[vt+1]=x.y;ot.array[vt+2]=R.x;ot.array[vt+3]=R.y;ot.array[vt+4]=w.x;ot.array[vt+5]=w.y;ot.array[vt+6]=H.x;ot.array[vt+7]=H.y;vt+=8}}}else if(3===ot.size){var Qt;if("c"===ot.type)Qt=["r","g","b"];else Qt=["x","y","z"];if(void 0===ot.boundTo||"vertices"===ot.boundTo){for(h=0,c=Vt.length;c>h;h++){f=jt[Vt[h]];x=ot.value[f.a];R=ot.value[f.b];w=ot.value[f.c];ot.array[vt]=x[Qt[0]];ot.array[vt+1]=x[Qt[1]];ot.array[vt+2]=x[Qt[2]];ot.array[vt+3]=R[Qt[0]];ot.array[vt+4]=R[Qt[1]];ot.array[vt+5]=R[Qt[2]];ot.array[vt+6]=w[Qt[0]];ot.array[vt+7]=w[Qt[1]];ot.array[vt+8]=w[Qt[2]];vt+=9}for(h=0,c=Bt.length;c>h;h++){f=jt[Bt[h]];x=ot.value[f.a];R=ot.value[f.b];w=ot.value[f.c];H=ot.value[f.d];ot.array[vt]=x[Qt[0]];ot.array[vt+1]=x[Qt[1]];ot.array[vt+2]=x[Qt[2]];ot.array[vt+3]=R[Qt[0]];ot.array[vt+4]=R[Qt[1]];ot.array[vt+5]=R[Qt[2]];ot.array[vt+6]=w[Qt[0]];ot.array[vt+7]=w[Qt[1]];ot.array[vt+8]=w[Qt[2]];ot.array[vt+9]=H[Qt[0]];ot.array[vt+10]=H[Qt[1]];ot.array[vt+11]=H[Qt[2]];vt+=12}}else if("faces"===ot.boundTo){for(h=0,c=Vt.length;c>h;h++){nt=ot.value[Vt[h]];x=nt;R=nt;w=nt;ot.array[vt]=x[Qt[0]];ot.array[vt+1]=x[Qt[1]];ot.array[vt+2]=x[Qt[2]];ot.array[vt+3]=R[Qt[0]];ot.array[vt+4]=R[Qt[1]];ot.array[vt+5]=R[Qt[2]];ot.array[vt+6]=w[Qt[0]];ot.array[vt+7]=w[Qt[1]];ot.array[vt+8]=w[Qt[2]];vt+=9}for(h=0,c=Bt.length;c>h;h++){nt=ot.value[Bt[h]];x=nt;R=nt;w=nt;H=nt;ot.array[vt]=x[Qt[0]];ot.array[vt+1]=x[Qt[1]];ot.array[vt+2]=x[Qt[2]];ot.array[vt+3]=R[Qt[0]];ot.array[vt+4]=R[Qt[1]];ot.array[vt+5]=R[Qt[2]];ot.array[vt+6]=w[Qt[0]];ot.array[vt+7]=w[Qt[1]];ot.array[vt+8]=w[Qt[2]];ot.array[vt+9]=H[Qt[0]];ot.array[vt+10]=H[Qt[1]];ot.array[vt+11]=H[Qt[2]];vt+=12}}else if("faceVertices"===ot.boundTo){for(h=0,c=Vt.length;c>h;h++){nt=ot.value[Vt[h]];x=nt[0];R=nt[1];w=nt[2];ot.array[vt]=x[Qt[0]];ot.array[vt+1]=x[Qt[1]];ot.array[vt+2]=x[Qt[2]];ot.array[vt+3]=R[Qt[0]];ot.array[vt+4]=R[Qt[1]];ot.array[vt+5]=R[Qt[2]];ot.array[vt+6]=w[Qt[0]];ot.array[vt+7]=w[Qt[1]];ot.array[vt+8]=w[Qt[2]];vt+=9}for(h=0,c=Bt.length;c>h;h++){nt=ot.value[Bt[h]];x=nt[0];R=nt[1];w=nt[2];H=nt[3];ot.array[vt]=x[Qt[0]];ot.array[vt+1]=x[Qt[1]];ot.array[vt+2]=x[Qt[2]];ot.array[vt+3]=R[Qt[0]];ot.array[vt+4]=R[Qt[1]];ot.array[vt+5]=R[Qt[2]];ot.array[vt+6]=w[Qt[0]];ot.array[vt+7]=w[Qt[1]];ot.array[vt+8]=w[Qt[2]];ot.array[vt+9]=H[Qt[0]];ot.array[vt+10]=H[Qt[1]];ot.array[vt+11]=H[Qt[2]];vt+=12}}}else if(4===ot.size)if(void 0===ot.boundTo||"vertices"===ot.boundTo){for(h=0,c=Vt.length;c>h;h++){f=jt[Vt[h]];x=ot.value[f.a];R=ot.value[f.b];w=ot.value[f.c];ot.array[vt]=x.x;ot.array[vt+1]=x.y;ot.array[vt+2]=x.z;ot.array[vt+3]=x.w;ot.array[vt+4]=R.x;ot.array[vt+5]=R.y;ot.array[vt+6]=R.z;ot.array[vt+7]=R.w;ot.array[vt+8]=w.x;ot.array[vt+9]=w.y;ot.array[vt+10]=w.z;ot.array[vt+11]=w.w;vt+=12}for(h=0,c=Bt.length;c>h;h++){f=jt[Bt[h]];x=ot.value[f.a];R=ot.value[f.b];w=ot.value[f.c];H=ot.value[f.d];ot.array[vt]=x.x;ot.array[vt+1]=x.y;ot.array[vt+2]=x.z;ot.array[vt+3]=x.w;ot.array[vt+4]=R.x;ot.array[vt+5]=R.y;ot.array[vt+6]=R.z;ot.array[vt+7]=R.w;ot.array[vt+8]=w.x;ot.array[vt+9]=w.y;ot.array[vt+10]=w.z;ot.array[vt+11]=w.w;ot.array[vt+12]=H.x;ot.array[vt+13]=H.y;ot.array[vt+14]=H.z;ot.array[vt+15]=H.w;vt+=16}}else if("faces"===ot.boundTo){for(h=0,c=Vt.length;c>h;h++){nt=ot.value[Vt[h]];x=nt;R=nt;w=nt;ot.array[vt]=x.x;ot.array[vt+1]=x.y;ot.array[vt+2]=x.z;ot.array[vt+3]=x.w;ot.array[vt+4]=R.x;ot.array[vt+5]=R.y;ot.array[vt+6]=R.z;ot.array[vt+7]=R.w;ot.array[vt+8]=w.x;ot.array[vt+9]=w.y;ot.array[vt+10]=w.z;ot.array[vt+11]=w.w;vt+=12}for(h=0,c=Bt.length;c>h;h++){nt=ot.value[Bt[h]];x=nt;R=nt;w=nt;H=nt;ot.array[vt]=x.x;ot.array[vt+1]=x.y;ot.array[vt+2]=x.z;ot.array[vt+3]=x.w;ot.array[vt+4]=R.x;ot.array[vt+5]=R.y;ot.array[vt+6]=R.z;ot.array[vt+7]=R.w;ot.array[vt+8]=w.x;ot.array[vt+9]=w.y;ot.array[vt+10]=w.z;ot.array[vt+11]=w.w;ot.array[vt+12]=H.x;ot.array[vt+13]=H.y;ot.array[vt+14]=H.z;ot.array[vt+15]=H.w;vt+=16}}else if("faceVertices"===ot.boundTo){for(h=0,c=Vt.length;c>h;h++){nt=ot.value[Vt[h]];x=nt[0];R=nt[1];w=nt[2];ot.array[vt]=x.x;ot.array[vt+1]=x.y;ot.array[vt+2]=x.z;ot.array[vt+3]=x.w;ot.array[vt+4]=R.x;ot.array[vt+5]=R.y;ot.array[vt+6]=R.z;ot.array[vt+7]=R.w;ot.array[vt+8]=w.x;ot.array[vt+9]=w.y;ot.array[vt+10]=w.z;ot.array[vt+11]=w.w;vt+=12}for(h=0,c=Bt.length;c>h;h++){nt=ot.value[Bt[h]];x=nt[0];R=nt[1];w=nt[2];H=nt[3];ot.array[vt]=x.x;ot.array[vt+1]=x.y;ot.array[vt+2]=x.z;ot.array[vt+3]=x.w;ot.array[vt+4]=R.x;ot.array[vt+5]=R.y;ot.array[vt+6]=R.z;ot.array[vt+7]=R.w;ot.array[vt+8]=w.x;ot.array[vt+9]=w.y;ot.array[vt+10]=w.z;ot.array[vt+11]=w.w;ot.array[vt+12]=H.x;ot.array[vt+13]=H.y;ot.array[vt+14]=H.z;ot.array[vt+15]=H.w;vt+=16}}Ti.bindBuffer(Ti.ARRAY_BUFFER,ot.buffer);Ti.bufferData(Ti.ARRAY_BUFFER,ot.array,i)}else;}if(r){delete e.__inittedArrays;delete e.__colorArray;delete e.__normalArray;delete e.__tangentArray;delete e.__uvArray;delete e.__uv2Array;delete e.__faceArray;delete e.__vertexArray;delete e.__lineArray;delete e.__skinIndexArray;delete e.__skinWeightArray}}}function _(e,t,i){var r=e.attributes;var n,o;for(n in r){o=r[n];if(o.needsUpdate){if("index"===n){Ti.bindBuffer(Ti.ELEMENT_ARRAY_BUFFER,o.buffer);Ti.bufferData(Ti.ELEMENT_ARRAY_BUFFER,o.array,t)}else{Ti.bindBuffer(Ti.ARRAY_BUFFER,o.buffer);Ti.bufferData(Ti.ARRAY_BUFFER,o.array,t)}o.needsUpdate=!1}if(i&&!o.dynamic)o.array=null}}function b(e){if(!fi[e]){Ti.enableVertexAttribArray(e);fi[e]=!0}}function x(){for(var e in fi)if(fi[e]){Ti.disableVertexAttribArray(e);fi[e]=!1}}function R(e,t,i){var r=e.program.attributes;if(-1!==i.morphTargetBase&&r.position>=0){Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[i.morphTargetBase]);b(r.position);Ti.vertexAttribPointer(r.position,3,Ti.FLOAT,!1,0,0)}else if(r.position>=0){Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglVertexBuffer);b(r.position);Ti.vertexAttribPointer(r.position,3,Ti.FLOAT,!1,0,0)}if(i.morphTargetForcedOrder.length){var n=0;var o=i.morphTargetForcedOrder;var a=i.morphTargetInfluences;for(;n<e.numSupportedMorphTargets&&n<o.length;){if(r["morphTarget"+n]>=0){Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[o[n]]);b(r["morphTarget"+n]);Ti.vertexAttribPointer(r["morphTarget"+n],3,Ti.FLOAT,!1,0,0)}if(r["morphNormal"+n]>=0&&e.morphNormals){Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[o[n]]);b(r["morphNormal"+n]);Ti.vertexAttribPointer(r["morphNormal"+n],3,Ti.FLOAT,!1,0,0)}i.__webglMorphTargetInfluences[n]=a[o[n]];n++}}else{var s,l=[];var a=i.morphTargetInfluences;var h,c=a.length;for(h=0;c>h;h++){s=a[h];if(s>0)l.push([s,h])}if(l.length>e.numSupportedMorphTargets){l.sort(H);l.length=e.numSupportedMorphTargets}else if(l.length>e.numSupportedMorphNormals)l.sort(H);else if(0===l.length)l.push([0,0]);var u,n=0;for(;n<e.numSupportedMorphTargets;){if(l[n]){u=l[n][1];if(r["morphTarget"+n]>=0){Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[u]);b(r["morphTarget"+n]);Ti.vertexAttribPointer(r["morphTarget"+n],3,Ti.FLOAT,!1,0,0)}if(r["morphNormal"+n]>=0&&e.morphNormals){Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[u]);b(r["morphNormal"+n]);Ti.vertexAttribPointer(r["morphNormal"+n],3,Ti.FLOAT,!1,0,0)}i.__webglMorphTargetInfluences[n]=a[u]}else i.__webglMorphTargetInfluences[n]=0;n++}}if(null!==e.program.uniforms.morphTargetInfluences)Ti.uniform1fv(e.program.uniforms.morphTargetInfluences,i.__webglMorphTargetInfluences)}function w(e,t){if(e.z!==t.z)return t.z-e.z;else return e.id-t.id}function H(e,t){return t[0]-e[0]}function M(e,t,i){if(e.length)for(var r=0,n=e.length;n>r;r++){Vt=null;Gt=null;Qt=-1;ei=-1;ti=-1;qt=-1;Kt=-1;Wt=-1;jt=-1;Ei=!0;e[r].render(t,i,ci,ui);Vt=null;Gt=null;Qt=-1;ei=-1;ti=-1;qt=-1;Kt=-1;Wt=-1;jt=-1;Ei=!0}}function S(e,t,i,r,n,o,a,s){var l,h,c,u,f,d,p;if(t){f=e.length-1;d=-1;p=-1}else{f=0;d=e.length;p=1}for(var m=f;m!==d;m+=p){l=e[m];if(l.render){h=l.object;c=l.buffer;if(s)u=s;else{u=l[i];if(!u)continue;if(a)It.setBlending(u.blending,u.blendEquation,u.blendSrc,u.blendDst);It.setDepthTest(u.depthTest);It.setDepthWrite(u.depthWrite);st(u.polygonOffset,u.polygonOffsetFactor,u.polygonOffsetUnits)}It.setMaterialFaces(u);if(c instanceof THREE.BufferGeometry)It.renderBufferDirect(r,n,o,u,c,h);else It.renderBuffer(r,n,o,u,c,h)}}}function C(e,t,i,r,n,o,a){var s,l,h;for(var c=0,u=e.length;u>c;c++){s=e[c];l=s.object;if(l.visible){if(a)h=a;else{h=s[t];if(!h)continue;if(o)It.setBlending(h.blending,h.blendEquation,h.blendSrc,h.blendDst);It.setDepthTest(h.depthTest);It.setDepthWrite(h.depthWrite);st(h.polygonOffset,h.polygonOffsetFactor,h.polygonOffsetUnits)}It.renderImmediateObject(i,r,n,h,l)}}}function A(e){var t=e.object,i=t.material;if(i.transparent){e.transparent=i;e.opaque=null}else{e.opaque=i;e.transparent=null}}function D(e){var t,i,r,n=e.object,o=e.buffer;r=n.material;if(r instanceof THREE.MeshFaceMaterial){i=o.materialIndex;t=r.materials[i];if(t.transparent){e.transparent=t;e.opaque=null}else{e.opaque=t;e.transparent=null}}else{t=r;if(t)if(t.transparent){e.transparent=t;e.opaque=null}else{e.opaque=t;e.transparent=null}}}function P(e,t){var i,r,n,o,a,s,l={};var h=e.morphTargets.length;var c=e.morphNormals.length;var u=t instanceof THREE.MeshFaceMaterial;e.geometryGroups={};for(i=0,r=e.faces.length;r>i;i++){n=e.faces[i];o=u?n.materialIndex:0;if(void 0===l[o])l[o]={hash:o,counter:0};s=l[o].hash+"_"+l[o].counter;if(void 0===e.geometryGroups[s])e.geometryGroups[s]={faces3:[],faces4:[],materialIndex:o,vertices:0,numMorphTargets:h,numMorphNormals:c};a=n instanceof THREE.Face3?3:4;if(e.geometryGroups[s].vertices+a>65535){l[o].counter+=1;s=l[o].hash+"_"+l[o].counter;if(void 0===e.geometryGroups[s])e.geometryGroups[s]={faces3:[],faces4:[],materialIndex:o,vertices:0,numMorphTargets:h,numMorphNormals:c}}if(n instanceof THREE.Face3)e.geometryGroups[s].faces3.push(i);else e.geometryGroups[s].faces4.push(i);e.geometryGroups[s].vertices+=a}e.geometryGroupsList=[];for(var f in e.geometryGroups){e.geometryGroups[f].id=Xt++;e.geometryGroupsList.push(e.geometryGroups[f])}}function k(e,o){var a,u,f,d;if(void 0===e.__webglInit){e.__webglInit=!0;e._modelViewMatrix=new THREE.Matrix4;e._normalMatrix=new THREE.Matrix3;if(void 0!==e.geometry&&void 0===e.geometry.__webglInit){e.geometry.__webglInit=!0;e.geometry.addEventListener("dispose",Ii)}u=e.geometry;if(void 0===u);else if(u instanceof THREE.BufferGeometry)g(u);else if(e instanceof THREE.Mesh){f=e.material;if(void 0===u.geometryGroups)P(u,f);for(a in u.geometryGroups){d=u.geometryGroups[a];if(!d.__webglVertexBuffer){n(d);c(d,e);u.verticesNeedUpdate=!0;u.morphTargetsNeedUpdate=!0;u.elementsNeedUpdate=!0;u.uvsNeedUpdate=!0;u.normalsNeedUpdate=!0;u.tangentsNeedUpdate=!0;u.colorsNeedUpdate=!0}}}else if(e instanceof THREE.Ribbon){if(!u.__webglVertexBuffer){r(u);h(u,e);u.verticesNeedUpdate=!0;u.colorsNeedUpdate=!0;u.normalsNeedUpdate=!0}}else if(e instanceof THREE.Line){if(!u.__webglVertexBuffer){i(u);l(u,e);u.verticesNeedUpdate=!0;u.colorsNeedUpdate=!0;u.lineDistancesNeedUpdate=!0}}else if(e instanceof THREE.ParticleSystem)if(!u.__webglVertexBuffer){t(u);s(u,e);u.verticesNeedUpdate=!0;u.colorsNeedUpdate=!0}}if(void 0===e.__webglActive){if(e instanceof THREE.Mesh){u=e.geometry;if(u instanceof THREE.BufferGeometry)L(o.__webglObjects,u,e);else if(u instanceof THREE.Geometry)for(a in u.geometryGroups){d=u.geometryGroups[a];L(o.__webglObjects,d,e)}}else if(e instanceof THREE.Ribbon||e instanceof THREE.Line||e instanceof THREE.ParticleSystem){u=e.geometry;L(o.__webglObjects,u,e)}else if(e instanceof THREE.ImmediateRenderObject||e.immediateRenderCallback)F(o.__webglObjectsImmediate,e);else if(e instanceof THREE.Sprite)o.__webglSprites.push(e);else if(e instanceof THREE.LensFlare)o.__webglFlares.push(e);e.__webglActive=!0}}function L(e,t,i){e.push({id:null,buffer:t,object:i,opaque:null,transparent:null,z:0})}function F(e,t){e.push({id:null,object:t,opaque:null,transparent:null,z:0})}function z(e){var t,i,r,n=e.geometry;if(n instanceof THREE.BufferGeometry)_(n,Ti.DYNAMIC_DRAW,!n.dynamic);else if(e instanceof THREE.Mesh){for(var o=0,a=n.geometryGroupsList.length;a>o;o++){t=n.geometryGroupsList[o];r=u(e,t);if(n.buffersNeedUpdate)c(t,e);i=r.attributes&&N(r);if(n.verticesNeedUpdate||n.morphTargetsNeedUpdate||n.elementsNeedUpdate||n.uvsNeedUpdate||n.normalsNeedUpdate||n.colorsNeedUpdate||n.tangentsNeedUpdate||i)T(t,e,Ti.DYNAMIC_DRAW,!n.dynamic,r)}n.verticesNeedUpdate=!1;n.morphTargetsNeedUpdate=!1;n.elementsNeedUpdate=!1;n.uvsNeedUpdate=!1;n.normalsNeedUpdate=!1;n.colorsNeedUpdate=!1;n.tangentsNeedUpdate=!1;n.buffersNeedUpdate=!1;r.attributes&&I(r)}else if(e instanceof THREE.Ribbon){r=u(e,n);i=r.attributes&&N(r);if(n.verticesNeedUpdate||n.colorsNeedUpdate||n.normalsNeedUpdate||i)y(n,Ti.DYNAMIC_DRAW);n.verticesNeedUpdate=!1;n.colorsNeedUpdate=!1;n.normalsNeedUpdate=!1;r.attributes&&I(r)}else if(e instanceof THREE.Line){r=u(e,n);i=r.attributes&&N(r);if(n.verticesNeedUpdate||n.colorsNeedUpdate||n.lineDistancesNeedUpdate||i)E(n,Ti.DYNAMIC_DRAW);n.verticesNeedUpdate=!1;n.colorsNeedUpdate=!1;n.lineDistancesNeedUpdate=!1;r.attributes&&I(r)}else if(e instanceof THREE.ParticleSystem){r=u(e,n);i=r.attributes&&N(r);if(n.verticesNeedUpdate||n.colorsNeedUpdate||e.sortParticles||i)v(n,Ti.DYNAMIC_DRAW,e);n.verticesNeedUpdate=!1;n.colorsNeedUpdate=!1;r.attributes&&I(r)}}function N(e){for(var t in e.attributes)if(e.attributes[t].needsUpdate)return!0;return!1}function I(e){for(var t in e.attributes)e.attributes[t].needsUpdate=!1}function O(e,t){if(e instanceof THREE.Mesh||e instanceof THREE.ParticleSystem||e instanceof THREE.Ribbon||e instanceof THREE.Line)U(t.__webglObjects,e);else if(e instanceof THREE.Sprite)V(t.__webglSprites,e);else if(e instanceof THREE.LensFlare)V(t.__webglFlares,e);else if(e instanceof THREE.ImmediateRenderObject||e.immediateRenderCallback)U(t.__webglObjectsImmediate,e);delete e.__webglActive}function U(e,t){for(var i=e.length-1;i>=0;i--)if(e[i].object===t)e.splice(i,1)}function V(e,t){for(var i=e.length-1;i>=0;i--)if(e[i]===t)e.splice(i,1)}function B(e,t){e.uniforms=THREE.UniformsUtils.clone(t.uniforms);e.vertexShader=t.vertexShader;e.fragmentShader=t.fragmentShader}function j(e,t,i,r,n){Yt=0;if(r.needsUpdate){if(r.program)Gi(r);It.initMaterial(r,t,i,n);r.needsUpdate=!1}if(r.morphTargets)if(!n.__webglMorphTargetInfluences)n.__webglMorphTargetInfluences=new Float32Array(It.maxMorphTargets);var o=!1;var a=r.program,s=a.uniforms,l=r.uniforms;if(a!==Vt){Ti.useProgram(a);Vt=a;o=!0}if(r.id!==jt){jt=r.id;o=!0}if(o||e!==Gt){Ti.uniformMatrix4fv(s.projectionMatrix,!1,e.projectionMatrix.elements);if(e!==Gt)Gt=e}if(r.skinning)if(Di&&n.useVertexTexture){if(null!==s.boneTexture){var h=et();Ti.uniform1i(s.boneTexture,h);It.setTexture(n.boneTexture,h)}}else if(null!==s.boneGlobalMatrices)Ti.uniformMatrix4fv(s.boneGlobalMatrices,!1,n.boneMatrices);if(o){if(i&&r.fog)q(l,i);if(r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshLambertMaterial||r.lights){if(Ei){ot(a,t);Ei=!1}Z(l,yi)}if(r instanceof THREE.MeshBasicMaterial||r instanceof THREE.MeshLambertMaterial||r instanceof THREE.MeshPhongMaterial)W(l,r);if(r instanceof THREE.LineBasicMaterial)G(l,r);else if(r instanceof THREE.LineDashedMaterial){G(l,r);X(l,r)}else if(r instanceof THREE.ParticleBasicMaterial)Y(l,r);else if(r instanceof THREE.MeshPhongMaterial)K(l,r);else if(r instanceof THREE.MeshLambertMaterial)Q(l,r);else if(r instanceof THREE.MeshDepthMaterial){l.mNear.value=e.near;l.mFar.value=e.far;l.opacity.value=r.opacity}else if(r instanceof THREE.MeshNormalMaterial)l.opacity.value=r.opacity;if(n.receiveShadow&&!r._shadowPass)$(l,t);tt(a,r.uniformsList);if(r instanceof THREE.ShaderMaterial||r instanceof THREE.MeshPhongMaterial||r.envMap)if(null!==s.cameraPosition){gi.getPositionFromMatrix(e.matrixWorld);Ti.uniform3f(s.cameraPosition,gi.x,gi.y,gi.z)}if(r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshLambertMaterial||r instanceof THREE.ShaderMaterial||r.skinning)if(null!==s.viewMatrix)Ti.uniformMatrix4fv(s.viewMatrix,!1,e.matrixWorldInverse.elements)}J(s,n);if(null!==s.modelMatrix)Ti.uniformMatrix4fv(s.modelMatrix,!1,n.matrixWorld.elements);return a}function W(e,t){e.opacity.value=t.opacity;if(It.gammaInput)e.diffuse.value.copyGammaToLinear(t.color);else e.diffuse.value=t.color;e.map.value=t.map;e.lightMap.value=t.lightMap;e.specularMap.value=t.specularMap;if(t.bumpMap){e.bumpMap.value=t.bumpMap;e.bumpScale.value=t.bumpScale}if(t.normalMap){e.normalMap.value=t.normalMap;e.normalScale.value.copy(t.normalScale)}var i;if(t.map)i=t.map;else if(t.specularMap)i=t.specularMap;else if(t.normalMap)i=t.normalMap;else if(t.bumpMap)i=t.bumpMap;if(void 0!==i){var r=i.offset;var n=i.repeat;e.offsetRepeat.value.set(r.x,r.y,n.x,n.y)}e.envMap.value=t.envMap;e.flipEnvMap.value=t.envMap instanceof THREE.WebGLRenderTargetCube?1:-1;if(It.gammaInput)e.reflectivity.value=t.reflectivity;else e.reflectivity.value=t.reflectivity;e.refractionRatio.value=t.refractionRatio;e.combine.value=t.combine;e.useRefract.value=t.envMap&&t.envMap.mapping instanceof THREE.CubeRefractionMapping}function G(e,t){e.diffuse.value=t.color;e.opacity.value=t.opacity}function X(e,t){e.dashSize.value=t.dashSize;e.totalSize.value=t.dashSize+t.gapSize;e.scale.value=t.scale}function Y(e,t){e.psColor.value=t.color;e.opacity.value=t.opacity;e.size.value=t.size;e.scale.value=Ct.height/2;e.map.value=t.map}function q(e,t){e.fogColor.value=t.color;if(t instanceof THREE.Fog){e.fogNear.value=t.near;e.fogFar.value=t.far}else if(t instanceof THREE.FogExp2)e.fogDensity.value=t.density}function K(e,t){e.shininess.value=t.shininess;if(It.gammaInput){e.ambient.value.copyGammaToLinear(t.ambient);e.emissive.value.copyGammaToLinear(t.emissive);e.specular.value.copyGammaToLinear(t.specular)}else{e.ambient.value=t.ambient;e.emissive.value=t.emissive;e.specular.value=t.specular
}if(t.wrapAround)e.wrapRGB.value.copy(t.wrapRGB)}function Q(e,t){if(It.gammaInput){e.ambient.value.copyGammaToLinear(t.ambient);e.emissive.value.copyGammaToLinear(t.emissive)}else{e.ambient.value=t.ambient;e.emissive.value=t.emissive}if(t.wrapAround)e.wrapRGB.value.copy(t.wrapRGB)}function Z(e,t){e.ambientLightColor.value=t.ambient;e.directionalLightColor.value=t.directional.colors;e.directionalLightDirection.value=t.directional.positions;e.pointLightColor.value=t.point.colors;e.pointLightPosition.value=t.point.positions;e.pointLightDistance.value=t.point.distances;e.spotLightColor.value=t.spot.colors;e.spotLightPosition.value=t.spot.positions;e.spotLightDistance.value=t.spot.distances;e.spotLightDirection.value=t.spot.directions;e.spotLightAngleCos.value=t.spot.anglesCos;e.spotLightExponent.value=t.spot.exponents;e.hemisphereLightSkyColor.value=t.hemi.skyColors;e.hemisphereLightGroundColor.value=t.hemi.groundColors;e.hemisphereLightDirection.value=t.hemi.positions}function $(e,t){if(e.shadowMatrix){var i=0;for(var r=0,n=t.length;n>r;r++){var o=t[r];if(o.castShadow){if(o instanceof THREE.SpotLight||o instanceof THREE.DirectionalLight&&!o.shadowCascade){e.shadowMap.value[i]=o.shadowMap;e.shadowMapSize.value[i]=o.shadowMapSize;e.shadowMatrix.value[i]=o.shadowMatrix;e.shadowDarkness.value[i]=o.shadowDarkness;e.shadowBias.value[i]=o.shadowBias;i++}}else;}}}function J(e,t){Ti.uniformMatrix4fv(e.modelViewMatrix,!1,t._modelViewMatrix.elements);if(e.normalMatrix)Ti.uniformMatrix3fv(e.normalMatrix,!1,t._normalMatrix.elements)}function et(){var e=Yt;if(e>=Hi)console.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+Hi);Yt+=1;return e}function tt(e,t){var i,r,n,o,a,s,l,h,c,u,f;for(c=0,u=t.length;u>c;c++){o=e.uniforms[t[c][1]];if(o){i=t[c][0];n=i.type;r=i.value;if("i"===n)Ti.uniform1i(o,r);else if("f"===n)Ti.uniform1f(o,r);else if("v2"===n)Ti.uniform2f(o,r.x,r.y);else if("v3"===n)Ti.uniform3f(o,r.x,r.y,r.z);else if("v4"===n)Ti.uniform4f(o,r.x,r.y,r.z,r.w);else if("c"===n)Ti.uniform3f(o,r.r,r.g,r.b);else if("iv1"===n)Ti.uniform1iv(o,r);else if("iv"===n)Ti.uniform3iv(o,r);else if("fv1"===n)Ti.uniform1fv(o,r);else if("fv"===n)Ti.uniform3fv(o,r);else if("v2v"===n){if(void 0===i._array)i._array=new Float32Array(2*r.length);for(l=0,h=r.length;h>l;l++){f=2*l;i._array[f]=r[l].x;i._array[f+1]=r[l].y}Ti.uniform2fv(o,i._array)}else if("v3v"===n){if(void 0===i._array)i._array=new Float32Array(3*r.length);for(l=0,h=r.length;h>l;l++){f=3*l;i._array[f]=r[l].x;i._array[f+1]=r[l].y;i._array[f+2]=r[l].z}Ti.uniform3fv(o,i._array)}else if("v4v"===n){if(void 0===i._array)i._array=new Float32Array(4*r.length);for(l=0,h=r.length;h>l;l++){f=4*l;i._array[f]=r[l].x;i._array[f+1]=r[l].y;i._array[f+2]=r[l].z;i._array[f+3]=r[l].w}Ti.uniform4fv(o,i._array)}else if("m4"===n){if(void 0===i._array)i._array=new Float32Array(16);r.flattenToArray(i._array);Ti.uniformMatrix4fv(o,!1,i._array)}else if("m4v"===n){if(void 0===i._array)i._array=new Float32Array(16*r.length);for(l=0,h=r.length;h>l;l++)r[l].flattenToArrayOffset(i._array,16*l);Ti.uniformMatrix4fv(o,!1,i._array)}else if("t"===n){a=r;s=et();Ti.uniform1i(o,s);if(!a)continue;if(a.image instanceof Array&&6===a.image.length)vt(a,s);else if(a instanceof THREE.WebGLRenderTargetCube)Et(a,s);else It.setTexture(a,s)}else if("tv"===n){if(void 0===i._array)i._array=[];for(l=0,h=i.value.length;h>l;l++)i._array[l]=et();Ti.uniform1iv(o,i._array);for(l=0,h=i.value.length;h>l;l++){a=i.value[l];s=i._array[l];if(a)It.setTexture(a,s);else;}}else console.warn("THREE.WebGLRenderer: Unknown uniform type: "+n)}else;}}function it(e,t){e._modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld);e._normalMatrix.getNormalMatrix(e._modelViewMatrix)}function rt(e,t,i,r){e[t]=i.r*i.r*r;e[t+1]=i.g*i.g*r;e[t+2]=i.b*i.b*r}function nt(e,t,i,r){e[t]=i.r*r;e[t+1]=i.g*r;e[t+2]=i.b*r}function ot(e,t){var i,r,n,o,a,s,l,h,c,u=0,f=0,d=0,p=yi,m=p.directional.colors,g=p.directional.positions,v=p.point.colors,E=p.point.positions,y=p.point.distances,T=p.spot.colors,_=p.spot.positions,b=p.spot.distances,x=p.spot.directions,R=p.spot.anglesCos,w=p.spot.exponents,H=p.hemi.skyColors,M=p.hemi.groundColors,S=p.hemi.positions,C=0,A=0,D=0,P=0,k=0,L=0,F=0,z=0,N=0,I=0,O=0,U=0;for(i=0,r=t.length;r>i;i++){n=t[i];if(!n.onlyShadow){o=n.color;l=n.intensity;c=n.distance;if(n instanceof THREE.AmbientLight){if(!n.visible)continue;if(It.gammaInput){u+=o.r*o.r;f+=o.g*o.g;d+=o.b*o.b}else{u+=o.r;f+=o.g;d+=o.b}}else if(n instanceof THREE.DirectionalLight){k+=1;if(!n.visible)continue;vi.getPositionFromMatrix(n.matrixWorld);gi.getPositionFromMatrix(n.target.matrixWorld);vi.sub(gi);vi.normalize();if(0===vi.x&&0===vi.y&&0===vi.z)continue;N=3*C;g[N]=vi.x;g[N+1]=vi.y;g[N+2]=vi.z;if(It.gammaInput)rt(m,N,o,l*l);else nt(m,N,o,l);C+=1}else if(n instanceof THREE.PointLight){L+=1;if(!n.visible)continue;I=3*A;if(It.gammaInput)rt(v,I,o,l*l);else nt(v,I,o,l);gi.getPositionFromMatrix(n.matrixWorld);E[I]=gi.x;E[I+1]=gi.y;E[I+2]=gi.z;y[A]=c;A+=1}else if(n instanceof THREE.SpotLight){F+=1;if(!n.visible)continue;O=3*D;if(It.gammaInput)rt(T,O,o,l*l);else nt(T,O,o,l);gi.getPositionFromMatrix(n.matrixWorld);_[O]=gi.x;_[O+1]=gi.y;_[O+2]=gi.z;b[D]=c;vi.copy(gi);gi.getPositionFromMatrix(n.target.matrixWorld);vi.sub(gi);vi.normalize();x[O]=vi.x;x[O+1]=vi.y;x[O+2]=vi.z;R[D]=Math.cos(n.angle);w[D]=n.exponent;D+=1}else if(n instanceof THREE.HemisphereLight){z+=1;if(!n.visible)continue;vi.getPositionFromMatrix(n.matrixWorld);vi.normalize();if(0===vi.x&&0===vi.y&&0===vi.z)continue;U=3*P;S[U]=vi.x;S[U+1]=vi.y;S[U+2]=vi.z;a=n.color;s=n.groundColor;if(It.gammaInput){h=l*l;rt(H,U,a,h);rt(M,U,s,h)}else{nt(H,U,a,l);nt(M,U,s,l)}P+=1}}else;}for(i=3*C,r=Math.max(m.length,3*k);r>i;i++)m[i]=0;for(i=3*A,r=Math.max(v.length,3*L);r>i;i++)v[i]=0;for(i=3*D,r=Math.max(T.length,3*F);r>i;i++)T[i]=0;for(i=3*P,r=Math.max(H.length,3*z);r>i;i++)H[i]=0;for(i=3*P,r=Math.max(M.length,3*z);r>i;i++)M[i]=0;p.directional.length=C;p.point.length=A;p.spot.length=D;p.hemi.length=P;p.ambient[0]=u;p.ambient[1]=f;p.ambient[2]=d}function at(e){if(e!==oi){Ti.lineWidth(e);oi=e}}function st(e,t,i){if(ii!==e){if(e)Ti.enable(Ti.POLYGON_OFFSET_FILL);else Ti.disable(Ti.POLYGON_OFFSET_FILL);ii=e}if(e&&(ri!==t||ni!==i)){Ti.polygonOffset(t,i);ri=t;ni=i}}function lt(e){var t,i,r=[];for(var n in e){t=e[n];if(t!==!1){i="#define "+n+" "+t;r.push(i)}else;}return r.join("\n")}function ht(e,t,i,r,n,o,a){var s,l,h,c,u;var f=[];if(e)f.push(e);else{f.push(t);f.push(i)}for(h in o){f.push(h);f.push(o[h])}for(s in a){f.push(s);f.push(a[s])}u=f.join();for(s=0,l=Ot.length;l>s;s++){var d=Ot[s];if(d.code===u){d.usedTimes++;return d.program}}var p="SHADOWMAP_TYPE_BASIC";if(a.shadowMapType===THREE.PCFShadowMap)p="SHADOWMAP_TYPE_PCF";else if(a.shadowMapType===THREE.PCFSoftShadowMap)p="SHADOWMAP_TYPE_PCF_SOFT";var m=lt(o);c=Ti.createProgram();var g=["precision "+At+" float;",m,Ai?"#define VERTEX_TEXTURES":"",It.gammaInput?"#define GAMMA_INPUT":"",It.gammaOutput?"#define GAMMA_OUTPUT":"",It.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+a.maxDirLights,"#define MAX_POINT_LIGHTS "+a.maxPointLights,"#define MAX_SPOT_LIGHTS "+a.maxSpotLights,"#define MAX_HEMI_LIGHTS "+a.maxHemiLights,"#define MAX_SHADOWS "+a.maxShadows,"#define MAX_BONES "+a.maxBones,a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.lightMap?"#define USE_LIGHTMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.vertexColors?"#define USE_COLOR":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.boneTextureWidth?"#define N_BONE_PIXEL_X "+a.boneTextureWidth.toFixed(1):"",a.boneTextureHeight?"#define N_BONE_PIXEL_Y "+a.boneTextureHeight.toFixed(1):"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals?"#define USE_MORPHNORMALS":"",a.perPixel?"#define PHONG_PER_PIXEL":"",a.wrapAround?"#define WRAP_AROUND":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+p:"",a.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",a.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","attribute vec3 morphTarget0;","attribute vec3 morphTarget1;","attribute vec3 morphTarget2;","attribute vec3 morphTarget3;","#ifdef USE_MORPHNORMALS","attribute vec3 morphNormal0;","attribute vec3 morphNormal1;","attribute vec3 morphNormal2;","attribute vec3 morphNormal3;","#else","attribute vec3 morphTarget4;","attribute vec3 morphTarget5;","attribute vec3 morphTarget6;","attribute vec3 morphTarget7;","#endif","#endif","#ifdef USE_SKINNING","attribute vec4 skinIndex;","attribute vec4 skinWeight;","#endif",""].join("\n");var v=["precision "+At+" float;",a.bumpMap||a.normalMap?"#extension GL_OES_standard_derivatives : enable":"",m,"#define MAX_DIR_LIGHTS "+a.maxDirLights,"#define MAX_POINT_LIGHTS "+a.maxPointLights,"#define MAX_SPOT_LIGHTS "+a.maxSpotLights,"#define MAX_HEMI_LIGHTS "+a.maxHemiLights,"#define MAX_SHADOWS "+a.maxShadows,a.alphaTest?"#define ALPHATEST "+a.alphaTest:"",It.gammaInput?"#define GAMMA_INPUT":"",It.gammaOutput?"#define GAMMA_OUTPUT":"",It.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"",a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.lightMap?"#define USE_LIGHTMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.vertexColors?"#define USE_COLOR":"",a.metal?"#define METAL":"",a.perPixel?"#define PHONG_PER_PIXEL":"",a.wrapAround?"#define WRAP_AROUND":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+p:"",a.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",a.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",""].join("\n");var E=dt("vertex",g+i);var y=dt("fragment",v+t);Ti.attachShader(c,E);Ti.attachShader(c,y);Ti.linkProgram(c);if(!Ti.getProgramParameter(c,Ti.LINK_STATUS))console.error("Could not initialise shader\nVALIDATE_STATUS: "+Ti.getProgramParameter(c,Ti.VALIDATE_STATUS)+", gl error ["+Ti.getError()+"]");Ti.deleteShader(y);Ti.deleteShader(E);c.uniforms={};c.attributes={};var T,_,b,x;T=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","morphTargetInfluences"];if(a.useVertexTexture)T.push("boneTexture");else T.push("boneGlobalMatrices");for(_ in r)T.push(_);ct(c,T);T=["position","normal","uv","uv2","tangent","color","skinIndex","skinWeight","lineDistance"];for(x=0;x<a.maxMorphTargets;x++)T.push("morphTarget"+x);for(x=0;x<a.maxMorphNormals;x++)T.push("morphNormal"+x);for(b in n)T.push(b);ut(c,T);c.id=Ut++;Ot.push({program:c,code:u,usedTimes:1});It.info.memory.programs=Ot.length;return c}function ct(e,t){var i,r,n;for(i=0,r=t.length;r>i;i++){n=t[i];e.uniforms[n]=Ti.getUniformLocation(e,n)}}function ut(e,t){var i,r,n;for(i=0,r=t.length;r>i;i++){n=t[i];e.attributes[n]=Ti.getAttribLocation(e,n)}}function ft(e){var t=e.split("\n");for(var i=0,r=t.length;r>i;i++)t[i]=i+1+": "+t[i];return t.join("\n")}function dt(e,t){var i;if("fragment"===e)i=Ti.createShader(Ti.FRAGMENT_SHADER);else if("vertex"===e)i=Ti.createShader(Ti.VERTEX_SHADER);Ti.shaderSource(i,t);Ti.compileShader(i);if(!Ti.getShaderParameter(i,Ti.COMPILE_STATUS)){console.error(Ti.getShaderInfoLog(i));console.error(ft(t));return null}return i}function pt(e){return 0===(e&e-1)}function mt(e,t,i){if(i){Ti.texParameteri(e,Ti.TEXTURE_WRAP_S,xt(t.wrapS));Ti.texParameteri(e,Ti.TEXTURE_WRAP_T,xt(t.wrapT));Ti.texParameteri(e,Ti.TEXTURE_MAG_FILTER,xt(t.magFilter));Ti.texParameteri(e,Ti.TEXTURE_MIN_FILTER,xt(t.minFilter))}else{Ti.texParameteri(e,Ti.TEXTURE_WRAP_S,Ti.CLAMP_TO_EDGE);Ti.texParameteri(e,Ti.TEXTURE_WRAP_T,Ti.CLAMP_TO_EDGE);Ti.texParameteri(e,Ti.TEXTURE_MAG_FILTER,bt(t.magFilter));Ti.texParameteri(e,Ti.TEXTURE_MIN_FILTER,bt(t.minFilter))}if(Ri&&t.type!==THREE.FloatType)if(t.anisotropy>1||t.__oldAnisotropy){Ti.texParameterf(e,Ri.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,Ci));t.__oldAnisotropy=t.anisotropy}}function gt(e,t){if(e.width<=t&&e.height<=t)return e;var i=Math.max(e.width,e.height);var r=Math.floor(e.width*t/i);var n=Math.floor(e.height*t/i);var o=document.createElement("canvas");o.width=r;o.height=n;var a=o.getContext("2d");a.drawImage(e,0,0,e.width,e.height,0,0,r,n);return o}function vt(e,t){if(6===e.image.length)if(e.needsUpdate){if(!e.image.__webglTextureCube){e.addEventListener("dispose",Oi);e.image.__webglTextureCube=Ti.createTexture();It.info.memory.textures++}Ti.activeTexture(Ti.TEXTURE0+t);Ti.bindTexture(Ti.TEXTURE_CUBE_MAP,e.image.__webglTextureCube);Ti.pixelStorei(Ti.UNPACK_FLIP_Y_WEBGL,e.flipY);var i=e instanceof THREE.CompressedTexture;var r=[];for(var n=0;6>n;n++)if(It.autoScaleCubemaps&&!i)r[n]=gt(e.image[n],Si);else r[n]=e.image[n];var o=r[0],a=pt(o.width)&&pt(o.height),s=xt(e.format),l=xt(e.type);mt(Ti.TEXTURE_CUBE_MAP,e,a);for(var n=0;6>n;n++)if(i){var h,c=r[n].mipmaps;for(var u=0,f=c.length;f>u;u++){h=c[u];Ti.compressedTexImage2D(Ti.TEXTURE_CUBE_MAP_POSITIVE_X+n,u,s,h.width,h.height,0,h.data)}}else Ti.texImage2D(Ti.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,s,s,l,r[n]);if(e.generateMipmaps&&a)Ti.generateMipmap(Ti.TEXTURE_CUBE_MAP);e.needsUpdate=!1;if(e.onUpdate)e.onUpdate()}else{Ti.activeTexture(Ti.TEXTURE0+t);Ti.bindTexture(Ti.TEXTURE_CUBE_MAP,e.image.__webglTextureCube)}}function Et(e,t){Ti.activeTexture(Ti.TEXTURE0+t);Ti.bindTexture(Ti.TEXTURE_CUBE_MAP,e.__webglTexture)}function yt(e,t,i){Ti.bindFramebuffer(Ti.FRAMEBUFFER,e);Ti.framebufferTexture2D(Ti.FRAMEBUFFER,Ti.COLOR_ATTACHMENT0,i,t.__webglTexture,0)}function Tt(e,t){Ti.bindRenderbuffer(Ti.RENDERBUFFER,e);if(t.depthBuffer&&!t.stencilBuffer){Ti.renderbufferStorage(Ti.RENDERBUFFER,Ti.DEPTH_COMPONENT16,t.width,t.height);Ti.framebufferRenderbuffer(Ti.FRAMEBUFFER,Ti.DEPTH_ATTACHMENT,Ti.RENDERBUFFER,e)}else if(t.depthBuffer&&t.stencilBuffer){Ti.renderbufferStorage(Ti.RENDERBUFFER,Ti.DEPTH_STENCIL,t.width,t.height);Ti.framebufferRenderbuffer(Ti.FRAMEBUFFER,Ti.DEPTH_STENCIL_ATTACHMENT,Ti.RENDERBUFFER,e)}else Ti.renderbufferStorage(Ti.RENDERBUFFER,Ti.RGBA4,t.width,t.height)}function _t(e){if(e instanceof THREE.WebGLRenderTargetCube){Ti.bindTexture(Ti.TEXTURE_CUBE_MAP,e.__webglTexture);Ti.generateMipmap(Ti.TEXTURE_CUBE_MAP);Ti.bindTexture(Ti.TEXTURE_CUBE_MAP,null)}else{Ti.bindTexture(Ti.TEXTURE_2D,e.__webglTexture);Ti.generateMipmap(Ti.TEXTURE_2D);Ti.bindTexture(Ti.TEXTURE_2D,null)}}function bt(e){if(e===THREE.NearestFilter||e===THREE.NearestMipMapNearestFilter||e===THREE.NearestMipMapLinearFilter)return Ti.NEAREST;else return Ti.LINEAR}function xt(e){if(e===THREE.RepeatWrapping)return Ti.REPEAT;if(e===THREE.ClampToEdgeWrapping)return Ti.CLAMP_TO_EDGE;if(e===THREE.MirroredRepeatWrapping)return Ti.MIRRORED_REPEAT;if(e===THREE.NearestFilter)return Ti.NEAREST;if(e===THREE.NearestMipMapNearestFilter)return Ti.NEAREST_MIPMAP_NEAREST;if(e===THREE.NearestMipMapLinearFilter)return Ti.NEAREST_MIPMAP_LINEAR;if(e===THREE.LinearFilter)return Ti.LINEAR;if(e===THREE.LinearMipMapNearestFilter)return Ti.LINEAR_MIPMAP_NEAREST;if(e===THREE.LinearMipMapLinearFilter)return Ti.LINEAR_MIPMAP_LINEAR;if(e===THREE.UnsignedByteType)return Ti.UNSIGNED_BYTE;if(e===THREE.UnsignedShort4444Type)return Ti.UNSIGNED_SHORT_4_4_4_4;if(e===THREE.UnsignedShort5551Type)return Ti.UNSIGNED_SHORT_5_5_5_1;if(e===THREE.UnsignedShort565Type)return Ti.UNSIGNED_SHORT_5_6_5;if(e===THREE.ByteType)return Ti.BYTE;if(e===THREE.ShortType)return Ti.SHORT;if(e===THREE.UnsignedShortType)return Ti.UNSIGNED_SHORT;if(e===THREE.IntType)return Ti.INT;if(e===THREE.UnsignedIntType)return Ti.UNSIGNED_INT;if(e===THREE.FloatType)return Ti.FLOAT;if(e===THREE.AlphaFormat)return Ti.ALPHA;if(e===THREE.RGBFormat)return Ti.RGB;if(e===THREE.RGBAFormat)return Ti.RGBA;if(e===THREE.LuminanceFormat)return Ti.LUMINANCE;if(e===THREE.LuminanceAlphaFormat)return Ti.LUMINANCE_ALPHA;if(e===THREE.AddEquation)return Ti.FUNC_ADD;if(e===THREE.SubtractEquation)return Ti.FUNC_SUBTRACT;if(e===THREE.ReverseSubtractEquation)return Ti.FUNC_REVERSE_SUBTRACT;if(e===THREE.ZeroFactor)return Ti.ZERO;if(e===THREE.OneFactor)return Ti.ONE;if(e===THREE.SrcColorFactor)return Ti.SRC_COLOR;if(e===THREE.OneMinusSrcColorFactor)return Ti.ONE_MINUS_SRC_COLOR;if(e===THREE.SrcAlphaFactor)return Ti.SRC_ALPHA;if(e===THREE.OneMinusSrcAlphaFactor)return Ti.ONE_MINUS_SRC_ALPHA;if(e===THREE.DstAlphaFactor)return Ti.DST_ALPHA;if(e===THREE.OneMinusDstAlphaFactor)return Ti.ONE_MINUS_DST_ALPHA;if(e===THREE.DstColorFactor)return Ti.DST_COLOR;if(e===THREE.OneMinusDstColorFactor)return Ti.ONE_MINUS_DST_COLOR;if(e===THREE.SrcAlphaSaturateFactor)return Ti.SRC_ALPHA_SATURATE;if(void 0!==wi){if(e===THREE.RGB_S3TC_DXT1_Format)return wi.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===THREE.RGBA_S3TC_DXT1_Format)return wi.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===THREE.RGBA_S3TC_DXT3_Format)return wi.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===THREE.RGBA_S3TC_DXT5_Format)return wi.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}function Rt(e){if(Di&&e&&e.useVertexTexture)return 1024;else{var t=Ti.getParameter(Ti.MAX_VERTEX_UNIFORM_VECTORS);var i=Math.floor((t-20)/4);var r=i;if(void 0!==e&&e instanceof THREE.SkinnedMesh){r=Math.min(e.bones.length,r);if(r<e.bones.length)console.warn("WebGLRenderer: too many bones - "+e.bones.length+", this GPU supports just "+r+" (try OpenGL instead of ANGLE)")}return r}}function wt(e){var t=0;var i=0;var r=0;var n=0;for(var o=0,a=e.length;a>o;o++){var s=e[o];if(!s.onlyShadow){if(s instanceof THREE.DirectionalLight)t++;if(s instanceof THREE.PointLight)i++;if(s instanceof THREE.SpotLight)r++;if(s instanceof THREE.HemisphereLight)n++}else;}return{directional:t,point:i,spot:r,hemi:n}}function Ht(e){var t=0;for(var i=0,r=e.length;r>i;i++){var n=e[i];if(n.castShadow){if(n instanceof THREE.SpotLight)t++;if(n instanceof THREE.DirectionalLight&&!n.shadowCascade)t++}else;}return t}function Mt(){try{if(!(Ti=Ct.getContext("experimental-webgl",{alpha:Dt,premultipliedAlpha:Pt,antialias:kt,stencil:Lt,preserveDrawingBuffer:Ft})))throw"Error creating WebGL context."}catch(e){console.error(e)}_i=Ti.getExtension("OES_texture_float");bi=Ti.getExtension("OES_texture_float_linear");xi=Ti.getExtension("OES_standard_derivatives");Ri=Ti.getExtension("EXT_texture_filter_anisotropic")||Ti.getExtension("MOZ_EXT_texture_filter_anisotropic")||Ti.getExtension("WEBKIT_EXT_texture_filter_anisotropic");wi=Ti.getExtension("WEBGL_compressed_texture_s3tc")||Ti.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||Ti.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");if(!_i)console.log("THREE.WebGLRenderer: Float textures not supported.");if(!xi)console.log("THREE.WebGLRenderer: Standard derivatives not supported.");if(!Ri)console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported.");if(!wi)console.log("THREE.WebGLRenderer: S3TC compressed textures not supported.");if(void 0===Ti.getShaderPrecisionFormat)Ti.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}}function St(){Ti.clearColor(0,0,0,1);Ti.clearDepth(1);Ti.clearStencil(0);Ti.enable(Ti.DEPTH_TEST);Ti.depthFunc(Ti.LEQUAL);Ti.frontFace(Ti.CCW);Ti.cullFace(Ti.BACK);Ti.enable(Ti.CULL_FACE);Ti.enable(Ti.BLEND);Ti.blendEquation(Ti.FUNC_ADD);Ti.blendFunc(Ti.SRC_ALPHA,Ti.ONE_MINUS_SRC_ALPHA);Ti.clearColor(zt.r,zt.g,zt.b,Nt)}console.log("THREE.WebGLRenderer",THREE.REVISION);e=e||{};var Ct=void 0!==e.canvas?e.canvas:document.createElement("canvas"),At=void 0!==e.precision?e.precision:"highp",Dt=void 0!==e.alpha?e.alpha:!0,Pt=void 0!==e.premultipliedAlpha?e.premultipliedAlpha:!0,kt=void 0!==e.antialias?e.antialias:!1,Lt=void 0!==e.stencil?e.stencil:!0,Ft=void 0!==e.preserveDrawingBuffer?e.preserveDrawingBuffer:!1,zt=new THREE.Color(0),Nt=0;if(void 0!==e.clearColor){console.warn("DEPRECATED: clearColor in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead.");zt.setHex(e.clearColor)}if(void 0!==e.clearAlpha){console.warn("DEPRECATED: clearAlpha in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead.");Nt=e.clearAlpha}this.domElement=Ct;this.context=null;this.devicePixelRatio=void 0!==e.devicePixelRatio?e.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1;this.autoClear=!0;this.autoClearColor=!0;this.autoClearDepth=!0;this.autoClearStencil=!0;this.sortObjects=!0;this.autoUpdateObjects=!0;this.gammaInput=!1;this.gammaOutput=!1;this.physicallyBasedShading=!1;this.shadowMapEnabled=!1;this.shadowMapAutoUpdate=!0;this.shadowMapType=THREE.PCFShadowMap;this.shadowMapCullFace=THREE.CullFaceFront;this.shadowMapDebug=!1;this.shadowMapCascade=!1;this.maxMorphTargets=8;this.maxMorphNormals=4;this.autoScaleCubemaps=!0;this.renderPluginsPre=[];this.renderPluginsPost=[];this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var It=this,Ot=[],Ut=0,Vt=null,Bt=null,jt=-1,Wt=null,Gt=null,Xt=0,Yt=0,qt=-1,Kt=-1,Qt=-1,Zt=-1,$t=-1,Jt=-1,ei=-1,ti=-1,ii=null,ri=null,ni=null,oi=null,ai=0,si=0,li=0,hi=0,ci=0,ui=0,fi={},di=new THREE.Frustum,pi=new THREE.Matrix4,mi=new THREE.Matrix4,gi=new THREE.Vector3,vi=new THREE.Vector3,Ei=!0,yi={ambient:[0,0,0],directional:{length:0,colors:new Array,positions:new Array},point:{length:0,colors:new Array,positions:new Array,distances:new Array},spot:{length:0,colors:new Array,positions:new Array,distances:new Array,directions:new Array,anglesCos:new Array,exponents:new Array},hemi:{length:0,skyColors:new Array,groundColors:new Array,positions:new Array}};var Ti;var _i;var bi;var xi;var Ri;var wi;Mt();St();this.context=Ti;var Hi=Ti.getParameter(Ti.MAX_TEXTURE_IMAGE_UNITS);var Mi=Ti.getParameter(Ti.MAX_VERTEX_TEXTURE_IMAGE_UNITS);Ti.getParameter(Ti.MAX_TEXTURE_SIZE);var Si=Ti.getParameter(Ti.MAX_CUBE_MAP_TEXTURE_SIZE);var Ci=Ri?Ti.getParameter(Ri.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0;var Ai=Mi>0;var Di=Ai&&_i;wi?Ti.getParameter(Ti.COMPRESSED_TEXTURE_FORMATS):[];var Pi=Ti.getShaderPrecisionFormat(Ti.VERTEX_SHADER,Ti.HIGH_FLOAT);var ki=Ti.getShaderPrecisionFormat(Ti.VERTEX_SHADER,Ti.MEDIUM_FLOAT);Ti.getShaderPrecisionFormat(Ti.VERTEX_SHADER,Ti.LOW_FLOAT);var Li=Ti.getShaderPrecisionFormat(Ti.FRAGMENT_SHADER,Ti.HIGH_FLOAT);var Fi=Ti.getShaderPrecisionFormat(Ti.FRAGMENT_SHADER,Ti.MEDIUM_FLOAT);Ti.getShaderPrecisionFormat(Ti.FRAGMENT_SHADER,Ti.LOW_FLOAT);Ti.getShaderPrecisionFormat(Ti.VERTEX_SHADER,Ti.HIGH_INT);Ti.getShaderPrecisionFormat(Ti.VERTEX_SHADER,Ti.MEDIUM_INT);Ti.getShaderPrecisionFormat(Ti.VERTEX_SHADER,Ti.LOW_INT);Ti.getShaderPrecisionFormat(Ti.FRAGMENT_SHADER,Ti.HIGH_INT);Ti.getShaderPrecisionFormat(Ti.FRAGMENT_SHADER,Ti.MEDIUM_INT);Ti.getShaderPrecisionFormat(Ti.FRAGMENT_SHADER,Ti.LOW_INT);var zi=Pi.precision>0&&Li.precision>0;var Ni=ki.precision>0&&Fi.precision>0;if("highp"===At&&!zi)if(Ni){At="mediump";console.warn("WebGLRenderer: highp not supported, using mediump")}else{At="lowp";console.warn("WebGLRenderer: highp and mediump not supported, using lowp")}if("mediump"===At&&!Ni){At="lowp";console.warn("WebGLRenderer: mediump not supported, using lowp")}this.getContext=function(){return Ti};this.supportsVertexTextures=function(){return Ai};this.supportsFloatTextures=function(){return _i};this.supportsStandardDerivatives=function(){return xi};this.supportsCompressedTextureS3TC=function(){return wi};this.getMaxAnisotropy=function(){return Ci};this.getPrecision=function(){return At};this.setSize=function(e,t,i){Ct.width=e*this.devicePixelRatio;Ct.height=t*this.devicePixelRatio;if(1!==this.devicePixelRatio&&i!==!1){Ct.style.width=e+"px";Ct.style.height=t+"px"}this.setViewport(0,0,Ct.width,Ct.height)};this.setViewport=function(e,t,i,r){ai=void 0!==e?e:0;si=void 0!==t?t:0;li=void 0!==i?i:Ct.width;hi=void 0!==r?r:Ct.height;Ti.viewport(ai,si,li,hi)};this.setScissor=function(e,t,i,r){Ti.scissor(e,t,i,r)};this.enableScissorTest=function(e){e?Ti.enable(Ti.SCISSOR_TEST):Ti.disable(Ti.SCISSOR_TEST)};this.setClearColor=function(e,t){zt.set(e);Nt=void 0!==t?t:1;Ti.clearColor(zt.r,zt.g,zt.b,Nt)};this.setClearColorHex=function(e,t){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(e,t)};this.getClearColor=function(){return zt};this.getClearAlpha=function(){return Nt};this.clear=function(e,t,i){var r=0;if(void 0===e||e)r|=Ti.COLOR_BUFFER_BIT;if(void 0===t||t)r|=Ti.DEPTH_BUFFER_BIT;if(void 0===i||i)r|=Ti.STENCIL_BUFFER_BIT;Ti.clear(r)};this.clearTarget=function(e,t,i,r){this.setRenderTarget(e);this.clear(t,i,r)};this.addPostPlugin=function(e){e.init(this);this.renderPluginsPost.push(e)};this.addPrePlugin=function(e){e.init(this);this.renderPluginsPre.push(e)};this.updateShadowMap=function(e,t){Vt=null;Qt=-1;ei=-1;ti=-1;Wt=-1;jt=-1;Ei=!0;qt=-1;Kt=-1;this.shadowMapPlugin.update(e,t)};var Ii=function(e){var t=e.target;t.removeEventListener("dispose",Ii);Bi(t);It.info.memory.geometries--};var Oi=function(e){var t=e.target;t.removeEventListener("dispose",Oi);ji(t);It.info.memory.textures--};var Ui=function(e){var t=e.target;t.removeEventListener("dispose",Ui);Wi(t);It.info.memory.textures--};var Vi=function(e){var t=e.target;t.removeEventListener("dispose",Vi);Gi(t)};var Bi=function(e){e.__webglInit=void 0;if(void 0!==e.__webglVertexBuffer)Ti.deleteBuffer(e.__webglVertexBuffer);if(void 0!==e.__webglNormalBuffer)Ti.deleteBuffer(e.__webglNormalBuffer);if(void 0!==e.__webglTangentBuffer)Ti.deleteBuffer(e.__webglTangentBuffer);if(void 0!==e.__webglColorBuffer)Ti.deleteBuffer(e.__webglColorBuffer);if(void 0!==e.__webglUVBuffer)Ti.deleteBuffer(e.__webglUVBuffer);if(void 0!==e.__webglUV2Buffer)Ti.deleteBuffer(e.__webglUV2Buffer);if(void 0!==e.__webglSkinIndicesBuffer)Ti.deleteBuffer(e.__webglSkinIndicesBuffer);if(void 0!==e.__webglSkinWeightsBuffer)Ti.deleteBuffer(e.__webglSkinWeightsBuffer);if(void 0!==e.__webglFaceBuffer)Ti.deleteBuffer(e.__webglFaceBuffer);if(void 0!==e.__webglLineBuffer)Ti.deleteBuffer(e.__webglLineBuffer);if(void 0!==e.__webglLineDistanceBuffer)Ti.deleteBuffer(e.__webglLineDistanceBuffer);if(void 0!==e.geometryGroups)for(var t in e.geometryGroups){var i=e.geometryGroups[t];if(void 0!==i.numMorphTargets)for(var r=0,n=i.numMorphTargets;n>r;r++)Ti.deleteBuffer(i.__webglMorphTargetsBuffers[r]);if(void 0!==i.numMorphNormals)for(var r=0,n=i.numMorphNormals;n>r;r++)Ti.deleteBuffer(i.__webglMorphNormalsBuffers[r]);o(i)}o(e)};var ji=function(e){if(e.image&&e.image.__webglTextureCube)Ti.deleteTexture(e.image.__webglTextureCube);else{if(!e.__webglInit)return;e.__webglInit=!1;Ti.deleteTexture(e.__webglTexture)}};var Wi=function(e){if(e&&e.__webglTexture){Ti.deleteTexture(e.__webglTexture);if(e instanceof THREE.WebGLRenderTargetCube)for(var t=0;6>t;t++){Ti.deleteFramebuffer(e.__webglFramebuffer[t]);Ti.deleteRenderbuffer(e.__webglRenderbuffer[t])}else{Ti.deleteFramebuffer(e.__webglFramebuffer);Ti.deleteRenderbuffer(e.__webglRenderbuffer)}}};var Gi=function(e){var t=e.program;if(void 0!==t){e.program=void 0;var i,r,n;var o=!1;for(i=0,r=Ot.length;r>i;i++){n=Ot[i];if(n.program===t){n.usedTimes--;if(0===n.usedTimes)o=!0;break}}if(o===!0){var a=[];for(i=0,r=Ot.length;r>i;i++){n=Ot[i];if(n.program!==t)a.push(n)}Ot=a;Ti.deleteProgram(t);It.info.memory.programs--}}};this.renderBufferImmediate=function(e,t,i){if(e.hasPositions&&!e.__webglVertexBuffer)e.__webglVertexBuffer=Ti.createBuffer();if(e.hasNormals&&!e.__webglNormalBuffer)e.__webglNormalBuffer=Ti.createBuffer();if(e.hasUvs&&!e.__webglUvBuffer)e.__webglUvBuffer=Ti.createBuffer();if(e.hasColors&&!e.__webglColorBuffer)e.__webglColorBuffer=Ti.createBuffer();if(e.hasPositions){Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglVertexBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,e.positionArray,Ti.DYNAMIC_DRAW);Ti.enableVertexAttribArray(t.attributes.position);Ti.vertexAttribPointer(t.attributes.position,3,Ti.FLOAT,!1,0,0)}if(e.hasNormals){Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglNormalBuffer);if(i.shading===THREE.FlatShading){var r,n,o,a,s,l,h,c,u,f,d,p,m,g,v=3*e.count;for(g=0;v>g;g+=9){m=e.normalArray;a=m[g];h=m[g+1];f=m[g+2];s=m[g+3];c=m[g+4];d=m[g+5];l=m[g+6];u=m[g+7];p=m[g+8];r=(a+s+l)/3;n=(h+c+u)/3;o=(f+d+p)/3;m[g]=r;m[g+1]=n;m[g+2]=o;m[g+3]=r;m[g+4]=n;m[g+5]=o;m[g+6]=r;m[g+7]=n;m[g+8]=o}}Ti.bufferData(Ti.ARRAY_BUFFER,e.normalArray,Ti.DYNAMIC_DRAW);Ti.enableVertexAttribArray(t.attributes.normal);Ti.vertexAttribPointer(t.attributes.normal,3,Ti.FLOAT,!1,0,0)}if(e.hasUvs&&i.map){Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglUvBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,e.uvArray,Ti.DYNAMIC_DRAW);Ti.enableVertexAttribArray(t.attributes.uv);Ti.vertexAttribPointer(t.attributes.uv,2,Ti.FLOAT,!1,0,0)}if(e.hasColors&&i.vertexColors!==THREE.NoColors){Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglColorBuffer);Ti.bufferData(Ti.ARRAY_BUFFER,e.colorArray,Ti.DYNAMIC_DRAW);Ti.enableVertexAttribArray(t.attributes.color);Ti.vertexAttribPointer(t.attributes.color,3,Ti.FLOAT,!1,0,0)}Ti.drawArrays(Ti.TRIANGLES,0,e.count);e.count=0};this.renderBufferDirect=function(e,t,i,r,n,o){if(r.visible!==!1){var a,s,l,h;var c=j(e,t,i,r,o);var u=c.attributes;var f=n.attributes;var d=!1,p=r.wireframe?1:0,m=16777215*n.id+2*c.id+p;if(m!==Wt){Wt=m;d=!0}if(d)x();if(o instanceof THREE.Mesh){var g=f["index"];if(g){var v=n.offsets;if(v.length>1)d=!0;for(var E=0,y=v.length;y>E;E++){var T=v[E].index;if(d){for(s in f)if("index"!==s){l=u[s];a=f[s];h=a.itemSize;if(l>=0){Ti.bindBuffer(Ti.ARRAY_BUFFER,a.buffer);b(l);Ti.vertexAttribPointer(l,h,Ti.FLOAT,!1,0,4*T*h)}}else;Ti.bindBuffer(Ti.ELEMENT_ARRAY_BUFFER,g.buffer)}Ti.drawElements(Ti.TRIANGLES,v[E].count,Ti.UNSIGNED_SHORT,2*v[E].start);It.info.render.calls++;It.info.render.vertices+=v[E].count;It.info.render.faces+=v[E].count/3}}else{if(d)for(s in f)if("index"!==s){l=u[s];a=f[s];h=a.itemSize;if(l>=0){Ti.bindBuffer(Ti.ARRAY_BUFFER,a.buffer);b(l);Ti.vertexAttribPointer(l,h,Ti.FLOAT,!1,0,0)}}else;var _=n.attributes["position"];Ti.drawArrays(Ti.TRIANGLES,0,_.numItems/3);It.info.render.calls++;It.info.render.vertices+=_.numItems/3;It.info.render.faces+=_.numItems/3/3}}else if(o instanceof THREE.ParticleSystem){if(d){for(s in f){l=u[s];a=f[s];h=a.itemSize;if(l>=0){Ti.bindBuffer(Ti.ARRAY_BUFFER,a.buffer);b(l);Ti.vertexAttribPointer(l,h,Ti.FLOAT,!1,0,0)}}var _=f["position"];Ti.drawArrays(Ti.POINTS,0,_.numItems/3);It.info.render.calls++;It.info.render.points+=_.numItems/3}}else if(o instanceof THREE.Line)if(d){for(s in f){l=u[s];a=f[s];h=a.itemSize;if(l>=0){Ti.bindBuffer(Ti.ARRAY_BUFFER,a.buffer);b(l);Ti.vertexAttribPointer(l,h,Ti.FLOAT,!1,0,0)}}var R=o.type===THREE.LineStrip?Ti.LINE_STRIP:Ti.LINES;at(r.linewidth);var _=f["position"];Ti.drawArrays(R,0,_.numItems/3);It.info.render.calls++;It.info.render.points+=_.numItems}}};this.renderBuffer=function(e,t,i,r,n,o){if(r.visible!==!1){var a,s,l;var h=j(e,t,i,r,o);var c=h.attributes;var u=!1,f=r.wireframe?1:0,d=16777215*n.id+2*h.id+f;if(d!==Wt){Wt=d;u=!0}if(u)x();if(!r.morphTargets&&c.position>=0){if(u){Ti.bindBuffer(Ti.ARRAY_BUFFER,n.__webglVertexBuffer);b(c.position);Ti.vertexAttribPointer(c.position,3,Ti.FLOAT,!1,0,0)}}else if(o.morphTargetBase)R(r,n,o);if(u){if(n.__webglCustomAttributesList)for(s=0,l=n.__webglCustomAttributesList.length;l>s;s++){a=n.__webglCustomAttributesList[s];if(c[a.buffer.belongsToAttribute]>=0){Ti.bindBuffer(Ti.ARRAY_BUFFER,a.buffer);b(c[a.buffer.belongsToAttribute]);Ti.vertexAttribPointer(c[a.buffer.belongsToAttribute],a.size,Ti.FLOAT,!1,0,0)}}if(c.color>=0){Ti.bindBuffer(Ti.ARRAY_BUFFER,n.__webglColorBuffer);b(c.color);
Ti.vertexAttribPointer(c.color,3,Ti.FLOAT,!1,0,0)}if(c.normal>=0){Ti.bindBuffer(Ti.ARRAY_BUFFER,n.__webglNormalBuffer);b(c.normal);Ti.vertexAttribPointer(c.normal,3,Ti.FLOAT,!1,0,0)}if(c.tangent>=0){Ti.bindBuffer(Ti.ARRAY_BUFFER,n.__webglTangentBuffer);b(c.tangent);Ti.vertexAttribPointer(c.tangent,4,Ti.FLOAT,!1,0,0)}if(c.uv>=0){Ti.bindBuffer(Ti.ARRAY_BUFFER,n.__webglUVBuffer);b(c.uv);Ti.vertexAttribPointer(c.uv,2,Ti.FLOAT,!1,0,0)}if(c.uv2>=0){Ti.bindBuffer(Ti.ARRAY_BUFFER,n.__webglUV2Buffer);b(c.uv2);Ti.vertexAttribPointer(c.uv2,2,Ti.FLOAT,!1,0,0)}if(r.skinning&&c.skinIndex>=0&&c.skinWeight>=0){Ti.bindBuffer(Ti.ARRAY_BUFFER,n.__webglSkinIndicesBuffer);b(c.skinIndex);Ti.vertexAttribPointer(c.skinIndex,4,Ti.FLOAT,!1,0,0);Ti.bindBuffer(Ti.ARRAY_BUFFER,n.__webglSkinWeightsBuffer);b(c.skinWeight);Ti.vertexAttribPointer(c.skinWeight,4,Ti.FLOAT,!1,0,0)}if(c.lineDistance>=0){Ti.bindBuffer(Ti.ARRAY_BUFFER,n.__webglLineDistanceBuffer);b(c.lineDistance);Ti.vertexAttribPointer(c.lineDistance,1,Ti.FLOAT,!1,0,0)}}if(o instanceof THREE.Mesh){if(r.wireframe){at(r.wireframeLinewidth);if(u)Ti.bindBuffer(Ti.ELEMENT_ARRAY_BUFFER,n.__webglLineBuffer);Ti.drawElements(Ti.LINES,n.__webglLineCount,Ti.UNSIGNED_SHORT,0)}else{if(u)Ti.bindBuffer(Ti.ELEMENT_ARRAY_BUFFER,n.__webglFaceBuffer);Ti.drawElements(Ti.TRIANGLES,n.__webglFaceCount,Ti.UNSIGNED_SHORT,0)}It.info.render.calls++;It.info.render.vertices+=n.__webglFaceCount;It.info.render.faces+=n.__webglFaceCount/3}else if(o instanceof THREE.Line){var p=o.type===THREE.LineStrip?Ti.LINE_STRIP:Ti.LINES;at(r.linewidth);Ti.drawArrays(p,0,n.__webglLineCount);It.info.render.calls++}else if(o instanceof THREE.ParticleSystem){Ti.drawArrays(Ti.POINTS,0,n.__webglParticleCount);It.info.render.calls++;It.info.render.points+=n.__webglParticleCount}else if(o instanceof THREE.Ribbon){Ti.drawArrays(Ti.TRIANGLE_STRIP,0,n.__webglVertexCount);It.info.render.calls++}}};this.render=function(e,t,i,r){if(t instanceof THREE.Camera!=!1){var n,o,a,s,l,h=e.__lights,c=e.fog;jt=-1;Ei=!0;if(e.autoUpdate===!0)e.updateMatrixWorld();if(void 0===t.parent)t.updateMatrixWorld();t.matrixWorldInverse.getInverse(t.matrixWorld);pi.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse);di.setFromMatrix(pi);if(this.autoUpdateObjects)this.initWebGLObjects(e);M(this.renderPluginsPre,e,t);It.info.render.calls=0;It.info.render.vertices=0;It.info.render.faces=0;It.info.render.points=0;this.setRenderTarget(i);if(this.autoClear||r)this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);l=e.__webglObjects;for(n=0,o=l.length;o>n;n++){a=l[n];s=a.object;a.id=n;a.render=!1;if(s.visible)if(!(s instanceof THREE.Mesh||s instanceof THREE.ParticleSystem)||!s.frustumCulled||di.intersectsObject(s)){it(s,t);D(a);a.render=!0;if(this.sortObjects===!0)if(null!==s.renderDepth)a.z=s.renderDepth;else{gi.getPositionFromMatrix(s.matrixWorld);gi.applyProjection(pi);a.z=gi.z}}}if(this.sortObjects)l.sort(w);l=e.__webglObjectsImmediate;for(n=0,o=l.length;o>n;n++){a=l[n];s=a.object;if(s.visible){it(s,t);A(a)}}if(e.overrideMaterial){var u=e.overrideMaterial;this.setBlending(u.blending,u.blendEquation,u.blendSrc,u.blendDst);this.setDepthTest(u.depthTest);this.setDepthWrite(u.depthWrite);st(u.polygonOffset,u.polygonOffsetFactor,u.polygonOffsetUnits);S(e.__webglObjects,!1,"",t,h,c,!0,u);C(e.__webglObjectsImmediate,"",t,h,c,!1,u)}else{var u=null;this.setBlending(THREE.NoBlending);S(e.__webglObjects,!0,"opaque",t,h,c,!1,u);C(e.__webglObjectsImmediate,"opaque",t,h,c,!1,u);S(e.__webglObjects,!1,"transparent",t,h,c,!0,u);C(e.__webglObjectsImmediate,"transparent",t,h,c,!0,u)}M(this.renderPluginsPost,e,t);if(i&&i.generateMipmaps&&i.minFilter!==THREE.NearestFilter&&i.minFilter!==THREE.LinearFilter)_t(i);this.setDepthTest(!0);this.setDepthWrite(!0)}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")};this.renderImmediateObject=function(e,t,i,r,n){var o=j(e,t,i,r,n);Wt=-1;It.setMaterialFaces(r);if(n.immediateRenderCallback)n.immediateRenderCallback(o,Ti,di);else n.render(function(e){It.renderBufferImmediate(e,o,r)})};this.initWebGLObjects=function(e){if(!e.__webglObjects){e.__webglObjects=[];e.__webglObjectsImmediate=[];e.__webglSprites=[];e.__webglFlares=[]}for(;e.__objectsAdded.length;){k(e.__objectsAdded[0],e);e.__objectsAdded.splice(0,1)}for(;e.__objectsRemoved.length;){O(e.__objectsRemoved[0],e);e.__objectsRemoved.splice(0,1)}for(var t=0,i=e.__webglObjects.length;i>t;t++){var r=e.__webglObjects[t].object;if(void 0===r.__webglInit){if(void 0!==r.__webglActive)O(r,e);k(r,e)}z(r)}};this.initMaterial=function(e,t,i,r){e.addEventListener("dispose",Vi);var n,o,a,s,l,h,c;if(e instanceof THREE.MeshDepthMaterial)c="depth";else if(e instanceof THREE.MeshNormalMaterial)c="normal";else if(e instanceof THREE.MeshBasicMaterial)c="basic";else if(e instanceof THREE.MeshLambertMaterial)c="lambert";else if(e instanceof THREE.MeshPhongMaterial)c="phong";else if(e instanceof THREE.LineBasicMaterial)c="basic";else if(e instanceof THREE.LineDashedMaterial)c="dashed";else if(e instanceof THREE.ParticleBasicMaterial)c="particle_basic";if(c)B(e,THREE.ShaderLib[c]);s=wt(t);h=Ht(t);l=Rt(r);a={map:!!e.map,envMap:!!e.envMap,lightMap:!!e.lightMap,bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,specularMap:!!e.specularMap,vertexColors:e.vertexColors,fog:i,useFog:e.fog,fogExp:i instanceof THREE.FogExp2,sizeAttenuation:e.sizeAttenuation,skinning:e.skinning,maxBones:l,useVertexTexture:Di&&r&&r.useVertexTexture,boneTextureWidth:r&&r.boneTextureWidth,boneTextureHeight:r&&r.boneTextureHeight,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:s.directional,maxPointLights:s.point,maxSpotLights:s.spot,maxHemiLights:s.hemi,maxShadows:h,shadowMapEnabled:this.shadowMapEnabled&&r.receiveShadow,shadowMapType:this.shadowMapType,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,alphaTest:e.alphaTest,metal:e.metal,perPixel:e.perPixel,wrapAround:e.wrapAround,doubleSided:e.side===THREE.DoubleSide,flipSided:e.side===THREE.BackSide};e.program=ht(c,e.fragmentShader,e.vertexShader,e.uniforms,e.attributes,e.defines,a);var u=e.program.attributes;if(e.morphTargets){e.numSupportedMorphTargets=0;var f,d="morphTarget";for(o=0;o<this.maxMorphTargets;o++){f=d+o;if(u[f]>=0)e.numSupportedMorphTargets++}}if(e.morphNormals){e.numSupportedMorphNormals=0;var f,d="morphNormal";for(o=0;o<this.maxMorphNormals;o++){f=d+o;if(u[f]>=0)e.numSupportedMorphNormals++}}e.uniformsList=[];for(n in e.uniforms)e.uniformsList.push([e.uniforms[n],n])};this.setFaceCulling=function(e,t){if(e===THREE.CullFaceNone)Ti.disable(Ti.CULL_FACE);else{if(t===THREE.FrontFaceDirectionCW)Ti.frontFace(Ti.CW);else Ti.frontFace(Ti.CCW);if(e===THREE.CullFaceBack)Ti.cullFace(Ti.BACK);else if(e===THREE.CullFaceFront)Ti.cullFace(Ti.FRONT);else Ti.cullFace(Ti.FRONT_AND_BACK);Ti.enable(Ti.CULL_FACE)}};this.setMaterialFaces=function(e){var t=e.side===THREE.DoubleSide;var i=e.side===THREE.BackSide;if(qt!==t){if(t)Ti.disable(Ti.CULL_FACE);else Ti.enable(Ti.CULL_FACE);qt=t}if(Kt!==i){if(i)Ti.frontFace(Ti.CW);else Ti.frontFace(Ti.CCW);Kt=i}};this.setDepthTest=function(e){if(ei!==e){if(e)Ti.enable(Ti.DEPTH_TEST);else Ti.disable(Ti.DEPTH_TEST);ei=e}};this.setDepthWrite=function(e){if(ti!==e){Ti.depthMask(e);ti=e}};this.setBlending=function(e,t,i,r){if(e!==Qt){if(e===THREE.NoBlending)Ti.disable(Ti.BLEND);else if(e===THREE.AdditiveBlending){Ti.enable(Ti.BLEND);Ti.blendEquation(Ti.FUNC_ADD);Ti.blendFunc(Ti.SRC_ALPHA,Ti.ONE)}else if(e===THREE.SubtractiveBlending){Ti.enable(Ti.BLEND);Ti.blendEquation(Ti.FUNC_ADD);Ti.blendFunc(Ti.ZERO,Ti.ONE_MINUS_SRC_COLOR)}else if(e===THREE.MultiplyBlending){Ti.enable(Ti.BLEND);Ti.blendEquation(Ti.FUNC_ADD);Ti.blendFunc(Ti.ZERO,Ti.SRC_COLOR)}else if(e===THREE.CustomBlending)Ti.enable(Ti.BLEND);else{Ti.enable(Ti.BLEND);Ti.blendEquationSeparate(Ti.FUNC_ADD,Ti.FUNC_ADD);Ti.blendFuncSeparate(Ti.SRC_ALPHA,Ti.ONE_MINUS_SRC_ALPHA,Ti.ONE,Ti.ONE_MINUS_SRC_ALPHA)}Qt=e}if(e===THREE.CustomBlending){if(t!==Zt){Ti.blendEquation(xt(t));Zt=t}if(i!==$t||r!==Jt){Ti.blendFunc(xt(i),xt(r));$t=i;Jt=r}}else{Zt=null;$t=null;Jt=null}};this.setTexture=function(e,t){if(e.needsUpdate){if(!e.__webglInit){e.__webglInit=!0;e.addEventListener("dispose",Oi);e.__webglTexture=Ti.createTexture();It.info.memory.textures++}Ti.activeTexture(Ti.TEXTURE0+t);Ti.bindTexture(Ti.TEXTURE_2D,e.__webglTexture);Ti.pixelStorei(Ti.UNPACK_FLIP_Y_WEBGL,e.flipY);Ti.pixelStorei(Ti.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha);Ti.pixelStorei(Ti.UNPACK_ALIGNMENT,e.unpackAlignment);var i=e.image,r=pt(i.width)&&pt(i.height),n=xt(e.format),o=xt(e.type);mt(Ti.TEXTURE_2D,e,r);var a,s=e.mipmaps;if(e instanceof THREE.DataTexture)if(s.length>0&&r){for(var l=0,h=s.length;h>l;l++){a=s[l];Ti.texImage2D(Ti.TEXTURE_2D,l,n,a.width,a.height,0,n,o,a.data)}e.generateMipmaps=!1}else Ti.texImage2D(Ti.TEXTURE_2D,0,n,i.width,i.height,0,n,o,i.data);else if(e instanceof THREE.CompressedTexture)for(var l=0,h=s.length;h>l;l++){a=s[l];Ti.compressedTexImage2D(Ti.TEXTURE_2D,l,n,a.width,a.height,0,a.data)}else if(s.length>0&&r){for(var l=0,h=s.length;h>l;l++){a=s[l];Ti.texImage2D(Ti.TEXTURE_2D,l,n,n,o,a)}e.generateMipmaps=!1}else Ti.texImage2D(Ti.TEXTURE_2D,0,n,n,o,e.image);if(e.generateMipmaps&&r)Ti.generateMipmap(Ti.TEXTURE_2D);e.needsUpdate=!1;if(e.onUpdate)e.onUpdate()}else{Ti.activeTexture(Ti.TEXTURE0+t);Ti.bindTexture(Ti.TEXTURE_2D,e.__webglTexture)}};this.setRenderTarget=function(e){var t=e instanceof THREE.WebGLRenderTargetCube;if(e&&!e.__webglFramebuffer){if(void 0===e.depthBuffer)e.depthBuffer=!0;if(void 0===e.stencilBuffer)e.stencilBuffer=!0;e.addEventListener("dispose",Ui);e.__webglTexture=Ti.createTexture();It.info.memory.textures++;var i=pt(e.width)&&pt(e.height),r=xt(e.format),n=xt(e.type);if(t){e.__webglFramebuffer=[];e.__webglRenderbuffer=[];Ti.bindTexture(Ti.TEXTURE_CUBE_MAP,e.__webglTexture);mt(Ti.TEXTURE_CUBE_MAP,e,i);for(var o=0;6>o;o++){e.__webglFramebuffer[o]=Ti.createFramebuffer();e.__webglRenderbuffer[o]=Ti.createRenderbuffer();Ti.texImage2D(Ti.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,r,e.width,e.height,0,r,n,null);yt(e.__webglFramebuffer[o],e,Ti.TEXTURE_CUBE_MAP_POSITIVE_X+o);Tt(e.__webglRenderbuffer[o],e)}if(i)Ti.generateMipmap(Ti.TEXTURE_CUBE_MAP)}else{e.__webglFramebuffer=Ti.createFramebuffer();if(e.shareDepthFrom)e.__webglRenderbuffer=e.shareDepthFrom.__webglRenderbuffer;else e.__webglRenderbuffer=Ti.createRenderbuffer();Ti.bindTexture(Ti.TEXTURE_2D,e.__webglTexture);mt(Ti.TEXTURE_2D,e,i);Ti.texImage2D(Ti.TEXTURE_2D,0,r,e.width,e.height,0,r,n,null);yt(e.__webglFramebuffer,e,Ti.TEXTURE_2D);if(e.shareDepthFrom){if(e.depthBuffer&&!e.stencilBuffer)Ti.framebufferRenderbuffer(Ti.FRAMEBUFFER,Ti.DEPTH_ATTACHMENT,Ti.RENDERBUFFER,e.__webglRenderbuffer);else if(e.depthBuffer&&e.stencilBuffer)Ti.framebufferRenderbuffer(Ti.FRAMEBUFFER,Ti.DEPTH_STENCIL_ATTACHMENT,Ti.RENDERBUFFER,e.__webglRenderbuffer)}else Tt(e.__webglRenderbuffer,e);if(i)Ti.generateMipmap(Ti.TEXTURE_2D)}if(t)Ti.bindTexture(Ti.TEXTURE_CUBE_MAP,null);else Ti.bindTexture(Ti.TEXTURE_2D,null);Ti.bindRenderbuffer(Ti.RENDERBUFFER,null);Ti.bindFramebuffer(Ti.FRAMEBUFFER,null)}var a,s,l,h,c;if(e){if(t)a=e.__webglFramebuffer[e.activeCubeFace];else a=e.__webglFramebuffer;s=e.width;l=e.height;h=0;c=0}else{a=null;s=li;l=hi;h=ai;c=si}if(a!==Bt){Ti.bindFramebuffer(Ti.FRAMEBUFFER,a);Ti.viewport(h,c,s,l);Bt=a}ci=s;ui=l};this.shadowMapPlugin=new THREE.ShadowMapPlugin;this.addPrePlugin(this.shadowMapPlugin);this.addPostPlugin(new THREE.SpritePlugin);this.addPostPlugin(new THREE.LensFlarePlugin)};THREE.WebGLRenderTarget=function(e,t,i){this.width=e;this.height=t;i=i||{};this.wrapS=void 0!==i.wrapS?i.wrapS:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==i.wrapT?i.wrapT:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==i.magFilter?i.magFilter:THREE.LinearFilter;this.minFilter=void 0!==i.minFilter?i.minFilter:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==i.anisotropy?i.anisotropy:1;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.format=void 0!==i.format?i.format:THREE.RGBAFormat;this.type=void 0!==i.type?i.type:THREE.UnsignedByteType;this.depthBuffer=void 0!==i.depthBuffer?i.depthBuffer:!0;this.stencilBuffer=void 0!==i.stencilBuffer?i.stencilBuffer:!0;this.generateMipmaps=!0;this.shareDepthFrom=null};THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,clone:function(){var e=new THREE.WebGLRenderTarget(this.width,this.height);e.wrapS=this.wrapS;e.wrapT=this.wrapT;e.magFilter=this.magFilter;e.minFilter=this.minFilter;e.anisotropy=this.anisotropy;e.offset.copy(this.offset);e.repeat.copy(this.repeat);e.format=this.format;e.type=this.type;e.depthBuffer=this.depthBuffer;e.stencilBuffer=this.stencilBuffer;e.generateMipmaps=this.generateMipmaps;e.shareDepthFrom=this.shareDepthFrom;return e},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype);THREE.WebGLRenderTargetCube=function(e,t,i){THREE.WebGLRenderTarget.call(this,e,t,i);this.activeCubeFace=0};THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype);THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3;this.positionScreen=new THREE.Vector4;this.visible=!0};THREE.RenderableVertex.prototype.copy=function(e){this.positionWorld.copy(e.positionWorld);this.positionScreen.copy(e.positionScreen)};THREE.RenderableFace3=function(){this.id=0;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.centroidModel=new THREE.Vector3;this.normalModel=new THREE.Vector3;this.normalModelView=new THREE.Vector3;this.vertexNormalsLength=0;this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.color=null;this.material=null;this.uvs=[[]];this.z=0};THREE.RenderableFace4=function(){this.id=0;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.v4=new THREE.RenderableVertex;this.centroidModel=new THREE.Vector3;this.normalModel=new THREE.Vector3;this.normalModelView=new THREE.Vector3;this.vertexNormalsLength=0;this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.color=null;this.material=null;this.uvs=[[]];this.z=0};THREE.RenderableObject=function(){this.id=0;this.object=null;this.z=0};THREE.RenderableParticle=function(){this.id=0;this.object=null;this.x=0;this.y=0;this.z=0;this.rotation=null;this.scale=new THREE.Vector2;this.material=null};THREE.RenderableLine=function(){this.id=0;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.vertexColors=[new THREE.Color,new THREE.Color];this.material=null;this.z=0};THREE.GeometryUtils={merge:function(e,t,i){var r,n,o=e.vertices.length,a=(e.faceVertexUvs[0].length,t instanceof THREE.Mesh?t.geometry:t),s=e.vertices,l=a.vertices,h=e.faces,c=a.faces,u=e.faceVertexUvs[0],f=a.faceVertexUvs[0];if(void 0===i)i=0;if(t instanceof THREE.Mesh){t.matrixAutoUpdate&&t.updateMatrix();r=t.matrix;n=(new THREE.Matrix3).getNormalMatrix(r)}for(var d=0,p=l.length;p>d;d++){var m=l[d];var g=m.clone();if(r)g.applyMatrix4(r);s.push(g)}for(d=0,p=c.length;p>d;d++){var v,E,y,T=c[d],_=T.vertexNormals,b=T.vertexColors;if(T instanceof THREE.Face3)v=new THREE.Face3(T.a+o,T.b+o,T.c+o);else if(T instanceof THREE.Face4)v=new THREE.Face4(T.a+o,T.b+o,T.c+o,T.d+o);v.normal.copy(T.normal);if(n)v.normal.applyMatrix3(n).normalize();for(var x=0,R=_.length;R>x;x++){E=_[x].clone();if(n)E.applyMatrix3(n).normalize();v.vertexNormals.push(E)}v.color.copy(T.color);for(var x=0,R=b.length;R>x;x++){y=b[x];v.vertexColors.push(y.clone())}v.materialIndex=T.materialIndex+i;v.centroid.copy(T.centroid);if(r)v.centroid.applyMatrix4(r);h.push(v)}for(d=0,p=f.length;p>d;d++){var w=f[d],H=[];for(var x=0,R=w.length;R>x;x++)H.push(new THREE.Vector2(w[x].x,w[x].y));u.push(H)}},removeMaterials:function(e,t){var i={};for(var r=0,n=t.length;n>r;r++)i[t[r]]=!0;var o,a=[];for(var r=0,n=e.faces.length;n>r;r++){o=e.faces[r];if(!(o.materialIndex in i))a.push(o)}e.faces=a},randomPointInTriangle:function(){var e=new THREE.Vector3;return function(t,i,r){var n=new THREE.Vector3;var o=THREE.Math.random16();var a=THREE.Math.random16();if(o+a>1){o=1-o;a=1-a}var s=1-o-a;n.copy(t);n.multiplyScalar(o);e.copy(i);e.multiplyScalar(a);n.add(e);e.copy(r);e.multiplyScalar(s);n.add(e);return n}}(),randomPointInFace:function(e,t,i){var r,n,o,a;if(e instanceof THREE.Face3){r=t.vertices[e.a];n=t.vertices[e.b];o=t.vertices[e.c];return THREE.GeometryUtils.randomPointInTriangle(r,n,o)}else if(e instanceof THREE.Face4){r=t.vertices[e.a];n=t.vertices[e.b];o=t.vertices[e.c];a=t.vertices[e.d];var s,l;if(i)if(e._area1&&e._area2){s=e._area1;l=e._area2}else{s=THREE.GeometryUtils.triangleArea(r,n,a);l=THREE.GeometryUtils.triangleArea(n,o,a);e._area1=s;e._area2=l}else s=THREE.GeometryUtils.triangleArea(r,n,a),l=THREE.GeometryUtils.triangleArea(n,o,a);var h=THREE.Math.random16()*(s+l);if(s>h)return THREE.GeometryUtils.randomPointInTriangle(r,n,a);else return THREE.GeometryUtils.randomPointInTriangle(n,o,a)}},randomPointsInGeometry:function(e,t){function i(e){function t(i,r){if(i>r)return i;var n=i+Math.floor((r-i)/2);if(d[n]>e)return t(i,n-1);else if(d[n]<e)return t(n+1,r);else return n}var i=t(0,d.length-1);return i}var r,n,o,a,s,l,h=e.faces,c=e.vertices,u=h.length,f=0,d=[];for(n=0;u>n;n++){r=h[n];if(r instanceof THREE.Face3){o=c[r.a];a=c[r.b];s=c[r.c];r._area=THREE.GeometryUtils.triangleArea(o,a,s)}else if(r instanceof THREE.Face4){o=c[r.a];a=c[r.b];s=c[r.c];l=c[r.d];r._area1=THREE.GeometryUtils.triangleArea(o,a,l);r._area2=THREE.GeometryUtils.triangleArea(a,s,l);r._area=r._area1+r._area2}f+=r._area;d[n]=f}var p,m,g=[];var v={};for(n=0;t>n;n++){p=THREE.Math.random16()*f;m=i(p);g[n]=THREE.GeometryUtils.randomPointInFace(h[m],e,!0);if(!v[m])v[m]=1;else v[m]+=1}return g},triangleArea:function(){var e=new THREE.Vector3;var t=new THREE.Vector3;return function(i,r,n){e.subVectors(r,i);t.subVectors(n,i);e.cross(t);return.5*e.length()}}(),center:function(e){e.computeBoundingBox();var t=e.boundingBox;var i=new THREE.Vector3;i.addVectors(t.min,t.max);i.multiplyScalar(-.5);e.applyMatrix((new THREE.Matrix4).makeTranslation(i.x,i.y,i.z));e.computeBoundingBox();return i},triangulateQuads:function(e){var t,i,r,n;var o=[];var a=[];var s=[];for(t=0,i=e.faceUvs.length;i>t;t++)a[t]=[];for(t=0,i=e.faceVertexUvs.length;i>t;t++)s[t]=[];for(t=0,i=e.faces.length;i>t;t++){var l=e.faces[t];if(l instanceof THREE.Face4){var h=l.a;var c=l.b;var u=l.c;var f=l.d;var d=new THREE.Face3;var p=new THREE.Face3;d.color.copy(l.color);p.color.copy(l.color);d.materialIndex=l.materialIndex;p.materialIndex=l.materialIndex;d.a=h;d.b=c;d.c=f;p.a=c;p.b=u;p.c=f;if(4===l.vertexColors.length){d.vertexColors[0]=l.vertexColors[0].clone();d.vertexColors[1]=l.vertexColors[1].clone();d.vertexColors[2]=l.vertexColors[3].clone();p.vertexColors[0]=l.vertexColors[1].clone();p.vertexColors[1]=l.vertexColors[2].clone();p.vertexColors[2]=l.vertexColors[3].clone()}o.push(d,p);for(r=0,n=e.faceVertexUvs.length;n>r;r++)if(e.faceVertexUvs[r].length){var m=e.faceVertexUvs[r][t];var g=m[0];var v=m[1];var E=m[2];var y=m[3];var T=[g.clone(),v.clone(),y.clone()];var _=[v.clone(),E.clone(),y.clone()];s[r].push(T,_)}for(r=0,n=e.faceUvs.length;n>r;r++)if(e.faceUvs[r].length){var b=e.faceUvs[r][t];a[r].push(b,b)}}else{o.push(l);for(r=0,n=e.faceUvs.length;n>r;r++)a[r].push(e.faceUvs[r][t]);for(r=0,n=e.faceVertexUvs.length;n>r;r++)s[r].push(e.faceVertexUvs[r][t])}}e.faces=o;e.faceUvs=a;e.faceVertexUvs=s;e.computeCentroids();e.computeFaceNormals();e.computeVertexNormals();if(e.hasTangents)e.computeTangents()},setMaterialIndex:function(e,t,i,r){var n=e.faces;var o=i||0;var a=r||n.length-1;for(var s=o;a>=s;s++)n[s].materialIndex=t}};THREE.ImageUtils={crossOrigin:"anonymous",loadTexture:function(e,t,i){var r=new Image;var n=new THREE.Texture(r,t);var o=new THREE.ImageLoader;o.crossOrigin=this.crossOrigin;o.load(e,function(e){n.image=e;n.needsUpdate=!0;if(i)i(n)});n.sourceFile=e;return n},loadCompressedTexture:function(e,t,i,r){var n=new THREE.CompressedTexture;n.mapping=t;var o=new XMLHttpRequest;o.onload=function(){var e=o.response;var t=THREE.ImageUtils.parseDDS(e,!0);n.format=t.format;n.mipmaps=t.mipmaps;n.image.width=t.width;n.image.height=t.height;n.generateMipmaps=!1;n.needsUpdate=!0;if(i)i(n)};o.onerror=r;o.open("GET",e,!0);o.responseType="arraybuffer";o.send(null);return n},loadTextureCube:function(e,t,i,r){var n=[];n.loadCount=0;var o=new THREE.Texture;o.image=n;if(void 0!==t)o.mapping=t;o.flipY=!1;for(var a=0,s=e.length;s>a;++a){var l=new Image;n[a]=l;l.onload=function(){n.loadCount+=1;if(6===n.loadCount){o.needsUpdate=!0;if(i)i(o)}};l.onerror=r;l.crossOrigin=this.crossOrigin;l.src=e[a]}return o},loadCompressedTextureCube:function(e,t,i,r){var n=[];n.loadCount=0;var o=new THREE.CompressedTexture;o.image=n;if(void 0!==t)o.mapping=t;o.flipY=!1;o.generateMipmaps=!1;var a=function(e,t){return function(){var r=e.response;var a=THREE.ImageUtils.parseDDS(r,!0);t.format=a.format;t.mipmaps=a.mipmaps;t.width=a.width;t.height=a.height;n.loadCount+=1;if(6===n.loadCount){o.format=a.format;o.needsUpdate=!0;if(i)i(o)}}};if(e instanceof Array)for(var s=0,l=e.length;l>s;++s){var h={};n[s]=h;var c=new XMLHttpRequest;c.onload=a(c,h);c.onerror=r;var u=e[s];c.open("GET",u,!0);c.responseType="arraybuffer";c.send(null)}else{var u=e;var c=new XMLHttpRequest;c.onload=function(){var e=c.response;var t=THREE.ImageUtils.parseDDS(e,!0);if(t.isCubemap){var r=t.mipmaps.length/t.mipmapCount;for(var a=0;r>a;a++){n[a]={mipmaps:[]};for(var s=0;s<t.mipmapCount;s++){n[a].mipmaps.push(t.mipmaps[a*t.mipmapCount+s]);n[a].format=t.format;n[a].width=t.width;n[a].height=t.height}}o.format=t.format;o.needsUpdate=!0;if(i)i(o)}};c.onerror=r;c.open("GET",u,!0);c.responseType="arraybuffer";c.send(null)}return o},parseDDS:function(e,t){function i(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function r(e){return String.fromCharCode(255&e,255&e>>8,255&e>>16,255&e>>24)}var n={mipmaps:[],width:0,height:0,format:null,mipmapCount:1};var o=542327876;var a=131072;var s=512;var l=4;var h=i("DXT1");var c=i("DXT3");var u=i("DXT5");var f=31;var d=0;var p=1;var m=2;var g=3;var v=4;var E=7;var y=20;var T=21;var _=28;var b=new Int32Array(e,0,f);if(b[d]!==o){console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header");return n}if(!b[y]&l){console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code");return n}var x;var R=b[T];switch(R){case h:x=8;n.format=THREE.RGB_S3TC_DXT1_Format;break;case c:x=16;n.format=THREE.RGBA_S3TC_DXT3_Format;break;case u:x=16;n.format=THREE.RGBA_S3TC_DXT5_Format;break;default:console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",r(R));return n}n.mipmapCount=1;if(b[m]&a&&t!==!1)n.mipmapCount=Math.max(1,b[E]);n.isCubemap=b[_]&s?!0:!1;n.width=b[v];n.height=b[g];var w=b[p]+4;var H=n.width;var M=n.height;var S=n.isCubemap?6:1;for(var C=0;S>C;C++){for(var A=0;A<n.mipmapCount;A++){var D=Math.max(4,H)/4*Math.max(4,M)/4*x;var P=new Uint8Array(e,w,D);var k={data:P,width:H,height:M};n.mipmaps.push(k);w+=D;H=Math.max(.5*H,1);M=Math.max(.5*M,1)}H=n.width;M=n.height}return n},getNormalMap:function(e,t){var i=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]};var r=function(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]};var n=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]};t=1|t;var o=e.width;var a=e.height;var s=document.createElement("canvas");s.width=o;s.height=a;var l=s.getContext("2d");l.drawImage(e,0,0);var h=l.getImageData(0,0,o,a).data;var c=l.createImageData(o,a);var u=c.data;for(var f=0;o>f;f++)for(var d=0;a>d;d++){var p=0>d-1?0:d-1;var m=d+1>a-1?a-1:d+1;var g=0>f-1?0:f-1;var v=f+1>o-1?o-1:f+1;var E=[];var y=[0,0,h[4*(d*o+f)]/255*t];E.push([-1,0,h[4*(d*o+g)]/255*t]);E.push([-1,-1,h[4*(p*o+g)]/255*t]);E.push([0,-1,h[4*(p*o+f)]/255*t]);E.push([1,-1,h[4*(p*o+v)]/255*t]);E.push([1,0,h[4*(d*o+v)]/255*t]);E.push([1,1,h[4*(m*o+v)]/255*t]);E.push([0,1,h[4*(m*o+f)]/255*t]);E.push([-1,1,h[4*(m*o+g)]/255*t]);var T=[];var _=E.length;for(var b=0;_>b;b++){var x=E[b];var R=E[(b+1)%_];x=r(x,y);R=r(R,y);T.push(n(i(x,R)))}var w=[0,0,0];for(var b=0;b<T.length;b++){w[0]+=T[b][0];w[1]+=T[b][1];w[2]+=T[b][2]}w[0]/=T.length;w[1]/=T.length;w[2]/=T.length;var H=4*(d*o+f);u[H]=0|255*((w[0]+1)/2);u[H+1]=0|255*((w[1]+1)/2);u[H+2]=0|255*w[2];u[H+3]=255}l.putImageData(c,0,0);return s},generateDataTexture:function(e,t,i){var r=e*t;var n=new Uint8Array(3*r);var o=Math.floor(255*i.r);var a=Math.floor(255*i.g);var s=Math.floor(255*i.b);for(var l=0;r>l;l++){n[3*l]=o;n[3*l+1]=a;n[3*l+2]=s}var h=new THREE.DataTexture(n,e,t,THREE.RGBFormat);h.needsUpdate=!0;return h}};THREE.SceneUtils={createMultiMaterialObject:function(e,t){var i=new THREE.Object3D;for(var r=0,n=t.length;n>r;r++)i.add(new THREE.Mesh(e,t[r]));return i},detach:function(e,t,i){e.applyMatrix(t.matrixWorld);t.remove(e);i.add(e)},attach:function(e,t,i){var r=new THREE.Matrix4;r.getInverse(i.matrixWorld);e.applyMatrix(r);t.remove(e);i.add(e)}};THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(e){var t=e.familyName.toLowerCase();var i=this;i.faces[t]=i.faces[t]||{};i.faces[t][e.cssFontWeight]=i.faces[t][e.cssFontWeight]||{};i.faces[t][e.cssFontWeight][e.cssFontStyle]=e;i.faces[t][e.cssFontWeight][e.cssFontStyle]=e;return e},drawText:function(e){var t,i=this.getFace(),r=this.size/i.resolution,n=0,o=String(e).split(""),a=o.length;var s=[];for(t=0;a>t;t++){var l=new THREE.Path;var h=this.extractGlyphPoints(o[t],i,r,n,l);n+=h.offset;s.push(h.path)}var c=n/2;return{paths:s,offset:c}},extractGlyphPoints:function(e,t,i,r,n){var o=[];var a,s,l,h,c,u,f,d,p,m,g,v,E,y,T,_,b,x,R,w=t.glyphs[e]||t.glyphs["?"];if(w){if(w.o){h=w._cachedOutline||(w._cachedOutline=w.o.split(" "));u=h.length;f=i;d=i;for(a=0;u>a;){c=h[a++];switch(c){case"m":p=h[a++]*f+r;m=h[a++]*d;n.moveTo(p,m);break;case"l":p=h[a++]*f+r;m=h[a++]*d;n.lineTo(p,m);break;case"q":g=h[a++]*f+r;v=h[a++]*d;T=h[a++]*f+r;_=h[a++]*d;n.quadraticCurveTo(T,_,g,v);R=o[o.length-1];if(R){E=R.x;y=R.y;for(s=1,l=this.divisions;l>=s;s++){var H=s/l;THREE.Shape.Utils.b2(H,E,T,g);THREE.Shape.Utils.b2(H,y,_,v)}}break;case"b":g=h[a++]*f+r;v=h[a++]*d;T=h[a++]*f+r;_=h[a++]*-d;b=h[a++]*f+r;x=h[a++]*-d;n.bezierCurveTo(g,v,T,_,b,x);R=o[o.length-1];if(R){E=R.x;y=R.y;for(s=1,l=this.divisions;l>=s;s++){var H=s/l;THREE.Shape.Utils.b3(H,E,T,b,g);THREE.Shape.Utils.b3(H,y,_,x,v)}}}}}return{offset:w.ha*i,path:n}}}};THREE.FontUtils.generateShapes=function(e,t){t=t||{};var i=void 0!==t.size?t.size:100;var r=void 0!==t.curveSegments?t.curveSegments:4;var n=void 0!==t.font?t.font:"helvetiker";var o=void 0!==t.weight?t.weight:"normal";var a=void 0!==t.style?t.style:"normal";THREE.FontUtils.size=i;THREE.FontUtils.divisions=r;THREE.FontUtils.face=n;THREE.FontUtils.weight=o;THREE.FontUtils.style=a;var s=THREE.FontUtils.drawText(e);var l=s.paths;var h=[];for(var c=0,u=l.length;u>c;c++)Array.prototype.push.apply(h,l[c].toShapes());return h};!function(e){var t=1e-10;var i=function(e,t){var i=e.length;if(3>i)return null;var o=[],a=[],s=[];var l,h,c;if(r(e)>0)for(h=0;i>h;h++)a[h]=h;else for(h=0;i>h;h++)a[h]=i-1-h;var u=i;var f=2*u;for(h=u-1;u>2;){if(f--<=0){console.log("Warning, unable to triangulate polygon!");if(t)return s;else return o}l=h;if(l>=u)l=0;h=l+1;if(h>=u)h=0;c=h+1;if(c>=u)c=0;if(n(e,l,h,c,u,a)){var d,p,m,g,v;d=a[l];p=a[h];m=a[c];o.push([e[d],e[p],e[m]]);s.push([a[l],a[h],a[c]]);for(g=h,v=h+1;u>v;g++,v++)a[g]=a[v];u--;f=2*u}}if(t)return s;else return o};var r=function(e){var t=e.length;var i=0;for(var r=t-1,n=0;t>n;r=n++)i+=e[r].x*e[n].y-e[n].x*e[r].y;return.5*i};var n=function(e,i,r,n,o,a){var s;var l,h,c,u;var f,d,p,m;l=e[a[i]].x;h=e[a[i]].y;c=e[a[r]].x;u=e[a[r]].y;f=e[a[n]].x;d=e[a[n]].y;if(t>(c-l)*(d-h)-(u-h)*(f-l))return!1;var g,v,E,y,T,_;var b,x,R,w,H,M;var S,C,A;g=f-c;v=d-u;E=l-f;y=h-d;T=c-l;_=u-h;for(s=0;o>s;s++)if(s!==i&&s!==r&&s!==n){p=e[a[s]].x;m=e[a[s]].y;b=p-l;x=m-h;R=p-c;w=m-u;H=p-f;M=m-d;A=g*w-v*R;S=T*x-_*b;C=E*M-y*H;if(A>=0&&C>=0&&S>=0)return!1}else;return!0};e.Triangulate=i;e.Triangulate.area=r;return e}(THREE.FontUtils);self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};THREE.typeface_js=self._typeface_js;THREE.Curve=function(){};THREE.Curve.prototype.getPoint=function(){console.log("Warning, getPoint() not implemented!");return null};THREE.Curve.prototype.getPointAt=function(e){var t=this.getUtoTmapping(e);return this.getPoint(t)};THREE.Curve.prototype.getPoints=function(e){if(!e)e=5;var t,i=[];for(t=0;e>=t;t++)i.push(this.getPoint(t/e));return i};THREE.Curve.prototype.getSpacedPoints=function(e){if(!e)e=5;var t,i=[];for(t=0;e>=t;t++)i.push(this.getPointAt(t/e));return i};THREE.Curve.prototype.getLength=function(){var e=this.getLengths();return e[e.length-1]};THREE.Curve.prototype.getLengths=function(e){if(!e)e=this.__arcLengthDivisions?this.__arcLengthDivisions:200;if(this.cacheArcLengths&&this.cacheArcLengths.length==e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t=[];var i,r=this.getPoint(0);var n,o=0;t.push(0);for(n=1;e>=n;n++){i=this.getPoint(n/e);o+=i.distanceTo(r);t.push(o);r=i}this.cacheArcLengths=t;return t};THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0;this.getLengths()};THREE.Curve.prototype.getUtoTmapping=function(e,t){var i=this.getLengths();var r=0,n=i.length;var o;if(t)o=t;else o=e*i[n-1];var a,s=0,l=n-1;for(;l>=s;){r=Math.floor(s+(l-s)/2);a=i[r]-o;if(!(0>a));else s=r+1}r=l;if(i[r]==o){var h=r/(n-1);return h}var c=i[r];var u=i[r+1];var f=u-c;var d=(o-c)/f;var h=(r+d)/(n-1);return h};THREE.Curve.prototype.getTangent=function(e){var t=1e-4;var i=e-t;var r=e+t;if(0>i)i=0;if(r>1)r=1;var n=this.getPoint(i);var o=this.getPoint(r);var a=o.clone().sub(n);return a.normalize()};THREE.Curve.prototype.getTangentAt=function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)};THREE.Curve.Utils={tangentQuadraticBezier:function(e,t,i,r){return 2*(1-e)*(i-t)+2*e*(r-i)},tangentCubicBezier:function(e,t,i,r,n){return-3*t*(1-e)*(1-e)+3*i*(1-e)*(1-e)-6*e*i*(1-e)+6*e*r*(1-e)-3*e*e*r+3*e*e*n},tangentSpline:function(e){var t=6*e*e-6*e;var i=3*e*e-4*e+1;var r=-6*e*e+6*e;var n=3*e*e-2*e;return t+i+r+n},interpolate:function(e,t,i,r,n){var o=.5*(i-e);var a=.5*(r-t);var s=n*n;var l=n*s;return(2*t-2*i+o+a)*l+(-3*t+3*i-2*o-a)*s+o*n+t}};THREE.Curve.create=function(e,t){e.prototype=Object.create(THREE.Curve.prototype);e.prototype.getPoint=t;return e};THREE.CurvePath=function(){this.curves=[];this.bends=[];this.autoClose=!1};THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype);THREE.CurvePath.prototype.add=function(e){this.curves.push(e)};THREE.CurvePath.prototype.checkConnection=function(){};THREE.CurvePath.prototype.closePath=function(){var e=this.curves[0].getPoint(0);var t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t))this.curves.push(new THREE.LineCurve(t,e))};THREE.CurvePath.prototype.getPoint=function(e){var t=e*this.getLength();var i=this.getCurveLengths();var r,n,o=0;for(;o<i.length;){if(i[o]>=t){r=i[o]-t;n=this.curves[o];var a=1-r/n.getLength();return n.getPointAt(a)}o++}return null};THREE.CurvePath.prototype.getLength=function(){var e=this.getCurveLengths();return e[e.length-1]};THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var e=[],t=0;var i,r=this.curves.length;for(i=0;r>i;i++){t+=this.curves[i].getLength();e.push(t)
}this.cacheLengths=e;return e};THREE.CurvePath.prototype.getBoundingBox=function(){var e=this.getPoints();var t,i,r;var n,o,a;t=i=Number.NEGATIVE_INFINITY;n=o=Number.POSITIVE_INFINITY;var s,l,h,c;var u=e[0]instanceof THREE.Vector3;c=u?new THREE.Vector3:new THREE.Vector2;for(l=0,h=e.length;h>l;l++){s=e[l];if(s.x>t)t=s.x;else if(s.x<n)n=s.x;if(s.y>i)i=s.y;else if(s.y<o)o=s.y;if(u)if(s.z>r)r=s.z;else if(s.z<a)a=s.z;c.add(s)}var f={minX:n,minY:o,maxX:t,maxY:i,centroid:c.divideScalar(h)};if(u){f.maxZ=r;f.minZ=a}return f};THREE.CurvePath.prototype.createPointsGeometry=function(e){var t=this.getPoints(e,!0);return this.createGeometry(t)};THREE.CurvePath.prototype.createSpacedPointsGeometry=function(e){var t=this.getSpacedPoints(e,!0);return this.createGeometry(t)};THREE.CurvePath.prototype.createGeometry=function(e){var t=new THREE.Geometry;for(var i=0;i<e.length;i++)t.vertices.push(new THREE.Vector3(e[i].x,e[i].y,e[i].z||0));return t};THREE.CurvePath.prototype.addWrapPath=function(e){this.bends.push(e)};THREE.CurvePath.prototype.getTransformedPoints=function(e,t){var i=this.getPoints(e);var r,n;if(!t)t=this.bends;for(r=0,n=t.length;n>r;r++)i=this.getWrapPoints(i,t[r]);return i};THREE.CurvePath.prototype.getTransformedSpacedPoints=function(e,t){var i=this.getSpacedPoints(e);var r,n;if(!t)t=this.bends;for(r=0,n=t.length;n>r;r++)i=this.getWrapPoints(i,t[r]);return i};THREE.CurvePath.prototype.getWrapPoints=function(e,t){var i=this.getBoundingBox();var r,n,o,a,s,l;for(r=0,n=e.length;n>r;r++){o=e[r];a=o.x;s=o.y;l=a/i.maxX;l=t.getUtoTmapping(l,a);var h=t.getPoint(l);var c=t.getNormalVector(l).multiplyScalar(s);o.x=h.x+c.x;o.y=h.y+c.y}return e};THREE.Gyroscope=function(){THREE.Object3D.call(this)};THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype);THREE.Gyroscope.prototype.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||e){if(this.parent){this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix);this.matrixWorld.decompose(this.translationWorld,this.quaternionWorld,this.scaleWorld);this.matrix.decompose(this.translationObject,this.quaternionObject,this.scaleObject);this.matrixWorld.compose(this.translationWorld,this.quaternionObject,this.scaleWorld)}else this.matrixWorld.copy(this.matrix);this.matrixWorldNeedsUpdate=!1;e=!0}for(var t=0,i=this.children.length;i>t;t++)this.children[t].updateMatrixWorld(e)};THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3;THREE.Gyroscope.prototype.translationObject=new THREE.Vector3;THREE.Gyroscope.prototype.quaternionWorld=new THREE.Quaternion;THREE.Gyroscope.prototype.quaternionObject=new THREE.Quaternion;THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3;THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3;THREE.Path=function(e){THREE.CurvePath.call(this);this.actions=[];if(e)this.fromPoints(e)};THREE.Path.prototype=Object.create(THREE.CurvePath.prototype);THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"};THREE.Path.prototype.fromPoints=function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,i=e.length;i>t;t++)this.lineTo(e[t].x,e[t].y)};THREE.Path.prototype.moveTo=function(){var e=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:e})};THREE.Path.prototype.lineTo=function(e,t){var i=Array.prototype.slice.call(arguments);var r=this.actions[this.actions.length-1].args;var n=r[r.length-2];var o=r[r.length-1];var a=new THREE.LineCurve(new THREE.Vector2(n,o),new THREE.Vector2(e,t));this.curves.push(a);this.actions.push({action:THREE.PathActions.LINE_TO,args:i})};THREE.Path.prototype.quadraticCurveTo=function(e,t,i,r){var n=Array.prototype.slice.call(arguments);var o=this.actions[this.actions.length-1].args;var a=o[o.length-2];var s=o[o.length-1];var l=new THREE.QuadraticBezierCurve(new THREE.Vector2(a,s),new THREE.Vector2(e,t),new THREE.Vector2(i,r));this.curves.push(l);this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:n})};THREE.Path.prototype.bezierCurveTo=function(e,t,i,r,n,o){var a=Array.prototype.slice.call(arguments);var s=this.actions[this.actions.length-1].args;var l=s[s.length-2];var h=s[s.length-1];var c=new THREE.CubicBezierCurve(new THREE.Vector2(l,h),new THREE.Vector2(e,t),new THREE.Vector2(i,r),new THREE.Vector2(n,o));this.curves.push(c);this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:a})};THREE.Path.prototype.splineThru=function(e){var t=Array.prototype.slice.call(arguments);var i=this.actions[this.actions.length-1].args;var r=i[i.length-2];var n=i[i.length-1];var o=[new THREE.Vector2(r,n)];Array.prototype.push.apply(o,e);var a=new THREE.SplineCurve(o);this.curves.push(a);this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:t})};THREE.Path.prototype.arc=function(e,t,i,r,n,o){var a=this.actions[this.actions.length-1].args;var s=a[a.length-2];var l=a[a.length-1];this.absarc(e+s,t+l,i,r,n,o)};THREE.Path.prototype.absarc=function(e,t,i,r,n,o){this.absellipse(e,t,i,i,r,n,o)};THREE.Path.prototype.ellipse=function(e,t,i,r,n,o,a){var s=this.actions[this.actions.length-1].args;var l=s[s.length-2];var h=s[s.length-1];this.absellipse(e+l,t+h,i,r,n,o,a)};THREE.Path.prototype.absellipse=function(e,t,i,r,n,o,a){var s=Array.prototype.slice.call(arguments);var l=new THREE.EllipseCurve(e,t,i,r,n,o,a);this.curves.push(l);var h=l.getPoint(a?1:0);s.push(h.x);s.push(h.y);this.actions.push({action:THREE.PathActions.ELLIPSE,args:s})};THREE.Path.prototype.getSpacedPoints=function(e){if(!e)e=40;var t=[];for(var i=0;e>i;i++)t.push(this.getPoint(i/e));return t};THREE.Path.prototype.getPoints=function(e,t){if(this.useSpacedPoints){console.log("tata");return this.getSpacedPoints(e,t)}e=e||12;var i=[];var r,n,o,a,s;var l,h,c,u,f,d,p,m,g,v,E,y,T;for(r=0,n=this.actions.length;n>r;r++){o=this.actions[r];a=o.action;s=o.args;switch(a){case THREE.PathActions.MOVE_TO:i.push(new THREE.Vector2(s[0],s[1]));break;case THREE.PathActions.LINE_TO:i.push(new THREE.Vector2(s[0],s[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:l=s[2];h=s[3];f=s[0];d=s[1];if(i.length>0){g=i[i.length-1];p=g.x;m=g.y}else{g=this.actions[r-1].args;p=g[g.length-2];m=g[g.length-1]}for(v=1;e>=v;v++){E=v/e;y=THREE.Shape.Utils.b2(E,p,f,l);T=THREE.Shape.Utils.b2(E,m,d,h);i.push(new THREE.Vector2(y,T))}break;case THREE.PathActions.BEZIER_CURVE_TO:l=s[4];h=s[5];f=s[0];d=s[1];c=s[2];u=s[3];if(i.length>0){g=i[i.length-1];p=g.x;m=g.y}else{g=this.actions[r-1].args;p=g[g.length-2];m=g[g.length-1]}for(v=1;e>=v;v++){E=v/e;y=THREE.Shape.Utils.b3(E,p,f,c,l);T=THREE.Shape.Utils.b3(E,m,d,u,h);i.push(new THREE.Vector2(y,T))}break;case THREE.PathActions.CSPLINE_THRU:g=this.actions[r-1].args;var _=new THREE.Vector2(g[g.length-2],g[g.length-1]);var b=[_];var x=e*s[0].length;b=b.concat(s[0]);var R=new THREE.SplineCurve(b);for(v=1;x>=v;v++)i.push(R.getPointAt(v/x));break;case THREE.PathActions.ARC:var w=s[0],H=s[1],M=s[2],S=s[3],C=s[4],A=!!s[5];var D=C-S;var P;var k=2*e;for(v=1;k>=v;v++){E=v/k;if(!A)E=1-E;P=S+E*D;y=w+M*Math.cos(P);T=H+M*Math.sin(P);i.push(new THREE.Vector2(y,T))}break;case THREE.PathActions.ELLIPSE:var w=s[0],H=s[1],L=s[2],F=s[3],S=s[4],C=s[5],A=!!s[6];var D=C-S;var P;var k=2*e;for(v=1;k>=v;v++){E=v/k;if(!A)E=1-E;P=S+E*D;y=w+L*Math.cos(P);T=H+F*Math.sin(P);i.push(new THREE.Vector2(y,T))}}}var z=i[i.length-1];var N=1e-10;if(Math.abs(z.x-i[0].x)<N&&Math.abs(z.y-i[0].y)<N)i.splice(i.length-1,1);if(t)i.push(i[0]);return i};THREE.Path.prototype.toShapes=function(e){var t,i,r,n,o;var a=[],s=new THREE.Path;for(t=0,i=this.actions.length;i>t;t++){r=this.actions[t];o=r.args;n=r.action;if(n==THREE.PathActions.MOVE_TO)if(0!=s.actions.length){a.push(s);s=new THREE.Path}s[n].apply(s,o)}if(0!=s.actions.length)a.push(s);if(0==a.length)return[];var l,h,c,u=[];if(1==a.length){h=a[0];c=new THREE.Shape;c.actions=h.actions;c.curves=h.curves;u.push(c);return u}var f=!THREE.Shape.Utils.isClockWise(a[0].getPoints());f=e?!f:f;if(f){c=new THREE.Shape;for(t=0,i=a.length;i>t;t++){h=a[t];l=THREE.Shape.Utils.isClockWise(h.getPoints());l=e?!l:l;if(l){c.actions=h.actions;c.curves=h.curves;u.push(c);c=new THREE.Shape}else c.holes.push(h)}}else{c=void 0;for(t=0,i=a.length;i>t;t++){h=a[t];l=THREE.Shape.Utils.isClockWise(h.getPoints());l=e?!l:l;if(l){if(c)u.push(c);c=new THREE.Shape;c.actions=h.actions;c.curves=h.curves}else c.holes.push(h)}u.push(c)}return u};THREE.Shape=function(){THREE.Path.apply(this,arguments);this.holes=[]};THREE.Shape.prototype=Object.create(THREE.Path.prototype);THREE.Shape.prototype.extrude=function(e){var t=new THREE.ExtrudeGeometry(this,e);return t};THREE.Shape.prototype.makeGeometry=function(e){var t=new THREE.ShapeGeometry(this,e);return t};THREE.Shape.prototype.getPointsHoles=function(e){var t,i=this.holes.length,r=[];for(t=0;i>t;t++)r[t]=this.holes[t].getTransformedPoints(e,this.bends);return r};THREE.Shape.prototype.getSpacedPointsHoles=function(e){var t,i=this.holes.length,r=[];for(t=0;i>t;t++)r[t]=this.holes[t].getTransformedSpacedPoints(e,this.bends);return r};THREE.Shape.prototype.extractAllPoints=function(e){return{shape:this.getTransformedPoints(e),holes:this.getPointsHoles(e)}};THREE.Shape.prototype.extractPoints=function(e){if(this.useSpacedPoints)return this.extractAllSpacedPoints(e);else return this.extractAllPoints(e)};THREE.Shape.prototype.extractAllSpacedPoints=function(e){return{shape:this.getTransformedSpacedPoints(e),holes:this.getSpacedPointsHoles(e)}};THREE.Shape.Utils={removeHoles:function(e,t){var i=e.concat();var r=i.concat();var n,o,a,s,l,h,c,u,f,d,p,m,g,v,E,y,T=[];for(l=0;l<t.length;l++){c=t[l];Array.prototype.push.apply(r,c);u=Number.POSITIVE_INFINITY;for(h=0;h<c.length;h++){p=c[h];var _=[];for(d=0;d<i.length;d++){m=i[d];f=p.distanceToSquared(m);_.push(f);if(u>f){u=f;a=h;s=d}}}n=s-1>=0?s-1:i.length-1;o=a-1>=0?a-1:c.length-1;var b=[c[a],i[s],i[n]];var x=THREE.FontUtils.Triangulate.area(b);var R=[c[a],c[o],i[s]];var w=THREE.FontUtils.Triangulate.area(R);var H=1;var M=-1;var S=s,C=a;s+=H;a+=M;if(0>s)s+=i.length;s%=i.length;if(0>a)a+=c.length;a%=c.length;n=s-1>=0?s-1:i.length-1;o=a-1>=0?a-1:c.length-1;b=[c[a],i[s],i[n]];var A=THREE.FontUtils.Triangulate.area(b);R=[c[a],c[o],i[s]];var D=THREE.FontUtils.Triangulate.area(R);if(x+w>A+D){s=S;a=C;if(0>s)s+=i.length;s%=i.length;if(0>a)a+=c.length;a%=c.length;n=s-1>=0?s-1:i.length-1;o=a-1>=0?a-1:c.length-1}else;g=i.slice(0,s);v=i.slice(s);E=c.slice(a);y=c.slice(0,a);var P=[c[a],i[s],i[n]];var k=[c[a],c[o],i[s]];T.push(P);T.push(k);i=g.concat(E).concat(y).concat(v)}return{shape:i,isolatedPts:T,allpoints:r}},triangulateShape:function(e,t){var i=THREE.Shape.Utils.removeHoles(e,t);var r=i.shape,n=i.allpoints,o=i.isolatedPts;var a=THREE.FontUtils.Triangulate(r,!1);var s,l,h,c,u,f,d={};for(s=0,l=n.length;l>s;s++){u=n[s].x+":"+n[s].y;if(void 0!==d[u])console.log("Duplicate point",u);d[u]=s}for(s=0,l=a.length;l>s;s++){c=a[s];for(h=0;3>h;h++){u=c[h].x+":"+c[h].y;f=d[u];if(void 0!==f)c[h]=f}}for(s=0,l=o.length;l>s;s++){c=o[s];for(h=0;3>h;h++){u=c[h].x+":"+c[h].y;f=d[u];if(void 0!==f)c[h]=f}}return a.concat(o)},isClockWise:function(e){return THREE.FontUtils.Triangulate.area(e)<0},b2p0:function(e,t){var i=1-e;return i*i*t},b2p1:function(e,t){return 2*(1-e)*e*t},b2p2:function(e,t){return e*e*t},b2:function(e,t,i,r){return this.b2p0(e,t)+this.b2p1(e,i)+this.b2p2(e,r)},b3p0:function(e,t){var i=1-e;return i*i*i*t},b3p1:function(e,t){var i=1-e;return 3*i*i*e*t},b3p2:function(e,t){var i=1-e;return 3*i*e*e*t},b3p3:function(e,t){return e*e*e*t},b3:function(e,t,i,r,n){return this.b3p0(e,t)+this.b3p1(e,i)+this.b3p2(e,r)+this.b3p3(e,n)}};THREE.LineCurve=function(e,t){this.v1=e;this.v2=t};THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.LineCurve.prototype.getPoint=function(e){var t=this.v2.clone().sub(this.v1);t.multiplyScalar(e).add(this.v1);return t};THREE.LineCurve.prototype.getPointAt=function(e){return this.getPoint(e)};THREE.LineCurve.prototype.getTangent=function(){var e=this.v2.clone().sub(this.v1);return e.normalize()};THREE.QuadraticBezierCurve=function(e,t,i){this.v0=e;this.v1=t;this.v2=i};THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.QuadraticBezierCurve.prototype.getPoint=function(e){var t,i;t=THREE.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x);i=THREE.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y);return new THREE.Vector2(t,i)};THREE.QuadraticBezierCurve.prototype.getTangent=function(e){var t,i;t=THREE.Curve.Utils.tangentQuadraticBezier(e,this.v0.x,this.v1.x,this.v2.x);i=THREE.Curve.Utils.tangentQuadraticBezier(e,this.v0.y,this.v1.y,this.v2.y);var r=new THREE.Vector2(t,i);r.normalize();return r};THREE.CubicBezierCurve=function(e,t,i,r){this.v0=e;this.v1=t;this.v2=i;this.v3=r};THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.CubicBezierCurve.prototype.getPoint=function(e){var t,i;t=THREE.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x);i=THREE.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y);return new THREE.Vector2(t,i)};THREE.CubicBezierCurve.prototype.getTangent=function(e){var t,i;t=THREE.Curve.Utils.tangentCubicBezier(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x);i=THREE.Curve.Utils.tangentCubicBezier(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var r=new THREE.Vector2(t,i);r.normalize();return r};THREE.SplineCurve=function(e){this.points=void 0==e?[]:e};THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.SplineCurve.prototype.getPoint=function(e){var t=new THREE.Vector2;var i=[];var r,n,o,a=this.points;r=(a.length-1)*e;n=Math.floor(r);o=r-n;i[0]=0==n?n:n-1;i[1]=n;i[2]=n>a.length-2?a.length-1:n+1;i[3]=n>a.length-3?a.length-1:n+2;t.x=THREE.Curve.Utils.interpolate(a[i[0]].x,a[i[1]].x,a[i[2]].x,a[i[3]].x,o);t.y=THREE.Curve.Utils.interpolate(a[i[0]].y,a[i[1]].y,a[i[2]].y,a[i[3]].y,o);return t};THREE.EllipseCurve=function(e,t,i,r,n,o,a){this.aX=e;this.aY=t;this.xRadius=i;this.yRadius=r;this.aStartAngle=n;this.aEndAngle=o;this.aClockwise=a};THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype);THREE.EllipseCurve.prototype.getPoint=function(e){var t=this.aEndAngle-this.aStartAngle;if(!this.aClockwise)e=1-e;var i=this.aStartAngle+e*t;var r=this.aX+this.xRadius*Math.cos(i);var n=this.aY+this.yRadius*Math.sin(i);return new THREE.Vector2(r,n)};THREE.ArcCurve=function(e,t,i,r,n,o){THREE.EllipseCurve.call(this,e,t,i,i,r,n,o)};THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype);THREE.LineCurve3=THREE.Curve.create(function(e,t){this.v1=e;this.v2=t},function(e){var t=new THREE.Vector3;t.subVectors(this.v2,this.v1);t.multiplyScalar(e);t.add(this.v1);return t});THREE.QuadraticBezierCurve3=THREE.Curve.create(function(e,t,i){this.v0=e;this.v1=t;this.v2=i},function(e){var t,i,r;t=THREE.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x);i=THREE.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y);r=THREE.Shape.Utils.b2(e,this.v0.z,this.v1.z,this.v2.z);return new THREE.Vector3(t,i,r)});THREE.CubicBezierCurve3=THREE.Curve.create(function(e,t,i,r){this.v0=e;this.v1=t;this.v2=i;this.v3=r},function(e){var t,i,r;t=THREE.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x);i=THREE.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y);r=THREE.Shape.Utils.b3(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z);return new THREE.Vector3(t,i,r)});THREE.SplineCurve3=THREE.Curve.create(function(e){this.points=void 0==e?[]:e},function(e){var t=new THREE.Vector3;var i=[];var r,n,o,a=this.points;r=(a.length-1)*e;n=Math.floor(r);o=r-n;i[0]=0==n?n:n-1;i[1]=n;i[2]=n>a.length-2?a.length-1:n+1;i[3]=n>a.length-3?a.length-1:n+2;var s=a[i[0]],l=a[i[1]],h=a[i[2]],c=a[i[3]];t.x=THREE.Curve.Utils.interpolate(s.x,l.x,h.x,c.x,o);t.y=THREE.Curve.Utils.interpolate(s.y,l.y,h.y,c.y,o);t.z=THREE.Curve.Utils.interpolate(s.z,l.z,h.z,c.z,o);return t});THREE.ClosedSplineCurve3=THREE.Curve.create(function(e){this.points=void 0==e?[]:e},function(e){var t=new THREE.Vector3;var i=[];var r,n,o,a=this.points;r=(a.length-0)*e;n=Math.floor(r);o=r-n;n+=n>0?0:(Math.floor(Math.abs(n)/a.length)+1)*a.length;i[0]=(n-1)%a.length;i[1]=n%a.length;i[2]=(n+1)%a.length;i[3]=(n+2)%a.length;t.x=THREE.Curve.Utils.interpolate(a[i[0]].x,a[i[1]].x,a[i[2]].x,a[i[3]].x,o);t.y=THREE.Curve.Utils.interpolate(a[i[0]].y,a[i[1]].y,a[i[2]].y,a[i[3]].y,o);t.z=THREE.Curve.Utils.interpolate(a[i[0]].z,a[i[1]].z,a[i[2]].z,a[i[3]].z,o);return t});THREE.AnimationHandler=function(){var e=[];var t={};var i={};i.update=function(t){for(var i=0;i<e.length;i++)e[i].update(t)};i.addToUpdate=function(t){if(-1===e.indexOf(t))e.push(t)};i.removeFromUpdate=function(t){var i=e.indexOf(t);if(-1!==i)e.splice(i,1)};i.add=function(e){if(void 0!==t[e.name])console.log("THREE.AnimationHandler.add: Warning! "+e.name+" already exists in library. Overwriting.");t[e.name]=e;n(e)};i.get=function(e){if("string"==typeof e)if(t[e])return t[e];else{console.log("THREE.AnimationHandler.get: Couldn't find animation "+e);return null}else;};i.parse=function(e){var t=[];if(e instanceof THREE.SkinnedMesh)for(var i=0;i<e.bones.length;i++)t.push(e.bones[i]);else r(e,t);return t};var r=function(e,t){t.push(e);for(var i=0;i<e.children.length;i++)r(e.children[i],t)};var n=function(e){if(e.initialized!==!0){for(var t=0;t<e.hierarchy.length;t++){for(var i=0;i<e.hierarchy[t].keys.length;i++){if(e.hierarchy[t].keys[i].time<0)e.hierarchy[t].keys[i].time=0;if(void 0!==e.hierarchy[t].keys[i].rot&&!(e.hierarchy[t].keys[i].rot instanceof THREE.Quaternion)){var r=e.hierarchy[t].keys[i].rot;e.hierarchy[t].keys[i].rot=new THREE.Quaternion(r[0],r[1],r[2],r[3])}}if(e.hierarchy[t].keys.length&&void 0!==e.hierarchy[t].keys[0].morphTargets){var n={};for(var i=0;i<e.hierarchy[t].keys.length;i++)for(var o=0;o<e.hierarchy[t].keys[i].morphTargets.length;o++){var a=e.hierarchy[t].keys[i].morphTargets[o];n[a]=-1}e.hierarchy[t].usedMorphTargets=n;for(var i=0;i<e.hierarchy[t].keys.length;i++){var s={};for(var a in n){for(var o=0;o<e.hierarchy[t].keys[i].morphTargets.length;o++)if(e.hierarchy[t].keys[i].morphTargets[o]===a){s[a]=e.hierarchy[t].keys[i].morphTargetsInfluences[o];break}if(o===e.hierarchy[t].keys[i].morphTargets.length)s[a]=0}e.hierarchy[t].keys[i].morphTargetsInfluences=s}}for(var i=1;i<e.hierarchy[t].keys.length;i++)if(e.hierarchy[t].keys[i].time===e.hierarchy[t].keys[i-1].time){e.hierarchy[t].keys.splice(i,1);i--}for(var i=0;i<e.hierarchy[t].keys.length;i++)e.hierarchy[t].keys[i].index=i}var l=parseInt(e.length*e.fps,10);e.JIT={};e.JIT.hierarchy=[];for(var t=0;t<e.hierarchy.length;t++)e.JIT.hierarchy.push(new Array(l));e.initialized=!0}};i.LINEAR=0;i.CATMULLROM=1;i.CATMULLROM_FORWARD=2;return i}();THREE.Animation=function(e,t,i){this.root=e;this.data=THREE.AnimationHandler.get(t);this.hierarchy=THREE.AnimationHandler.parse(e);this.currentTime=0;this.timeScale=1;this.isPlaying=!1;this.isPaused=!0;this.loop=!0;this.interpolationType=void 0!==i?i:THREE.AnimationHandler.LINEAR;this.points=[];this.target=new THREE.Vector3};THREE.Animation.prototype.play=function(e,t){if(this.isPlaying===!1){this.isPlaying=!0;this.loop=void 0!==e?e:!0;this.currentTime=void 0!==t?t:0;var i,r,n=this.hierarchy.length;for(i=0;n>i;i++){r=this.hierarchy[i];r.matrixAutoUpdate=!0;if(void 0===r.animationCache){r.animationCache={};r.animationCache.prevKey={pos:0,rot:0,scl:0};r.animationCache.nextKey={pos:0,rot:0,scl:0};r.animationCache.originalMatrix=r instanceof THREE.Bone?r.skinMatrix:r.matrix}var o=r.animationCache.prevKey;var a=r.animationCache.nextKey;o.pos=this.data.hierarchy[i].keys[0];o.rot=this.data.hierarchy[i].keys[0];o.scl=this.data.hierarchy[i].keys[0];a.pos=this.getNextKeyWith("pos",i,1);a.rot=this.getNextKeyWith("rot",i,1);a.scl=this.getNextKeyWith("scl",i,1)}this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};THREE.Animation.prototype.pause=function(){if(this.isPaused===!0)THREE.AnimationHandler.addToUpdate(this);else THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};THREE.Animation.prototype.stop=function(){this.isPlaying=!1;this.isPaused=!1;THREE.AnimationHandler.removeFromUpdate(this)};THREE.Animation.prototype.update=function(e){if(this.isPlaying!==!1){var t=["pos","rot","scl"];var i;var r;var n;var o,a;var s,l;var h;var c;var u;this.data.JIT.hierarchy;var f,d;var p,m,g;this.currentTime+=e*this.timeScale;d=this.currentTime;f=this.currentTime=this.currentTime%this.data.length;u=parseInt(Math.min(f*this.data.fps,this.data.length*this.data.fps),10);for(var v=0,E=this.hierarchy.length;E>v;v++){h=this.hierarchy[v];c=h.animationCache;for(var y=0;3>y;y++){i=t[y];s=c.prevKey[i];l=c.nextKey[i];if(l.time<=d){if(d>f)if(this.loop){s=this.data.hierarchy[v].keys[0];l=this.getNextKeyWith(i,v,1);for(;l.time<f;){s=l;l=this.getNextKeyWith(i,v,l.index+1)}}else{this.stop();return}else do{s=l;l=this.getNextKeyWith(i,v,l.index+1)}while(l.time<f);c.prevKey[i]=s;c.nextKey[i]=l}h.matrixAutoUpdate=!0;h.matrixWorldNeedsUpdate=!0;r=(f-s.time)/(l.time-s.time);o=s[i];a=l[i];if(0>r||r>1){console.log("THREE.Animation.update: Warning! Scale out of bounds:"+r+" on bone "+v);r=0>r?0:1}if("pos"===i){n=h.position;if(this.interpolationType===THREE.AnimationHandler.LINEAR){n.x=o[0]+(a[0]-o[0])*r;n.y=o[1]+(a[1]-o[1])*r;n.z=o[2]+(a[2]-o[2])*r}else if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD){this.points[0]=this.getPrevKeyWith("pos",v,s.index-1)["pos"];this.points[1]=o;this.points[2]=a;this.points[3]=this.getNextKeyWith("pos",v,l.index+1)["pos"];r=.33*r+.33;p=this.interpolateCatmullRom(this.points,r);n.x=p[0];n.y=p[1];n.z=p[2];if(this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD){m=this.interpolateCatmullRom(this.points,1.01*r);this.target.set(m[0],m[1],m[2]);this.target.sub(n);this.target.y=0;this.target.normalize();g=Math.atan2(this.target.x,this.target.z);h.rotation.set(0,g,0)}}}else if("rot"===i)THREE.Quaternion.slerp(o,a,h.quaternion,r);else if("scl"===i){n=h.scale;n.x=o[0]+(a[0]-o[0])*r;n.y=o[1]+(a[1]-o[1])*r;n.z=o[2]+(a[2]-o[2])*r}}}}};THREE.Animation.prototype.interpolateCatmullRom=function(e,t){var i,r,n,o,a,s,l,h,c,u=[],f=[];i=(e.length-1)*t;r=Math.floor(i);n=i-r;u[0]=0===r?r:r-1;u[1]=r;u[2]=r>e.length-2?r:r+1;u[3]=r>e.length-3?r:r+2;s=e[u[0]];l=e[u[1]];h=e[u[2]];c=e[u[3]];o=n*n;a=n*o;f[0]=this.interpolate(s[0],l[0],h[0],c[0],n,o,a);f[1]=this.interpolate(s[1],l[1],h[1],c[1],n,o,a);f[2]=this.interpolate(s[2],l[2],h[2],c[2],n,o,a);return f};THREE.Animation.prototype.interpolate=function(e,t,i,r,n,o,a){var s=.5*(i-e),l=.5*(r-t);return(2*(t-i)+s+l)*a+(-3*(t-i)-2*s-l)*o+s*n+t};THREE.Animation.prototype.getNextKeyWith=function(e,t,i){var r=this.data.hierarchy[t].keys;if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)i=i<r.length-1?i:r.length-1;else i%=r.length;for(;i<r.length;i++)if(void 0!==r[i][e])return r[i];return this.data.hierarchy[t].keys[0]};THREE.Animation.prototype.getPrevKeyWith=function(e,t,i){var r=this.data.hierarchy[t].keys;if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)i=i>0?i:0;else i=i>=0?i:i+r.length;for(;i>=0;i--)if(void 0!==r[i][e])return r[i];return this.data.hierarchy[t].keys[r.length-1]};THREE.KeyFrameAnimation=function(e,t,i){this.root=e;this.data=THREE.AnimationHandler.get(t);this.hierarchy=THREE.AnimationHandler.parse(e);this.currentTime=0;this.timeScale=.001;this.isPlaying=!1;this.isPaused=!0;this.loop=!0;this.JITCompile=void 0!==i?i:!0;for(var r=0,n=this.hierarchy.length;n>r;r++){var o=this.data.hierarchy[r].keys,a=this.data.hierarchy[r].sids,s=this.hierarchy[r];if(o.length&&a){for(var l=0;l<a.length;l++){var h=a[l],c=this.getNextKeyWith(h,r,0);if(c)c.apply(h)}s.matrixAutoUpdate=!1;this.data.hierarchy[r].node.updateMatrix();s.matrixWorldNeedsUpdate=!0}}};THREE.KeyFrameAnimation.prototype.play=function(e,t){if(!this.isPlaying){this.isPlaying=!0;this.loop=void 0!==e?e:!0;this.currentTime=void 0!==t?t:0;this.startTimeMs=t;this.startTime=1e7;this.endTime=-this.startTime;var i,r,n,o=this.hierarchy.length;for(i=0;o>i;i++){r=this.hierarchy[i];n=this.data.hierarchy[i];if(void 0===n.animationCache){n.animationCache={};n.animationCache.prevKey=null;n.animationCache.nextKey=null;n.animationCache.originalMatrix=r instanceof THREE.Bone?r.skinMatrix:r.matrix}var a=this.data.hierarchy[i].keys;if(a.length){n.animationCache.prevKey=a[0];n.animationCache.nextKey=a[1];this.startTime=Math.min(a[0].time,this.startTime);this.endTime=Math.max(a[a.length-1].time,this.endTime)}}this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};THREE.KeyFrameAnimation.prototype.pause=function(){if(this.isPaused)THREE.AnimationHandler.addToUpdate(this);else THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};THREE.KeyFrameAnimation.prototype.stop=function(){this.isPlaying=!1;this.isPaused=!1;THREE.AnimationHandler.removeFromUpdate(this);for(var e=0;e<this.data.hierarchy.length;e++){var t=this.hierarchy[e];var i=this.data.hierarchy[e];if(void 0!==i.animationCache){var r=i.animationCache.originalMatrix;if(t instanceof THREE.Bone){r.copy(t.skinMatrix);t.skinMatrix=r}else{r.copy(t.matrix);t.matrix=r}delete i.animationCache}}};THREE.KeyFrameAnimation.prototype.update=function(e){if(this.isPlaying){var t,i;var r;var n;var o;var a=this.data.JIT.hierarchy;var s,l;var h;this.currentTime+=e*this.timeScale;l=this.currentTime;s=this.currentTime=this.currentTime%this.data.length;if(s<this.startTimeMs)s=this.currentTime=this.startTimeMs+s;o=parseInt(Math.min(s*this.data.fps,this.data.length*this.data.fps),10);h=l>s;if(!h||this.loop){if(!(s<this.startTime)){for(var c=0,u=this.hierarchy.length;u>c;c++){r=this.hierarchy[c];n=this.data.hierarchy[c];var f=n.keys,d=n.animationCache;if(this.JITCompile&&void 0!==a[c][o])if(r instanceof THREE.Bone){r.skinMatrix=a[c][o];r.matrixWorldNeedsUpdate=!1}else{r.matrix=a[c][o];r.matrixWorldNeedsUpdate=!0}else if(f.length){if(this.JITCompile&&d)if(r instanceof THREE.Bone)r.skinMatrix=d.originalMatrix;else r.matrix=d.originalMatrix;t=d.prevKey;i=d.nextKey;if(t&&i){if(i.time<=l){if(h&&this.loop){t=f[0];i=f[1];for(;i.time<s;){t=i;i=f[t.index+1]}}else if(!h){var p=f.length-1;for(;i.time<s&&i.index!==p;){t=i;i=f[t.index+1]}}d.prevKey=t;d.nextKey=i}if(i.time>=s)t.interpolate(i,s);else t.interpolate(i,i.time)}this.data.hierarchy[c].node.updateMatrix();r.matrixWorldNeedsUpdate=!0}}if(this.JITCompile)if(void 0===a[0][o]){this.hierarchy[0].updateMatrixWorld(!0);for(var c=0;c<this.hierarchy.length;c++)if(this.hierarchy[c]instanceof THREE.Bone)a[c][o]=this.hierarchy[c].skinMatrix.clone();else a[c][o]=this.hierarchy[c].matrix.clone()}}}else{for(var c=0,u=this.hierarchy.length;u>c;c++){var f=this.data.hierarchy[c].keys,m=this.data.hierarchy[c].sids,g=f.length-1,v=this.hierarchy[c];if(f.length){for(var E=0;E<m.length;E++){var y=m[E],T=this.getPrevKeyWith(y,c,g);if(T)T.apply(y)}this.data.hierarchy[c].node.updateMatrix();v.matrixWorldNeedsUpdate=!0}}this.stop()}}};THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(e,t,i){var r=this.data.hierarchy[t].keys;i%=r.length;for(;i<r.length;i++)if(r[i].hasTarget(e))return r[i];return r[0]};THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(e,t,i){var r=this.data.hierarchy[t].keys;i=i>=0?i:i+r.length;for(;i>=0;i--)if(r[i].hasTarget(e))return r[i];return r[r.length-1]};THREE.CubeCamera=function(e,t,i){THREE.Object3D.call(this);var r=90,n=1;var o=new THREE.PerspectiveCamera(r,n,e,t);o.up.set(0,-1,0);o.lookAt(new THREE.Vector3(1,0,0));this.add(o);var a=new THREE.PerspectiveCamera(r,n,e,t);a.up.set(0,-1,0);a.lookAt(new THREE.Vector3(-1,0,0));this.add(a);var s=new THREE.PerspectiveCamera(r,n,e,t);s.up.set(0,0,1);s.lookAt(new THREE.Vector3(0,1,0));this.add(s);var l=new THREE.PerspectiveCamera(r,n,e,t);l.up.set(0,0,-1);l.lookAt(new THREE.Vector3(0,-1,0));this.add(l);var h=new THREE.PerspectiveCamera(r,n,e,t);h.up.set(0,-1,0);h.lookAt(new THREE.Vector3(0,0,1));this.add(h);var c=new THREE.PerspectiveCamera(r,n,e,t);c.up.set(0,-1,0);c.lookAt(new THREE.Vector3(0,0,-1));this.add(c);this.renderTarget=new THREE.WebGLRenderTargetCube(i,i,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter});this.updateCubeMap=function(e,t){var i=this.renderTarget;var r=i.generateMipmaps;i.generateMipmaps=!1;i.activeCubeFace=0;e.render(t,o,i);i.activeCubeFace=1;e.render(t,a,i);i.activeCubeFace=2;e.render(t,s,i);i.activeCubeFace=3;e.render(t,l,i);i.activeCubeFace=4;e.render(t,h,i);i.generateMipmaps=r;i.activeCubeFace=5;e.render(t,c,i)}};THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype);THREE.CombinedCamera=function(e,t,i,r,n,o,a){THREE.Camera.call(this);this.fov=i;this.left=-e/2;this.right=e/2;this.top=t/2;this.bottom=-t/2;this.cameraO=new THREE.OrthographicCamera(e/-2,e/2,t/2,t/-2,o,a);this.cameraP=new THREE.PerspectiveCamera(i,e/t,r,n);this.zoom=1;this.toPerspective()};THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype);THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near;this.far=this.cameraP.far;this.cameraP.fov=this.fov/this.zoom;this.cameraP.updateProjectionMatrix();this.projectionMatrix=this.cameraP.projectionMatrix;this.inPerspectiveMode=!0;this.inOrthographicMode=!1};THREE.CombinedCamera.prototype.toOrthographic=function(){var e=this.fov;var t=this.cameraP.aspect;var i=this.cameraP.near;var r=this.cameraP.far;var n=(i+r)/2;var o=Math.tan(e/2)*n;var a=2*o;var s=a*t;var l=s/2;o/=this.zoom;l/=this.zoom;this.cameraO.left=-l;this.cameraO.right=l;this.cameraO.top=o;this.cameraO.bottom=-o;this.cameraO.updateProjectionMatrix();this.near=this.cameraO.near;this.far=this.cameraO.far;this.projectionMatrix=this.cameraO.projectionMatrix;this.inPerspectiveMode=!1;this.inOrthographicMode=!0};THREE.CombinedCamera.prototype.setSize=function(e,t){this.cameraP.aspect=e/t;this.left=-e/2;this.right=e/2;this.top=t/2;this.bottom=-t/2};THREE.CombinedCamera.prototype.setFov=function(e){this.fov=e;if(this.inPerspectiveMode)this.toPerspective();else this.toOrthographic()};THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){if(this.inPerspectiveMode)this.toPerspective();else{this.toPerspective();this.toOrthographic()}};THREE.CombinedCamera.prototype.setLens=function(e,t){if(void 0===t)t=24;var i=2*THREE.Math.radToDeg(Math.atan(t/(2*e)));this.setFov(i);return i};THREE.CombinedCamera.prototype.setZoom=function(e){this.zoom=e;if(this.inPerspectiveMode)this.toPerspective();else this.toOrthographic()};THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0;this.rotation.y=Math.PI;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0;this.rotation.y=-Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0;this.rotation.y=Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CircleGeometry=function(e,t,i,r){THREE.Geometry.call(this);e=e||50;i=void 0!==i?i:0;r=void 0!==r?r:2*Math.PI;t=void 0!==t?Math.max(3,t):8;var n,o=[],a=new THREE.Vector3,s=new THREE.Vector2(.5,.5);this.vertices.push(a);o.push(s);for(n=0;t>=n;n++){var l=new THREE.Vector3;var h=i+n/t*r;l.x=e*Math.cos(h);l.y=e*Math.sin(h);this.vertices.push(l);o.push(new THREE.Vector2((l.x/e+1)/2,(l.y/e+1)/2))}var c=new THREE.Vector3(0,0,1);for(n=1;t>=n;n++){var u=n;var f=n+1;var d=0;this.faces.push(new THREE.Face3(u,f,d,[c,c,c]));this.faceVertexUvs[0].push([o[n],o[n+1],s])
}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,e)};THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CubeGeometry=function(e,t,i,r,n,o){function a(e,t,i,r,n,o,a,l){var h,c,u,f=s.widthSegments,d=s.heightSegments,p=n/2,m=o/2,g=s.vertices.length;if("x"===e&&"y"===t||"y"===e&&"x"===t)h="z";else if("x"===e&&"z"===t||"z"===e&&"x"===t){h="y";d=s.depthSegments}else if("z"===e&&"y"===t||"y"===e&&"z"===t){h="x";f=s.depthSegments}var v=f+1,E=d+1,y=n/f,T=o/d,_=new THREE.Vector3;_[h]=a>0?1:-1;for(u=0;E>u;u++)for(c=0;v>c;c++){var b=new THREE.Vector3;b[e]=(c*y-p)*i;b[t]=(u*T-m)*r;b[h]=a;s.vertices.push(b)}for(u=0;d>u;u++)for(c=0;f>c;c++){var x=c+v*u;var R=c+v*(u+1);var w=c+1+v*(u+1);var H=c+1+v*u;var M=new THREE.Face4(x+g,R+g,w+g,H+g);M.normal.copy(_);M.vertexNormals.push(_.clone(),_.clone(),_.clone(),_.clone());M.materialIndex=l;s.faces.push(M);s.faceVertexUvs[0].push([new THREE.Vector2(c/f,1-u/d),new THREE.Vector2(c/f,1-(u+1)/d),new THREE.Vector2((c+1)/f,1-(u+1)/d),new THREE.Vector2((c+1)/f,1-u/d)])}}THREE.Geometry.call(this);var s=this;this.width=e;this.height=t;this.depth=i;this.widthSegments=r||1;this.heightSegments=n||1;this.depthSegments=o||1;var l=this.width/2;var h=this.height/2;var c=this.depth/2;a("z","y",-1,-1,this.depth,this.height,l,0);a("z","y",1,-1,this.depth,this.height,-l,1);a("x","z",1,1,this.width,this.depth,h,2);a("x","z",1,-1,this.width,this.depth,-h,3);a("x","y",1,-1,this.width,this.height,c,4);a("x","y",-1,-1,this.width,this.height,-c,5);this.computeCentroids();this.mergeVertices()};THREE.CubeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CylinderGeometry=function(e,t,i,r,n,o){THREE.Geometry.call(this);this.radiusTop=e=void 0!==e?e:20;this.radiusBottom=t=void 0!==t?t:20;this.height=i=void 0!==i?i:100;this.radialSegments=r=r||8;this.heightSegments=n=n||1;this.openEnded=o=void 0!==o?o:!1;var a=i/2;var s,l,h=[],c=[];for(l=0;n>=l;l++){var u=[];var f=[];var d=l/n;var p=d*(t-e)+e;for(s=0;r>=s;s++){var m=s/r;var g=new THREE.Vector3;g.x=p*Math.sin(2*m*Math.PI);g.y=-d*i+a;g.z=p*Math.cos(2*m*Math.PI);this.vertices.push(g);u.push(this.vertices.length-1);f.push(new THREE.Vector2(m,1-d))}h.push(u);c.push(f)}var v=(t-e)/i;var E,y;for(s=0;r>s;s++){if(0!==e){E=this.vertices[h[0][s]].clone();y=this.vertices[h[0][s+1]].clone()}else{E=this.vertices[h[1][s]].clone();y=this.vertices[h[1][s+1]].clone()}E.setY(Math.sqrt(E.x*E.x+E.z*E.z)*v).normalize();y.setY(Math.sqrt(y.x*y.x+y.z*y.z)*v).normalize();for(l=0;n>l;l++){var T=h[l][s];var _=h[l+1][s];var b=h[l+1][s+1];var x=h[l][s+1];var R=E.clone();var w=E.clone();var H=y.clone();var M=y.clone();var S=c[l][s].clone();var C=c[l+1][s].clone();var A=c[l+1][s+1].clone();var D=c[l][s+1].clone();this.faces.push(new THREE.Face4(T,_,b,x,[R,w,H,M]));this.faceVertexUvs[0].push([S,C,A,D])}}if(o===!1&&e>0){this.vertices.push(new THREE.Vector3(0,a,0));for(s=0;r>s;s++){var T=h[0][s];var _=h[0][s+1];var b=this.vertices.length-1;var R=new THREE.Vector3(0,1,0);var w=new THREE.Vector3(0,1,0);var H=new THREE.Vector3(0,1,0);var S=c[0][s].clone();var C=c[0][s+1].clone();var A=new THREE.Vector2(C.u,0);this.faces.push(new THREE.Face3(T,_,b,[R,w,H]));this.faceVertexUvs[0].push([S,C,A])}}if(o===!1&&t>0){this.vertices.push(new THREE.Vector3(0,-a,0));for(s=0;r>s;s++){var T=h[l][s+1];var _=h[l][s];var b=this.vertices.length-1;var R=new THREE.Vector3(0,-1,0);var w=new THREE.Vector3(0,-1,0);var H=new THREE.Vector3(0,-1,0);var S=c[l][s+1].clone();var C=c[l][s].clone();var A=new THREE.Vector2(C.u,1);this.faces.push(new THREE.Face3(T,_,b,[R,w,H]));this.faceVertexUvs[0].push([S,C,A])}}this.computeCentroids();this.computeFaceNormals()};THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry=function(e,t){if("undefined"!=typeof e){THREE.Geometry.call(this);e=e instanceof Array?e:[e];this.shapebb=e[e.length-1].getBoundingBox();this.addShapeList(e,t);this.computeCentroids();this.computeFaceNormals()}else e=[]};THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry.prototype.addShapeList=function(e,t){var i=e.length;for(var r=0;i>r;r++){var n=e[r];this.addShape(n,t)}};THREE.ExtrudeGeometry.prototype.addShape=function(e,t){function i(e,t,i){if(!t)console.log("die");return t.clone().multiplyScalar(i).add(e)}function r(e,t,i){return o(e,t,i)}function n(e,t,i){var r=Math.atan2(t.y-e.y,t.x-e.x);var n=Math.atan2(i.y-e.y,i.x-e.x);if(r>n)n+=2*Math.PI;var o=(r+n)/2;var a=-Math.cos(o);var s=-Math.sin(o);var l=new THREE.Vector2(a,s);return l}function o(e,t,i){var r,o,a,s,l,h,c=THREE.ExtrudeGeometry.__v1,u=THREE.ExtrudeGeometry.__v2,f=THREE.ExtrudeGeometry.__v3,d=THREE.ExtrudeGeometry.__v4,p=THREE.ExtrudeGeometry.__v5,m=THREE.ExtrudeGeometry.__v6;c.set(e.x-t.x,e.y-t.y);u.set(e.x-i.x,e.y-i.y);r=c.normalize();o=u.normalize();f.set(-r.y,r.x);d.set(o.y,-o.x);p.copy(e).add(f);m.copy(e).add(d);if(p.equals(m))return d.clone();p.copy(t).add(f);m.copy(i).add(d);a=r.dot(d);s=m.sub(p).dot(d);if(0===a){console.log("Either infinite or no solutions!");if(0===s)console.log("Its finite solutions.");else console.log("Too bad, no solutions.")}l=s/a;if(0>l)return n(e,t,i);h=r.multiplyScalar(l).add(p);return h.sub(e).clone()}function a(){if(g){var e=0;var t=X*e;for(K=0;Y>K;K++){G=I[K];c(G[2]+t,G[1]+t,G[0]+t,!0)}e=E+2*m;t=X*e;for(K=0;Y>K;K++){G=I[K];c(G[0]+t,G[1]+t,G[2]+t,!1)}}else{for(K=0;Y>K;K++){G=I[K];c(G[2],G[1],G[0],!0)}for(K=0;Y>K;K++){G=I[K];c(G[0]+X*E,G[1]+X*E,G[2]+X*E,!1)}}}function s(){var e=0;l(O,e);e+=O.length;for(A=0,D=z.length;D>A;A++){C=z[A];l(C,e);e+=C.length}}function l(e,t){var i,r;K=e.length;for(;--K>=0;){i=K;r=K-1;if(0>r)r=e.length-1;var n=0,o=E+2*m;for(n=0;o>n;n++){var a=X*n;var s=X*(n+1);var l=t+i+a,h=t+r+a,c=t+r+s,f=t+i+s;u(l,h,c,f,e,n,o,i,r)}}}function h(e,t,i){P.vertices.push(new THREE.Vector3(e,t,i))}function c(i,r,n,o){i+=k;r+=k;n+=k;P.faces.push(new THREE.Face3(i,r,n,null,null,b));var a=o?R.generateBottomUV(P,e,t,i,r,n):R.generateTopUV(P,e,t,i,r,n);P.faceVertexUvs[0].push(a)}function u(i,r,n,o,a,s,l,h,c){i+=k;r+=k;n+=k;o+=k;P.faces.push(new THREE.Face4(i,r,n,o,null,null,x));var u=R.generateSideWallUV(P,e,a,t,i,r,n,o,s,l,h,c);P.faceVertexUvs[0].push(u)}var f=void 0!==t.amount?t.amount:100;var d=void 0!==t.bevelThickness?t.bevelThickness:6;var p=void 0!==t.bevelSize?t.bevelSize:d-2;var m=void 0!==t.bevelSegments?t.bevelSegments:3;var g=void 0!==t.bevelEnabled?t.bevelEnabled:!0;var v=void 0!==t.curveSegments?t.curveSegments:12;var E=void 0!==t.steps?t.steps:1;var y=t.extrudePath;var T,_=!1;var b=t.material;var x=t.extrudeMaterial;var R=void 0!==t.UVGenerator?t.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator;this.shapebb;var w,H,M,S;if(y){T=y.getSpacedPoints(E);_=!0;g=!1;w=void 0!==t.frames?t.frames:new THREE.TubeGeometry.FrenetFrames(y,E,!1);H=new THREE.Vector3;M=new THREE.Vector3;S=new THREE.Vector3}if(!g){m=0;d=0;p=0}var C,A,D;var P=this;var k=this.vertices.length;var L=e.extractPoints(v);var F=L.shape;var z=L.holes;var N=!THREE.Shape.Utils.isClockWise(F);if(N){F=F.reverse();for(A=0,D=z.length;D>A;A++){C=z[A];if(THREE.Shape.Utils.isClockWise(C))z[A]=C.reverse()}N=!1}var I=THREE.Shape.Utils.triangulateShape(F,z);var O=F;for(A=0,D=z.length;D>A;A++){C=z[A];F=F.concat(C)}var U,V,B,j,W,G,X=F.length,Y=I.length;O.length;180/Math.PI;var q=[];for(var K=0,Q=O.length,Z=Q-1,$=K+1;Q>K;K++,Z++,$++){if(Z===Q)Z=0;if($===Q)$=0;O[K];O[Z];O[$];q[K]=r(O[K],O[Z],O[$])}var J,et=[],tt=q.concat();for(A=0,D=z.length;D>A;A++){C=z[A];J=[];for(K=0,Q=C.length,Z=Q-1,$=K+1;Q>K;K++,Z++,$++){if(Z===Q)Z=0;if($===Q)$=0;J[K]=r(C[K],C[Z],C[$])}et.push(J);tt=tt.concat(J)}for(U=0;m>U;U++){B=U/m;j=d*(1-B);V=p*Math.sin(B*Math.PI/2);for(K=0,Q=O.length;Q>K;K++){W=i(O[K],q[K],V);h(W.x,W.y,-j)}for(A=0,D=z.length;D>A;A++){C=z[A];J=et[A];for(K=0,Q=C.length;Q>K;K++){W=i(C[K],J[K],V);h(W.x,W.y,-j)}}}V=p;for(K=0;X>K;K++){W=g?i(F[K],tt[K],V):F[K];if(!_)h(W.x,W.y,0);else{M.copy(w.normals[0]).multiplyScalar(W.x);H.copy(w.binormals[0]).multiplyScalar(W.y);S.copy(T[0]).add(M).add(H);h(S.x,S.y,S.z)}}var it;for(it=1;E>=it;it++)for(K=0;X>K;K++){W=g?i(F[K],tt[K],V):F[K];if(!_)h(W.x,W.y,f/E*it);else{M.copy(w.normals[it]).multiplyScalar(W.x);H.copy(w.binormals[it]).multiplyScalar(W.y);S.copy(T[it]).add(M).add(H);h(S.x,S.y,S.z)}}for(U=m-1;U>=0;U--){B=U/m;j=d*(1-B);V=p*Math.sin(B*Math.PI/2);for(K=0,Q=O.length;Q>K;K++){W=i(O[K],q[K],V);h(W.x,W.y,f+j)}for(A=0,D=z.length;D>A;A++){C=z[A];J=et[A];for(K=0,Q=C.length;Q>K;K++){W=i(C[K],J[K],V);if(!_)h(W.x,W.y,f+j);else h(W.x,W.y+T[E-1].y,T[E-1].x+j)}}}a();s()};THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(e,t,i,r,n,o){var a=e.vertices[r].x,s=e.vertices[r].y,l=e.vertices[n].x,h=e.vertices[n].y,c=e.vertices[o].x,u=e.vertices[o].y;return[new THREE.Vector2(a,s),new THREE.Vector2(l,h),new THREE.Vector2(c,u)]},generateBottomUV:function(e,t,i,r,n,o){return this.generateTopUV(e,t,i,r,n,o)},generateSideWallUV:function(e,t,i,r,n,o,a,s){var l=e.vertices[n].x,h=e.vertices[n].y,c=e.vertices[n].z,u=e.vertices[o].x,f=e.vertices[o].y,d=e.vertices[o].z,p=e.vertices[a].x,m=e.vertices[a].y,g=e.vertices[a].z,v=e.vertices[s].x,E=e.vertices[s].y,y=e.vertices[s].z;if(Math.abs(h-f)<.01)return[new THREE.Vector2(l,1-c),new THREE.Vector2(u,1-d),new THREE.Vector2(p,1-g),new THREE.Vector2(v,1-y)];else return[new THREE.Vector2(h,1-c),new THREE.Vector2(f,1-d),new THREE.Vector2(m,1-g),new THREE.Vector2(E,1-y)]}};THREE.ExtrudeGeometry.__v1=new THREE.Vector2;THREE.ExtrudeGeometry.__v2=new THREE.Vector2;THREE.ExtrudeGeometry.__v3=new THREE.Vector2;THREE.ExtrudeGeometry.__v4=new THREE.Vector2;THREE.ExtrudeGeometry.__v5=new THREE.Vector2;THREE.ExtrudeGeometry.__v6=new THREE.Vector2;THREE.ShapeGeometry=function(e,t){THREE.Geometry.call(this);if(e instanceof Array==!1)e=[e];this.shapebb=e[e.length-1].getBoundingBox();this.addShapeList(e,t);this.computeCentroids();this.computeFaceNormals()};THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ShapeGeometry.prototype.addShapeList=function(e,t){for(var i=0,r=e.length;r>i;i++)this.addShape(e[i],t);return this};THREE.ShapeGeometry.prototype.addShape=function(e,t){if(void 0===t)t={};var i=void 0!==t.curveSegments?t.curveSegments:12;var r=t.material;var n=void 0===t.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:t.UVGenerator;this.shapebb;var o,a,s;var l=this.vertices.length;var h=e.extractPoints(i);var c=h.shape;var u=h.holes;var f=!THREE.Shape.Utils.isClockWise(c);if(f){c=c.reverse();for(o=0,a=u.length;a>o;o++){s=u[o];if(THREE.Shape.Utils.isClockWise(s))u[o]=s.reverse()}f=!1}var d=THREE.Shape.Utils.triangulateShape(c,u);var p=c;for(o=0,a=u.length;a>o;o++){s=u[o];c=c.concat(s)}var m,g=c.length;var v,E=d.length;p.length;for(o=0;g>o;o++){m=c[o];this.vertices.push(new THREE.Vector3(m.x,m.y,0))}for(o=0;E>o;o++){v=d[o];var y=v[0]+l;var T=v[1]+l;var _=v[2]+l;this.faces.push(new THREE.Face3(y,T,_,null,null,r));this.faceVertexUvs[0].push(n.generateBottomUV(this,e,t,y,T,_))}};THREE.LatheGeometry=function(e,t,i,r){THREE.Geometry.call(this);t=t||12;i=i||0;r=r||2*Math.PI;var n=1/(e.length-1);var o=1/t;for(var a=0,s=t;s>=a;a++){var l=i+a*o*r;var h=Math.cos(l),c=Math.sin(l);for(var u=0,f=e.length;f>u;u++){var d=e[u];var p=new THREE.Vector3;p.x=h*d.x-c*d.y;p.y=c*d.x+h*d.y;p.z=d.z;this.vertices.push(p)}}var m=e.length;for(var a=0,s=t;s>a;a++)for(var u=0,f=e.length-1;f>u;u++){var g=u+m*a;var v=g;var E=g+m;var h=g+1+m;var y=g+1;this.faces.push(new THREE.Face4(v,E,h,y));var T=a*o;var _=u*n;var b=T+o;var x=_+n;this.faceVertexUvs[0].push([new THREE.Vector2(T,_),new THREE.Vector2(b,_),new THREE.Vector2(b,x),new THREE.Vector2(T,x)])}this.mergeVertices();this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.PlaneGeometry=function(e,t,i,r){THREE.Geometry.call(this);this.width=e;this.height=t;this.widthSegments=i||1;this.heightSegments=r||1;var n,o;var a=e/2;var s=t/2;var l=this.widthSegments;var h=this.heightSegments;var c=l+1;var u=h+1;var f=this.width/l;var d=this.height/h;var p=new THREE.Vector3(0,0,1);for(o=0;u>o;o++)for(n=0;c>n;n++){var m=n*f-a;var g=o*d-s;this.vertices.push(new THREE.Vector3(m,-g,0))}for(o=0;h>o;o++)for(n=0;l>n;n++){var v=n+c*o;var E=n+c*(o+1);var y=n+1+c*(o+1);var T=n+1+c*o;var _=new THREE.Face4(v,E,y,T);_.normal.copy(p);_.vertexNormals.push(p.clone(),p.clone(),p.clone(),p.clone());this.faces.push(_);this.faceVertexUvs[0].push([new THREE.Vector2(n/l,1-o/h),new THREE.Vector2(n/l,1-(o+1)/h),new THREE.Vector2((n+1)/l,1-(o+1)/h),new THREE.Vector2((n+1)/l,1-o/h)])}this.computeCentroids()};THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.RingGeometry=function(e,t,i,r,n,o){THREE.Geometry.call(this);e=e||0;t=t||50;n=void 0!==n?n:0;o=void 0!==o?o:2*Math.PI;i=void 0!==i?Math.max(3,i):8;r=void 0!==r?Math.max(3,r):8;var a,s,l=[],h=e,c=(t-e)/r;for(a=0;r>=a;a++){for(s=0;i>=s;s++){var u=new THREE.Vector3;var f=n+s/i*o;u.x=h*Math.cos(f);u.y=h*Math.sin(f);this.vertices.push(u);l.push(new THREE.Vector2((u.x/h+1)/2,-(u.y/h+1)/2+1))}h+=c}var d=new THREE.Vector3(0,0,1);for(a=0;r>a;a++){var p=a*i;for(s=0;i>=s;s++){var f=s+p;var m=f+a;var g=f+i+a;var v=f+i+1+a;this.faces.push(new THREE.Face3(m,g,v,[d,d,d]));this.faceVertexUvs[0].push([l[m],l[g],l[v]]);m=f+a;g=f+i+1+a;v=f+1+a;this.faces.push(new THREE.Face3(m,g,v,[d,d,d]));this.faceVertexUvs[0].push([l[m],l[g],l[v]])}}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,h)};THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.SphereGeometry=function(e,t,i,r,n,o,a){THREE.Geometry.call(this);this.radius=e=e||50;this.widthSegments=t=Math.max(3,Math.floor(t)||8);this.heightSegments=i=Math.max(2,Math.floor(i)||6);this.phiStart=r=void 0!==r?r:0;this.phiLength=n=void 0!==n?n:2*Math.PI;this.thetaStart=o=void 0!==o?o:0;this.thetaLength=a=void 0!==a?a:Math.PI;var s,l,h=[],c=[];for(l=0;i>=l;l++){var u=[];var f=[];for(s=0;t>=s;s++){var d=s/t;var p=l/i;var m=new THREE.Vector3;m.x=-e*Math.cos(r+d*n)*Math.sin(o+p*a);m.y=e*Math.cos(o+p*a);m.z=e*Math.sin(r+d*n)*Math.sin(o+p*a);this.vertices.push(m);u.push(this.vertices.length-1);f.push(new THREE.Vector2(d,1-p))}h.push(u);c.push(f)}for(l=0;l<this.heightSegments;l++)for(s=0;s<this.widthSegments;s++){var g=h[l][s+1];var v=h[l][s];var E=h[l+1][s];var y=h[l+1][s+1];var T=this.vertices[g].clone().normalize();var _=this.vertices[v].clone().normalize();var b=this.vertices[E].clone().normalize();var x=this.vertices[y].clone().normalize();var R=c[l][s+1].clone();var w=c[l][s].clone();var H=c[l+1][s].clone();var M=c[l+1][s+1].clone();if(Math.abs(this.vertices[g].y)===this.radius){this.faces.push(new THREE.Face3(g,E,y,[T,b,x]));this.faceVertexUvs[0].push([R,H,M])}else if(Math.abs(this.vertices[E].y)===this.radius){this.faces.push(new THREE.Face3(g,v,E,[T,_,b]));this.faceVertexUvs[0].push([R,w,H])}else{this.faces.push(new THREE.Face4(g,v,E,y,[T,_,b,x]));this.faceVertexUvs[0].push([R,w,H,M])}}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,e)};THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TextGeometry=function(e,t){t=t||{};var i=THREE.FontUtils.generateShapes(e,t);t.amount=void 0!==t.height?t.height:50;if(void 0===t.bevelThickness)t.bevelThickness=10;if(void 0===t.bevelSize)t.bevelSize=8;if(void 0===t.bevelEnabled)t.bevelEnabled=!1;THREE.ExtrudeGeometry.call(this,i,t)};THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype);THREE.TorusGeometry=function(e,t,i,r,n){THREE.Geometry.call(this);this.radius=e||100;this.tube=t||40;this.radialSegments=i||8;this.tubularSegments=r||6;this.arc=n||2*Math.PI;var o=new THREE.Vector3,a=[],s=[];for(var l=0;l<=this.radialSegments;l++)for(var h=0;h<=this.tubularSegments;h++){var c=h/this.tubularSegments*this.arc;var u=2*l/this.radialSegments*Math.PI;o.x=this.radius*Math.cos(c);o.y=this.radius*Math.sin(c);var f=new THREE.Vector3;f.x=(this.radius+this.tube*Math.cos(u))*Math.cos(c);f.y=(this.radius+this.tube*Math.cos(u))*Math.sin(c);f.z=this.tube*Math.sin(u);this.vertices.push(f);a.push(new THREE.Vector2(h/this.tubularSegments,l/this.radialSegments));s.push(f.clone().sub(o).normalize())}for(var l=1;l<=this.radialSegments;l++)for(var h=1;h<=this.tubularSegments;h++){var d=(this.tubularSegments+1)*l+h-1;var p=(this.tubularSegments+1)*(l-1)+h-1;var m=(this.tubularSegments+1)*(l-1)+h;var g=(this.tubularSegments+1)*l+h;var v=new THREE.Face4(d,p,m,g,[s[d],s[p],s[m],s[g]]);v.normal.add(s[d]);v.normal.add(s[p]);v.normal.add(s[m]);v.normal.add(s[g]);v.normal.normalize();this.faces.push(v);this.faceVertexUvs[0].push([a[d].clone(),a[p].clone(),a[m].clone(),a[g].clone()])}this.computeCentroids()};THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TorusKnotGeometry=function(e,t,i,r,n,o,a){function s(e,t,i,r,n){var o=Math.cos(e);var a=Math.sin(e);var s=t/i*e;var l=Math.cos(s);var h=.5*r*(2+l)*o;var c=.5*r*(2+l)*a;var u=.5*n*r*Math.sin(s);return new THREE.Vector3(h,c,u)}THREE.Geometry.call(this);var l=this;this.radius=e||100;this.tube=t||40;this.radialSegments=i||64;this.tubularSegments=r||8;this.p=n||2;this.q=o||3;this.heightScale=a||1;this.grid=new Array(this.radialSegments);var h=new THREE.Vector3;var c=new THREE.Vector3;var u=new THREE.Vector3;for(var f=0;f<this.radialSegments;++f){this.grid[f]=new Array(this.tubularSegments);var d=2*(f/this.radialSegments)*this.p*Math.PI;var p=s(d,this.q,this.p,this.radius,this.heightScale);var m=s(d+.01,this.q,this.p,this.radius,this.heightScale);h.subVectors(m,p);c.addVectors(m,p);u.crossVectors(h,c);c.crossVectors(u,h);u.normalize();c.normalize();for(var g=0;g<this.tubularSegments;++g){var v=2*(g/this.tubularSegments)*Math.PI;var E=-this.tube*Math.cos(v);var y=this.tube*Math.sin(v);var T=new THREE.Vector3;T.x=p.x+E*c.x+y*u.x;T.y=p.y+E*c.y+y*u.y;T.z=p.z+E*c.z+y*u.z;this.grid[f][g]=l.vertices.push(T)-1}}for(var f=0;f<this.radialSegments;++f)for(var g=0;g<this.tubularSegments;++g){var _=(f+1)%this.radialSegments;var b=(g+1)%this.tubularSegments;var x=this.grid[f][g];var R=this.grid[_][g];var w=this.grid[_][b];var H=this.grid[f][b];var M=new THREE.Vector2(f/this.radialSegments,g/this.tubularSegments);var S=new THREE.Vector2((f+1)/this.radialSegments,g/this.tubularSegments);var C=new THREE.Vector2((f+1)/this.radialSegments,(g+1)/this.tubularSegments);var A=new THREE.Vector2(f/this.radialSegments,(g+1)/this.tubularSegments);this.faces.push(new THREE.Face4(x,R,w,H));this.faceVertexUvs[0].push([M,S,C,A])}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TubeGeometry=function(e,t,i,r,n){function o(e,t,i){return H.vertices.push(new THREE.Vector3(e,t,i))-1}THREE.Geometry.call(this);this.path=e;this.segments=t||64;this.radius=i||1;this.radialSegments=r||8;this.closed=n||!1;this.grid=[];var a,s,l,h,c,u,f,d,p,m,g,v,E,y,T,_,b,x,R,w,H=this,M=this.segments+1,S=new THREE.Vector3;var C=new THREE.TubeGeometry.FrenetFrames(this.path,this.segments,this.closed),A=C.tangents,D=C.normals,P=C.binormals;this.tangents=A;this.normals=D;this.binormals=P;for(p=0;M>p;p++){this.grid[p]=[];h=p/(M-1);d=e.getPointAt(h);a=A[p];s=D[p];l=P[p];for(m=0;m<this.radialSegments;m++){c=2*(m/this.radialSegments)*Math.PI;u=-this.radius*Math.cos(c);f=this.radius*Math.sin(c);S.copy(d);S.x+=u*s.x+f*l.x;S.y+=u*s.y+f*l.y;S.z+=u*s.z+f*l.z;this.grid[p][m]=o(S.x,S.y,S.z)}}for(p=0;p<this.segments;p++)for(m=0;m<this.radialSegments;m++){g=this.closed?(p+1)%this.segments:p+1;v=(m+1)%this.radialSegments;E=this.grid[p][m];y=this.grid[g][m];T=this.grid[g][v];_=this.grid[p][v];b=new THREE.Vector2(p/this.segments,m/this.radialSegments);x=new THREE.Vector2((p+1)/this.segments,m/this.radialSegments);R=new THREE.Vector2((p+1)/this.segments,(m+1)/this.radialSegments);w=new THREE.Vector2(p/this.segments,(m+1)/this.radialSegments);this.faces.push(new THREE.Face4(E,y,T,_));this.faceVertexUvs[0].push([b,x,R,w])}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TubeGeometry.FrenetFrames=function(e,t,i){function r(){d[0]=new THREE.Vector3;p[0]=new THREE.Vector3;o=Number.MAX_VALUE;a=Math.abs(f[0].x);s=Math.abs(f[0].y);l=Math.abs(f[0].z);if(o>=a){o=a;u.set(1,0,0)}if(o>=s){o=s;u.set(0,1,0)}if(o>=l)u.set(0,0,1);m.crossVectors(f[0],u).normalize();d[0].crossVectors(f[0],m);p[0].crossVectors(f[0],d[0])}var n,o,a,s,l,h,c,u=(new THREE.Vector3,new THREE.Vector3),f=(new THREE.Vector3,[]),d=[],p=[],m=new THREE.Vector3,g=new THREE.Matrix4,v=t+1,E=1e-4;this.tangents=f;this.normals=d;this.binormals=p;for(h=0;v>h;h++){c=h/(v-1);f[h]=e.getTangentAt(c);f[h].normalize()}r();for(h=1;v>h;h++){d[h]=d[h-1].clone();p[h]=p[h-1].clone();m.crossVectors(f[h-1],f[h]);if(m.length()>E){m.normalize();n=Math.acos(THREE.Math.clamp(f[h-1].dot(f[h]),-1,1));d[h].applyMatrix4(g.makeRotationAxis(m,n))}p[h].crossVectors(f[h],d[h])}if(i){n=Math.acos(THREE.Math.clamp(d[0].dot(d[v-1]),-1,1));n/=v-1;if(f[0].dot(m.crossVectors(d[0],d[v-1]))>0)n=-n;for(h=1;v>h;h++){d[h].applyMatrix4(g.makeRotationAxis(f[h],n*h));p[h].crossVectors(f[h],d[h])}}};THREE.PolyhedronGeometry=function(e,t,i,r){function n(e){var t=e.normalize().clone();t.index=c.vertices.push(t)-1;var i=s(e)/2/Math.PI+.5;var r=l(e)/Math.PI+.5;t.uv=new THREE.Vector2(i,1-r);return t}function o(e,t,i){var r=new THREE.Face3(e.index,t.index,i.index,[e.clone(),t.clone(),i.clone()]);r.centroid.add(e).add(t).add(i).divideScalar(3);c.faces.push(r);var n=s(r.centroid);c.faceVertexUvs[0].push([h(e.uv,e,n),h(t.uv,t,n),h(i.uv,i,n)])}function a(e,t){var i=Math.pow(2,t);Math.pow(4,t);var r=n(c.vertices[e.a]);var a=n(c.vertices[e.b]);var s=n(c.vertices[e.c]);var l=[];for(var h=0;i>=h;h++){l[h]=[];var u=n(r.clone().lerp(s,h/i));var f=n(a.clone().lerp(s,h/i));var d=i-h;for(var p=0;d>=p;p++)if(0==p&&h==i)l[h][p]=u;else l[h][p]=n(u.clone().lerp(f,p/d))}for(var h=0;i>h;h++)for(var p=0;2*(i-h)-1>p;p++){var m=Math.floor(p/2);if(0==p%2)o(l[h][m+1],l[h+1][m],l[h][m]);else o(l[h][m+1],l[h+1][m+1],l[h+1][m])}}function s(e){return Math.atan2(e.z,-e.x)}function l(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}function h(e,t,i){if(0>i&&1===e.x)e=new THREE.Vector2(e.x-1,e.y);if(0===t.x&&0===t.z)e=new THREE.Vector2(i/2/Math.PI+.5,e.y);return e.clone()}THREE.Geometry.call(this);i=i||1;r=r||0;var c=this;for(var u=0,f=e.length;f>u;u++)n(new THREE.Vector3(e[u][0],e[u][1],e[u][2]));var d=this.vertices;var p=[];for(var u=0,f=t.length;f>u;u++){var m=d[t[u][0]];var g=d[t[u][1]];var v=d[t[u][2]];p[u]=new THREE.Face3(m.index,g.index,v.index,[m.clone(),g.clone(),v.clone()])}for(var u=0,f=p.length;f>u;u++)a(p[u],r);for(var u=0,f=this.faceVertexUvs[0].length;f>u;u++){var E=this.faceVertexUvs[0][u];var y=E[0].x;var T=E[1].x;var _=E[2].x;var b=Math.max(y,Math.max(T,_));var x=Math.min(y,Math.min(T,_));if(b>.9&&.1>x){if(.2>y)E[0].x+=1;if(.2>T)E[1].x+=1;if(.2>_)E[2].x+=1}}for(var u=0,f=this.vertices.length;f>u;u++)this.vertices[u].multiplyScalar(i);this.mergeVertices();this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,i)};THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.IcosahedronGeometry=function(e,t){this.radius=e;this.detail=t;var i=(1+Math.sqrt(5))/2;var r=[[-1,i,0],[1,i,0],[-1,-i,0],[1,-i,0],[0,-1,i],[0,1,i],[0,-1,-i],[0,1,-i],[i,0,-1],[i,0,1],[-i,0,-1],[-i,0,1]];var n=[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]];THREE.PolyhedronGeometry.call(this,r,n,e,t)};THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.OctahedronGeometry=function(e,t){var i=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]];var r=[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]];THREE.PolyhedronGeometry.call(this,i,r,e,t)};THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TetrahedronGeometry=function(e,t){var i=[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]];var r=[[2,1,0],[0,3,2],[1,3,0],[2,3,1]];THREE.PolyhedronGeometry.call(this,i,r,e,t)};THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ParametricGeometry=function(e,t,i,r){THREE.Geometry.call(this);var n=this.vertices;var o=this.faces;var a=this.faceVertexUvs[0];r=void 0===r?!1:r;var s,l,h;var c,u;var f=t+1;for(s=0;i>=s;s++){u=s/i;for(l=0;t>=l;l++){c=l/t;h=e(c,u);n.push(h)}}var d,p,m,g;var v,E,y,T;for(s=0;i>s;s++)for(l=0;t>l;l++){d=s*f+l;p=s*f+l+1;m=(s+1)*f+l;g=(s+1)*f+l+1;v=new THREE.Vector2(l/t,s/i);E=new THREE.Vector2((l+1)/t,s/i);y=new THREE.Vector2(l/t,(s+1)/i);T=new THREE.Vector2((l+1)/t,(s+1)/i);if(r){o.push(new THREE.Face3(d,p,m));o.push(new THREE.Face3(p,g,m));a.push([v,E,y]);a.push([E,T,y])}else{o.push(new THREE.Face4(d,p,g,m));a.push([v,E,T,y])}}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.AxisHelper=function(e){e=e||1;var t=new THREE.Geometry;t.vertices.push(new THREE.Vector3,new THREE.Vector3(e,0,0),new THREE.Vector3,new THREE.Vector3(0,e,0),new THREE.Vector3,new THREE.Vector3(0,0,e));t.colors.push(new THREE.Color(16711680),new THREE.Color(16755200),new THREE.Color(65280),new THREE.Color(11206400),new THREE.Color(255),new THREE.Color(43775));var i=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,t,i,THREE.LinePieces)};THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype);THREE.ArrowHelper=function(e,t,i,r){THREE.Object3D.call(this);if(void 0===r)r=16776960;if(void 0===i)i=1;this.position=t;var n=new THREE.Geometry;n.vertices.push(new THREE.Vector3(0,0,0));n.vertices.push(new THREE.Vector3(0,1,0));this.line=new THREE.Line(n,new THREE.LineBasicMaterial({color:r}));this.line.matrixAutoUpdate=!1;this.add(this.line);var o=new THREE.CylinderGeometry(0,.05,.25,5,1);o.applyMatrix((new THREE.Matrix4).makeTranslation(0,.875,0));this.cone=new THREE.Mesh(o,new THREE.MeshBasicMaterial({color:r}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(e);this.setLength(i)};THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.ArrowHelper.prototype.setDirection=function(){var e=new THREE.Vector3;var t;return function(i){if(i.y>.99999)this.quaternion.set(0,0,0,1);else if(i.y<-.99999)this.quaternion.set(1,0,0,0);else{e.set(i.z,0,-i.x).normalize();t=Math.acos(i.y);this.quaternion.setFromAxisAngle(e,t)}}}();THREE.ArrowHelper.prototype.setLength=function(e){this.scale.set(e,e,e)};THREE.ArrowHelper.prototype.setColor=function(e){this.line.material.color.setHex(e);this.cone.material.color.setHex(e)};THREE.BoxHelper=function(e){var t=[new THREE.Vector3(1,1,1),new THREE.Vector3(-1,1,1),new THREE.Vector3(-1,-1,1),new THREE.Vector3(1,-1,1),new THREE.Vector3(1,1,-1),new THREE.Vector3(-1,1,-1),new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,-1,-1)];this.vertices=t;var i=new THREE.Geometry;i.vertices.push(t[0],t[1],t[1],t[2],t[2],t[3],t[3],t[0],t[4],t[5],t[5],t[6],t[6],t[7],t[7],t[4],t[0],t[4],t[1],t[5],t[2],t[6],t[3],t[7]);THREE.Line.call(this,i,new THREE.LineBasicMaterial({color:16776960}),THREE.LinePieces);if(void 0!==e)this.update(e)};THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype);THREE.BoxHelper.prototype.update=function(e){var t=e.geometry;if(null===t.boundingBox)t.computeBoundingBox();var i=t.boundingBox.min;var r=t.boundingBox.max;var n=this.vertices;n[0].set(r.x,r.y,r.z);n[1].set(i.x,r.y,r.z);n[2].set(i.x,i.y,r.z);n[3].set(r.x,i.y,r.z);n[4].set(r.x,r.y,i.z);n[5].set(i.x,r.y,i.z);n[6].set(i.x,i.y,i.z);n[7].set(r.x,i.y,i.z);this.geometry.computeBoundingSphere();this.geometry.verticesNeedUpdate=!0;this.matrixAutoUpdate=!1;this.matrixWorld=e.matrixWorld};THREE.BoundingBoxHelper=function(e,t){var i=t||8947848;this.object=e;this.box=new THREE.Box3;THREE.Mesh.call(this,new THREE.CubeGeometry(1,1,1),new THREE.MeshBasicMaterial({color:i,wireframe:!0}))};THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object);this.box.size(this.scale);this.box.center(this.position)};THREE.CameraHelper=function(e){function t(e,t,r){i(e,r);i(t,r)}function i(e,t){r.vertices.push(new THREE.Vector3);r.colors.push(new THREE.Color(t));if(void 0===o[e])o[e]=[];o[e].push(r.vertices.length-1)}var r=new THREE.Geometry;var n=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors});var o={};var a=16755200;var s=16711680;var l=43775;var h=16777215;var c=3355443;t("n1","n2",a);t("n2","n4",a);t("n4","n3",a);t("n3","n1",a);t("f1","f2",a);t("f2","f4",a);t("f4","f3",a);t("f3","f1",a);t("n1","f1",a);t("n2","f2",a);t("n3","f3",a);t("n4","f4",a);t("p","n1",s);t("p","n2",s);t("p","n3",s);t("p","n4",s);t("u1","u2",l);t("u2","u3",l);t("u3","u1",l);t("c","t",h);t("p","c",c);t("cn1","cn2",c);t("cn3","cn4",c);t("cf1","cf2",c);t("cf3","cf4",c);THREE.Line.call(this,r,n,THREE.LinePieces);this.camera=e;this.matrixWorld=e.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=o;this.update()};THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype);THREE.CameraHelper.prototype.update=function(){var e=new THREE.Vector3;var t=new THREE.Camera;var i=new THREE.Projector;return function(){function r(r,o,a,s){e.set(o,a,s);i.unprojectVector(e,t);var l=n.pointMap[r];if(void 0!==l)for(var h=0,c=l.length;c>h;h++)n.geometry.vertices[l[h]].copy(e)}var n=this;var o=1,a=1;t.projectionMatrix.copy(this.camera.projectionMatrix);r("c",0,0,-1);r("t",0,0,1);r("n1",-o,-a,-1);r("n2",o,-a,-1);r("n3",-o,a,-1);r("n4",o,a,-1);r("f1",-o,-a,1);r("f2",o,-a,1);r("f3",-o,a,1);r("f4",o,a,1);r("u1",.7*o,1.1*a,-1);r("u2",.7*-o,1.1*a,-1);r("u3",0,2*a,-1);r("cf1",-o,0,1);r("cf2",o,0,1);r("cf3",0,-a,1);r("cf4",0,a,1);r("cn1",-o,0,-1);r("cn2",o,0,-1);r("cn3",0,-a,-1);r("cn4",0,a,-1);this.geometry.verticesNeedUpdate=!0}}();THREE.DirectionalLightHelper=function(e,t){THREE.Object3D.call(this);this.light=e;this.light.updateMatrixWorld();this.matrixWorld=e.matrixWorld;this.matrixAutoUpdate=!1;var i=new THREE.PlaneGeometry(t,t);var r=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});r.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightPlane=new THREE.Mesh(i,r);this.add(this.lightPlane);i=new THREE.Geometry;i.vertices.push(new THREE.Vector3);i.vertices.push(new THREE.Vector3);i.computeLineDistances();r=new THREE.LineBasicMaterial({fog:!1});r.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine=new THREE.Line(i,r);this.add(this.targetLine);this.update()};THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.DirectionalLightHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){e.getPositionFromMatrix(this.light.matrixWorld).negate();this.lightPlane.lookAt(e);this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine.geometry.vertices[1].copy(e);this.targetLine.geometry.verticesNeedUpdate=!0;this.targetLine.material.color.copy(this.lightPlane.material.color)}}();THREE.FaceNormalsHelper=function(e,t,i,r){this.object=e;this.size=t||1;var n=i||16776960;var o=r||1;var a=new THREE.Geometry;var s=this.object.geometry.faces;for(var l=0,h=s.length;h>l;l++){a.vertices.push(new THREE.Vector3);a.vertices.push(new THREE.Vector3)}THREE.Line.call(this,a,new THREE.LineBasicMaterial({color:n,linewidth:o}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};THREE.FaceNormalsHelper.prototype=Object.create(THREE.Line.prototype);THREE.FaceNormalsHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){this.object.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(this.object.matrixWorld);
var t=this.geometry.vertices;var i=this.object.geometry.faces;var r=this.object.matrixWorld;for(var n=0,o=i.length;o>n;n++){var a=i[n];e.copy(a.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);var s=2*n;t[s].copy(a.centroid).applyMatrix4(r);t[s+1].addVectors(t[s],e)}this.geometry.verticesNeedUpdate=!0;return this}}();THREE.GridHelper=function(e,t){var i=new THREE.Geometry;var r=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924);this.color2=new THREE.Color(8947848);for(var n=-e;e>=n;n+=t){i.vertices.push(new THREE.Vector3(-e,0,n),new THREE.Vector3(e,0,n),new THREE.Vector3(n,0,-e),new THREE.Vector3(n,0,e));var o=0===n?this.color1:this.color2;i.colors.push(o,o,o,o)}THREE.Line.call(this,i,r,THREE.LinePieces)};THREE.GridHelper.prototype=Object.create(THREE.Line.prototype);THREE.GridHelper.prototype.setColors=function(e,t){this.color1.set(e);this.color2.set(t);this.geometry.colorsNeedUpdate=!0};THREE.HemisphereLightHelper=function(e,t){THREE.Object3D.call(this);this.light=e;this.light.updateMatrixWorld();this.matrixWorld=e.matrixWorld;this.matrixAutoUpdate=!1;this.colors=[new THREE.Color,new THREE.Color];var i=new THREE.SphereGeometry(t,4,2);i.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(var r=0,n=8;n>r;r++)i.faces[r].color=this.colors[4>r?0:1];var o=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0});this.lightSphere=new THREE.Mesh(i,o);this.add(this.lightSphere);this.update()};THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.HemisphereLightHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);this.lightSphere.lookAt(e.getPositionFromMatrix(this.light.matrixWorld).negate());this.lightSphere.geometry.colorsNeedUpdate=!0}}();THREE.PointLightHelper=function(e,t){this.light=e;this.light.updateMatrixWorld();var i=new THREE.SphereGeometry(t,4,2);var r=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});r.color.copy(this.light.color).multiplyScalar(this.light.intensity);THREE.Mesh.call(this,i,r);this.matrixWorld=this.light.matrixWorld;this.matrixAutoUpdate=!1};THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};THREE.SpotLightHelper=function(e){THREE.Object3D.call(this);this.light=e;this.light.updateMatrixWorld();this.matrixWorld=e.matrixWorld;this.matrixAutoUpdate=!1;var t=new THREE.CylinderGeometry(0,1,1,8,1,!0);t.applyMatrix((new THREE.Matrix4).makeTranslation(0,-.5,0));t.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));var i=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(t,i);this.add(this.cone);this.update()};THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.SpotLightHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){var t=this.light.distance?this.light.distance:1e4;var i=t*Math.tan(this.light.angle);this.cone.scale.set(i,i,t);this.cone.lookAt(e.getPositionFromMatrix(this.light.matrixWorld).negate());this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}();THREE.VertexNormalsHelper=function(e,t,i,r){this.object=e;this.size=t||1;var n=i||16711680;var o=r||1;var a=new THREE.Geometry;e.geometry.vertices;var s=e.geometry.faces;for(var l=0,h=s.length;h>l;l++){var c=s[l];for(var u=0,f=c.vertexNormals.length;f>u;u++){a.vertices.push(new THREE.Vector3);a.vertices.push(new THREE.Vector3)}}THREE.Line.call(this,a,new THREE.LineBasicMaterial({color:n,linewidth:o}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};THREE.VertexNormalsHelper.prototype=Object.create(THREE.Line.prototype);THREE.VertexNormalsHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){var t=["a","b","c","d"];this.object.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(this.object.matrixWorld);var i=this.geometry.vertices;var r=this.object.geometry.vertices;var n=this.object.geometry.faces;var o=this.object.matrixWorld;var a=0;for(var s=0,l=n.length;l>s;s++){var h=n[s];for(var c=0,u=h.vertexNormals.length;u>c;c++){var f=h[t[c]];var d=r[f];var p=h.vertexNormals[c];i[a].copy(d).applyMatrix4(o);e.copy(p).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);e.add(i[a]);a+=1;i[a].copy(e);a+=1}}this.geometry.verticesNeedUpdate=!0;return this}}();THREE.VertexTangentsHelper=function(e,t,i,r){this.object=e;this.size=t||1;var n=i||255;var o=r||1;var a=new THREE.Geometry;e.geometry.vertices;var s=e.geometry.faces;for(var l=0,h=s.length;h>l;l++){var c=s[l];for(var u=0,f=c.vertexTangents.length;f>u;u++){a.vertices.push(new THREE.Vector3);a.vertices.push(new THREE.Vector3)}}THREE.Line.call(this,a,new THREE.LineBasicMaterial({color:n,linewidth:o}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.update()};THREE.VertexTangentsHelper.prototype=Object.create(THREE.Line.prototype);THREE.VertexTangentsHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){var t=["a","b","c","d"];this.object.updateMatrixWorld(!0);var i=this.geometry.vertices;var r=this.object.geometry.vertices;var n=this.object.geometry.faces;var o=this.object.matrixWorld;var a=0;for(var s=0,l=n.length;l>s;s++){var h=n[s];for(var c=0,u=h.vertexTangents.length;u>c;c++){var f=h[t[c]];var d=r[f];var p=h.vertexTangents[c];i[a].copy(d).applyMatrix4(o);e.copy(p).transformDirection(o).multiplyScalar(this.size);e.add(i[a]);a+=1;i[a].copy(e);a+=1}}this.geometry.verticesNeedUpdate=!0;return this}}();THREE.WireframeHelper=function(e){var t=[0,0],i={};var r=function(e,t){return e-t};var n=["a","b","c","d"];var o=new THREE.Geometry;var a=e.geometry.vertices;var s=e.geometry.faces;for(var l=0,h=s.length;h>l;l++){var c=s[l];var u=c instanceof THREE.Face4?4:3;for(var f=0;u>f;f++){t[0]=c[n[f]];t[1]=c[n[(f+1)%u]];t.sort(r);var d=t.toString();if(void 0===i[d]){o.vertices.push(a[t[0]]);o.vertices.push(a[t[1]]);i[d]=!0}}}THREE.Line.call(this,o,new THREE.LineBasicMaterial({color:16777215}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.matrixWorld=e.matrixWorld};THREE.WireframeHelper.prototype=Object.create(THREE.Line.prototype);THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this);this.render=function(){}};THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype);THREE.LensFlare=function(e,t,i,r,n){THREE.Object3D.call(this);this.lensFlares=[];this.positionScreen=new THREE.Vector3;this.customUpdateCallback=void 0;if(void 0!==e)this.add(e,t,i,r,n)};THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype);THREE.LensFlare.prototype.add=function(e,t,i,r,n,o){if(void 0===t)t=-1;if(void 0===i)i=0;if(void 0===o)o=1;if(void 0===n)n=new THREE.Color(16777215);if(void 0===r)r=THREE.NormalBlending;i=Math.min(i,Math.max(0,i));this.lensFlares.push({texture:e,size:t,distance:i,x:0,y:0,z:0,scale:1,rotation:1,opacity:o,color:n,blending:r})};THREE.LensFlare.prototype.updateLensFlares=function(){var e,t=this.lensFlares.length;var i;var r=2*-this.positionScreen.x;var n=2*-this.positionScreen.y;for(e=0;t>e;e++){i=this.lensFlares[e];i.x=this.positionScreen.x+r*i.distance;i.y=this.positionScreen.y+n*i.distance;i.wantedRotation=.25*i.x*Math.PI;i.rotation+=.25*(i.wantedRotation-i.rotation)}};THREE.MorphBlendMesh=function(e,t){THREE.Mesh.call(this,e,t);this.animationsMap={};this.animationsList=[];var i=this.geometry.morphTargets.length;var r="__default";var n=0;var o=i-1;var a=i/1;this.createAnimation(r,n,o,a);this.setAnimationWeight(r,1)};THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.MorphBlendMesh.prototype.createAnimation=function(e,t,i,r){var n={startFrame:t,endFrame:i,length:i-t+1,fps:r,duration:(i-t)/r,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=n;this.animationsList.push(n)};THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(e){var t=/([a-z]+)(\d+)/;var i,r={};var n=this.geometry;for(var o=0,a=n.morphTargets.length;a>o;o++){var s=n.morphTargets[o];var l=s.name.match(t);if(l&&l.length>1){var h=l[1];l[2];if(!r[h])r[h]={start:1/0,end:-1/0};var c=r[h];if(o<c.start)c.start=o;if(o>c.end)c.end=o;if(!i)i=h}}for(var h in r){var c=r[h];this.createAnimation(h,c.start,c.end,e)}this.firstAnimation=i};THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(e){var t=this.animationsMap[e];if(t){t.direction=1;t.directionBackwards=!1}};THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(e){var t=this.animationsMap[e];if(t){t.direction=-1;t.directionBackwards=!0}};THREE.MorphBlendMesh.prototype.setAnimationFPS=function(e,t){var i=this.animationsMap[e];if(i){i.fps=t;i.duration=(i.end-i.start)/i.fps}};THREE.MorphBlendMesh.prototype.setAnimationDuration=function(e,t){var i=this.animationsMap[e];if(i){i.duration=t;i.fps=(i.end-i.start)/i.duration}};THREE.MorphBlendMesh.prototype.setAnimationWeight=function(e,t){var i=this.animationsMap[e];if(i)i.weight=t};THREE.MorphBlendMesh.prototype.setAnimationTime=function(e,t){var i=this.animationsMap[e];if(i)i.time=t};THREE.MorphBlendMesh.prototype.getAnimationTime=function(e){var t=0;var i=this.animationsMap[e];if(i)t=i.time;return t};THREE.MorphBlendMesh.prototype.getAnimationDuration=function(e){var t=-1;var i=this.animationsMap[e];if(i)t=i.duration;return t};THREE.MorphBlendMesh.prototype.playAnimation=function(e){var t=this.animationsMap[e];if(t){t.time=0;t.active=!0}else console.warn("animation["+e+"] undefined")};THREE.MorphBlendMesh.prototype.stopAnimation=function(e){var t=this.animationsMap[e];if(t)t.active=!1};THREE.MorphBlendMesh.prototype.update=function(e){for(var t=0,i=this.animationsList.length;i>t;t++){var r=this.animationsList[t];if(r.active){var n=r.duration/r.length;r.time+=r.direction*e;if(r.mirroredLoop){if(r.time>r.duration||r.time<0){r.direction*=-1;if(r.time>r.duration){r.time=r.duration;r.directionBackwards=!0}if(r.time<0){r.time=0;r.directionBackwards=!1}}}else{r.time=r.time%r.duration;if(r.time<0)r.time+=r.duration}var o=r.startFrame+THREE.Math.clamp(Math.floor(r.time/n),0,r.length-1);var a=r.weight;if(o!==r.currentFrame){this.morphTargetInfluences[r.lastFrame]=0;this.morphTargetInfluences[r.currentFrame]=1*a;this.morphTargetInfluences[o]=0;r.lastFrame=r.currentFrame;r.currentFrame=o}var s=r.time%n/n;if(r.directionBackwards)s=1-s;this.morphTargetInfluences[r.currentFrame]=s*a;this.morphTargetInfluences[r.lastFrame]=(1-s)*a}else;}};THREE.LensFlarePlugin=function(){function e(e,i){var r=t.createProgram();var n=t.createShader(t.FRAGMENT_SHADER);var o=t.createShader(t.VERTEX_SHADER);var a="precision "+i+" float;\n";t.shaderSource(n,a+e.fragmentShader);t.shaderSource(o,a+e.vertexShader);t.compileShader(n);t.compileShader(o);t.attachShader(r,n);t.attachShader(r,o);t.linkProgram(r);return r}var t,i,r,n={};this.init=function(o){t=o.context;i=o;r=o.getPrecision();n.vertices=new Float32Array(16);n.faces=new Uint16Array(6);var a=0;n.vertices[a++]=-1;n.vertices[a++]=-1;n.vertices[a++]=0;n.vertices[a++]=0;n.vertices[a++]=1;n.vertices[a++]=-1;n.vertices[a++]=1;n.vertices[a++]=0;n.vertices[a++]=1;n.vertices[a++]=1;n.vertices[a++]=1;n.vertices[a++]=1;n.vertices[a++]=-1;n.vertices[a++]=1;n.vertices[a++]=0;n.vertices[a++]=1;a=0;n.faces[a++]=0;n.faces[a++]=1;n.faces[a++]=2;n.faces[a++]=0;n.faces[a++]=2;n.faces[a++]=3;n.vertexBuffer=t.createBuffer();n.elementBuffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n.vertexBuffer);t.bufferData(t.ARRAY_BUFFER,n.vertices,t.STATIC_DRAW);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.elementBuffer);t.bufferData(t.ELEMENT_ARRAY_BUFFER,n.faces,t.STATIC_DRAW);n.tempTexture=t.createTexture();n.occlusionTexture=t.createTexture();t.bindTexture(t.TEXTURE_2D,n.tempTexture);t.texImage2D(t.TEXTURE_2D,0,t.RGB,16,16,0,t.RGB,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST);t.bindTexture(t.TEXTURE_2D,n.occlusionTexture);t.texImage2D(t.TEXTURE_2D,0,t.RGBA,16,16,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST);if(t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS)<=0){n.hasVertexTexture=!1;n.program=e(THREE.ShaderFlares["lensFlare"],r)}else{n.hasVertexTexture=!0;n.program=e(THREE.ShaderFlares["lensFlareVertexTexture"],r)}n.attributes={};n.uniforms={};n.attributes.vertex=t.getAttribLocation(n.program,"position");n.attributes.uv=t.getAttribLocation(n.program,"uv");n.uniforms.renderType=t.getUniformLocation(n.program,"renderType");n.uniforms.map=t.getUniformLocation(n.program,"map");n.uniforms.occlusionMap=t.getUniformLocation(n.program,"occlusionMap");n.uniforms.opacity=t.getUniformLocation(n.program,"opacity");n.uniforms.color=t.getUniformLocation(n.program,"color");n.uniforms.scale=t.getUniformLocation(n.program,"scale");n.uniforms.rotation=t.getUniformLocation(n.program,"rotation");n.uniforms.screenPosition=t.getUniformLocation(n.program,"screenPosition")};this.render=function(e,r,o,a){var s=e.__webglFlares,l=s.length;if(l){var h=new THREE.Vector3;var c=a/o,u=.5*o,f=.5*a;var d=16/a,p=new THREE.Vector2(d*c,d);var m=new THREE.Vector3(1,1,0),g=new THREE.Vector2(1,1);var v=n.uniforms,E=n.attributes;t.useProgram(n.program);t.enableVertexAttribArray(n.attributes.vertex);t.enableVertexAttribArray(n.attributes.uv);t.uniform1i(v.occlusionMap,0);t.uniform1i(v.map,1);t.bindBuffer(t.ARRAY_BUFFER,n.vertexBuffer);t.vertexAttribPointer(E.vertex,2,t.FLOAT,!1,16,0);t.vertexAttribPointer(E.uv,2,t.FLOAT,!1,16,8);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.elementBuffer);t.disable(t.CULL_FACE);t.depthMask(!1);var y,T,_,b,x;for(y=0;l>y;y++){d=16/a;p.set(d*c,d);b=s[y];h.set(b.matrixWorld.elements[12],b.matrixWorld.elements[13],b.matrixWorld.elements[14]);h.applyMatrix4(r.matrixWorldInverse);h.applyProjection(r.projectionMatrix);m.copy(h);g.x=m.x*u+u;g.y=m.y*f+f;if(n.hasVertexTexture||g.x>0&&g.x<o&&g.y>0&&g.y<a){t.activeTexture(t.TEXTURE1);t.bindTexture(t.TEXTURE_2D,n.tempTexture);t.copyTexImage2D(t.TEXTURE_2D,0,t.RGB,g.x-8,g.y-8,16,16,0);t.uniform1i(v.renderType,0);t.uniform2f(v.scale,p.x,p.y);t.uniform3f(v.screenPosition,m.x,m.y,m.z);t.disable(t.BLEND);t.enable(t.DEPTH_TEST);t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0);t.activeTexture(t.TEXTURE0);t.bindTexture(t.TEXTURE_2D,n.occlusionTexture);t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,g.x-8,g.y-8,16,16,0);t.uniform1i(v.renderType,1);t.disable(t.DEPTH_TEST);t.activeTexture(t.TEXTURE1);t.bindTexture(t.TEXTURE_2D,n.tempTexture);t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0);b.positionScreen.copy(m);if(b.customUpdateCallback)b.customUpdateCallback(b);else b.updateLensFlares();t.uniform1i(v.renderType,2);t.enable(t.BLEND);for(T=0,_=b.lensFlares.length;_>T;T++){x=b.lensFlares[T];if(x.opacity>.001&&x.scale>.001){m.x=x.x;m.y=x.y;m.z=x.z;d=x.size*x.scale/a;p.x=d*c;p.y=d;t.uniform3f(v.screenPosition,m.x,m.y,m.z);t.uniform2f(v.scale,p.x,p.y);t.uniform1f(v.rotation,x.rotation);t.uniform1f(v.opacity,x.opacity);t.uniform3f(v.color,x.color.r,x.color.g,x.color.b);i.setBlending(x.blending,x.blendEquation,x.blendSrc,x.blendDst);i.setTexture(x.texture,1);t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}}}}t.enable(t.CULL_FACE);t.enable(t.DEPTH_TEST);t.depthMask(!0)}}};THREE.ShadowMapPlugin=function(){function e(e,t){var i=new THREE.DirectionalLight;i.isVirtual=!0;i.onlyShadow=!0;i.castShadow=!0;i.shadowCameraNear=e.shadowCameraNear;i.shadowCameraFar=e.shadowCameraFar;i.shadowCameraLeft=e.shadowCameraLeft;i.shadowCameraRight=e.shadowCameraRight;i.shadowCameraBottom=e.shadowCameraBottom;i.shadowCameraTop=e.shadowCameraTop;i.shadowCameraVisible=e.shadowCameraVisible;i.shadowDarkness=e.shadowDarkness;i.shadowBias=e.shadowCascadeBias[t];i.shadowMapWidth=e.shadowCascadeWidth[t];i.shadowMapHeight=e.shadowCascadeHeight[t];i.pointsWorld=[];i.pointsFrustum=[];var r=i.pointsWorld,n=i.pointsFrustum;for(var o=0;8>o;o++){r[o]=new THREE.Vector3;n[o]=new THREE.Vector3}var a=e.shadowCascadeNearZ[t];var s=e.shadowCascadeFarZ[t];n[0].set(-1,-1,a);n[1].set(1,-1,a);n[2].set(-1,1,a);n[3].set(1,1,a);n[4].set(-1,-1,s);n[5].set(1,-1,s);n[6].set(-1,1,s);n[7].set(1,1,s);return i}function t(e,t){var i=e.shadowCascadeArray[t];i.position.copy(e.position);i.target.position.copy(e.target.position);i.lookAt(i.target);i.shadowCameraVisible=e.shadowCameraVisible;i.shadowDarkness=e.shadowDarkness;i.shadowBias=e.shadowCascadeBias[t];var r=e.shadowCascadeNearZ[t];var n=e.shadowCascadeFarZ[t];var o=i.pointsFrustum;o[0].z=r;o[1].z=r;o[2].z=r;o[3].z=r;o[4].z=n;o[5].z=n;o[6].z=n;o[7].z=n}function i(e,t){var i=t.shadowCamera,r=t.pointsFrustum,n=t.pointsWorld;f.set(1/0,1/0,1/0);d.set(-1/0,-1/0,-1/0);for(var o=0;8>o;o++){var a=n[o];a.copy(r[o]);THREE.ShadowMapPlugin.__projector.unprojectVector(a,e);a.applyMatrix4(i.matrixWorldInverse);if(a.x<f.x)f.x=a.x;if(a.x>d.x)d.x=a.x;if(a.y<f.y)f.y=a.y;if(a.y>d.y)d.y=a.y;if(a.z<f.z)f.z=a.z;if(a.z>d.z)d.z=a.z}i.left=f.x;i.right=d.x;i.top=d.y;i.bottom=f.y;i.updateProjectionMatrix()}function r(e){return e.material instanceof THREE.MeshFaceMaterial?e.material.materials[0]:e.material}var n,o,a,s,l,h,c=new THREE.Frustum,u=new THREE.Matrix4,f=new THREE.Vector3,d=new THREE.Vector3,p=new THREE.Vector3;this.init=function(e){n=e.context;o=e;var t=THREE.ShaderLib["depthRGBA"];var i=THREE.UniformsUtils.clone(t.uniforms);a=new THREE.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:i});s=new THREE.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:i,morphTargets:!0});l=new THREE.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:i,skinning:!0});h=new THREE.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:i,morphTargets:!0,skinning:!0});a._shadowPass=!0;s._shadowPass=!0;l._shadowPass=!0;h._shadowPass=!0};this.render=function(e,t){if(o.shadowMapEnabled&&o.shadowMapAutoUpdate)this.update(e,t)};this.update=function(f,d){var m,g,v,E,y,T,_,b,x,R,w,H,M,S,C=[],A=0,D=null;n.clearColor(1,1,1,1);n.disable(n.BLEND);n.enable(n.CULL_FACE);n.frontFace(n.CCW);if(o.shadowMapCullFace===THREE.CullFaceFront)n.cullFace(n.FRONT);else n.cullFace(n.BACK);o.setDepthTest(!0);for(m=0,g=f.__lights.length;g>m;m++){M=f.__lights[m];if(M.castShadow)if(M instanceof THREE.DirectionalLight&&M.shadowCascade)for(y=0;y<M.shadowCascadeCount;y++){var P;if(!M.shadowCascadeArray[y]){P=e(M,y);P.originalCamera=d;var k=new THREE.Gyroscope;k.position=M.shadowCascadeOffset;k.add(P);k.add(P.target);d.add(k);M.shadowCascadeArray[y]=P;console.log("Created virtualLight",P)}else P=M.shadowCascadeArray[y];t(M,y);C[A]=P;A++}else{C[A]=M;A++}else;}for(m=0,g=C.length;g>m;m++){M=C[m];if(!M.shadowMap){var L=THREE.LinearFilter;if(o.shadowMapType===THREE.PCFSoftShadowMap)L=THREE.NearestFilter;var F={minFilter:L,magFilter:L,format:THREE.RGBAFormat};M.shadowMap=new THREE.WebGLRenderTarget(M.shadowMapWidth,M.shadowMapHeight,F);M.shadowMapSize=new THREE.Vector2(M.shadowMapWidth,M.shadowMapHeight);M.shadowMatrix=new THREE.Matrix4}if(!M.shadowCamera){if(M instanceof THREE.SpotLight)M.shadowCamera=new THREE.PerspectiveCamera(M.shadowCameraFov,M.shadowMapWidth/M.shadowMapHeight,M.shadowCameraNear,M.shadowCameraFar);else if(M instanceof THREE.DirectionalLight)M.shadowCamera=new THREE.OrthographicCamera(M.shadowCameraLeft,M.shadowCameraRight,M.shadowCameraTop,M.shadowCameraBottom,M.shadowCameraNear,M.shadowCameraFar);else{console.error("Unsupported light type for shadow");continue}f.add(M.shadowCamera);if(f.autoUpdate===!0)f.updateMatrixWorld()}if(M.shadowCameraVisible&&!M.cameraHelper){M.cameraHelper=new THREE.CameraHelper(M.shadowCamera);M.shadowCamera.add(M.cameraHelper)}if(M.isVirtual&&P.originalCamera==d)i(d,M);T=M.shadowMap;_=M.shadowMatrix;b=M.shadowCamera;b.position.getPositionFromMatrix(M.matrixWorld);p.getPositionFromMatrix(M.target.matrixWorld);b.lookAt(p);b.updateMatrixWorld();b.matrixWorldInverse.getInverse(b.matrixWorld);if(M.cameraHelper)M.cameraHelper.visible=M.shadowCameraVisible;if(M.shadowCameraVisible)M.cameraHelper.update();_.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);_.multiply(b.projectionMatrix);_.multiply(b.matrixWorldInverse);u.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);c.setFromMatrix(u);o.setRenderTarget(T);o.clear();S=f.__webglObjects;for(v=0,E=S.length;E>v;v++){w=S[v];H=w.object;w.render=!1;if(H.visible&&H.castShadow)if(!(H instanceof THREE.Mesh||H instanceof THREE.ParticleSystem)||!H.frustumCulled||c.intersectsObject(H)){H._modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,H.matrixWorld);w.render=!0}}var z,N,I;for(v=0,E=S.length;E>v;v++){w=S[v];if(w.render){H=w.object;x=w.buffer;z=r(H);N=H.geometry.morphTargets.length>0&&z.morphTargets;I=H instanceof THREE.SkinnedMesh&&z.skinning;if(H.customDepthMaterial)R=H.customDepthMaterial;else if(I)R=N?h:l;else if(N)R=s;else R=a;if(x instanceof THREE.BufferGeometry)o.renderBufferDirect(b,f.__lights,D,R,x,H);else o.renderBuffer(b,f.__lights,D,R,x,H)}}S=f.__webglObjectsImmediate;for(v=0,E=S.length;E>v;v++){w=S[v];H=w.object;if(H.visible&&H.castShadow){H._modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,H.matrixWorld);o.renderImmediateObject(b,f.__lights,D,a,H)}}}var O=o.getClearColor(),U=o.getClearAlpha();n.clearColor(O.r,O.g,O.b,U);n.enable(n.BLEND);if(o.shadowMapCullFace===THREE.CullFaceFront)n.cullFace(n.BACK)}};THREE.ShadowMapPlugin.__projector=new THREE.Projector;THREE.SpritePlugin=function(){function e(e,t){var r=i.createProgram();var n=i.createShader(i.FRAGMENT_SHADER);var o=i.createShader(i.VERTEX_SHADER);var a="precision "+t+" float;\n";i.shaderSource(n,a+e.fragmentShader);i.shaderSource(o,a+e.vertexShader);i.compileShader(n);i.compileShader(o);i.attachShader(r,n);i.attachShader(r,o);i.linkProgram(r);return r}function t(e,t){if(e.z!==t.z)return t.z-e.z;else return t.id-e.id}var i,r,n,o={};this.init=function(t){i=t.context;r=t;n=t.getPrecision();o.vertices=new Float32Array(16);o.faces=new Uint16Array(6);var a=0;o.vertices[a++]=-1;o.vertices[a++]=-1;o.vertices[a++]=0;o.vertices[a++]=0;o.vertices[a++]=1;o.vertices[a++]=-1;o.vertices[a++]=1;o.vertices[a++]=0;o.vertices[a++]=1;o.vertices[a++]=1;o.vertices[a++]=1;o.vertices[a++]=1;o.vertices[a++]=-1;o.vertices[a++]=1;o.vertices[a++]=0;o.vertices[a++]=1;a=0;o.faces[a++]=0;o.faces[a++]=1;o.faces[a++]=2;o.faces[a++]=0;o.faces[a++]=2;o.faces[a++]=3;o.vertexBuffer=i.createBuffer();o.elementBuffer=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,o.vertexBuffer);i.bufferData(i.ARRAY_BUFFER,o.vertices,i.STATIC_DRAW);i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,o.elementBuffer);i.bufferData(i.ELEMENT_ARRAY_BUFFER,o.faces,i.STATIC_DRAW);o.program=e(THREE.ShaderSprite["sprite"],n);o.attributes={};o.uniforms={};o.attributes.position=i.getAttribLocation(o.program,"position");o.attributes.uv=i.getAttribLocation(o.program,"uv");o.uniforms.uvOffset=i.getUniformLocation(o.program,"uvOffset");o.uniforms.uvScale=i.getUniformLocation(o.program,"uvScale");o.uniforms.rotation=i.getUniformLocation(o.program,"rotation");o.uniforms.scale=i.getUniformLocation(o.program,"scale");o.uniforms.alignment=i.getUniformLocation(o.program,"alignment");o.uniforms.color=i.getUniformLocation(o.program,"color");o.uniforms.map=i.getUniformLocation(o.program,"map");o.uniforms.opacity=i.getUniformLocation(o.program,"opacity");o.uniforms.useScreenCoordinates=i.getUniformLocation(o.program,"useScreenCoordinates");o.uniforms.sizeAttenuation=i.getUniformLocation(o.program,"sizeAttenuation");o.uniforms.screenPosition=i.getUniformLocation(o.program,"screenPosition");o.uniforms.modelViewMatrix=i.getUniformLocation(o.program,"modelViewMatrix");o.uniforms.projectionMatrix=i.getUniformLocation(o.program,"projectionMatrix");o.uniforms.fogType=i.getUniformLocation(o.program,"fogType");o.uniforms.fogDensity=i.getUniformLocation(o.program,"fogDensity");o.uniforms.fogNear=i.getUniformLocation(o.program,"fogNear");o.uniforms.fogFar=i.getUniformLocation(o.program,"fogFar");o.uniforms.fogColor=i.getUniformLocation(o.program,"fogColor");o.uniforms.alphaTest=i.getUniformLocation(o.program,"alphaTest")};this.render=function(e,n,a,s){var l=e.__webglSprites,h=l.length;if(h){var c=o.attributes,u=o.uniforms;var f=s/a;var d=.5*a,p=.5*s;i.useProgram(o.program);i.enableVertexAttribArray(c.position);i.enableVertexAttribArray(c.uv);i.disable(i.CULL_FACE);i.enable(i.BLEND);i.bindBuffer(i.ARRAY_BUFFER,o.vertexBuffer);i.vertexAttribPointer(c.position,2,i.FLOAT,!1,16,0);i.vertexAttribPointer(c.uv,2,i.FLOAT,!1,16,8);i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,o.elementBuffer);i.uniformMatrix4fv(u.projectionMatrix,!1,n.projectionMatrix.elements);i.activeTexture(i.TEXTURE0);i.uniform1i(u.map,0);var m=0;var g=0;var v=e.fog;if(v){i.uniform3f(u.fogColor,v.color.r,v.color.g,v.color.b);if(v instanceof THREE.Fog){i.uniform1f(u.fogNear,v.near);i.uniform1f(u.fogFar,v.far);i.uniform1i(u.fogType,1);m=1;g=1}else if(v instanceof THREE.FogExp2){i.uniform1f(u.fogDensity,v.density);i.uniform1i(u.fogType,2);m=2;g=2}}else{i.uniform1i(u.fogType,0);m=0;g=0}var E,y,T,_,b,x=[];for(E=0;h>E;E++){y=l[E];T=y.material;if(y.visible&&0!==T.opacity)if(!T.useScreenCoordinates){y._modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,y.matrixWorld);y.z=-y._modelViewMatrix.elements[14]}else y.z=-y.position.z;else;}l.sort(t);for(E=0;h>E;E++){y=l[E];T=y.material;if(y.visible&&0!==T.opacity){if(T.map&&T.map.image&&T.map.image.width){i.uniform1f(u.alphaTest,T.alphaTest);if(T.useScreenCoordinates===!0){i.uniform1i(u.useScreenCoordinates,1);i.uniform3f(u.screenPosition,(y.position.x*r.devicePixelRatio-d)/d,(p-y.position.y*r.devicePixelRatio)/p,Math.max(0,Math.min(1,y.position.z)));x[0]=r.devicePixelRatio;x[1]=r.devicePixelRatio}else{i.uniform1i(u.useScreenCoordinates,0);i.uniform1i(u.sizeAttenuation,T.sizeAttenuation?1:0);i.uniformMatrix4fv(u.modelViewMatrix,!1,y._modelViewMatrix.elements);x[0]=1;x[1]=1}if(e.fog&&T.fog)b=g;else b=0;if(m!==b){i.uniform1i(u.fogType,b);m=b}_=1/(T.scaleByViewport?s:1);x[0]*=_*f*y.scale.x;x[1]*=_*y.scale.y;i.uniform2f(u.uvScale,T.uvScale.x,T.uvScale.y);i.uniform2f(u.uvOffset,T.uvOffset.x,T.uvOffset.y);i.uniform2f(u.alignment,T.alignment.x,T.alignment.y);i.uniform1f(u.opacity,T.opacity);i.uniform3f(u.color,T.color.r,T.color.g,T.color.b);i.uniform1f(u.rotation,y.rotation);i.uniform2fv(u.scale,x);r.setBlending(T.blending,T.blendEquation,T.blendSrc,T.blendDst);r.setDepthTest(T.depthTest);r.setDepthWrite(T.depthWrite);r.setTexture(T.map,0);i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0)}}else;}i.enable(i.CULL_FACE)}}};THREE.DepthPassPlugin=function(){function e(e){return e.material instanceof THREE.MeshFaceMaterial?e.material.materials[0]:e.material}this.enabled=!1;this.renderTarget=null;var t,i,r,n,o,a,s=new THREE.Frustum,l=new THREE.Matrix4;this.init=function(e){t=e.context;i=e;var s=THREE.ShaderLib["depthRGBA"];var l=THREE.UniformsUtils.clone(s.uniforms);r=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l});n=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l,morphTargets:!0});o=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l,skinning:!0});a=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l,morphTargets:!0,skinning:!0});r._shadowPass=!0;n._shadowPass=!0;o._shadowPass=!0;a._shadowPass=!0};this.render=function(e,t){if(this.enabled)this.update(e,t)};this.update=function(h,c){var u,f,d,p,m,g,v,E=null;t.clearColor(1,1,1,1);t.disable(t.BLEND);i.setDepthTest(!0);if(h.autoUpdate===!0)h.updateMatrixWorld();c.matrixWorldInverse.getInverse(c.matrixWorld);l.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);s.setFromMatrix(l);i.setRenderTarget(this.renderTarget);i.clear();v=h.__webglObjects;for(u=0,f=v.length;f>u;u++){m=v[u];g=m.object;m.render=!1;if(g.visible)if(!(g instanceof THREE.Mesh||g instanceof THREE.ParticleSystem)||!g.frustumCulled||s.intersectsObject(g)){g._modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,g.matrixWorld);m.render=!0}}var y,T,_;for(u=0,f=v.length;f>u;u++){m=v[u];if(m.render){g=m.object;d=m.buffer;if(g instanceof THREE.ParticleSystem&&!g.customDepthMaterial)continue;y=e(g);if(y)i.setMaterialFaces(g.material);T=g.geometry.morphTargets.length>0&&y.morphTargets;_=g instanceof THREE.SkinnedMesh&&y.skinning;if(g.customDepthMaterial)p=g.customDepthMaterial;else if(_)p=T?a:o;else if(T)p=n;else p=r;if(d instanceof THREE.BufferGeometry)i.renderBufferDirect(c,h.__lights,E,p,d,g);else i.renderBuffer(c,h.__lights,E,p,d,g)}}v=h.__webglObjectsImmediate;for(u=0,f=v.length;f>u;u++){m=v[u];g=m.object;if(g.visible){g._modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,g.matrixWorld);i.renderImmediateObject(c,h.__lights,E,r,g)}}var b=i.getClearColor(),x=i.getClearAlpha();t.clearColor(b.r,b.g,b.b,x);t.enable(t.BLEND)}};THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},lensFlare:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}};
THREE.ShaderSprite={sprite:{vertexShader:["uniform int useScreenCoordinates;","uniform int sizeAttenuation;","uniform vec3 screenPosition;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 alignment;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position + alignment;","vec2 rotatedPosition;","rotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;","rotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;","vec4 finalPosition;","if( useScreenCoordinates != 0 ) {","finalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );","} else {","finalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition * ( sizeAttenuation == 1 ? 1.0 : finalPosition.z );","}","gl_Position = finalPosition;","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")}};define("libs/threejs/build/three",function(){});define("geometry/cubeframe",["libs/threejs/build/three"],function(){function e(e,t){return 0!=(e&1<<t)}var t=function(e,t,i,r,n,o,a,s,l){function h(e,t,i,r,n,o,a,s,l,h){var u,f,d,p=c.widthSegments,m=c.heightSegments,g=n/2,v=o/2,E=c.vertices.length;if("x"===e&&"y"===t||"y"===e&&"x"===t)u="z";else if("x"===e&&"z"===t||"z"===e&&"x"===t){u="y";m=c.depthSegments}else if("z"===e&&"y"===t||"y"===e&&"z"===t){u="x";p=c.depthSegments}var y=p+1,T=m+1,_=n/p,b=o/m,x=new THREE.Vector3;x[u]=a>0?1:-1;for(d=0;T>d;d++)for(f=0;y>f;f++){var R=new THREE.Vector3;R[e]=(f*_-g)*i;R[t]=(d*b-v)*r;R[u]=a;c.vertices.push(R)}for(d=0;m>d;d++)for(f=0;p>f;f++){var w=f+y*d;var H=f+y*(d+1);var M=f+1+y*(d+1);var S=f+1+y*d;var C=new THREE.Face4(w+E,H+E,M+E,S+E);C.normal.copy(x);C.vertexNormals.push(x.clone(),x.clone(),x.clone(),x.clone());C.materialIndex=s;c.faces.push(C);c.faceVertexUvs[0].push([new THREE.Vector2(f/p*l,1-d/m*h),new THREE.Vector2(f/p*l,1-(d+1)/m*h),new THREE.Vector2((f+1)/p*l,1-(d+1)/m*h),new THREE.Vector2((f+1)/p*l,1-d/m*h)])}}THREE.Geometry.call(this);var c=this;this.width=e;this.height=t;this.depth=i;this.widthSegments=a||1;this.heightSegments=s||1;this.depthSegments=l||1;r=r||1;n=n||1;o=o||1;var u=this.width/2;var f=this.height/2;var d=this.depth/2;h("z","y",-1,-1,this.depth,this.height,u,0,o,n);h("z","y",1,-1,this.depth,this.height,-u,1,o,n);h("x","z",1,1,this.width,this.depth,f,2,r,o);h("x","z",1,-1,this.width,this.depth,-f,3,r,o);h("x","y",1,-1,this.width,this.height,d,4,r,n);h("x","y",-1,-1,this.width,this.height,-d,5,r,n);this.computeCentroids();this.mergeVertices()};t.prototype=Object.create(THREE.Geometry.prototype);return function(i,r,n,o,a,s){var l=a/o;var h={w:new THREE.Mesh(new t(i-o,o,o,1,1,1)),h:new THREE.Mesh(new t(a,r-o,a,l,1,l)),d:new THREE.Mesh(new t(o,o,n-o,1,1,1))},c=new THREE.Mesh(new THREE.CubeGeometry(o,o,o));hw=.5*i,hh=.5*r,hd=.5*n,cube=new THREE.Mesh(THREE.Geometry());h.d.geometry.faces=h.d.geometry.faces.slice(0,4);h.w.geometry.faces=h.w.geometry.faces.slice(2);h.h.geometry.faces.splice(2,2);h.w.position.set(0,-hh,-hd);if(e(s,0))THREE.GeometryUtils.merge(cube.geometry,h.w);h.w.position.set(0,-hh,hd);if(e(s,1))THREE.GeometryUtils.merge(cube.geometry,h.w);h.w.position.set(0,hh,hd);if(e(s,2))THREE.GeometryUtils.merge(cube.geometry,h.w);h.w.position.set(0,hh,-hd);if(e(s,3))THREE.GeometryUtils.merge(cube.geometry,h.w);h.h.position.set(-hw,0,-hd);if(e(s,4))THREE.GeometryUtils.merge(cube.geometry,h.h);h.h.position.set(hw,0,-hd);if(e(s,5))THREE.GeometryUtils.merge(cube.geometry,h.h);h.h.position.set(hw,0,hd);if(e(s,6))THREE.GeometryUtils.merge(cube.geometry,h.h);h.h.position.set(-hw,0,hd);if(e(s,7))THREE.GeometryUtils.merge(cube.geometry,h.h);h.d.position.set(-hw,-hh,0);if(e(s,8))THREE.GeometryUtils.merge(cube.geometry,h.d);h.d.position.set(hw,-hh,0);if(e(s,9))THREE.GeometryUtils.merge(cube.geometry,h.d);h.d.position.set(hw,hh,0);if(e(s,10))THREE.GeometryUtils.merge(cube.geometry,h.d);h.d.position.set(-hw,hh,0);if(e(s,11))THREE.GeometryUtils.merge(cube.geometry,h.d);var u=.5*Math.PI;c.position.set(-hw,-hh,-hd);if(e(s,0)||e(s,8)||e(s,4))THREE.GeometryUtils.merge(cube.geometry,c);c.position.set(hw,-hh,-hd);c.rotation.y-=u;if(e(s,0)||e(s,9)||e(s,5))THREE.GeometryUtils.merge(cube.geometry,c);c.position.set(hw,-hh,hd);c.rotation.y-=u;if(e(s,1)||e(s,9)||e(s,6))THREE.GeometryUtils.merge(cube.geometry,c);c.position.set(-hw,-hh,hd);c.rotation.y-=u;if(e(s,1)||e(s,8)||e(s,7))THREE.GeometryUtils.merge(cube.geometry,c);c.position.set(-hw,hh,-hd);if(e(s,3)||e(s,11)||e(s,4))THREE.GeometryUtils.merge(cube.geometry,c);c.position.set(hw,hh,-hd);c.rotation.y+=u;if(e(s,3)||e(s,10)||e(s,5))THREE.GeometryUtils.merge(cube.geometry,c);c.position.set(hw,hh,hd);c.rotation.y+=u;if(e(s,2)||e(s,10)||e(s,6))THREE.GeometryUtils.merge(cube.geometry,c);c.position.set(-hw,hh,hd);c.rotation.y+=u;if(e(s,2)||e(s,11)||e(s,7))THREE.GeometryUtils.merge(cube.geometry,c);return cube.geometry}});define("structure",["utils/noise","geometry/cubeframe","utils/math"],function(e,t,i){var r={DIMENSION:30,SCALE:100};var n=function(n,o,a,s,l,h){var c,u,f,d,p=e.noise3D(r.DIMENSION,r.DIMENSION,r.DIMENSION,n,o,a),m=.5*r.DIMENSION,g=r.DIMENSION,v=new THREE.Geometry,E=[],y=[],f=new THREE.Mesh,T=Math.pow(2,12)-1;for(;g-->0;){u=r.DIMENSION;for(;u-->0;){c=r.DIMENSION;for(;c-->0;){d=p(c,u,g);if(d>s){E.push([c,u,g]);f.geometry=t(r.SCALE,r.SCALE,r.SCALE,l,h,0|i.random(1,T));f.position.set(-m+c,-m+u,-m+g);f.position.multiplyScalar(r.SCALE);THREE.GeometryUtils.merge(v,f)}else y.push([c,u,g])}}}return{geometry:v,volume:E,empty:y}};n.grid=r;return n});define("utils/timer",[],function(){var e={now:function(){return window.performance&&window.performance.now?performance.now()+performance.timing.navigationStart:Date.now()},isHighPrecision:function(){return e.now()<1e12}};return e});THREE.TransformControls=function(e,t,i){function r(e){if(0===e.button&&u.active===!1){var t=l(e,X[u.mode].children);if(t){if(ut!==t.object){u.hovered=!0;if(null!==ut){ut.material.color.copy(ft);ut.material.opacity=dt}ut=t.object;ft.copy(ut.material.color);dt=ut.material.opacity;ut.material.color.setRGB(1,1,0);ut.material.opacity=1;u.dispatchEvent(f)}}else if(null!==ut){ut.material.color.copy(ft);ut.material.opacity=dt;ut=null;u.hovered=!1;u.dispatchEvent(f)}}u.document.addEventListener("mousemove",o,!1);u.document.addEventListener("mouseup",a,!1)}function n(e){if(0===e.button){var t=l(e,X[u.mode].children);if(t){u.active=t.object.name;u.update();u.setIntersectionPlane();var i=l(e,[Y[K]]);if(i){F.copy(u.object.position);z.copy(u.object.scale);N.extractRotation(u.object.matrix);B.extractRotation(u.object.matrixWorld);I.extractRotation(u.object.parent.matrixWorld);O.getScaleFromMatrix(R.getInverse(u.object.parent.matrixWorld));E.copy(i.point)}}}u.document.addEventListener("mousemove",o,!1);u.document.addEventListener("mouseup",a,!1)}function o(e){if(u.active){var t=l(e,[Y[K]]);if(t){v.copy(t.point);if("translate"==u.mode&&h("T")){v.sub(E);v.multiply(O);if("local"==u.space){v.applyMatrix4(R.getInverse(B));if(!h("X")||1!=u.modifierAxis.x)v.x=0;if(!h("Y")||1!=u.modifierAxis.y)v.y=0;if(!h("Z")||1!=u.modifierAxis.z)v.z=0;if(h("XYZ"))v.set(0,0,0);v.applyMatrix4(N);u.object.position.copy(F);u.object.position.add(v)}if("world"==u.space||h("XYZ")){if(!h("X")||1!=u.modifierAxis.x)v.x=0;if(!h("Y")||1!=u.modifierAxis.y)v.y=0;if(!h("Z")||1!=u.modifierAxis.z)v.z=0;v.applyMatrix4(R.getInverse(I));u.object.position.copy(F);u.object.position.add(v);if(u.snapDist){if(h("X"))u.object.position.x=Math.round(u.object.position.x/u.snapDist)*u.snapDist;if(h("Y"))u.object.position.y=Math.round(u.object.position.y/u.snapDist)*u.snapDist;if(h("Z"))u.object.position.z=Math.round(u.object.position.z/u.snapDist)*u.snapDist}}}else if("scale"==u.mode&&h("S")){v.sub(E);v.multiply(O);if("local"==u.space)if(h("XYZ")){_=1+v.y/50;u.object.scale.x=z.x*_;u.object.scale.y=z.y*_;u.object.scale.z=z.z*_}else{v.applyMatrix4(R.getInverse(B));if(!h("X")||1!=u.modifierAxis.x)v.x=0;if(!h("Y")||1!=u.modifierAxis.y)v.y=0;if(!h("Z")||1!=u.modifierAxis.z)v.z=0;if(h("X"))u.object.scale.x=z.x*(1+v.x/50);if(h("Y"))u.object.scale.y=z.y*(1+v.y/50);if(h("Z"))u.object.scale.z=z.z*(1+v.z/50)}}else if("rotate"==u.mode&&h("R")){v.sub(U);v.multiply(O);w.copy(E).sub(U);w.multiply(O);if("RE"==u.active){v.applyMatrix4(R.getInverse(b));w.applyMatrix4(R.getInverse(b));y.set(Math.atan2(v.z,v.y),Math.atan2(v.x,v.z),Math.atan2(v.y,v.x));T.set(Math.atan2(w.z,w.y),Math.atan2(w.x,w.z),Math.atan2(w.y,w.x));H.setFromRotationMatrix(R.getInverse(I));L.setFromAxisAngle(x,y.z-T.z);A.setFromRotationMatrix(B);H.multiplyQuaternions(H,L);H.multiplyQuaternions(H,A);u.object.quaternion.copy(H)}else if("RXYZE"==u.active){L.setFromEuler(v.clone().cross(w).normalize());H.setFromRotationMatrix(R.getInverse(I));D.setFromAxisAngle(L,-v.clone().angleTo(w));A.setFromRotationMatrix(B);H.multiplyQuaternions(H,D);H.multiplyQuaternions(H,A);u.object.quaternion.copy(H)}else if("local"==u.space){v.applyMatrix4(R.getInverse(B));w.applyMatrix4(R.getInverse(B));y.set(Math.atan2(v.z,v.y),Math.atan2(v.x,v.z),Math.atan2(v.y,v.x));T.set(Math.atan2(w.z,w.y),Math.atan2(w.x,w.z),Math.atan2(w.y,w.x));A.setFromRotationMatrix(N);D.setFromAxisAngle(M,y.x-T.x);P.setFromAxisAngle(S,y.y-T.y);k.setFromAxisAngle(C,y.z-T.z);if("RX"==u.active)A.multiplyQuaternions(A,D);if("RY"==u.active)A.multiplyQuaternions(A,P);if("RZ"==u.active)A.multiplyQuaternions(A,k);u.object.quaternion.copy(A)}else if("world"==u.space){y.set(Math.atan2(v.z,v.y),Math.atan2(v.x,v.z),Math.atan2(v.y,v.x));T.set(Math.atan2(w.z,w.y),Math.atan2(w.x,w.z),Math.atan2(w.y,w.x));H.setFromRotationMatrix(R.getInverse(I));D.setFromAxisAngle(M,y.x-T.x);P.setFromAxisAngle(S,y.y-T.y);k.setFromAxisAngle(C,y.z-T.z);A.setFromRotationMatrix(B);if("RX"==u.active)H.multiplyQuaternions(H,D);if("RY"==u.active)H.multiplyQuaternions(H,P);if("RZ"==u.active)H.multiplyQuaternions(H,k);H.multiplyQuaternions(H,A);u.object.quaternion.copy(H)}}}u.update();u.dispatchEvent(f)}}function a(){u.active=!1;u.document.removeEventListener("mousemove",o,!1);u.document.removeEventListener("mouseup",a,!1)}function s(e){var t=u.mode;var i=u.space;var r=u.scale;if(87==e.keyCode){if("translate"==u.mode)u.space="world"==u.space?"local":"world";u.mode="translate"}if(69==e.keyCode){if("rotate"==u.mode)u.space="world"==u.space?"local":"world";u.mode="rotate"}if(82==e.keyCode){u.mode="scale";u.space="local"}if(187==e.keyCode||107==e.keyCode)u.scale+=.1;if(189==e.keyCode||109==e.keyCode){u.scale-=.1;u.scale=Math.max(u.scale,.1)}if(u.mode!==t||u.space!==i||u.scale!==r){u.setMode(u.mode);u.dispatchEvent(f)}}function l(e,t){g.set(2*(e.layerX/u.domElement.offsetWidth)-1,2*-(e.layerY/u.domElement.offsetHeight)+1,.5);m.unprojectVector(g,u.camera);p.set(j,g.sub(j).normalize());var i=p.intersectObjects(t,!0);return i[0]?i[0]:!1}function h(e){if(-1!=u.active.search(e))return!0;else return!1}function c(e){var t=new THREE.Geometry;THREE.GeometryUtils.merge(t,e);e.geometry=t;e.position.set(0,0,0);e.rotation.set(0,0,0);e.scale.set(1,1,1)}this.camera=e;this.domElement=void 0!==t?t:document;this.document=void 0!==i?i:document;this.object=void 0;this.active=!1;this.hovered=!1;this.keysEnabled=!1;this.mode="translate";this.space="world";this.scale=1;this.snapDist=null;this.modifierAxis=new THREE.Vector3(1,1,1);this.gizmo=new THREE.Object3D;var u=this;var f={type:"change"};var d=!1;var p=new THREE.Raycaster;var m=new THREE.Projector;var g=new THREE.Vector3;var v=new THREE.Vector3;var E=new THREE.Vector3;var y=new THREE.Vector3;var T=new THREE.Vector3;var _=1;var b=new THREE.Matrix4;var x=new THREE.Vector3;var R=new THREE.Matrix4;var w=new THREE.Vector3;var H=new THREE.Quaternion;var M=new THREE.Vector3(1,0,0);var S=new THREE.Vector3(0,1,0);var C=new THREE.Vector3(0,0,1);var A=new THREE.Quaternion;var D=new THREE.Quaternion;var P=new THREE.Quaternion;var k=new THREE.Quaternion;var L=new THREE.Quaternion;var F=new THREE.Vector3;var z=new THREE.Vector3;var N=new THREE.Matrix4;var I=new THREE.Matrix4;var O=new THREE.Vector3;var U=new THREE.Vector3;var V=new THREE.Euler;var B=new THREE.Matrix4;var j=new THREE.Vector3;var W=new THREE.Euler;var G={};var X={};var Y={};var q=["XY","YZ","XZ","XYZE"];var K="XY";var Q=new THREE.Object3D;this.gizmo.add(Q);for(var Z in q){Y[q[Z]]=new THREE.Mesh(new THREE.PlaneGeometry(500,500));Y[q[Z]].material.side=THREE.DoubleSide;Y[q[Z]].visible=!1;Q.add(Y[q[Z]])}Y["YZ"].rotation.set(0,Math.PI/2,0);Y["XZ"].rotation.set(-Math.PI/2,0,0);c(Y["YZ"]);c(Y["XZ"]);G["translate"]=new THREE.Object3D;G["rotate"]=new THREE.Object3D;G["scale"]=new THREE.Object3D;this.gizmo.add(G["translate"]);this.gizmo.add(G["rotate"]);this.gizmo.add(G["scale"]);X["translate"]=new THREE.Object3D;X["rotate"]=new THREE.Object3D;X["scale"]=new THREE.Object3D;this.gizmo.add(X["translate"]);this.gizmo.add(X["rotate"]);this.gizmo.add(X["scale"]);var $=function(e,t){var i=new THREE.MeshBasicMaterial;i.color=e;i.side=THREE.DoubleSide;i.depthTest=!1;i.depthWrite=!1;i.opacity=void 0!==t?t:1;i.transparent=!0;return i};var J=function(e,t){var i=new THREE.LineBasicMaterial;i.color=e;i.depthTest=!1;i.depthWrite=!1;i.opacity=void 0!==t?t:1;i.transparent=!0;return i};var et=new THREE.Color(16777215);var tt=new THREE.Color(8421504);var it=new THREE.Color(16711680);var rt=new THREE.Color(65280);var nt=new THREE.Color(255);var ot=new THREE.Color(65535);var at=new THREE.Color(16711935);var st=new THREE.Color(16776960);var lt,ht;lt=new THREE.Geometry;lt.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(1,0,0),new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,1));lt.colors.push(it,it,rt,rt,nt,nt);material=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});ht=new THREE.Line(lt,material,THREE.LinePieces);G["translate"].add(ht);G["scale"].add(ht.clone());ht=new THREE.Mesh(new THREE.OctahedronGeometry(.1,0),$(et,.25));ht.name="TXYZ";G["translate"].add(ht);X["translate"].add(ht.clone());lt=new THREE.PlaneGeometry(.3,.3);ht=new THREE.Mesh(lt,$(st,.25));ht.position.set(.15,.15,0);c(ht);ht.name="TXY";G["translate"].add(ht);X["translate"].add(ht.clone());ht=new THREE.Mesh(lt,$(ot,.25));ht.position.set(0,.15,.15);ht.rotation.y=Math.PI/2;c(ht);ht.name="TYZ";G["translate"].add(ht);X["translate"].add(ht.clone());ht=new THREE.Mesh(lt,$(at,.25));ht.position.set(.15,0,.15);ht.rotation.x=Math.PI/2;c(ht);ht.name="TXZ";G["translate"].add(ht);X["translate"].add(ht.clone());lt=new THREE.CylinderGeometry(0,.05,.2,4,1,!0);ht=new THREE.Mesh(lt,$(it));ht.position.x=1.1;ht.rotation.z=-Math.PI/2;c(ht);ht.name="TX";G["translate"].add(ht);ht=new THREE.Mesh(lt,$(rt));ht.position.y=1.1;c(ht);ht.name="TY";G["translate"].add(ht);ht=new THREE.Mesh(lt,$(nt));ht.position.z=1.1;ht.rotation.x=Math.PI/2;c(ht);ht.name="TZ";G["translate"].add(ht);lt=new THREE.CylinderGeometry(.2,.1,.8,4,1,!1);ht=new THREE.Mesh(lt,$(it));ht.position.x=.7;ht.rotation.z=-Math.PI/2;c(ht);ht.name="TX";X["translate"].add(ht);ht=new THREE.Mesh(lt,$(rt));ht.position.y=.7;c(ht);ht.name="TY";X["translate"].add(ht);ht=new THREE.Mesh(lt,$(nt));ht.position.z=.7;ht.rotation.x=Math.PI/2;c(ht);ht.name="TZ";X["translate"].add(ht);lt=new THREE.CubeGeometry(.125,.125,.125);ht=new THREE.Mesh(lt,$(et,.25));ht.name="SXYZ";G["scale"].add(ht);X["scale"].add(ht.clone());ht=new THREE.Mesh(lt,$(it));ht.position.set(1.05,0,0);c(ht);ht.name="SX";G["scale"].add(ht);X["scale"].add(ht.clone());ht=new THREE.Mesh(lt,$(rt));ht.position.set(0,1.05,0);c(ht);ht.name="SY";G["scale"].add(ht);X["scale"].add(ht.clone());ht=new THREE.Mesh(lt,$(nt));ht.position.set(0,0,1.05);c(ht);ht.name="SZ";G["scale"].add(ht);X["scale"].add(ht.clone());var ct=function(e,t,i){lt=new THREE.Geometry;i=i?i:1;for(var r=0;64*i>=r;++r){if("x"==t)lt.vertices.push(new THREE.Vector3(0,Math.cos(r/32*Math.PI),Math.sin(r/32*Math.PI)).multiplyScalar(e));if("y"==t)lt.vertices.push(new THREE.Vector3(Math.cos(r/32*Math.PI),0,Math.sin(r/32*Math.PI)).multiplyScalar(e));if("z"==t)lt.vertices.push(new THREE.Vector3(Math.sin(r/32*Math.PI),Math.cos(r/32*Math.PI),0).multiplyScalar(e))}return lt};ht=new THREE.Line(ct(1,"x",.5),J(it));ht.name="RX";G["rotate"].add(ht);ht=new THREE.Line(ct(1,"y",.5),J(rt));ht.name="RY";G["rotate"].add(ht);ht=new THREE.Line(ct(1,"z",.5),J(nt));ht.name="RZ";G["rotate"].add(ht);ht=new THREE.Line(ct(1,"z"),J(tt));ht.name="RXYZE";G["rotate"].add(ht);ht=new THREE.Line(ct(1.25,"z"),J(st,.25));ht.name="RE";G["rotate"].add(ht);lt=new THREE.TorusGeometry(1,.15,4,6,Math.PI);ht=new THREE.Mesh(lt,$(it));ht.rotation.z=-Math.PI/2;ht.rotation.y=-Math.PI/2;c(ht);ht.name="RX";X["rotate"].add(ht);ht=new THREE.Mesh(lt,$(rt));ht.rotation.z=Math.PI;ht.rotation.x=-Math.PI/2;c(ht);ht.name="RY";X["rotate"].add(ht);ht=new THREE.Mesh(lt,$(nt));ht.rotation.z=-Math.PI/2;c(ht);ht.name="RZ";X["rotate"].add(ht);ht=new THREE.Mesh(new THREE.SphereGeometry(.95,12,12),$(et,.25));ht.name="RXYZE";X["rotate"].add(ht);Y["SPHERE"]=new THREE.Mesh(new THREE.SphereGeometry(.95,12,12));Y["SPHERE"].visible=!1;Q.add(Y["SPHERE"]);ht=new THREE.Mesh(new THREE.TorusGeometry(1.3,.15,4,12),$(st,.25));ht.name="RE";X["rotate"].add(ht);ht=null;this.attach=function(e){this.object=e;this.setMode(u.mode);this.domElement.addEventListener("mousedown",n,!1);this.domElement.addEventListener("mousemove",r,!1);if(this.keysEnabled)this.document.addEventListener("keydown",s,!1)};this.detach=function(){this.object=void 0;this.hide();this.domElement.removeEventListener("mousedown",n,!1);this.domElement.removeEventListener("mousemove",r,!1);if(this.keysEnabled)this.document.removeEventListener("keydown",s,!1)};this.update=function(e){if(void 0!==this.object){if(e)this.camera=e;this.object.updateMatrixWorld();U.getPositionFromMatrix(this.object.matrixWorld);V.setFromRotationMatrix(R.extractRotation(this.object.matrixWorld));this.camera.updateMatrixWorld();j.getPositionFromMatrix(this.camera.matrixWorld);W.setFromRotationMatrix(R.extractRotation(this.camera.matrixWorld));_=U.distanceTo(j)/6*this.scale;this.gizmo.position.copy(U);this.gizmo.scale.set(_,_,_);for(var t in this.gizmo.children)for(var i in this.gizmo.children[t].children){var r=this.gizmo.children[t].children[i];var n=r.name;if(-1!=n.search("E")){b.lookAt(j,U,w.set(0,1,0));r.rotation.setFromRotationMatrix(b)}else{x.copy(j).sub(U).normalize();if("local"==this.space){H.setFromEuler(V);if(-1!=n.search("R")){R.makeRotationFromQuaternion(H).getInverse(R);x.applyProjection(R);if("RX"==n){D.setFromAxisAngle(M,Math.atan2(-x.y,x.z));H.multiplyQuaternions(H,D)}if("RY"==n){P.setFromAxisAngle(S,Math.atan2(x.x,x.z));H.multiplyQuaternions(H,P)}if("RZ"==n){k.setFromAxisAngle(C,Math.atan2(x.y,x.x));H.multiplyQuaternions(H,k)}}r.quaternion.copy(H)}else if("world"==this.space){r.rotation.set(0,0,0);if("RX"==n)r.rotation.x=Math.atan2(-x.y,x.z);if("RY"==n)r.rotation.y=Math.atan2(x.x,x.z);if("RZ"==n)r.rotation.z=Math.atan2(x.y,x.x)}}}}};this.hide=function(){for(var e in G)for(var t in G[e].children)G[e].children[t].visible=!1;for(var e in X)for(var t in X[e].children)X[e].children[t].visible=!1};this.setMode=function(e){u.mode=e;this.hide();if("scale"==u.mode)u.space="local";for(var t in G[this.mode].children)G[this.mode].children[t].visible=!0;for(var t in X[this.mode].children)X[this.mode].children[t].visible=d;u.update()};this.setIntersectionPlane=function(){x.copy(j).sub(U).normalize();if("local"==this.space)x.applyMatrix4(R.getInverse(u.object.matrixWorld));if(h("X"))if(x.y>x.z)K="XZ";else K="XY";if(h("Y"))if(x.x>x.z)K="YZ";else K="XY";if(h("Z"))if(x.x>x.y)K="YZ";else K="XZ";if(h("XY"))K="XY";if(h("YZ"))K="YZ";if(h("XZ"))K="XZ";if(h("XYZ")||h("E"))K="XYZE";if(h("RX"))K="YZ";if(h("RY"))K="XZ";if(h("RZ"))K="XY";if(h("RXYZ"))K="SPHERE"};var ut=null;var ft=new THREE.Color;var dt=1};THREE.TransformControls.prototype=Object.create(THREE.EventDispatcher.prototype);define("libs/threejs/examples/js/controls/TransformControls",function(){});define("lighting",["utils/math","libs/threejs/examples/js/controls/TransformControls"],function(){return function(e,t,i,r){function n(e){p=e.target.hovered}function o(o){o.controls=new THREE.TransformControls(t,i);o.controls.scale=.65;o.controls.attach(o);f.push(o);e.add(o);if(r){o.controls.addEventListener("change",n);e.add(o.controls.gizmo)}if(onLightAddedCallback)onLightAddedCallback();return o}function a(e,t){e.__folders[t].close();e.__ul.removeChild(e.__folders[t].domElement.parentNode);e.__folders[t]=void 0;e.onResize()}var s,l=0,h=0,c=0,u=0,f=[],d=!1,p=!1;var m=new THREE.AmbientLight(2236962);e.add(m);var g={updateColors:function(){},remove:function(){}};var v={onLightAdded:function(e){onLightAddedCallback=e},onLightRemoved:function(e){onLightRemovedCallback=e},update:function(){d=!1;s=f.length;for(;s-->0;){f[s].helper.update();f[s].controls.update();d=d||Boolean(f[s].controls.active)}return d||p},addPointLight:function(t,i,n,s){var h=new THREE.PointLight(t,i,n||2e3);if(s)h.position.copy(s);else h.position.set(12*Math.random()-6,12*Math.random()-6,12*Math.random()-6).multiplyScalar(100);h.helper=new THREE.PointLightHelper(h,100);if(r)e.add(h.helper);h.api={color:"#"+h.color.getHexString()};l++;o(h);if(r){var c="Point Light "+l;var u=r.addFolder(c);u.addColor(h.api,"color").onChange(function(){h.color.set(h.api.color)});u.add(h,"intensity");u.add(h,"distance");u.add(g,"remove").onChange(function(){e.remove(h);e.remove(h.helper);e.remove(h.controls.gizmo);f.splice(f.indexOf(h));a(r,c);if(onLightRemovedCallback)onLightRemovedCallback()})}},addDirectionalLight:function(t){var i=new THREE.DirectionalLight(t);i.helper=new THREE.DirectionalLightHelper(i,100);if(r)e.add(i.helper);i.api={color:"#"+i.color.getHexString()};h++;o(i);if(r){var n="Directional Light "+h;var s=r.addFolder(n);s.addColor(i.api,"color").onChange(function(){i.color.set(i.api.color)});s.add(i,"intensity");s.add(g,"remove").onChange(function(){e.remove(i);e.remove(i.helper);e.remove(i.controls.gizmo);f.splice(f.indexOf(i));a(r,n);if(onLightRemovedCallback)onLightRemovedCallback()})}},addHemispshereLight:function(t){var i=new THREE.HemisphereLight(t);i.helper=new THREE.HemisphereLightHelper(i,100);if(r)e.add(i.helper);i.api={color:"#"+i.color.getHexString(),groundColor:"#"+i.groundColor.getHexString()};c++;o(i);if(r){var n="Hemisphere Light "+c;var s=r.addFolder(n);s.addColor(i.api,"color").onChange(function(){i.color.set(i.api.color)});s.addColor(i.api,"groundColor").onChange(function(){i.groundColor.set(i.api.groundColor)});s.add(i,"intensity");s.add(g,"remove").onChange(function(){e.remove(i);e.remove(i.helper);e.remove(i.controls.gizmo);f.splice(f.indexOf(i));a(r,n);if(onLightRemovedCallback)onLightRemovedCallback()})}},addSpotLight:function(t){var i=new THREE.SpotLight(t);i.helper=new THREE.SpotLightHelper(i,100);if(r)e.add(i.helper);i.api={color:"#"+i.color.getHexString()};u++;o(i);if(r){var n="Spotlight "+u;var s=r.addFolder(n);s.addColor(i.api,"color").onChange(function(){i.color.set(i.api.color)});s.add(i,"intensity");s.add(i,"angle",0,.5*Math.PI).step(.01);s.add(i,"exponent",0,10).step(.1);s.add(g,"remove").onChange(function(){e.remove(i);e.remove(i.helper);e.remove(i.controls.gizmo);f.splice(f.indexOf(i));a(r,n);if(onLightRemovedCallback)onLightRemovedCallback()})}}};if(r){r=r.addFolder("lights");r.add(v,"addPointLight");r.add(v,"addDirectionalLight");r.add(v,"addHemispshereLight");r.add(v,"addSpotLight");var E=r.addFolder("Ambient Lighting");var y={color:"#"+m.color.getHexString()};E.addColor(y,"color").onChange(function(){m.color.set(y.color)})}return v}});var dat=dat||{};dat.gui=dat.gui||{};dat.utils=dat.utils||{};dat.controllers=dat.controllers||{};dat.dom=dat.dom||{};dat.color=dat.color||{};dat.utils.css=function(){return{load:function(e,t){var t=t||document,i=t.createElement("link");i.type="text/css";i.rel="stylesheet";i.href=e;t.getElementsByTagName("head")[0].appendChild(i)},inject:function(e,t){var t=t||document,i=document.createElement("style");i.type="text/css";i.innerHTML=e;t.getElementsByTagName("head")[0].appendChild(i)}}}();dat.utils.common=function(){var e=Array.prototype.forEach,t=Array.prototype.slice;return{BREAK:{},extend:function(e){this.each(t.call(arguments,1),function(t){for(var i in t)this.isUndefined(t[i])||(e[i]=t[i])},this);return e},defaults:function(e){this.each(t.call(arguments,1),function(t){for(var i in t)this.isUndefined(e[i])&&(e[i]=t[i])},this);return e},compose:function(){var e=t.call(arguments);return function(){for(var i=t.call(arguments),r=e.length-1;r>=0;r--)i=[e[r].apply(this,i)];return i[0]}},each:function(t,i,r){if(e&&t.forEach===e)t.forEach(i,r);else if(t.length===t.length+0)for(var n=0,o=t.length;o>n&&!(n in t&&i.call(r,t[n],n)===this.BREAK);n++);else for(n in t)if(i.call(r,t[n],n)===this.BREAK)break},defer:function(e){setTimeout(e,0)},toArray:function(e){return e.toArray?e.toArray():t.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){return e!==e},isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}}}();dat.controllers.Controller=function(e){var t=function(e,t){this.initialValue=e[t];this.domElement=document.createElement("div");this.object=e;this.property=t;this.__onFinishChange=this.__onChange=void 0};e.extend(t.prototype,{onChange:function(e){this.__onChange=e;return this},onFinishChange:function(e){this.__onFinishChange=e;return this},setValue:function(e){this.object[this.property]=e;this.__onChange&&this.__onChange.call(this,e);this.updateDisplay();return this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}});return t}(dat.utils.common);dat.dom.dom=function(e){function t(t){if("0"===t||e.isUndefined(t))return 0;t=t.match(r);return!e.isNull(t)?parseFloat(t[1]):0}var i={};e.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(t,r){e.each(t,function(e){i[e]=r})});var r=/(\d+(\.\d+)?)px/,n={makeSelectable:function(e,t){if(void 0!==e&&void 0!==e.style)e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off"},makeFullscreen:function(t,i,r){e.isUndefined(i)&&(i=!0);e.isUndefined(r)&&(r=!0);t.style.position="absolute";if(i)t.style.left=0,t.style.right=0;if(r)t.style.top=0,t.style.bottom=0},fakeEvent:function(t,r,n,o){var n=n||{},a=i[r];if(!a)throw Error("Event type "+r+" not supported.");var s=document.createEvent(a);switch(a){case"MouseEvents":s.initMouseEvent(r,n.bubbles||!1,n.cancelable||!0,window,n.clickCount||1,0,0,n.x||n.clientX||0,n.y||n.clientY||0,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":a=s.initKeyboardEvent||s.initKeyEvent;e.defaults(n,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0});a(r,n.bubbles||!1,n.cancelable,window,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.keyCode,n.charCode);break;default:s.initEvent(r,n.bubbles||!1,n.cancelable||!0)}e.defaults(s,o);t.dispatchEvent(s)},bind:function(e,t,i,r){e.addEventListener?e.addEventListener(t,i,r||!1):e.attachEvent&&e.attachEvent("on"+t,i);return n},unbind:function(e,t,i,r){e.removeEventListener?e.removeEventListener(t,i,r||!1):e.detachEvent&&e.detachEvent("on"+t,i);return n},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var i=e.className.split(/ +/);if(-1==i.indexOf(t))i.push(t),e.className=i.join(" ").replace(/^\s+/,"").replace(/\s+$/,"")}return n},removeClass:function(e,t){if(t){if(void 0!==e.className)if(e.className===t)e.removeAttribute("class");else{var i=e.className.split(/ +/),r=i.indexOf(t);if(-1!=r)i.splice(r,1),e.className=i.join(" ")}}else e.className=void 0;return n},hasClass:function(e,t){return RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){e=getComputedStyle(e);return t(e["border-left-width"])+t(e["border-right-width"])+t(e["padding-left"])+t(e["padding-right"])+t(e.width)},getHeight:function(e){e=getComputedStyle(e);return t(e["border-top-width"])+t(e["border-bottom-width"])+t(e["padding-top"])+t(e["padding-bottom"])+t(e.height)},getOffset:function(e){var t={left:0,top:0};if(e.offsetParent)do t.left+=e.offsetLeft,t.top+=e.offsetTop;while(e=e.offsetParent);return t},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}};return n}(dat.utils.common);dat.controllers.OptionController=function(e,t,i){var r=function(e,n,o){r.superclass.call(this,e,n);var a=this;this.__select=document.createElement("select");if(i.isArray(o)){var s={};i.each(o,function(e){s[e]=e});o=s}i.each(o,function(e,t){var i=document.createElement("option");i.innerHTML=t;i.setAttribute("value",e);a.__select.appendChild(i)});this.updateDisplay();t.bind(this.__select,"change",function(){a.setValue(this.options[this.selectedIndex].value)});this.domElement.appendChild(this.__select)};r.superclass=e;i.extend(r.prototype,e.prototype,{setValue:function(e){e=r.superclass.prototype.setValue.call(this,e);this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue());return e},updateDisplay:function(){this.__select.value=this.getValue();return r.superclass.prototype.updateDisplay.call(this)}});return r}(dat.controllers.Controller,dat.dom.dom,dat.utils.common);dat.controllers.NumberController=function(e,t){var i=function(e,r,n){i.superclass.call(this,e,r);n=n||{};this.__min=n.min;this.__max=n.max;this.__step=n.step;e=this.__impliedStep=t.isUndefined(this.__step)?0==this.initialValue?1:Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__step;e=e.toString();this.__precision=e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0};i.superclass=e;t.extend(i.prototype,e.prototype,{setValue:function(e){if(void 0!==this.__min&&e<this.__min)e=this.__min;else if(void 0!==this.__max&&e>this.__max)e=this.__max;void 0!==this.__step&&0!=e%this.__step&&(e=Math.round(e/this.__step)*this.__step);return i.superclass.prototype.setValue.call(this,e)},min:function(e){this.__min=e;return this},max:function(e){this.__max=e;return this},step:function(e){this.__step=e;return this}});return i}(dat.controllers.Controller,dat.utils.common);dat.controllers.NumberControllerBox=function(e,t,i){var r=function(e,n,o){function a(){var e=parseFloat(c.__input.value);i.isNaN(e)||c.setValue(e)}function s(e){var t=h-e.clientY;c.setValue(c.getValue()+t*c.__impliedStep);h=e.clientY}function l(){t.unbind(window,"mousemove",s);t.unbind(window,"mouseup",l)}this.__truncationSuspended=!1;r.superclass.call(this,e,n,o);var h,c=this;this.__input=document.createElement("input");this.__input.setAttribute("type","text");t.bind(this.__input,"change",a);t.bind(this.__input,"blur",function(){a();
c.__onFinishChange&&c.__onFinishChange.call(c,c.getValue())});t.bind(this.__input,"mousedown",function(e){t.bind(window,"mousemove",s);t.bind(window,"mouseup",l);h=e.clientY});t.bind(this.__input,"keydown",function(e){if(13===e.keyCode)c.__truncationSuspended=!0,this.blur(),c.__truncationSuspended=!1});this.updateDisplay();this.domElement.appendChild(this.__input)};r.superclass=e;i.extend(r.prototype,e.prototype,{updateDisplay:function(){var e,t=this.__input;if(this.__truncationSuspended)e=this.getValue();else{e=this.getValue();var i=Math.pow(10,this.__precision);e=Math.round(e*i)/i}t.value=e;return r.superclass.prototype.updateDisplay.call(this)}});return r}(dat.controllers.NumberController,dat.dom.dom,dat.utils.common);dat.controllers.NumberControllerSlider=function(e,t,i,r,n){var o=function(e,i,r,n,a){function s(e){e.preventDefault();var i=t.getOffset(h.__background),r=t.getWidth(h.__background);h.setValue(h.__min+(h.__max-h.__min)*((e.clientX-i.left)/(i.left+r-i.left)));return!1}function l(){t.unbind(window,"mousemove",s);t.unbind(window,"mouseup",l);h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}o.superclass.call(this,e,i,{min:r,max:n,step:a});var h=this;this.__background=document.createElement("div");this.__foreground=document.createElement("div");t.bind(this.__background,"mousedown",function(e){t.bind(window,"mousemove",s);t.bind(window,"mouseup",l);s(e)});t.addClass(this.__background,"slider");t.addClass(this.__foreground,"slider-fg");this.updateDisplay();this.__background.appendChild(this.__foreground);this.domElement.appendChild(this.__background)};o.superclass=e;o.useDefaultStyles=function(){i.inject(n)};r.extend(o.prototype,e.prototype,{updateDisplay:function(){this.__foreground.style.width=100*((this.getValue()-this.__min)/(this.__max-this.__min))+"%";return o.superclass.prototype.updateDisplay.call(this)}});return o}(dat.controllers.NumberController,dat.dom.dom,dat.utils.css,dat.utils.common,".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}");dat.controllers.FunctionController=function(e,t,i){var r=function(e,i,n){r.superclass.call(this,e,i);var o=this;this.__button=document.createElement("div");this.__button.innerHTML=void 0===n?"Fire":n;t.bind(this.__button,"click",function(e){e.preventDefault();o.fire();return!1});t.addClass(this.__button,"button");this.domElement.appendChild(this.__button)};r.superclass=e;i.extend(r.prototype,e.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this);this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue());this.getValue().call(this.object)}});return r}(dat.controllers.Controller,dat.dom.dom,dat.utils.common);dat.controllers.BooleanController=function(e,t,i){var r=function(e,i){r.superclass.call(this,e,i);var n=this;this.__prev=this.getValue();this.__checkbox=document.createElement("input");this.__checkbox.setAttribute("type","checkbox");t.bind(this.__checkbox,"change",function(){n.setValue(!n.__prev)},!1);this.domElement.appendChild(this.__checkbox);this.updateDisplay()};r.superclass=e;i.extend(r.prototype,e.prototype,{setValue:function(e){e=r.superclass.prototype.setValue.call(this,e);this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue());this.__prev=this.getValue();return e},updateDisplay:function(){this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1;return r.superclass.prototype.updateDisplay.call(this)}});return r}(dat.controllers.Controller,dat.dom.dom,dat.utils.common);dat.color.toString=function(e){return function(t){if(1==t.a||e.isUndefined(t.a)){for(t=t.hex.toString(16);t.length<6;)t="0"+t;return"#"+t}else return"rgba("+Math.round(t.r)+","+Math.round(t.g)+","+Math.round(t.b)+","+t.a+")"}}(dat.utils.common);dat.color.interpret=function(e,t){var i,r,n=[{litmus:t.isString,conversions:{THREE_CHAR_HEX:{read:function(e){e=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:e},SIX_CHAR_HEX:{read:function(e){e=e.match(/^#([A-F0-9]{6})$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:e},CSS_RGB:{read:function(e){e=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:e},CSS_RGBA:{read:function(e){e=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:e}}},{litmus:t.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:t.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3!=e.length?!1:{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4!=e.length?!1:{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:t.isObject,conversions:{RGBA_OBJ:{read:function(e){return t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)&&t.isNumber(e.a)?{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)?{space:"RGB",r:e.r,g:e.g,b:e.b}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)&&t.isNumber(e.a)?{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)?{space:"HSV",h:e.h,s:e.s,v:e.v}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}];return function(){r=!1;var e=arguments.length>1?t.toArray(arguments):arguments[0];t.each(n,function(n){if(n.litmus(e))return t.each(n.conversions,function(n,o){i=n.read(e);if(r===!1&&i!==!1)return r=i,i.conversionName=o,i.conversion=n,t.BREAK;else return void 0}),t.BREAK;else return void 0});return r}}(dat.color.toString,dat.utils.common);dat.GUI=dat.gui.GUI=function(e,t,i,r,n,o,a,s,l,h,c,u,f,d,p){function m(e,t,i,o){if(void 0===t[i])throw Error("Object "+t+' has no property "'+i+'"');o.color?t=new c(t,i):(t=[t,i].concat(o.factoryArgs),t=r.apply(e,t));if(o.before instanceof n)o.before=o.before.__li;E(e,t);d.addClass(t.domElement,"c");i=document.createElement("span");d.addClass(i,"property-name");i.innerHTML=t.property;var a=document.createElement("div");a.appendChild(i);a.appendChild(t.domElement);o=g(e,a,o.before);d.addClass(o,L.CLASS_CONTROLLER_ROW);d.addClass(o,typeof t.getValue());v(e,o,t);e.__controllers.push(t);return t}function g(e,t,i){var r=document.createElement("li");t&&r.appendChild(t);i?e.__ul.insertBefore(r,params.before):e.__ul.appendChild(r);e.onResize();return r}function v(e,t,i){i.__li=t;i.__gui=e;p.extend(i,{options:function(t){if(arguments.length>1)return i.remove(),m(e,i.object,i.property,{before:i.__li.nextElementSibling,factoryArgs:[p.toArray(arguments)]});if(p.isArray(t)||p.isObject(t))return i.remove(),m(e,i.object,i.property,{before:i.__li.nextElementSibling,factoryArgs:[t]});else return void 0},name:function(e){i.__li.firstElementChild.firstElementChild.innerHTML=e;return i},listen:function(){i.__gui.listen(i);return i},remove:function(){i.__gui.remove(i);return i}});if(i instanceof l){var r=new s(i.object,i.property,{min:i.__min,max:i.__max,step:i.__step});p.each(["updateDisplay","onChange","onFinishChange"],function(e){var t=i[e],n=r[e];i[e]=r[e]=function(){var e=Array.prototype.slice.call(arguments);t.apply(i,e);return n.apply(r,e)}});d.addClass(t,"has-slider");i.domElement.insertBefore(r.domElement,i.domElement.firstElementChild)}else if(i instanceof s){var n=function(t){return p.isNumber(i.__min)&&p.isNumber(i.__max)?(i.remove(),m(e,i.object,i.property,{before:i.__li.nextElementSibling,factoryArgs:[i.__min,i.__max,i.__step]})):t};i.min=p.compose(n,i.min);i.max=p.compose(n,i.max)}else if(i instanceof o)d.bind(t,"click",function(){d.fakeEvent(i.__checkbox,"click")}),d.bind(i.__checkbox,"click",function(e){e.stopPropagation()});else if(i instanceof a)d.bind(t,"click",function(){d.fakeEvent(i.__button,"click")}),d.bind(t,"mouseover",function(){d.addClass(i.__button,"hover")}),d.bind(t,"mouseout",function(){d.removeClass(i.__button,"hover")});else if(i instanceof c)d.addClass(t,"color"),i.updateDisplay=p.compose(function(e){t.style.borderLeftColor=i.__color.toString();return e},i.updateDisplay),i.updateDisplay();i.setValue=p.compose(function(t){e.getRoot().__preset_select&&i.isModified()&&R(e.getRoot(),!0);return t},i.setValue)}function E(e,t){var i=e.getRoot(),r=i.__rememberedObjects.indexOf(t.object);if(-1!=r){var n=i.__rememberedObjectIndecesToControllers[r];void 0===n&&(n={},i.__rememberedObjectIndecesToControllers[r]=n);n[t.property]=t;if(i.load&&i.load.remembered){i=i.load.remembered;if(i[e.preset])i=i[e.preset];else if(i[M])i=i[M];else return;if(i[r]&&void 0!==i[r][t.property])r=i[r][t.property],t.initialValue=r,t.setValue(r)}}}function y(e){var t=e.__save_row=document.createElement("li");d.addClass(e.domElement,"has-save");e.__ul.insertBefore(t,e.__ul.firstChild);d.addClass(t,"save-row");var i=document.createElement("span");i.innerHTML="&nbsp;";d.addClass(i,"button gears");var r=document.createElement("span");r.innerHTML="Save";d.addClass(r,"button");d.addClass(r,"save");var n=document.createElement("span");n.innerHTML="New";d.addClass(n,"button");d.addClass(n,"save-as");var o=document.createElement("span");o.innerHTML="Revert";d.addClass(o,"button");d.addClass(o,"revert");var a=e.__preset_select=document.createElement("select");e.load&&e.load.remembered?p.each(e.load.remembered,function(t,i){x(e,i,i==e.preset)}):x(e,M,!1);d.bind(a,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value});t.appendChild(a);t.appendChild(i);t.appendChild(r);t.appendChild(n);t.appendChild(o);if(H){var t=document.getElementById("dg-save-locally"),s=document.getElementById("dg-local-explain");t.style.display="block";t=document.getElementById("dg-local-storage");"true"===localStorage.getItem(document.location.href+".isLocal")&&t.setAttribute("checked","checked");var l=function(){s.style.display=e.useLocalStorage?"block":"none"};l();d.bind(t,"change",function(){e.useLocalStorage=!e.useLocalStorage;l()})}var h=document.getElementById("dg-new-constructor");d.bind(h,"keydown",function(e){e.metaKey&&(67===e.which||67==e.keyCode)&&C.hide()});d.bind(i,"click",function(){h.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2);C.show();h.focus();h.select()});d.bind(r,"click",function(){e.save()});d.bind(n,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)});d.bind(o,"click",function(){e.revert()})}function T(e){function t(t){t.preventDefault();n=t.clientX;d.addClass(e.__closeButton,L.CLASS_DRAG);d.bind(window,"mousemove",i);d.bind(window,"mouseup",r);return!1}function i(t){t.preventDefault();e.width+=n-t.clientX;e.onResize();n=t.clientX;return!1}function r(){d.removeClass(e.__closeButton,L.CLASS_DRAG);d.unbind(window,"mousemove",i);d.unbind(window,"mouseup",r)}e.__resize_handle=document.createElement("div");p.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var n;d.bind(e.__resize_handle,"mousedown",t);d.bind(e.__closeButton,"mousedown",t);e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function _(e,t){e.domElement.style.width=t+"px";if(e.__save_row&&e.autoPlace)e.__save_row.style.width=t+"px";if(e.__closeButton)e.__closeButton.style.width=t+"px"}function b(e,t){var i={};p.each(e.__rememberedObjects,function(r,n){var o={};p.each(e.__rememberedObjectIndecesToControllers[n],function(e,i){o[i]=t?e.initialValue:e.getValue()});i[n]=o});return i}function x(e,t,i){var r=document.createElement("option");r.innerHTML=t;r.value=t;e.__preset_select.appendChild(r);if(i)e.__preset_select.selectedIndex=e.__preset_select.length-1}function R(e,t){var i=e.__preset_select[e.__preset_select.selectedIndex];i.innerHTML=t?i.value+"*":i.value}function w(e){0!=e.length&&u(function(){w(e)});p.each(e,function(e){e.updateDisplay()})}e.inject(i);var H,M="Default";try{H="localStorage"in window&&null!==window.localStorage}catch(S){H=!1}var C,A,D=!0,P=!1,k=[],L=function(e){function t(){localStorage.setItem(document.location.href+".gui",JSON.stringify(r.getSaveObject()))}function i(){var e=r.getRoot();e.width+=1;p.defer(function(){e.width-=1})}var r=this;this.domElement=document.createElement("div");this.__ul=document.createElement("ul");this.domElement.appendChild(this.__ul);d.addClass(this.domElement,"dg");this.__folders={};this.__controllers=[];this.__rememberedObjects=[];this.__rememberedObjectIndecesToControllers=[];this.__listening=[];e=e||{};e=p.defaults(e,{autoPlace:!0,width:L.DEFAULT_WIDTH});e=p.defaults(e,{resizable:e.autoPlace,hideable:e.autoPlace});if(p.isUndefined(e.load))e.load={preset:M};else if(e.preset)e.load.preset=e.preset;p.isUndefined(e.parent)&&e.hideable&&k.push(this);e.resizable=p.isUndefined(e.parent)&&e.resizable;if(e.autoPlace&&p.isUndefined(e.scrollable))e.scrollable=!0;var n=H&&"true"===localStorage.getItem(document.location.href+".isLocal");Object.defineProperties(this,{parent:{get:function(){return e.parent}},scrollable:{get:function(){return e.scrollable}},autoPlace:{get:function(){return e.autoPlace}},preset:{get:function(){return r.parent?r.getRoot().preset:e.load.preset},set:function(t){r.parent?r.getRoot().preset=t:e.load.preset=t;for(t=0;t<this.__preset_select.length;t++)if(this.__preset_select[t].value==this.preset)this.__preset_select.selectedIndex=t;r.revert()}},width:{get:function(){return e.width},set:function(t){e.width=t;_(r,t)}},name:{get:function(){return e.name},set:function(t){e.name=t;if(a)a.innerHTML=e.name}},closed:{get:function(){return e.closed},set:function(t){e.closed=t;e.closed?d.addClass(r.__ul,L.CLASS_CLOSED):d.removeClass(r.__ul,L.CLASS_CLOSED);this.onResize();if(r.__closeButton)r.__closeButton.innerHTML=t?L.TEXT_OPEN:L.TEXT_CLOSED}},load:{get:function(){return e.load}},useLocalStorage:{get:function(){return n},set:function(e){H&&((n=e)?d.bind(window,"unload",t):d.unbind(window,"unload",t),localStorage.setItem(document.location.href+".isLocal",e))}}});if(p.isUndefined(e.parent)){e.closed=!1;d.addClass(this.domElement,L.CLASS_MAIN);d.makeSelectable(this.domElement,!1);if(H&&n){r.useLocalStorage=!0;var o=localStorage.getItem(document.location.href+".gui");if(o)e.load=JSON.parse(o)}this.__closeButton=document.createElement("div");this.__closeButton.innerHTML=L.TEXT_CLOSED;d.addClass(this.__closeButton,L.CLASS_CLOSE_BUTTON);this.domElement.appendChild(this.__closeButton);d.bind(this.__closeButton,"click",function(){r.closed=!r.closed})}else{if(void 0===e.closed)e.closed=!0;var a=document.createTextNode(e.name);d.addClass(a,"controller-name");o=g(r,a);d.addClass(this.__ul,L.CLASS_CLOSED);d.addClass(o,"title");d.bind(o,"click",function(e){e.preventDefault();r.closed=!r.closed;return!1});if(!e.closed)this.closed=!1}e.autoPlace&&(p.isUndefined(e.parent)&&(D&&(A=document.createElement("div"),d.addClass(A,"dg"),d.addClass(A,L.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(A),D=!1),A.appendChild(this.domElement),d.addClass(this.domElement,L.CLASS_AUTO_PLACE)),this.parent||_(r,e.width));d.bind(window,"resize",function(){r.onResize()});d.bind(this.__ul,"webkitTransitionEnd",function(){r.onResize()});d.bind(this.__ul,"transitionend",function(){r.onResize()});d.bind(this.__ul,"oTransitionEnd",function(){r.onResize()});this.onResize();e.resizable&&T(this);r.getRoot();e.parent||i()};L.toggleHide=function(){P=!P;p.each(k,function(e){e.domElement.style.zIndex=P?-999:999;e.domElement.style.opacity=P?0:1})};L.CLASS_AUTO_PLACE="a";L.CLASS_AUTO_PLACE_CONTAINER="ac";L.CLASS_MAIN="main";L.CLASS_CONTROLLER_ROW="cr";L.CLASS_TOO_TALL="taller-than-window";L.CLASS_CLOSED="closed";L.CLASS_CLOSE_BUTTON="close-button";L.CLASS_DRAG="drag";L.DEFAULT_WIDTH=245;L.TEXT_CLOSED="Close Controls";L.TEXT_OPEN="Open Controls";d.bind(window,"keydown",function(e){"text"!==document.activeElement.type&&(72===e.which||72==e.keyCode)&&L.toggleHide()},!1);p.extend(L.prototype,{add:function(e,t){return m(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return m(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li);this.__controllers.slice(this.__controllers.indexOf(e),1);var t=this;p.defer(function(){t.onResize()})},destroy:function(){this.autoPlace&&A.removeChild(this.domElement)},addFolder:function(e){if(void 0!==this.__folders[e])throw Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace;if(this.load&&this.load.folders&&this.load.folders[e])t.closed=this.load.folders[e].closed,t.load=this.load.folders[e];t=new L(t);this.__folders[e]=t;e=g(this,t.domElement);d.addClass(e,"folder");return t},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=d.getOffset(e.__ul).top,i=0;p.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(i+=d.getHeight(t))});window.innerHeight-t-20<i?(d.addClass(e.domElement,L.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(d.removeClass(e.domElement,L.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&p.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"});if(e.__closeButton)e.__closeButton.style.width=e.width+"px"},remember:function(){if(p.isUndefined(C))C=new f,C.domElement.innerHTML=t;if(this.parent)throw Error("You can only call remember on a top level GUI.");var e=this;p.each(Array.prototype.slice.call(arguments),function(t){0==e.__rememberedObjects.length&&y(e);-1==e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)});this.autoPlace&&_(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;e.closed=this.closed;if(this.__rememberedObjects.length>0){e.preset=this.preset;if(!e.remembered)e.remembered={};e.remembered[this.preset]=b(this)}e.folders={};p.each(this.__folders,function(t,i){e.folders[i]=t.getSaveObject()});return e},save:function(){if(!this.load.remembered)this.load.remembered={};this.load.remembered[this.preset]=b(this);R(this,!1)},saveAs:function(e){if(!this.load.remembered)this.load.remembered={},this.load.remembered[M]=b(this,!0);this.load.remembered[e]=b(this);this.preset=e;x(this,e,!0)},revert:function(e){p.each(this.__controllers,function(t){this.getRoot().load.remembered?E(e||this.getRoot(),t):t.setValue(t.initialValue)},this);p.each(this.__folders,function(e){e.revert(e)});e||R(this.getRoot(),!1)},listen:function(e){var t=0==this.__listening.length;this.__listening.push(e);t&&w(this.__listening)}});return L}(dat.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n",dat.controllers.factory=function(e,t,i,r,n,o,a){return function(s,l,h,c){var u=s[l];if(a.isArray(h)||a.isObject(h))return new e(s,l,h);if(a.isNumber(u))return a.isNumber(h)&&a.isNumber(c)?new i(s,l,h,c):new t(s,l,{min:h,max:c});if(a.isString(u))return new r(s,l);if(a.isFunction(u))return new n(s,l,"");if(a.isBoolean(u))return new o(s,l);else return void 0}}(dat.controllers.OptionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.StringController=function(e,t,i){var r=function(e,i){function n(){o.setValue(o.__input.value)}r.superclass.call(this,e,i);var o=this;this.__input=document.createElement("input");this.__input.setAttribute("type","text");t.bind(this.__input,"keyup",n);t.bind(this.__input,"change",n);t.bind(this.__input,"blur",function(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())});t.bind(this.__input,"keydown",function(e){13===e.keyCode&&this.blur()});this.updateDisplay();this.domElement.appendChild(this.__input)};r.superclass=e;i.extend(r.prototype,e.prototype,{updateDisplay:function(){if(!t.isActive(this.__input))this.__input.value=this.getValue();return r.superclass.prototype.updateDisplay.call(this)}});return r}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.FunctionController,dat.controllers.BooleanController,dat.utils.common),dat.controllers.Controller,dat.controllers.BooleanController,dat.controllers.FunctionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.OptionController,dat.controllers.ColorController=function(e,t,i,r,n){function o(e,t,i,r){e.style.background="";n.each(l,function(n){e.style.cssText+="background: "+n+"linear-gradient("+t+", "+i+" 0%, "+r+" 100%); "})}function a(e){e.style.background="";e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);";e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var s=function(e,l){function h(e){d(e);t.bind(window,"mousemove",d);t.bind(window,"mouseup",c)}function c(){t.unbind(window,"mousemove",d);t.unbind(window,"mouseup",c)}function u(){var e=r(this.value);e!==!1?(m.__color.__state=e,m.setValue(m.__color.toOriginal())):this.value=m.__color.toString()}function f(){t.unbind(window,"mousemove",p);t.unbind(window,"mouseup",f)}function d(e){e.preventDefault();var i=t.getWidth(m.__saturation_field),r=t.getOffset(m.__saturation_field),n=(e.clientX-r.left+document.body.scrollLeft)/i,e=1-(e.clientY-r.top+document.body.scrollTop)/i;e>1?e=1:0>e&&(e=0);n>1?n=1:0>n&&(n=0);m.__color.v=e;m.__color.s=n;m.setValue(m.__color.toOriginal());return!1}function p(e){e.preventDefault();var i=t.getHeight(m.__hue_field),r=t.getOffset(m.__hue_field),e=1-(e.clientY-r.top+document.body.scrollTop)/i;e>1?e=1:0>e&&(e=0);m.__color.h=360*e;m.setValue(m.__color.toOriginal());return!1}s.superclass.call(this,e,l);this.__color=new i(this.getValue());this.__temp=new i(0);var m=this;this.domElement=document.createElement("div");t.makeSelectable(this.domElement,!1);this.__selector=document.createElement("div");this.__selector.className="selector";this.__saturation_field=document.createElement("div");this.__saturation_field.className="saturation-field";this.__field_knob=document.createElement("div");this.__field_knob.className="field-knob";this.__field_knob_border="2px solid ";this.__hue_knob=document.createElement("div");this.__hue_knob.className="hue-knob";this.__hue_field=document.createElement("div");this.__hue_field.className="hue-field";this.__input=document.createElement("input");this.__input.type="text";this.__input_textShadow="0 1px 1px ";t.bind(this.__input,"keydown",function(e){13===e.keyCode&&u.call(this)});t.bind(this.__input,"blur",u);t.bind(this.__selector,"mousedown",function(){t.addClass(this,"drag").bind(window,"mouseup",function(){t.removeClass(m.__selector,"drag")})});var g=document.createElement("div");n.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"});n.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1});n.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1});n.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"});n.extend(g.style,{width:"100%",height:"100%",background:"none"});o(g,"top","rgba(0,0,0,0)","#000");n.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"});a(this.__hue_field);n.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"});t.bind(this.__saturation_field,"mousedown",h);t.bind(this.__field_knob,"mousedown",h);t.bind(this.__hue_field,"mousedown",function(e){p(e);t.bind(window,"mousemove",p);t.bind(window,"mouseup",f)});this.__saturation_field.appendChild(g);this.__selector.appendChild(this.__field_knob);this.__selector.appendChild(this.__saturation_field);this.__selector.appendChild(this.__hue_field);this.__hue_field.appendChild(this.__hue_knob);this.domElement.appendChild(this.__input);this.domElement.appendChild(this.__selector);this.updateDisplay()};s.superclass=e;n.extend(s.prototype,e.prototype,{updateDisplay:function(){var e=r(this.getValue());if(e!==!1){var t=!1;n.each(i.COMPONENTS,function(i){if(!n.isUndefined(e[i])&&!n.isUndefined(this.__color.__state[i])&&e[i]!==this.__color.__state[i])return t=!0,{};else return void 0},this);t&&n.extend(this.__color.__state,e)
}n.extend(this.__temp.__state,this.__color.__state);this.__temp.a=1;var a=this.__color.v<.5||this.__color.s>.5?255:0,s=255-a;n.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+a+","+a+","+a+")"});this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px";this.__temp.s=1;this.__temp.v=1;o(this.__saturation_field,"left","#fff",this.__temp.toString());n.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+a+","+a+","+a+")",textShadow:this.__input_textShadow+"rgba("+s+","+s+","+s+",.7)"})}});var l=["-moz-","-o-","-webkit-","-ms-",""];return s}(dat.controllers.Controller,dat.dom.dom,dat.color.Color=function(e,t,i,r){function n(e,t,i){Object.defineProperty(e,t,{get:function(){if("RGB"===this.__state.space)return this.__state[t];a(this,t,i);return this.__state[t]},set:function(e){if("RGB"!==this.__state.space)a(this,t,i),this.__state.space="RGB";this.__state[t]=e}})}function o(e,t){Object.defineProperty(e,t,{get:function(){if("HSV"===this.__state.space)return this.__state[t];s(this);return this.__state[t]},set:function(e){if("HSV"!==this.__state.space)s(this),this.__state.space="HSV";this.__state[t]=e}})}function a(e,i,n){if("HEX"===e.__state.space)e.__state[i]=t.component_from_hex(e.__state.hex,n);else if("HSV"===e.__state.space)r.extend(e.__state,t.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v));else throw"Corrupted color state"}function s(e){var i=t.rgb_to_hsv(e.r,e.g,e.b);r.extend(e.__state,{s:i.s,v:i.v});if(r.isNaN(i.h)){if(r.isUndefined(e.__state.h))e.__state.h=0}else e.__state.h=i.h}var l=function(){this.__state=e.apply(this,arguments);if(this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};l.COMPONENTS="r,g,b,h,s,v,hex,a".split(",");r.extend(l.prototype,{toString:function(){return i(this)},toOriginal:function(){return this.__state.conversion.write(this)}});n(l.prototype,"r",2);n(l.prototype,"g",1);n(l.prototype,"b",0);o(l.prototype,"h");o(l.prototype,"s");o(l.prototype,"v");Object.defineProperty(l.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}});Object.defineProperty(l.prototype,"hex",{get:function(){if("HEX"!==!this.__state.space)this.__state.hex=t.rgb_to_hex(this.r,this.g,this.b);return this.__state.hex},set:function(e){this.__state.space="HEX";this.__state.hex=e}});return l}(dat.color.interpret,dat.color.math=function(){var e;return{hsv_to_rgb:function(e,t,i){var r=e/60-Math.floor(e/60),n=i*(1-t),o=i*(1-r*t),t=i*(1-(1-r)*t),e=[[i,t,n],[o,i,n],[n,i,t],[n,o,i],[t,n,i],[i,n,o]][Math.floor(e/60)%6];return{r:255*e[0],g:255*e[1],b:255*e[2]}},rgb_to_hsv:function(e,t,i){var r=Math.min(e,t,i),n=Math.max(e,t,i),r=n-r;if(0==n)return{h:0/0,s:0,v:0};e=e==n?(t-i)/r:t==n?2+(i-e)/r:4+(e-t)/r;e/=6;0>e&&(e+=1);return{h:360*e,s:r/n,v:n/255}},rgb_to_hex:function(e,t,i){e=this.hex_with_component(0,2,e);e=this.hex_with_component(e,1,t);return e=this.hex_with_component(e,0,i)},component_from_hex:function(e,t){return 255&e>>8*t},hex_with_component:function(t,i,r){return r<<(e=8*i)|t&~(255<<e)}}}(),dat.color.toString,dat.utils.common),dat.color.interpret,dat.utils.common),dat.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),dat.dom.CenteredDiv=function(e,t){var i=function(){this.backgroundElement=document.createElement("div");t.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"});e.makeFullscreen(this.backgroundElement);this.backgroundElement.style.position="fixed";this.domElement=document.createElement("div");t.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"});document.body.appendChild(this.backgroundElement);document.body.appendChild(this.domElement);var i=this;e.bind(this.backgroundElement,"click",function(){i.hide()})};i.prototype.show=function(){var e=this;this.backgroundElement.style.display="block";this.domElement.style.display="block";this.domElement.style.opacity=0;this.domElement.style.webkitTransform="scale(1.1)";this.layout();t.defer(function(){e.backgroundElement.style.opacity=1;e.domElement.style.opacity=1;e.domElement.style.webkitTransform="scale(1)"})};i.prototype.hide=function(){var t=this,i=function(){t.domElement.style.display="none";t.backgroundElement.style.display="none";e.unbind(t.domElement,"webkitTransitionEnd",i);e.unbind(t.domElement,"transitionend",i);e.unbind(t.domElement,"oTransitionEnd",i)};e.bind(this.domElement,"webkitTransitionEnd",i);e.bind(this.domElement,"transitionend",i);e.bind(this.domElement,"oTransitionEnd",i);this.backgroundElement.style.opacity=0;this.domElement.style.opacity=0;this.domElement.style.webkitTransform="scale(1.1)"};i.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-e.getWidth(this.domElement)/2+"px";this.domElement.style.top=window.innerHeight/2-e.getHeight(this.domElement)/2+"px"};return i}(dat.dom.dom,dat.utils.common),dat.dom.dom,dat.utils.common);define("libs/datgui",function(){});!function(e){if("function"==typeof define&&define.amd)define("purl",e);else window.purl=e()}(function(){function e(e,t){var i=decodeURI(e),r=m[t?"strict":"loose"].exec(i),n={attr:{},param:{},seg:{}},a=14;for(;a--;)n.attr[d[a]]=r[a]||"";n.param["query"]=o(n.attr["query"]);n.param["fragment"]=o(n.attr["fragment"]);n.seg["path"]=n.attr.path.replace(/^\/+|\/+$/g,"").split("/");n.seg["fragment"]=n.attr.fragment.replace(/^\/+|\/+$/g,"").split("/");n.attr["base"]=n.attr.host?(n.attr.protocol?n.attr.protocol+"://"+n.attr.host:n.attr.host)+(n.attr.port?":"+n.attr.port:""):"";return n}function t(e){var t=e.tagName;if("undefined"!=typeof t)return f[t.toLowerCase()];else return t}function i(e,t){if(0===e[t].length)return e[t]={};var i={};for(var r in e[t])i[r]=e[t][r];e[t]=i;return i}function r(e,t,n,o){var a=e.shift();if(!a)if(h(t[n]))t[n].push(o);else if("object"==typeof t[n])t[n]=o;else if("undefined"==typeof t[n])t[n]=o;else t[n]=[t[n],o];else{var s=t[n]=t[n]||[];if("]"==a)if(h(s)){if(""!==o)s.push(o)}else if("object"==typeof s)s[c(s).length]=o;else s=t[n]=[t[n],o];else if(~a.indexOf("]")){a=a.substr(0,a.length-1);if(!g.test(a)&&h(s))s=i(t,n);r(e,s,a,o)}else{if(!g.test(a)&&h(s))s=i(t,n);r(e,s,a,o)}}}function n(e,t,i){if(~t.indexOf("]")){var n=t.split("[");r(n,e,"base",i)}else{if(!g.test(t)&&h(e.base)){var o={};for(var s in e.base)o[s]=e.base[s];e.base=o}if(""!==t)a(e.base,t,i)}return e}function o(e){return l(String(e).split(/&|;/),function(e,t){try{t=decodeURIComponent(t.replace(/\+/g," "))}catch(i){}var r=t.indexOf("="),o=s(t),a=t.substr(0,o||r),l=t.substr(o||r,t.length);l=l.substr(l.indexOf("=")+1,l.length);if(""===a){a=t;l=""}return n(e,a,l)},{base:{}}).base}function a(e,t,i){var r=e[t];if("undefined"==typeof r)e[t]=i;else if(h(r))r.push(i);else e[t]=[r,i]}function s(e){var t,i,r=e.length;for(var n=0;r>n;++n){i=e[n];if("]"==i)t=!1;if("["==i)t=!0;if("="==i&&!t)return n}}function l(e,t){var i=0,r=e.length>>0,n=arguments[2];for(;r>i;){if(i in e)n=t.call(void 0,n,e[i],i,e);++i}return n}function h(e){return"[object Array]"===Object.prototype.toString.call(e)}function c(e){var t=[];for(var i in e)if(e.hasOwnProperty(i))t.push(i);return t}function u(t,i){if(1===arguments.length&&t===!0){i=!0;t=void 0}i=i||!1;t=t||window.location.toString();return{data:e(t,i),attr:function(e){e=p[e]||e;return"undefined"!=typeof e?this.data.attr[e]:this.data.attr},param:function(e){return"undefined"!=typeof e?this.data.param.query[e]:this.data.param.query},fparam:function(e){return"undefined"!=typeof e?this.data.param.fragment[e]:this.data.param.fragment},segment:function(e){if("undefined"==typeof e)return this.data.seg.path;else{e=0>e?this.data.seg.path.length+e:e-1;return this.data.seg.path[e]}},fsegment:function(e){if("undefined"==typeof e)return this.data.seg.fragment;else{e=0>e?this.data.seg.fragment.length+e:e-1;return this.data.seg.fragment[e]}}}}var f={a:"href",img:"src",form:"action",base:"href",script:"src",iframe:"src",link:"href",embed:"src",object:"data"},d=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","fragment"],p={anchor:"fragment"},m={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},g=/^[0-9]+$/;u.jQuery=function(e){if(null!=e){e.fn.url=function(i){var r="";if(this.length)r=e(this).attr(t(this[0]))||"";return u(r,i)};e.url=u}};u.jQuery(window.jQuery);return u});define("utils/gui",["libs/datgui","purl"],function(){return void 0===$.url().param("gui")?null:new dat.GUI({autoPlace:!1})});define("data",["module"],function(e){var t=function(t,i){require([e.config().instagram.feed+"&callback=define",e.config().twitter.feed+"&callback=define"],function(e,r){r.loaded="OK"===r.status;e.loaded="OK"===e.status;var n=e.loaded&&r.loaded;if(n)t(r,e);else i(e,r)})};t.search=function(t,i){require([e.config().instagram.search+t+"&callback=define&bust="+Date.now(),e.config().twitter.search+t+"&callback=define&bust="+Date.now()],function(e,t){t.loaded="OK"===t.status;e.loaded="OK"===e.status;var r=e.loaded&&t.loaded;if(r)i(t.results.search_results,e.results.search_results);else errCallback(e,t)})};return t});define("textplane",["libs/threejs/build/three"],function(){function e(e,t,i,r,n,o){var a=t.split(" ");var s="";for(var l=0;l<a.length;l++){var h=s+a[l]+" ";var c=e.measureText(h);var u=c.width;if(u>n&&l>0||a[l].split("\n").length>1){e.fillText(s,i,r);s=a[l]+" ";r+=o*(a[l].split("\n").length>1?2:1)}else s=h}e.fillText(s,i,r)}var t=1500;return function(i,r,n,o,a,s){var l=document.createElement("canvas"),h=l.getContext("2d");l.width=t;l.height=t;s=s||0;r=r||11;n=n||16777215;o=o||0;a=a||0;h.font=r+"pt Helvertica Neue, Arial, sans";h.scale(-1,-1);h.measureText(i).width;h=l.getContext("2d");h.textAlign="center";h.font=r+"pt Helvertica Neue, Arial, sans";h.textBaseline="middle";h.fillStyle=("000000"+n.toString(16)).slice(-6);e(h,i,l.width*-.5,l.height*-.5,.3*l.width,31);var c=new THREE.Texture(l);c.needsUpdate=!0;return l}});define("transition",[],function(){function e(e){i=o.length;for(;i-->0;)o[i](e)}function t(e,t,i,n){n.spring=n.spring||r;n.delay=n.delay||0;var o=!1;var a,l,h,c,u,f=0,d=0,p=Math.sqrt(n.spring);return update=function(i,r,m,g){d+=m;if(d>=n.delay){u=r-i;c=m*s.globalSpeed;a=u*n.spring;l=2*-f*p;h=a+l;f+=h*c;f=g?0:f;e[t]+=f*c;if(!o)return o=!0}return!1}}var i,r=1.5,n=20,o=[],a=function(){};var s=function(e,i,r,s){var s=s||{},l=t(e,i,r,s),h=!1,c=!1,u={callback:a,startCallback:function(){},target:r||null,arrived:!1,paused:!1,speed:s.speed||1,dispose:function(){o.splice(o.indexOf(f),1)},reset:function(){h=!0}};s.threshold=s.threshold||n;var f=function(t){c=!1;if(!u.paused&&null!==u.target){c=l(e[i],u.target,t*u.speed,h);if(c)u.startCallback();if(!u.arrived&&Math.abs(u.target-e[i])<=s.threshold){u.arrived=!0;u.callback()}}h=!1};o.push(f);return u};s.update=function(t){e(t||1)};s.globalSpeed=1;s.vec3=function(e,i,r){var s,l,h,r=r||{},c=t(e,["x"],i.x,r),u=t(e,["y"],i.y,r),f=t(e,["z"],i.z,r),d=!1,p=!1;controls={callback:a,startCallback:function(){},target:i||null,arrived:!1,paused:!0,speed:r.speed||1,dispose:function(){o.splice(o.indexOf(m),1)},reset:function(){p=!0}};r.threshold=r.threshold||n;var m=function(t){if(!controls.paused&&null!==controls.target){d=c(e.x,controls.target.x,t*controls.speed,p);d=u(e.y,controls.target.y,t*controls.speed,p)&&d;d=f(e.z,controls.target.z,t*controls.speed,p)&&d;if(d)controls.startCallback();s=controls.target.x-e.x;l=controls.target.y-e.y;h=controls.target.z-e.z;var i=Math.sqrt(s*s+l*l+h*h);if(!controls.arrived&&i<=r.threshold){controls.arrived=!0;controls.callback()}}p=!1};o.push(m);return controls};return s});define("utils/easing",{linear:function(e){return e},inQuad:function(e){return e*e},outQuad:function(e){return e*(2-e)},inOutQuad:function(e){return.5>e?2*e*e:-1+(4-2*e)*e},inCubic:function(e){return e*e*e},outCubic:function(e){return--e*e*e+1},inOutCubic:function(e){return.5>e?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},inQuart:function(e){return e*e*e*e},outQuart:function(e){return 1- --e*e*e*e},inOutQuart:function(e){return.5>e?8*e*e*e*e:1-8*--e*e*e*e},inQuint:function(e){return e*e*e*e*e},outQuint:function(e){return 1+--e*e*e*e*e},inOutQuint:function(e){return.5>e?16*e*e*e*e*e:1+16*--e*e*e*e*e}});THREE.OrbitControls=function(e,t){function i(){return 2*Math.PI/60/60*h.autoRotateSpeed}function r(){return Math.pow(.95,h.userZoomSpeed)}function n(e){if(h.enabled!==!1)if(h.userRotate!==!1){if(0===e.button){x=b.ROTATE;f.set(e.clientX,e.clientY)}else if(1===e.button){x=b.ZOOM;m.set(e.clientX,e.clientY)}else if(2===e.button)x=b.PAN;h.domElement.addEventListener("mousemove",o,!1);h.domElement.addEventListener("mouseup",a,!1)}}function o(e){e.preventDefault();e.stopImmediatePropagation();if(h.enabled!==!1){e.preventDefault();if(x===b.ROTATE){if(w){w=!1;h.dispatchEvent(startDragEvent)}d.set(e.clientX,e.clientY);p.subVectors(d,f);h.rotateLeft(2*Math.PI*p.x/u*h.userRotateSpeed);h.rotateUp(2*Math.PI*p.y/u*h.userRotateSpeed);f.copy(d)}else if(x===b.ZOOM){g.set(e.clientX,e.clientY);v.subVectors(g,m);if(v.y>0)h.zoomIn();else h.zoomOut();m.copy(g)}else if(x===b.PAN){var t=e.movementX||e.mozMovementX||e.webkitMovementX||0;var i=e.movementY||e.mozMovementY||e.webkitMovementY||0;h.pan(new THREE.Vector3(-t,i,0))}}}function a(e){e.preventDefault();e.stopImmediatePropagation();w=!0;if(h.enabled!==!1)if(h.userRotate!==!1){h.domElement.removeEventListener("mousemove",o,!1);h.domElement.removeEventListener("mouseup",a,!1);x=b.NONE}}function s(e){if(h.enabled!==!1)if(h.userZoom!==!1){var t=0;if(e.wheelDelta)t=e.wheelDelta;else if(e.detail)t=-e.detail;if(t>0)h.zoomOut();else h.zoomIn()}}function l(e){if(h.enabled!==!1)if(h.userPan!==!1)switch(e.keyCode){case h.keys.UP:h.pan(new THREE.Vector3(0,1,0));break;case h.keys.BOTTOM:h.pan(new THREE.Vector3(0,-1,0));break;case h.keys.LEFT:h.pan(new THREE.Vector3(-1,0,0));break;case h.keys.RIGHT:h.pan(new THREE.Vector3(1,0,0))}}this.object=e;this.domElement=void 0!==t?t:document;this.enabled=!0;this.center=new THREE.Vector3;this.userZoom=!0;this.userZoomSpeed=1;this.userRotate=!0;this.userRotateSpeed=1;this.userPan=!0;this.userPanSpeed=2;this.autoRotate=!1;this.autoRotateSpeed=2;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.minDistance=0;this.maxDistance=1/0;this.distance=4e3;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var h=this;var c=1e-6;var u=1800;var f=new THREE.Vector2;var d=new THREE.Vector2;var p=new THREE.Vector2;var m=new THREE.Vector2;var g=new THREE.Vector2;var v=new THREE.Vector2;var E=0;var y=0;var T=1;var _=new THREE.Vector3;var b={NONE:-1,ROTATE:0,ZOOM:1,PAN:2};var x=b.NONE;var R={type:"change"};this.rotateLeft=function(e){if(void 0===e)e=i();y-=e};this.rotateRight=function(e){if(void 0===e)e=i();y+=e};this.rotateUp=function(e){if(void 0===e)e=i();E-=e};this.rotateDown=function(e){if(void 0===e)e=i();E+=e};this.zoomIn=function(e){if(void 0===e)e=r();T/=e};this.zoomOut=function(e){if(void 0===e)e=r();T*=e};this.pan=function(e){e.transformDirection(this.object.matrix);e.multiplyScalar(h.userPanSpeed);this.object.position.add(e);this.center.add(e)};this.update=function(e){if(e)this.object=e;var t=this.object.position;var r=t.clone().sub(this.center);var n=Math.atan2(r.x,r.z);var o=Math.atan2(Math.sqrt(r.x*r.x+r.z*r.z),r.y);if(this.autoRotate)this.rotateLeft(i());n+=y;o+=E;o=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,o));o=Math.max(c,Math.min(Math.PI-c,o));r.length()*T;r.x=this.distance*Math.sin(o)*Math.sin(n);r.y=this.distance*Math.cos(o);r.z=this.distance*Math.sin(o)*Math.cos(n);t.copy(this.center).add(r);this.object.lookAt(this.center);y=0;E=0;T=1;if(_.distanceTo(this.object.position)>0){this.dispatchEvent(R);_.copy(this.object.position)}};var w=!0;startDragEvent={type:"drag"};this.setPauseState=function(e){if(this.enabled===e){if(e){this.domElement.removeEventListener("mousemove",o,!1);this.domElement.removeEventListener("mouseup",a,!1);this.domElement.addEventListener("mousewheel",a,!1)}else{this.domElement.addEventListener("mousedown",n,!1);this.domElement.addEventListener("mousewheel",a,!1)}this.enabled=!e}};this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1);this.domElement.addEventListener("mousedown",n,!1);this.domElement.addEventListener("mousewheel",s,!1);this.domElement.addEventListener("DOMMouseScroll",s,!1);this.domElement.addEventListener("keydown",l,!1)};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);define("libs/threejs/examples/js/controls/OrbitControls",function(){});define("main",["module","jquery","libs/jquery-ui","glsl!shaders/structure.glsl","utils/math","structure","glsl!shaders/skydome.glsl","utils/timer","lighting","utils/gui","data","textplane","transition","utils/easing","glsl!shaders/clouds.glsl","glsl!shaders/post.glsl","purl","./libs/threejs/examples/js/controls/OrbitControls"],function(e,t,i,r,o,a,s,l,h,c,u,f,d,p,m,g){function v(e,t,i){e.fadeIn({duration:t||400,complete:i})}function E(e,t,i){e.stop().fadeOut({duration:t||400,complete:i})}function y(){var e=at.children.length;for(;e-->0;){at.remove(at.children[e]);ii.splice(ii.indexOf(at.children[e]))}}function T(t,i,r){var n=[];n.loadCount=0;Et.image=n;var o="https://levismakeourmark.thismoment.com/v4/api/media/image_proxy.json?url=";Et.flipY=!1;for(var a=0,s=t.length;s>a;++a){var l=new Image;n[a]=l;l.onload=function(){n.loadCount+=1;if(6===n.loadCount){Et.needsUpdate=!0;if(i)i(Et)}};l.onerror=r;l.crossOrigin="";l.src=(e.config().proxy||o)+t[a]}return Et}function _(e,t){e.envMap=T([t,t,t,t,t,t])}function b(e,t){yt.image=[t,t,t,t,t,t];yt.needsUpdate=!0;e.envMap=yt}function x(e,t){q.xOffset=500*p.inOutQuad(q.expanded?t:1-t)}function R(e,t,i){i=i||1;dt=t||250;Tt.target=dt;_t.target.copy(e);st=!0;_t.arrived=!1;Tt.arrived=!1;_t.paused=!1;_t.speed=Tt.speed=i}function w(){if(W&&W.light){W.isSelected=!1;W.light.transition.target=0;W.light.transitionDist.target=1;W.light.transition.paused=!1;Jt.push(W.light)}j=null;ci.out.play();E(q,400);R(nt.set(0,0,0),2e3,.4)}function H(){var e=ot.children.length;for(;e-->0;)if(ot.children[e].material)ot.children[e].material.needsUpdate=!0;e=at.children.length;for(;e-->0;)if(at.children[e].material)at.children[e].material.needsUpdate=!0;zt.needsUpdate=!0}function M(e){It.opacity=e;Nt.opacity=e;It.color.setHex(.5>e?4473924:It.originColor);It.ambient.setHex(.5>e?4473924:It.originAmbientColor);Nt.color.setHex(.5>e?4473924:It.originColor);Nt.ambient.setHex(.5>e?4473924:It.originAmbientColor)}function S(e,t,i){var r=new THREE.Mesh(hi,t?Nt:It);var n=0|Math.random()*$t.volume.length;var o=$t.volume[n];i?r.position.copy(i):r.position.set(o[0],o[1],o[2]);r.position.x-=15;r.position.y-=15;r.position.z-=15;r.position.multiplyScalar(100);r.matrixWorld.setPosition(r.position);r.infoDataObject=e;return r}function C(e){E(q,400);j=null;var t,i=new THREE.Vector3;$("#search-field").blur();if(""!==e)u.search(e,function(r,o){var a=r.concat(o);K.children("#body").children("#results").html('YOUR SEARCH FOR <br/>"<b>'+e.toUpperCase()+'</b>"<br/> RETURNED <b>'+(0===a.length?"NO":Math.min(a.length,V))+"</b> RESULTS");K.fadeIn(400,function(){if(0===a.length)$(this).delay(5e3).fadeOut(400)});ft=!0;y();if(a.length>0){M(.3);var s,l,h=$t.centeredVolume.slice();n=Math.min(a.length,V);for(;n-->0&&h.length>0;){s=h[0|Math.random()*h.length];i.set(s[0],s[1],s[2]);l=n>=r.length;t=S(a[n],l,i);ii.push(t);t.isInstagram=l;t.material=Ot;at.add(t)}}})}function A(){if(Lt){Z.remove(Lt);Lt.geometry.dispose()}$t=a(Vt.frequency,Vt.complexity,Ft,Vt.threshold,Vt.horizontal_thickness,Vt.vertical_thickness);$t.centeredVolume=$t.volume.slice();var e=new THREE.Vector3,t=new THREE.Vector3;$t.centeredVolume.sort(function(i,r){return e.set(i[0]-15,i[1]-15,i[2]-15).length()-t.set(r[0]-15,r[1]-15,r[2]-15).length()});$t.centeredVolume=$t.centeredVolume.splice(0,0|$t.centeredVolume.length*B);Lt=new THREE.Mesh($t.geometry,zt);console.log(Lt.geometry.vertices.length,Lt.geometry.faces.length);Lt.matrixAutoUpdate=!1;Z.add(Lt)}function D(){function e(t){cloat=!0;mi=t-fi;pi=mi-di;pi=pi>O?O:pi;di=mi;ct=Ut.update(J);et.setPauseState(ct);if(!ct)et.update(J);k();d.update(pi/1e3*Vt.speed);if(lt&&W){P(W.position,J,$("#main"));q.css("transform","translate( "+Number(gi.left+250-q.xOffset)+"px, "+Number(gi.top-200)+"px )")}L(pi,di);requestAnimationFrame(e)}if(!ui){ui=!0;ci.ambient.play();di=0;pi=0;mi=0;fi=l.now()-(performance&&performance.timing?performance.timing.navigationStart:F);requestAnimationFrame(e)}}function P(e,t,i){vi.copy(e);Ei.copy(t.projectionMatrix).multiply(t.matrixWorldInverse);vi.applyProjection(Ei);gi.left=(vi.x+1)*i.width()/2;gi.top=(-vi.y+1)*i.height()/2;return gi}function k(){yi.set(rt.x,rt.y,1);tt.unprojectVector(yi,J);it.set(J.position,yi.sub(J.position).normalize());var e=it.intersectObjects(ii,!0);if(e.length>0&&!e[0].object.unclickable){if(G!=e[0].object){ci.mouseOver[Math.floor(Math.random()*ci.mouseOver.length)].play();if(G&&G!==j){G.light.transition.paused=!1;G.light.transition.target=0}if(ft&&-1===at.children.indexOf(e[0].object))return;G=e[0].object;var t=null===G.light;var i=G.light||Jt[Jt.length-Jt.unshift(Jt.pop())];G.light=i;if(t){i.opacity=0;i.transition.reset()}i.transition.target=1;i.object=G;i.color.set(G.material.color).multiplyScalar(30);i.position.copy(G.position);i.transition.paused=!1}}else{if(G&&G!==j){G.light.transition.paused=!1;G.light.transition.target=0}G=null}}function L(e,t){var i=allLights.length;for(;i-->0;){allLights[i].distance=Math.sin(5e-4*t)*range+range+150;allLights[i].intensity=allLights[i].distance/175*(.6*Math.cos(10*t)+8);allLights[i].intensity*=allLights[i].opacity;allLights[i].distance*=allLights[i].distanceCoeff}var r=wt.children.length;for(;r-->0;){wt.children[r].up.set(0,1,0).applyQuaternion(J.quaternion);wt.children[r].lookAt(J.position);wt.children[r].currentRot+=wt.children[r].rotDirection;Ti.setFromAxisAngle(normal,wt.children[r].currentRot);wt.children[r].quaternion.multiply(Ti)}bt.uniforms.uTime.value+=.001*e;xt.position.copy(J.position);forward.set(0,0,-1).applyQuaternion(J.quaternion);xt.position.add(forward);X.render(Z,J)}console.log("==============================");console.log("NAME:         "+NAME);console.log("VERSION:      681c996");console.log("DEBUG MODE:   "+!1);console.log("==============================");var F=Date.now();if(c){var z=document.getElementById("gui");z.appendChild(c.domElement)}var N=window.innerWidth,I=window.innerHeight,O=1e3/60,U=7,V=10,B=.3;new THREE.Vector3(1500,1500,1500);var j,W,G,X=new THREE.WebGLRenderer({antialias:!0}),Y=$("#main")[0],q=$("#info-overlay"),K=$("#search-overlay"),Q=$("#search-field")[0],Z=new THREE.Scene,J=new THREE.PerspectiveCamera(65,N/I,1,1e5),et=new THREE.OrbitControls(J,Y),tt=new THREE.Projector,it=new THREE.Raycaster,rt=new THREE.Vector2,nt=new THREE.Vector3,ot=new THREE.Object3D,at=new THREE.Object3D,st=!1,lt=!1,ht=8e-4,ct=!1,ut=!0,ft=!1;$("#search-field").focus(function(){$(this).parent().toggleClass("search-focus",!0);$(".featured-submissions").slideDown(50)}).blur(function(){if(ut){$(this).parent().toggleClass("search-focus",!1);$(".featured-submissions").slideUp(0)}});$(".vip").mousedown(function(){ut=!1});$(".vip").mouseup(function(){ut=!0;var e=$(this).data().username;$("#search-field").val(e);C(e);$("#search-field").blur()});q.expanded=!1;q.xOffset=0;q.fadeOut(0);Z.fog=new THREE.Fog(0,1,5e3);X.setClearColor(1777698);et.velocity=new THREE.Vector3;et.maxPolarAngle=Math.PI/1.42;et.userRotateSpeed=.4;et.userPan=!1;et.userZoom=!1;et.autoRotate=!0;et.autoRotateSpeed=300*ht;var dt=et.distance=2e3;et.distanceVel=0;et.addEventListener("drag",function(){ci.mouseDrag.play()});J.position.z=2e3;Z.add(J);Z.add(at);Y.appendChild(X.domElement);window.addEventListener("resize",function(){N=window.innerWidth;I=window.innerHeight;J.aspect=N/I;J.updateProjectionMatrix();X.setSize(N,I)});document.addEventListener("mousemove",function(e){e.preventDefault();rt.x=2*(e.clientX/window.innerWidth)-1;rt.y=2*-(e.clientY/window.innerHeight)+1});var pt,mt;if("undefined"!=typeof document.hidden){pt="hidden";mt="visibilitychange"}else if("undefined"!=typeof document.mozHidden){pt="mozHidden";mt="mozvisibilitychange"}else if("undefined"!=typeof document.msHidden){pt="msHidden";mt="msvisibilitychange"}else if("undefined"!=typeof document.webkitHidden){pt="webkitHidden";mt="webkitvisibilitychange"}document.addEventListener(mt,function(){Howler.volume=document[pt]?0:1;if(!document[pt]){di=0;pi=0;mi=0;fi=l.now()-(performance&&performance.timing?performance.timing.navigationStart:F)}});$("#search-field").click(function(e){e.stopImmediatePropagation();$(this).select();$(this).keypress(function(){if(j){j.material.envMap=vt;j.material.needsUpdate=!0}w()})});K.children(".close-button-icon").click(function(e){e.preventDefault();e.stopImmediatePropagation();ft=!1;Q.value="";y();E(K,400);E(q,400);if(q.expanded){q.expanded=!1;q.children("#body").toggle({direction:"right",progress:x,duration:400},400)}M(.75);w()});var gt=["img/skybox/px.jpg","img/skybox/nx.jpg","img/skybox/py.jpg","img/skybox/ny.jpg","img/skybox/pz.jpg","img/skybox/nz.jpg"];var vt=THREE.ImageUtils.loadTextureCube(gt,new THREE.CubeRefractionMapping);var Et=new THREE.Texture(null,new THREE.CubeRefractionMapping);var yt=new THREE.Texture(null,new THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.LinearMipMapLinearFilter,THREE.LinearMipMapLinearFilter);this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(.05,.05);yt.magFilter=THREE.LinearMipMapLinearFilter;yt.minFilter=THREE.LinearMipMapLinearFilter;$("#show-more").click(function(e){e.preventDefault();e.stopImmediatePropagation();q.expanded=!q.expanded;q.children("#body").toggle({direction:"right",easing:"easeInOutQuad",duration:400,progress:x,onComplete:function(){if(!q.expanded)q.video.get(0).currentTime=0}});if(q.video){if(q.expanded)q.video.get(0).currentTime=0;q.expanded?q.video.get(0).play():q.video.get(0).pause()}});q.children(".buttons").children(".close-button-icon").click(function(e){e.preventDefault();e.stopImmediatePropagation();E(q,400);if(q.expanded){q.expanded=!1;q.children("#body").toggle({direction:"right",progress:x,duration:400});if(W.isInstagram)q.video.get(0).pause()}W.material.envMap=vt;W.material.needsUpdate=!0;w()});var Tt=d(et,["distance"],null,{spring:1.5});var _t=d.vec3(et.center,new THREE.Vector3,null,{spring:2});_t.paused=!0;_t.callback=function(){st=!1;lt=!0;if(j){W=j;var e=q.children("#body");ci.closer[Math.floor(Math.random()*ci.closer.length)].play();e.children("#content").html(j.infoDataObject.title);$("#show-more").toggleClass("camera-button-icon",j.isInstagram);e.children("#user-info").children("#user-name").html("<a href='"+(j.isInstagram?"http://instagram.com/"+j.infoDataObject.user_info.screen_name:j.infoDataObject.user_info.user_url)+"' target='_blank'>"+j.infoDataObject.user_name+"</a>");e.children("#user-info").children("#user-id").html((j.isInstagram?"":"@")+j.infoDataObject.user_info.screen_name);e.children("#date").html("Posted via "+(j.isInstagram?"Instagram":"Twitter")+" on "+new Date(j.infoDataObject.add_date).toDateString().slice(4));v(q,400)}};document.addEventListener("click",function(e){if(G&&G!==j){e.preventDefault();e.stopImmediatePropagation();if(ft&&-1===at.children.indexOf(G))return;if(j){j.isSelected=!1;j.light.transition.target=0;j.light.transition.reset();j.light.transition.paused=!1;j.light.transitionDist.target=1;Jt.push(j.light);j.material.envMap=vt;j.material.needsUpdate=!0}j=G;j.isSelected=!0;j.light.transitionDist.target=3;Jt.splice(Jt.indexOf(j.light),1);ci.click[Math.floor(Math.random()*ci.click.length)].play();et.autoRotate=!0;var t=q.children("#body").children("#image");E(q,400,function(e,i,r){t.attr("src",e);if(j.isInstagram)_(j.material,i);else{var n=f(j.infoDataObject.title.toUpperCase(),20);b(j.material,n)}if(j.isInstagram&&r){if(void 0===q.video){$("#date").before(q.video=$('<video width="100%" height="auto" ></video>'));q.video.sourceElem=q.video.append('<source type="video/mp4" />')}q.video.sourceElem.attr("src",r)}}.bind(this,j.infoDataObject.attribution_avatar,j.infoDataObject.media.length>0?j.infoDataObject.media[0].large:void 0,j.infoDataObject.media.length>0?j.infoDataObject.media[0].video_url:void 0));if(q.expanded){q.expanded=!1;q.children("#body").toggle({direction:"right",progress:x,duration:400})}if(q.video){q.video.get(0).pause();q.video.toggle(j.isInstagram,0)}R(j.position)}});X.setSize(N,I);var bt=new THREE.ShaderMaterial({uniforms:{uTime:{type:"f",value:0},opacity:{type:"f",value:.26},fNintensity:{type:"f",value:.8},fSintensity:{type:"f",value:.7},fScount:{type:"f",value:2500},vignetteAmount:{type:"f",value:1},vignetteStart:{type:"f",value:.2},vignetteEnd:{type:"f",value:.87},noiseColor:{type:"c",value:new THREE.Color(2631720)},vignColor:{type:"c",value:new THREE.Color(788488)}},vertexShader:g.vertexShader,fragmentShader:g.fragmentShader,depthWrite:!1,depthTest:!1,transparent:!0,blend:THREE.MultiplyBlending});var xt=new THREE.Mesh(new THREE.PlaneGeometry(2,2,1,1),bt);Z.add(xt);var Rt={};var wt=new THREE.Object3D;new THREE.Geometry;var Ht=THREE.ImageUtils.loadTexture("img/darkCloud.png");Rt.material=new THREE.ShaderMaterial({uniforms:{map:{type:"t",value:Ht},fogColor:{type:"c",value:Z.fog.color},fogNear:{type:"f",value:Z.fog.near},fogFar:{type:"f",value:Z.fog.far},opacity:{type:"f",value:.18},offset:{type:"f",value:.4},useClouds:{type:"f",value:1},exponent:{type:"f",value:1}},vertexShader:m.vertexShader,fragmentShader:m.fragmentShader,depthWrite:!1,transparent:!0,blend:THREE.AdditiveBlending});var Mt=new THREE.PlaneGeometry(64,64);var St;for(var Ct=0;15>Ct;Ct++){St=new THREE.Mesh(Mt,Rt.material);St.position.x=o.random(-1500,1500);St.position.y=o.random(-1500,1500);St.position.z=o.random(-1500,1500);St.oldScale=St.scale.x=St.scale.y=15*Math.random()*Math.random()+25;St.currentRot=Math.random()*Math.PI;St.rotDirection=4e-4*o.random(-1,1);wt.add(St)}Z.add(wt);var At={topColor:{type:"c",value:new THREE.Color(7829367)},bottomColor:{type:"c",value:new THREE.Color(2236962)},offset:{type:"f",value:10},exponent:{type:"f",value:.5}};var Dt=new THREE.SphereGeometry(4e3,32,15);var Pt=new THREE.ShaderMaterial({vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,uniforms:At,side:THREE.BackSide});Pt.visible=!1;var kt=new THREE.Mesh(Dt,Pt);Z.add(kt);var ot,Lt,Ft=2394;var zt=new THREE.MeshPhongMaterial({reflectivity:.3,perPixel:!1,color:2236962,ambient:4353412,specular:16777215,shininess:30,metal:!1});var Nt=new THREE.MeshPhongMaterial({color:new THREE.Color(6688e3),specular:16777215,ambient:new THREE.Color(16720384),transparent:!0,envMap:vt,side:THREE.DoubleSide,opacity:.75});Nt.originColor=new THREE.Color(6688e3);Nt.originAmbientColor=new THREE.Color(16720384);var It=new THREE.MeshPhongMaterial({color:new THREE.Color(2622720),ambient:new THREE.Color(1048320),transparent:!0,envMap:vt,side:THREE.DoubleSide,opacity:.75});It.originColor=new THREE.Color(2622720);It.originAmbientColor=new THREE.Color(1048320);var Ot=new THREE.MeshPhongMaterial({color:new THREE.Color(16724991),ambient:new THREE.Color(1048320),transparent:!0,side:THREE.DoubleSide,opacity:.75});zt.seed=Ft.toString();var Ut=new h(Z,J,Y,c);Ut.onLightAdded(H);Ut.onLightRemoved(H);Ut.addPointLight(16777215);Ut.addPointLight(16777215);Ut.addPointLight(16777215);var Vt={frequency:.95,speed:1.4,threshold:.68,noiseAmount:.7,complexity:.82,horizontal_thickness:11,vertical_thickness:3,generate:A,seed:String(Ft),camera:!1,clouds:{debug:!1,opacity:Rt.material.uniforms.opacity.value,offset:Rt.material.uniforms.offset.value,exponent:Rt.material.uniforms.exponent.value,update:function(){Rt.material.uniforms.exponent.value=Vt.clouds.exponent;
Rt.material.uniforms.opacity.value=Vt.clouds.opacity;Rt.material.uniforms.offset.value=Vt.clouds.offset;Rt.material.uniforms.useClouds.value=Vt.clouds.debug?0:1;var e=wt.children.length;var t;for(;e-->0;){t=!Vt.clouds.debug?wt.children[e].oldScale:5;wt.children[e].scale.set(t,t,1)}}},post:{grain:{speed:1,opacity:bt.uniforms.opacity.value,amount:bt.uniforms.fNintensity.value,scanlines:bt.uniforms.fSintensity.value,numScanlines:bt.uniforms.fScount.value,color:"#"+bt.uniforms.noiseColor.value.getHexString()},vignette:{opacity:bt.uniforms.vignetteAmount.value,start:bt.uniforms.vignetteStart.value,end:bt.uniforms.vignetteEnd.value,color:"#"+bt.uniforms.vignColor.value.getHexString()},update:function(){bt.uniforms.fNintensity.value=Vt.post.grain.amount;bt.uniforms.fSintensity.value=Vt.post.grain.scanlines;bt.uniforms.fScount.value=Vt.post.grain.numScanlines;bt.uniforms.opacity.value=Vt.post.grain.opacity;bt.uniforms.vignetteAmount.value=Vt.post.vignette.opacity;bt.uniforms.vignetteStart.value=Vt.post.vignette.start;bt.uniforms.vignetteEnd.value=Vt.post.vignette.end;bt.uniforms.noiseColor.value.set(Vt.post.grain.color);bt.uniforms.vignColor.value.set(Vt.post.vignette.color)}},background_color:"#"+X.getClearColor().getHexString(),fog:{color:"#"+Z.fog.color.getHexString()},random:function(){Ft=0|9999*Math.random();Vt.seed=String(Ft);A()},updateCamera:function(){J.updateProjectionMatrix()},structure:{shininess:zt.shininess,color:"#"+zt.color.getHexString(),specular:"#"+zt.specular.getHexString(),ambient:"#"+zt.ambient.getHexString(),updateMaterial:function(){zt.color.set(Vt.structure.color);zt.specular.set(Vt.structure.specular);zt.ambient.set(Vt.structure.ambient);zt.shininess=Vt.structure.shininess}},dataObjects:{refractionRatio:.98,reflectivity:1,opacity:.75,metal:!1,twitter:{color:"#"+It.color.getHexString(),specular:"#"+It.specular.getHexString(),ambient:"#"+It.ambient.getHexString(),shininess:It.shininess,combine:It.combine},instagram:{color:"#"+Nt.color.getHexString(),specular:"#"+Nt.specular.getHexString(),ambient:"#"+Nt.ambient.getHexString(),shininess:Nt.shininess,combine:Nt.combine},updateMaterial:function(){Nt.refractionRatio=It.refractionRatio=Vt.dataObjects.refractionRatio;Nt.reflectivity=It.reflectivity=Vt.dataObjects.reflectivity;Nt.opacity=It.opacity=Vt.dataObjects.opacity;Nt.metal=It.metal=Vt.dataObjects.metal;Nt.color.set(Vt.dataObjects.instagram.color);It.color.set(Vt.dataObjects.twitter.color);Nt.specular.set(Vt.dataObjects.instagram.specular);It.specular.set(Vt.dataObjects.twitter.specular);Nt.ambient.set(Vt.dataObjects.instagram.ambient);It.ambient.set(Vt.dataObjects.twitter.ambient);Nt.shininess=Vt.dataObjects.instagram.shininess;It.shininess=Vt.dataObjects.twitter.shininess;Nt.combine=Vt.dataObjects.instagram.combine;It.combine=Vt.dataObjects.twitter.combine;n=at.children.length;for(;n-->0;)if(at.children[n].material){at.children[n].material.refractionRatio=Vt.dataObjects.refractionRatio;at.children[n].material.reflectivity=Vt.dataObjects.reflectivity;at.children[n].material.opacity=Vt.dataObjects.opacity;ot.children[n].material.metal=Vt.dataObjects.metal;ot.children[n].material.needsUpdate=!0}}},updateBackgoundColor:function(){X.setClearColor(Vt.background_color)},updateFogColor:function(){Z.fog.color.set(Vt.fog.color)}};if(c){var Bt=c.addFolder("structure");Bt.add(Vt,"frequency",0,2).onFinishChange(Vt.generate);Bt.add(Vt,"threshold",.01,.99).onFinishChange(Vt.generate);Bt.add(Vt,"complexity",0,1).onFinishChange(Vt.generate);Bt.add(Vt,"horizontal_thickness",0,50).onFinishChange(Vt.generate);Bt.add(Vt,"vertical_thickness",0,50).onFinishChange(Vt.generate);var jt=c.addFolder("Structure Material");jt.addColor(Vt.structure,"color").onChange(Vt.structure.updateMaterial);jt.addColor(Vt.structure,"ambient").onChange(Vt.structure.updateMaterial);jt.addColor(Vt.structure,"specular").onChange(Vt.structure.updateMaterial);jt.add(Vt.structure,"shininess").onChange(Vt.structure.updateMaterial);jt.add(zt,"metal");var Wt=c.addFolder("Data Object Material");Wt.add(Vt.dataObjects,"refractionRatio").onChange(Vt.dataObjects.updateMaterial);Wt.add(Vt.dataObjects,"reflectivity").onChange(Vt.dataObjects.updateMaterial);Wt.add(Vt.dataObjects,"opacity").onChange(Vt.dataObjects.updateMaterial);Wt.add(Vt.dataObjects,"metal").onChange(Vt.dataObjects.updateMaterial);var Gt=Wt.addFolder("instagram material");Gt.addColor(Vt.dataObjects.instagram,"color").onChange(Vt.dataObjects.updateMaterial);Gt.addColor(Vt.dataObjects.instagram,"specular").onChange(Vt.dataObjects.updateMaterial);Gt.addColor(Vt.dataObjects.instagram,"ambient").onChange(Vt.dataObjects.updateMaterial);Gt.add(Vt.dataObjects.instagram,"shininess");Gt.add(Vt.dataObjects.instagram,"combine",{Multiply:THREE.MultiplyOperation,Mix:THREE.MixOperation,Add:THREE.AddOperation}).onChange(Vt.dataObjects.updateMaterial);var Xt=Wt.addFolder("twitter material");Xt.addColor(Vt.dataObjects.twitter,"color").onChange(Vt.dataObjects.updateMaterial);Xt.addColor(Vt.dataObjects.twitter,"specular").onChange(Vt.dataObjects.updateMaterial);Xt.addColor(Vt.dataObjects.twitter,"ambient").onChange(Vt.dataObjects.updateMaterial);Xt.add(Vt.dataObjects.twitter,"shininess");Xt.add(Vt.dataObjects.twitter,"combine",{Multiply:THREE.MultiplyOperation,Mix:THREE.MixOperation,Add:THREE.AddOperation}).onChange(Vt.dataObjects.updateMaterial);var Yt=c.addFolder("clouds");Yt.add(Vt.clouds,"debug").onChange(Vt.clouds.update);Yt.add(Vt.clouds,"opacity",0,1).onChange(Vt.clouds.update);Yt.add(Vt.clouds,"offset",0,1).onChange(Vt.clouds.update);Yt.add(Vt.clouds,"exponent",0).onChange(Vt.clouds.update);var qt=c.addFolder("Fog");qt.addColor(Vt.fog,"color").onChange(Vt.updateFogColor);qt.add(Z.fog,"near");qt.add(Z.fog,"far");var Kt=c.addFolder("Post");var Qt=Kt.addFolder("grain");Qt.add(Vt.post.grain,"amount").onChange(Vt.post.update);Qt.add(Vt.post.grain,"scanlines").onChange(Vt.post.update);Qt.add(Vt.post.grain,"numScanlines").onChange(Vt.post.update);Qt.add(Vt.post.grain,"opacity").onChange(Vt.post.update);Qt.addColor(Vt.post.grain,"color").onChange(Vt.post.update);var Zt=Kt.addFolder("Vignette");Zt.add(Vt.post.vignette,"opacity").onChange(Vt.post.update);Zt.add(Vt.post.vignette,"start").onChange(Vt.post.update);Zt.add(Vt.post.vignette,"end").onChange(Vt.post.update);Zt.addColor(Vt.post.vignette,"color").onChange(Vt.post.update);c.add(Vt,"seed");c.add(Vt,"random");c.add(Vt,"generate");c.add(Pt,"visible");c.add(Vt,"speed");c.add(J,"fov",0,100).onChange(Vt.updateCamera);c.addColor(Vt,"background_color").onChange(Vt.updateBackgoundColor)}var $t,Jt=[],ei=new THREE.Mesh(new THREE.Geometry,Nt),ti=new THREE.Mesh(new THREE.Geometry,It),ii=[];var ri,ni=3;for(;ni-->0;){ri=new THREE.PointLight(16711680,0,250);ri.opacity=0;ri.distanceCoeff=1;ri.transition=d(ri,"opacity",null,{threshold:.01,speed:5});ri.transitionDist=d(ri,"distanceCoeff",1,{threshold:.01,speed:.1});ri.transition.callback=function(e){e.transition.arrived=!1;e.transition.paused=!0;e.opacity=e.transition.target;if(e.transition.target<.5&&e.object&&!e.object.isSelected)e.object.light=null}.bind(this,ri);Jt.push(ri);Z.add(ri)}allLights=Jt.slice();Z.add(ei);Z.add(ti);u(function(e,t){A();var i,r,n,a=e.results.length+t.results.length;for(;a-->0;){r=a>=e.results.length;i=r?t.results[a-e.results.length]:e.results[a];n=S(i,r);n.isInstagram=r;if(U>a){var s=Math.random();var l=1/3>s?"x":2/3>s?"y":"z";n.targetProp=l;n.targetPosition=n.position[l];n.position[l]+=5e3*(2*Math.round(Math.random())-1);n.unclickable=!0;n.transition=d(n.position,l,n.targetPosition,{spring:10,speed:o.random(.5,.6),delay:o.random(2,30)});n.transition.startCallback=function(e){Z.add(e);ci.entering[Math.floor(Math.random()*ci.entering.length)].play()}.bind(this,n);n.transition.callback=function(e){console.log("here",U);e.position[e.targetProp]=e.targetPosition;e.unclickable=!1;ii.push(e);e.transition.dispose()}.bind(this,n)}else{ii.push(n);THREE.GeometryUtils.merge(n.isInstagram?ei.geometry:ti.geometry,n)}}D()},function(e,t){if(!t.loaded)console.log("Instagram failed to load.");if(!e.loaded)console.log("Twitter failed to load.")});var oi=5;var ai=new THREE.Mesh(new THREE.CubeGeometry(85,85,oi,10,10,1)),si=new THREE.Mesh(new THREE.CubeGeometry(oi,85,85,1,10,10)),li=new THREE.Mesh(new THREE.CubeGeometry(85,oi,85,10,1,10));var hi=new THREE.Geometry;ai.position.z=-50;THREE.GeometryUtils.merge(hi,ai);ai.position.z=50;THREE.GeometryUtils.merge(hi,ai);si.position.x=-50;THREE.GeometryUtils.merge(hi,si);si.position.x=50;THREE.GeometryUtils.merge(hi,si);li.position.y=-50;THREE.GeometryUtils.merge(hi,li);li.position.y=50;THREE.GeometryUtils.merge(hi,li);$("#search-field").change(function(){Q.value;C(Q.value)});var ci={};ci.mouseOver=[];ci.mouseOver[0]=new Howl({urls:["audio/over1.mp3"],volume:1});ci.mouseOver[1]=new Howl({urls:["audio/over2.mp3"],volume:1});ci.ambient=new Howl({urls:["audio/raum.mp3"],loop:!0,volume:1});ci.click=[];ci.click[0]=new Howl({urls:["audio/fly-in1.mp3"],volume:1});ci.click[1]=new Howl({urls:["audio/fly-in2.mp3"],volume:1});ci.click[2]=new Howl({urls:["audio/fly-in3.mp3"],volume:1});ci.closer=[];ci.closer[0]=new Howl({urls:["audio/closer1.mp3"],volume:1});ci.closer[1]=new Howl({urls:["audio/closer2.mp3"],volume:1});ci.closer[2]=new Howl({urls:["audio/closer3.mp3"],volume:1});ci.out=new Howl({urls:["audio/flyout.mp3"],volume:1});ci.entering=[];ci.entering[0]=new Howl({urls:["audio/entering1.mp3"],volume:1});ci.entering[1]=new Howl({urls:["audio/entering2.mp3"],volume:1});ci.mouseDrag=new Howl({urls:["audio/turn.mp3"],volume:1});var $t;var ui=!1;var fi,di,pi,mi;var gi={};var vi=new THREE.Vector3,Ei=new THREE.Matrix4;var yi=new THREE.Vector3;forward=new THREE.Vector3(0,0,-1),normal=new THREE.Vector3(0,0,1),camUp=new THREE.Vector3(0,1,0);range=25;var Ti=new THREE.Quaternion});